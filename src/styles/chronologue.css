/* Chronologue Mode Styles */

/* Chronologue timeline arc */
.rt-chronologue-timeline-arc {
  pointer-events: none;
}

.rt-chronologue-timeline-arc line:not(.rt-elapsed-endpoint-marker) {
  stroke: var(--text-muted);
  stroke-width: 1;
}

/* Chronologue time labels */
.rt-chronologue-time-label {
  font-size: 20px;
  fill: var(--text-muted);
  opacity: 0.7;
  pointer-events: none;
}

/* Chronologue warning for scenes without When field */
.rt-chronologue-warning .rt-scene-path {
  stroke: var(--text-error);
  stroke-width: 2;
  stroke-dasharray: 4 4;
}

/* Hide chronological ticks that overlap with elapsed endpoint markers */
.rt-chronological-tick.rt-tick-hidden {
  opacity: 0;
  pointer-events: none;
}

/* Elapsed time label */
.rt-elapsed-time-group {
  pointer-events: none;
}

.rt-elapsed-time-label {
  font-size: 16px;
  font-weight: 700;
  fill: var(--interactive-accent);
  stroke: white;
  stroke-width: 7px;
  stroke-linejoin: round;
  stroke-linecap: round;
  paint-order: stroke fill;
  text-transform: uppercase;
}

.rt-chronologue-duration-ticks {
  pointer-events: none;
}

.rt-chronologue-duration-ticks .rt-duration-arc {
  stroke: var(--text-muted);
  stroke-width: 6px;
}

.rt-chronologue-duration-ticks .rt-duration-arc-overlap {
  stroke: #ff9900;
  /* Yellow for temporal overlaps */
  stroke-width: 6px;
  /*stroke-dasharray: 4, 1; /* Dotted pattern: 4px dash, 1px gap */
}

.rt-chronologue-duration-ticks .rt-duration-arc-unparseable {
  stroke: var(--rt-color-due);
  /* Red for unparseable/missing durations */
  stroke-width: 6px;
}

.rt-chronologue-duration-ticks .rt-duration-arc-ongoing:not(.rt-duration-arc-overlap) {
  stroke: var(--text-muted);
  /* Standard color for "ongoing" durations */
  stroke-width: 6px;
}

/* Discontinuity marker text "âˆž" - infinity symbol marks large time jumps between scenes in chronologue mode */
.rt-discontinuity-marker {
  font-size: 20px;
  font-weight: 500;
  fill: var(--text-muted);
  stroke: rgb(0, 0, 0);
  stroke-width: 6px;
  stroke-linejoin: round;
  stroke-linecap: round;
  paint-order: stroke fill;
  pointer-events: none;
  /* Hide discontinuity markers by default (only show in shift mode) */
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.2s ease, fill 0.2s ease;
  /* Add transition to base state for both directions */
}

/* Show discontinuity markers when shift mode is active */
svg[data-shift-mode="active"] .rt-discontinuity-marker {
  opacity: 1;
  visibility: visible;
}

/* ==========================================================================
   Backdrop Ring Styles
   ========================================================================== */

.rt-backdrop-ring {
  pointer-events: none;
  /* Let clicks pass through to synopsis */
}

.rt-backdrop-ring-background {
  stroke: var(--rt-color-empty); /* Changed to use theme empty color (white/dark-bg) */
  stroke-opacity: 1; /* Fully opaque */
  fill: none !important;
}

/* New border class for inner/outer edges */
.rt-backdrop-border {
  stroke: var(--rt-color-empty); /* Match scene borders (usually white or bg color) */
  stroke-width: 1px;
  fill: none;
  opacity: 1;
}

.radial-timeline-container .rt-backdrop-segment {
  fill: #cccccc; /* Default lighter gray */
  fill-opacity: 1; /* Fully opaque */
  opacity: 1;
  /* transition: fill-opacity 0.2s ease, opacity 0.2s ease; */
  cursor: pointer;
  stroke: none !important; /* No stroke on the segment itself, handled by borders */
  pointer-events: fill !important;
}

/* Active/hovered backdrop segment */
.radial-timeline-container .rt-backdrop-segment:hover,
.radial-timeline-container .rt-backdrop-segment.rt-selected {
  fill: var(--rt-max-publish-stage-color) !important;
  fill-opacity: 0.8 !important;
  stroke: none !important;
}

/* Box outline around backdrop segment (matches planetary calendar box style) */
.rt-backdrop-box {
  display: none; /* Remove dashed border as requested */
  /* transition: stroke 0.2s ease; */
}

/* Hide box during scene hover (global fade) */
.radial-timeline-svg.scene-hover .rt-backdrop-box {
  stroke: transparent;
}

/* Overlap pattern: alternating solid/outline with hue cycling */
.radial-timeline-container .rt-backdrop-segment.rt-backdrop-overlap {
  --rt-backdrop-overlap-hue: var(--rt-backdrop-hue, 210);
  fill: hsl(var(--rt-backdrop-overlap-hue), 65%, 58%);
  stroke: hsl(var(--rt-backdrop-overlap-hue), 65%, 42%);
  stroke-width: 2px;
  fill-opacity: 0.4;
  opacity: 1;
  mix-blend-mode: multiply;
}

/* Hue classes for overlap depth (used instead of inline styles) */
.rt-backdrop-hue-0 { --rt-backdrop-hue: 210; } /* blue */
.rt-backdrop-hue-1 { --rt-backdrop-hue: 20; }  /* orange */
.rt-backdrop-hue-2 { --rt-backdrop-hue: 120; } /* green */
.rt-backdrop-hue-3 { --rt-backdrop-hue: 280; } /* purple */
.rt-backdrop-hue-4 { --rt-backdrop-hue: 60; }  /* yellow */
.rt-backdrop-hue-5 { --rt-backdrop-hue: 320; } /* magenta */
.rt-backdrop-hue-6 { --rt-backdrop-hue: 140; } /* teal */
.rt-backdrop-hue-7 { --rt-backdrop-hue: 260; } /* indigo */

/* When hovering a specific backdrop segment, hide overlap overlays (rendered after bases) */
.radial-timeline-container .rt-backdrop-segment:hover ~ .rt-backdrop-segment.rt-backdrop-overlap,
.radial-timeline-container .rt-backdrop-segment.rt-selected ~ .rt-backdrop-segment.rt-backdrop-overlap {
  opacity: 0;
}

.radial-timeline-container .rt-backdrop-segment.rt-backdrop-overlap-even {
  /* Keep the fill, hide stroke for clean solid */
  stroke: none !important;
  fill-opacity: 0.65;
}

.radial-timeline-container .rt-backdrop-segment.rt-backdrop-overlap-odd {
  /* Outline-only with dash for contrast */
  fill: none !important;
  stroke: hsl(var(--rt-backdrop-overlap-hue), 70%, 48%) !important;
  stroke-width: 2.5px !important;
  stroke-dasharray: 10 6;
  stroke-linecap: round;
}

/* Repeating text label along the arc */
.rt-backdrop-label {
  /* Use the custom bit font */
  font-family: 'hooge05_55Regular', monospace, ui-monospace, SFMono-Regular;
  font-size: 20px;
  font-weight: normal;
  fill: #666666; /* Match ring fill color as requested */
  /* 100% White */
  stroke: none;
  /* NO STROKE BY DEFAULT */
  text-shadow: none;
  text-decoration: none;
  dominant-baseline: middle;
  pointer-events: none;
  letter-spacing: 1px;
  text-transform: uppercase;
  /* transition: fill 0.2s ease, opacity 0.2s ease, stroke 0.2s ease; */
}

.rt-backdrop-overlap-label {
  fill: hsl(var(--rt-backdrop-overlap-hue, 210), 70%, 55%);
  fill-opacity: 0.7;
}

.rt-backdrop-overlap-label.rt-backdrop-overlap-odd {
  fill: none !important;
  stroke: hsl(var(--rt-backdrop-overlap-hue, 210), 70%, 55%);
  stroke-width: 0.9px;
  stroke-opacity: 0.7;
}

/* Ensure textPath inherits label styling and has no decoration */
.rt-backdrop-label textPath {
  text-decoration: none;
  pointer-events: none;
}

/* Ensure definition paths are never rendered (SVG defs are invisible by default) */
.rt-scene-group[data-item-type="Backdrop"] defs path {
  fill: none;
  stroke: none;
}

/* On backdrop hover: text and box turn to max publish stage color */
.rt-scene-group[data-item-type="Backdrop"]:hover .rt-backdrop-label {
  fill: var(--rt-max-publish-stage-color) !important;
  opacity: 1 !important;
  stroke: none !important;
}

.rt-scene-group[data-item-type="Backdrop"]:hover .rt-backdrop-box {
  stroke: var(--rt-max-publish-stage-color) !important;
}

/* Global Fade: When any scene is hovered, backdrop takes same non-select color as scenes */
.radial-timeline-container .radial-timeline-svg.scene-hover .rt-backdrop-segment:not(:hover) {
  fill: var(--rt-color-empty-selected) !important;
  fill-opacity: 1 !important;
  stroke: none !important;
}

/* Backdrop labels during scene-hover: stay visible white, no stroke */
.radial-timeline-svg.scene-hover .rt-backdrop-label {
  fill: var(--rt-color-empty) !important;
  opacity: 1 !important;
  stroke: none !important;
}

/* Highlighted label in scene-hover handled above in consolidated rule */

.radial-timeline-svg.scene-hover .rt-backdrop-ring-background {
  stroke: var(--rt-color-empty-selected) !important;
  stroke-opacity: 1 !important;
}

/* Shift mode compliance */
.radial-timeline-svg[data-shift-mode="active"] .rt-backdrop-ring {
  opacity: 0.15;
  /* transition: opacity 0.2s ease; */
}

/* Ensure backdrop segments never get fill during shift mode.
   But normal backdrop segments DO have fill now. Only Shift Mode should hide/dim it. */
.radial-timeline-svg[data-shift-mode="active"] .rt-backdrop-segment {
  fill: none !important;
  stroke: var(--text-muted); /* Fallback outline for shift mode? or just hide */
  stroke-width: 1px;
}

/* Global fade and non-selected states just change the fill color (handled above) */
/* .rt-global-fade .rt-backdrop-segment, ... removed empty block */

/* Re-brighten on hover during shift mode */
.radial-timeline-container .radial-timeline-svg[data-shift-mode="active"] .rt-backdrop-segment:hover {
  opacity: 1;
}

/* Shift mode: brighten label when hovering backdrop */
.radial-timeline-svg[data-shift-mode="active"] .rt-scene-group[data-item-type="Backdrop"]:hover .rt-backdrop-label {
  opacity: 1;
}

/* Shift mode: Disable interactivity for backdrop */
.radial-timeline-svg[data-shift-mode="active"] .rt-scene-group[data-item-type="Backdrop"],
.radial-timeline-svg[data-shift-mode="active"] .rt-scene-group[data-item-type="Backdrop"] * {
  pointer-events: none !important;
}