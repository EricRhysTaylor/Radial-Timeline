/* Chronologue Mode Styles */

/* Chronologue timeline arc */
.rt-chronologue-timeline-arc {
  pointer-events: none;
}

.rt-chronologue-timeline-arc line:not(.rt-elapsed-endpoint-marker) {
  stroke: var(--text-muted);
  stroke-width: 1;
}

/* Chronologue time labels */
.rt-chronologue-time-label {
  font-size: 20px;
  fill: var(--text-muted);
  opacity: 0.7;
  pointer-events: none;
}

/* Chronologue warning for scenes without When field */
.rt-chronologue-warning .rt-scene-path {
  stroke: var(--text-error);
  stroke-width: 2;
  stroke-dasharray: 4 4;
}

/* Hide chronological ticks that overlap with elapsed endpoint markers */
.rt-chronological-tick.rt-tick-hidden {
  opacity: 0;
  pointer-events: none;
}

/* Elapsed time label */
.rt-elapsed-time-group {
  pointer-events: none;
}

.rt-elapsed-time-label {
  font-size: 16px;
  font-weight: 700;
  fill: var(--interactive-accent);
  stroke: white;
  stroke-width: 7px;
  stroke-linejoin: round;
  stroke-linecap: round;
  paint-order: stroke fill;
  text-transform: uppercase;
}

.rt-chronologue-duration-ticks {
  pointer-events: none;
}

.rt-chronologue-duration-ticks .rt-duration-arc {
  stroke: var(--text-muted);
  stroke-width: 6px;
}

.rt-chronologue-duration-ticks .rt-duration-arc-overlap {
  stroke: #ff9900;
  /* Yellow for temporal overlaps */
  stroke-width: 6px;
  /*stroke-dasharray: 4, 1; /* Dotted pattern: 4px dash, 1px gap */
}

.rt-chronologue-duration-ticks .rt-duration-arc-unparseable {
  stroke: var(--rt-color-due);
  /* Red for unparseable/missing durations */
  stroke-width: 6px;
}

.rt-chronologue-duration-ticks .rt-duration-arc-ongoing:not(.rt-duration-arc-overlap) {
  stroke: var(--text-muted);
  /* Standard color for "ongoing" durations */
  stroke-width: 6px;
}

/* Discontinuity marker text "âˆž" - infinity symbol marks large time jumps between scenes in chronologue mode */
.rt-discontinuity-marker {
  font-size: 20px;
  font-weight: 500;
  fill: var(--text-muted);
  stroke: rgb(0, 0, 0);
  stroke-width: 6px;
  stroke-linejoin: round;
  stroke-linecap: round;
  paint-order: stroke fill;
  pointer-events: none;
  /* Hide discontinuity markers by default (only show in shift mode) */
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.2s ease, fill 0.2s ease;
  /* Add transition to base state for both directions */
}

/* Show discontinuity markers when shift mode is active */
svg[data-shift-mode="active"] .rt-discontinuity-marker {
  opacity: 1;
  visibility: visible;
}

/* ==========================================================================
   Backdrop Ring Styles
   ========================================================================== */

.rt-backdrop-ring {
  pointer-events: none;
  /* Let clicks pass through to synopsis */
}

.rt-backdrop-ring-background {
  stroke: var(--rt-color-empty); /* Changed to use theme empty color (white/dark-bg) */
  stroke-opacity: 1; /* Fully opaque */
  fill: none !important;
}

/* New border class for inner/outer edges */
.rt-backdrop-border {
  stroke: var(--rt-color-empty); /* Match scene borders (usually white or bg color) */
  stroke-width: 1px;
  fill: none;
  opacity: 1;
}

.radial-timeline-container .rt-backdrop-segment {
  fill: #cccccc; /* Default lighter gray */
  fill-opacity: 1; /* Fully opaque */
  opacity: 1;
  /* transition: fill-opacity 0.2s ease, opacity 0.2s ease; */
  cursor: pointer;
  stroke: none !important; /* No stroke on the segment itself, handled by borders */
  pointer-events: fill !important;
}

/* Active/hovered backdrop segment */
.radial-timeline-container .rt-backdrop-segment:hover,
.radial-timeline-container .rt-backdrop-segment.rt-selected {
  fill: var(--rt-max-publish-stage-color) !important;
  fill-opacity: 0.8 !important;
  stroke: none !important;
}

/* Box outline around backdrop segment (matches planetary calendar box style) */
.rt-backdrop-box {
  display: none; /* Remove dashed border as requested */
  /* transition: stroke 0.2s ease; */
}

/* Hide box during scene hover (global fade) */
.radial-timeline-svg.scene-hover .rt-backdrop-box {
  stroke: transparent;
}

/* Overlap pattern: Diagonal gray stripes on darker gray background */
.radial-timeline-container .rt-backdrop-segment.rt-backdrop-overlap {
  fill: url(#rt-backdrop-diagonal);
  stroke: none; /* No border for overlap box */
  fill-opacity: 1; /* Pattern handles opacity */
  opacity: 1;
  mix-blend-mode: normal; /* Normal blend so pattern shows clearly over base */
}

/* Base style for overlap segments (resetting hue/parity specific styles) */
.radial-timeline-container .rt-backdrop-segment.rt-backdrop-overlap-even,
.radial-timeline-container .rt-backdrop-segment.rt-backdrop-overlap-odd {
  /* Common styling for pattern approach */
  stroke-dasharray: none;
  stroke: none !important; /* No border */
  fill-opacity: 1;
  fill: url(#rt-backdrop-diagonal) !important;
}
.radial-timeline-container .rt-backdrop-segment:hover ~ .rt-backdrop-segment.rt-backdrop-overlap,
.radial-timeline-container .rt-backdrop-segment.rt-selected ~ .rt-backdrop-segment.rt-backdrop-overlap {
  opacity: 0;
}

/* When hovering anywhere on the backdrop ring, also hide overlap overlays so base highlights are unobstructed */
.radial-timeline-container .rt-backdrop-ring:hover .rt-backdrop-segment.rt-backdrop-overlap {
  opacity: 0;
}

/* Enhanced z-order handling for overlapping backdrops */
.radial-timeline-container .rt-scene-group[data-item-type="Backdrop"]:hover ~ .rt-scene-group[data-item-type="Backdrop"],
.radial-timeline-container .rt-scene-group[data-item-type="Backdrop"]:hover ~ .rt-backdrop-segment.rt-backdrop-overlap {
  opacity: 0 !important;
  pointer-events: none !important;
}

/* REMOVED DUPLICATE BLOCK: .radial-timeline-container .rt-backdrop-segment.rt-backdrop-overlap-even */
/* REMOVED DUPLICATE BLOCK: .radial-timeline-container .rt-backdrop-segment.rt-backdrop-overlap-odd */

/* Repeating text label along the arc */
.rt-backdrop-label {
  /* Use the custom bit font */
  font-family: 'hooge05_55Regular', monospace, ui-monospace, SFMono-Regular;
  font-size: 20px;
  font-weight: normal;
  fill: white; /* Changed to pure white */
  /* 100% White */
  stroke: none;
  /* NO STROKE BY DEFAULT */
  text-shadow: none;
  text-decoration: none;
  dominant-baseline: middle;
  pointer-events: none;
  letter-spacing: 1px;
  text-transform: uppercase;
  /* transition: fill 0.2s ease, opacity 0.2s ease, stroke 0.2s ease; */
}

.rt-backdrop-overlap-label {
  fill: white; /* Changed to pure white */
  fill-opacity: 1;
  stroke: none;
}

.rt-backdrop-overlap-label.rt-backdrop-overlap-odd {
  fill: white !important; /* Changed to pure white */
  stroke: none !important;
}

/* Ensure textPath inherits label styling and has no decoration */
.rt-backdrop-label textPath {
  text-decoration: none;
  pointer-events: none;
}

/* Ensure definition paths are never rendered (SVG defs are invisible by default) */
.rt-scene-group[data-item-type="Backdrop"] defs path {
  fill: none;
  stroke: none;
}

/* On backdrop hover: text and box turn to max publish stage color */
.rt-scene-group[data-item-type="Backdrop"]:hover .rt-backdrop-label {
  fill: var(--rt-max-publish-stage-color) !important;
  opacity: 1 !important;
  stroke: none !important;
}

.rt-scene-group[data-item-type="Backdrop"]:hover .rt-backdrop-box {
  stroke: var(--rt-max-publish-stage-color) !important;
}

/* Global Fade: When any scene is hovered, backdrop takes same non-select color as scenes */
.radial-timeline-container .radial-timeline-svg.scene-hover .rt-backdrop-segment:not(:hover) {
  fill: var(--rt-color-empty-selected) !important;
  fill-opacity: 1 !important;
  stroke: none !important;
}

/* Hide overlap segments when any scene is hovered to reduce noise */
.radial-timeline-container .radial-timeline-svg.scene-hover .rt-backdrop-segment.rt-backdrop-overlap {
  opacity: 0 !important;
}

/* Backdrop labels during scene-hover: stay visible white, no stroke */
.radial-timeline-svg.scene-hover .rt-backdrop-label {
  fill: var(--rt-color-empty) !important;
  opacity: 1 !important;
  stroke: none !important;
}

/* Highlighted label in scene-hover handled above in consolidated rule */

.radial-timeline-svg.scene-hover .rt-backdrop-ring-background {
  stroke: var(--rt-color-empty-selected) !important;
  stroke-opacity: 1 !important;
}

/* ALT hover in Chronologue: keep red tint on backdrops and labels */
.radial-timeline-svg[data-mode="chronologue"][data-shift-mode="alien"].scene-hover .rt-backdrop-segment {
  fill: rgba(180, 60, 60, 0.05) !important;
  stroke: rgba(180, 60, 60, 0.3);
  stroke-width: 1px;
}

.radial-timeline-svg[data-mode="chronologue"][data-shift-mode="alien"].scene-hover .rt-backdrop-segment.rt-backdrop-overlap {
  opacity: 0.25 !important;
  pointer-events: none !important;
}

.radial-timeline-svg[data-mode="chronologue"][data-shift-mode="alien"].scene-hover .rt-backdrop-ring-background {
  stroke: rgba(255, 0, 0, 0.5) !important;
  stroke-opacity: 0.15 !important;
}

.radial-timeline-svg[data-mode="chronologue"][data-shift-mode="alien"].scene-hover .rt-backdrop-border {
  stroke: rgba(180, 60, 60, 0.5) !important;
  opacity: 1 !important;
}

.radial-timeline-svg[data-mode="chronologue"][data-shift-mode="alien"].scene-hover .rt-backdrop-label {
  fill: rgba(200, 50, 50, 0.8) !important;
  opacity: 0.3 !important;
}

/* Runtime hover in Chronologue: keep blue tint on backdrops and labels */
.radial-timeline-svg[data-mode="chronologue"][data-shift-mode="runtime"].scene-hover .rt-backdrop-segment {
  fill: rgba(60, 140, 220, 0.05) !important;
  stroke: rgba(60, 140, 220, 0.25);
  stroke-width: 1px;
}

.radial-timeline-svg[data-mode="chronologue"][data-shift-mode="runtime"].scene-hover .rt-backdrop-segment.rt-backdrop-overlap {
  opacity: 0.25 !important;
  pointer-events: none !important;
}

.radial-timeline-svg[data-mode="chronologue"][data-shift-mode="runtime"].scene-hover .rt-backdrop-ring-background {
  stroke: rgba(60, 140, 220, 0.5) !important;
  stroke-opacity: 0.18 !important;
}

.radial-timeline-svg[data-mode="chronologue"][data-shift-mode="runtime"].scene-hover .rt-backdrop-border {
  stroke: rgba(60, 140, 220, 0.4) !important;
  opacity: 0.7 !important;
}

.radial-timeline-svg[data-mode="chronologue"][data-shift-mode="runtime"].scene-hover .rt-backdrop-label {
  fill: rgba(60, 140, 220, 0.7) !important;
  opacity: 0.3 !important;
}

/* Shift mode compliance */
.radial-timeline-svg[data-shift-mode="active"] .rt-backdrop-ring {
  opacity: 0.1; 
}

/* Shift mode: Hide background ring inside the container to keep it faint (effective 0.02) */
.radial-timeline-svg[data-shift-mode="active"] .rt-backdrop-ring-background {
  stroke-opacity: 0.1 !important;
}

/* Shift mode: Hide borders */
.radial-timeline-svg[data-shift-mode="active"] .rt-backdrop-border {
  opacity: 0.2 !important;
}

/* Shift mode: Backdrop labels - white like scene titles but pushed back */
.radial-timeline-svg[data-shift-mode="active"] .rt-backdrop-label {
  fill: white !important;
  opacity: 1; /* Maximize visibility within the 0.2 container */
}

/* Shift mode: Muted overlap segments */
.radial-timeline-svg[data-shift-mode="active"] .rt-backdrop-segment.rt-backdrop-overlap {
  opacity: 0.2 !important;
  pointer-events: none !important;
}

/* Shift mode: Subtle backdrop segment fill */
.radial-timeline-svg[data-shift-mode="active"] .rt-backdrop-segment {
  fill: rgba(128, 128, 128, 0.01) !important;
  stroke: var(--text-muted);
  stroke-width: 1px;
}

/* Global fade and non-selected states just change the fill color (handled above) */
/* .rt-global-fade .rt-backdrop-segment, ... removed empty block */

/* Re-brighten on hover during shift mode */
.radial-timeline-container .radial-timeline-svg[data-shift-mode="active"] .rt-backdrop-segment:hover {
  opacity: 1;
  cursor: default; /* Ensure no pointer cursor on backdrop during shift mode */
}

/* Shift mode: brighten label when hovering backdrop */
.radial-timeline-svg[data-shift-mode="active"] .rt-scene-group[data-item-type="Backdrop"]:hover .rt-backdrop-label {
  opacity: 1;
}

/* Shift mode: Disable interactivity for backdrop */
.radial-timeline-svg[data-shift-mode="active"] .rt-scene-group[data-item-type="Backdrop"],
.radial-timeline-svg[data-shift-mode="active"] .rt-scene-group[data-item-type="Backdrop"] * {
  pointer-events: none !important;
}

/* Alien mode: Red-tinted backdrop treatment */
/* Removed opacity override since default is 1, allowing children to be fully opaque */
/* .radial-timeline-svg[data-shift-mode="alien"] .rt-backdrop-ring { } */

/* Alien mode: Tint the ring background itself red */
.radial-timeline-svg[data-shift-mode="alien"] .rt-backdrop-ring-background {
  stroke: rgba(255, 0, 0, 0.5) !important;
  stroke-opacity: 0.15 !important; /* Move opacity here */
}

/* Alien mode: Match backdrop borders to spokes/scene borders */
.radial-timeline-svg[data-shift-mode="alien"] .rt-backdrop-border {
  stroke: rgba(180, 60, 60, 0.5) !important;
  opacity: 1 !important;
}

/* Alien mode: Backdrop labels - red tinted and much more visible */
.radial-timeline-svg[data-shift-mode="alien"] .rt-backdrop-label {
  fill: rgba(200, 50, 50, 0.8) !important;
  opacity: 0.3 !important;
}

/* Alien mode: Muted overlap segments with red tint */
.radial-timeline-svg[data-shift-mode="alien"] .rt-backdrop-segment.rt-backdrop-overlap {
  opacity: 0.25 !important;
  pointer-events: none !important;
}

/* Alien mode: Subtle red-tinted backdrop segment fill */
.radial-timeline-svg[data-shift-mode="alien"] .rt-backdrop-segment {
  fill: rgba(180, 60, 60, 0.05) !important;
  stroke: rgba(180, 60, 60, 0.3);
  stroke-width: 1px;
}

.radial-timeline-svg[data-shift-mode="alien"] .rt-scene-group[data-item-type="Backdrop"],
.radial-timeline-svg[data-shift-mode="alien"] .rt-scene-group[data-item-type="Backdrop"] * {
  pointer-events: none !important;
}
