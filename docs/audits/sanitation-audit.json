{
  "generatedAt": "2026-02-20T16:40:21.383Z",
  "scannedDirectories": [
    "src",
    "scripts"
  ],
  "filesScanned": [
    "scripts/audit/run-tsc-audit.sh",
    "scripts/bundle-css.mjs",
    "scripts/check-inquiry-ert-lock.mjs",
    "scripts/check-model-updates.mjs",
    "scripts/check-obsidian-version.mjs",
    "scripts/check-social-ert-lock.mjs",
    "scripts/check-translations.mjs",
    "scripts/compliance-check.mjs",
    "scripts/css-drift-check.mjs",
    "scripts/echo-branch.mjs",
    "scripts/generate-wiki-sidebar.mjs",
    "scripts/publish-wiki.mjs",
    "scripts/scan-ert-classes.mjs",
    "scripts/sync-yaml-to-wiki.mjs",
    "scripts/update-ai-models.mjs",
    "scripts/verify.mjs",
    "src/GossamerCommands.ts",
    "src/RuntimeCommands.ts",
    "src/SceneAnalysisCommands.ts",
    "src/SynopsisManager.ts",
    "src/ai/caps/computeCaps.test.ts",
    "src/ai/caps/computeCaps.ts",
    "src/ai/caps/providerCaps.ts",
    "src/ai/credentials/credentials.test.ts",
    "src/ai/credentials/credentials.ts",
    "src/ai/credentials/noPlaintextKeys.test.ts",
    "src/ai/credentials/redactSensitive.test.ts",
    "src/ai/credentials/redactSensitive.ts",
    "src/ai/credentials/secretStorage.ts",
    "src/ai/errors.ts",
    "src/ai/evidence/pulseTriplet.test.ts",
    "src/ai/evidence/pulseTriplet.ts",
    "src/ai/index.ts",
    "src/ai/log.ts",
    "src/ai/prompts/compilePrompt.ts",
    "src/ai/prompts/composeEnvelope.test.ts",
    "src/ai/prompts/composeEnvelope.ts",
    "src/ai/prompts/gossamer.ts",
    "src/ai/prompts/gossamerAnalysis.ts",
    "src/ai/prompts/sceneAnalysis.ts",
    "src/ai/prompts/synopsis.ts",
    "src/ai/prompts/templates.ts",
    "src/ai/prompts/unifiedBeatAnalysis.ts",
    "src/ai/providers/anthropicProvider.ts",
    "src/ai/providers/googleProvider.ts",
    "src/ai/providers/ollamaProvider.ts",
    "src/ai/providers/openaiProvider.ts",
    "src/ai/providers/provider.ts",
    "src/ai/references/sceneRefNormalizer.test.ts",
    "src/ai/references/sceneRefNormalizer.ts",
    "src/ai/registry/builtinModels.ts",
    "src/ai/registry/mergeModels.test.ts",
    "src/ai/registry/mergeModels.ts",
    "src/ai/registry/modelRegistry.ts",
    "src/ai/registry/providerSnapshot.test.ts",
    "src/ai/registry/providerSnapshot.ts",
    "src/ai/registry/recommendationWhy.ts",
    "src/ai/registry/recommendations.test.ts",
    "src/ai/registry/recommendations.ts",
    "src/ai/registry/remoteRegistry.test.ts",
    "src/ai/registry/remoteRegistry.ts",
    "src/ai/router/selectModel.test.ts",
    "src/ai/router/selectModel.ts",
    "src/ai/runtime/aiClient.ts",
    "src/ai/runtime/aiTelemetry.ts",
    "src/ai/runtime/cache.ts",
    "src/ai/runtime/jsonValidator.ts",
    "src/ai/runtime/legacyImportGuard.test.ts",
    "src/ai/runtime/rateLimit.ts",
    "src/ai/settings/aiSettings.ts",
    "src/ai/settings/migrateAiSettings.test.ts",
    "src/ai/settings/migrateAiSettings.ts",
    "src/ai/settings/validateAiSettings.test.ts",
    "src/ai/settings/validateAiSettings.ts",
    "src/ai/types.ts",
    "src/api/anthropicApi.ts",
    "src/api/geminiApi.ts",
    "src/api/legacyAccessGuard.ts",
    "src/api/localAiApi.ts",
    "src/api/openaiApi.ts",
    "src/api/providerCapabilities.ts",
    "src/api/providerErrors.ts",
    "src/api/providerRouter.ts",
    "src/api/requestPayload.ts",
    "src/assets/embeddedFonts.ts",
    "src/constants/aiDefaults.ts",
    "src/constants/tokenLimits.ts",
    "src/data/aiModels.ts",
    "src/debug/index.ts",
    "src/debug/snapshot.ts",
    "src/globals.d.ts",
    "src/i18n/index.ts",
    "src/i18n/locales/en.ts",
    "src/i18n/locales/ja.ts",
    "src/inquiry/InquiryService.ts",
    "src/inquiry/InquirySessionStore.ts",
    "src/inquiry/InquiryView.ts",
    "src/inquiry/components/InquiryGlyph.ts",
    "src/inquiry/constants.ts",
    "src/inquiry/prompts.ts",
    "src/inquiry/runner/InquiryRunnerService.test.ts",
    "src/inquiry/runner/InquiryRunnerService.ts",
    "src/inquiry/runner/types.ts",
    "src/inquiry/services/InquiryCorpusResolver.ts",
    "src/inquiry/services/corpusSelectionKeys.test.ts",
    "src/inquiry/services/corpusSelectionKeys.ts",
    "src/inquiry/services/minimapSubset.test.ts",
    "src/inquiry/services/minimapSubset.ts",
    "src/inquiry/services/readiness.test.ts",
    "src/inquiry/services/readiness.ts",
    "src/inquiry/sessionTypes.ts",
    "src/inquiry/state.ts",
    "src/inquiry/utils/artifacts.ts",
    "src/inquiry/utils/logs.ts",
    "src/inquiry/utils/scanRoots.ts",
    "src/inquiry/zoneLayout.ts",
    "src/main.ts",
    "src/migrations/sceneAnalysis.ts",
    "src/migrations/sceneIds.ts",
    "src/modals/AprPaletteModal.ts",
    "src/modals/AuthorProgressModal.ts",
    "src/modals/BookDesignerModal.ts",
    "src/modals/CreateBeatsTemplatesModal.ts",
    "src/modals/DragConfirmModal.ts",
    "src/modals/GossamerProcessingModal.ts",
    "src/modals/GossamerScoreModal.ts",
    "src/modals/ManageSubplotsModal.ts",
    "src/modals/ManuscriptOptionsModal.ts",
    "src/modals/PlanetaryTimeModal.ts",
    "src/modals/ReleaseNotesModal.ts",
    "src/modals/RuntimeProcessingModal.ts",
    "src/modals/SceneAnalysisProcessingModal.ts",
    "src/modals/TimelineRepairModal.ts",
    "src/modals/ZeroDraftModal.ts",
    "src/modes/ModeDefinition.ts",
    "src/modes/ModeInteractionController.ts",
    "src/modes/ModeManager.ts",
    "src/modes/ModeRegistry.ts",
    "src/modes/definitions/AllScenesMode.ts",
    "src/modes/definitions/ChronologueMode.ts",
    "src/modes/definitions/GossamerMode.ts",
    "src/modes/definitions/MainPlotMode.ts",
    "src/modes/index.ts",
    "src/renderer/ChangeDetection.ts",
    "src/renderer/DynamicLayerUpdater.ts",
    "src/renderer/TimelineRenderer.ts",
    "src/renderer/apr/AprBranding.ts",
    "src/renderer/apr/AprConstants.ts",
    "src/renderer/apr/AprLayoutConfig.ts",
    "src/renderer/apr/AprRenderer.ts",
    "src/renderer/apr/aprHelpers.ts",
    "src/renderer/apr/aprLayout.ts",
    "src/renderer/apr/aprPresets.ts",
    "src/renderer/apr/index.ts",
    "src/renderer/components/ActLabels.ts",
    "src/renderer/components/Acts.ts",
    "src/renderer/components/AprOverlay.ts",
    "src/renderer/components/AuthorProgressIndicator.ts",
    "src/renderer/components/BackdropMicroRings.ts",
    "src/renderer/components/BackdropRing.ts",
    "src/renderer/components/BeatSlices.ts",
    "src/renderer/components/Beats.ts",
    "src/renderer/components/ChronologueTimeline.ts",
    "src/renderer/components/Defs.ts",
    "src/renderer/components/Grid.ts",
    "src/renderer/components/HelpIcon.ts",
    "src/renderer/components/MilestoneIndicator.ts",
    "src/renderer/components/MonthSpokes.ts",
    "src/renderer/components/Months.ts",
    "src/renderer/components/NumberSquares.ts",
    "src/renderer/components/Progress.ts",
    "src/renderer/components/ProgressRing.ts",
    "src/renderer/components/ProgressTicks.ts",
    "src/renderer/components/SceneArcs.ts",
    "src/renderer/components/Scenes.ts",
    "src/renderer/components/SubplotDominanceIndicators.ts",
    "src/renderer/components/SubplotLabels.ts",
    "src/renderer/components/Synopses.ts",
    "src/renderer/components/VersionIndicator.ts",
    "src/renderer/dom/BeatLabelAdjuster.ts",
    "src/renderer/dom/NumberSquareDOMUpdater.ts",
    "src/renderer/dom/SceneDOMUpdater.ts",
    "src/renderer/dom/SubplotLabelDOMUpdater.ts",
    "src/renderer/dom/SynopsisDOMUpdater.ts",
    "src/renderer/gossamerLayer.ts",
    "src/renderer/layout/LayoutConstants.ts",
    "src/renderer/layout/Paths.ts",
    "src/renderer/layout/Rings.ts",
    "src/renderer/modules/ModeRenderingHelpers.ts",
    "src/renderer/renderers/NumberSquareRenderer.ts",
    "src/renderer/renderers/RingRenderer.ts",
    "src/renderer/utils/AuthorProgressUtils.ts",
    "src/renderer/utils/Chronologue.ts",
    "src/renderer/utils/Estimation.ts",
    "src/renderer/utils/FontMetricsCache.ts",
    "src/renderer/utils/Gossamer.ts",
    "src/renderer/utils/GridData.ts",
    "src/renderer/utils/LabelMetrics.ts",
    "src/renderer/utils/MonthSpokes.ts",
    "src/renderer/utils/Performance.ts",
    "src/renderer/utils/Precompute.ts",
    "src/renderer/utils/ProgressRing.ts",
    "src/renderer/utils/RotationToggle.ts",
    "src/renderer/utils/SceneFill.ts",
    "src/renderer/utils/SceneLayout.ts",
    "src/renderer/utils/SynopsisBuilder.ts",
    "src/sceneAnalysis/FileUpdater.ts",
    "src/sceneAnalysis/Maintenance.ts",
    "src/sceneAnalysis/Processor.ts",
    "src/sceneAnalysis/RequestRunner.ts",
    "src/sceneAnalysis/SynopsisCommands.ts",
    "src/sceneAnalysis/TripletBuilder.ts",
    "src/sceneAnalysis/aiProvider.ts",
    "src/sceneAnalysis/data.ts",
    "src/sceneAnalysis/responseParsing.ts",
    "src/sceneAnalysis/synopsisQuality.ts",
    "src/sceneAnalysis/types.ts",
    "src/services/AuthorProgressService.ts",
    "src/services/BeatsProcessingService.ts",
    "src/services/CommandRegistrar.ts",
    "src/services/FileTrackingService.ts",
    "src/services/GossamerScoreService.ts",
    "src/services/HoverHighlighter.ts",
    "src/services/MilestonesService.ts",
    "src/services/ReleaseNotesService.ts",
    "src/services/RendererService.ts",
    "src/services/SceneAnalysisService.ts",
    "src/services/SceneDataService.ts",
    "src/services/SceneHighlighter.ts",
    "src/services/SceneReorderService.ts",
    "src/services/SearchService.ts",
    "src/services/SettingsService.ts",
    "src/services/StatusBarService.ts",
    "src/services/SubplotManagementService.ts",
    "src/services/ThemeService.ts",
    "src/services/TimelineMetricsService.ts",
    "src/services/TimelineService.ts",
    "src/services/VersionCheckService.ts",
    "src/settings/AiContextModal.ts",
    "src/settings/FolderSuggest.ts",
    "src/settings/IconSuggest.ts",
    "src/settings/ProjectPathSuggest.ts",
    "src/settings/SettingImpact.ts",
    "src/settings/SettingsTab.ts",
    "src/settings/defaults.ts",
    "src/settings/refactorAlerts.ts",
    "src/settings/sections/AiSection.test.ts",
    "src/settings/sections/AiSection.ts",
    "src/settings/sections/AuthorProgressSection.ts",
    "src/settings/sections/BackdropSection.ts",
    "src/settings/sections/BeatPropertiesSection.ts",
    "src/settings/sections/CampaignManagerSection.ts",
    "src/settings/sections/ChronologueSection.ts",
    "src/settings/sections/ColorsSection.ts",
    "src/settings/sections/ConfigurationSection.ts",
    "src/settings/sections/GeneralSection.ts",
    "src/settings/sections/InquirySection.ts",
    "src/settings/sections/MetadataSection.ts",
    "src/settings/sections/PlanetaryTimeSection.ts",
    "src/settings/sections/PovSection.ts",
    "src/settings/sections/ProfessionalSection.ts",
    "src/settings/sections/PublicationSection.ts",
    "src/settings/sections/ReadmeSection.ts",
    "src/settings/sections/ReleaseNotesSection.ts",
    "src/settings/sections/RuntimeSection.ts",
    "src/settings/wikiLink.ts",
    "src/synopsis/SynopsisData.ts",
    "src/synopsis/SynopsisView.ts",
    "src/timelineRepair/RepairPipeline.ts",
    "src/timelineRepair/aiTemporalParse.ts",
    "src/timelineRepair/frontmatterWriter.ts",
    "src/timelineRepair/index.ts",
    "src/timelineRepair/keywordSweep.ts",
    "src/timelineRepair/patternSync.ts",
    "src/timelineRepair/sessionDiff.ts",
    "src/timelineRepair/types.ts",
    "src/types/index.ts",
    "src/types/obsidian-augment.ts",
    "src/types/obsidian-secrets.d.ts",
    "src/types/releaseNotes.ts",
    "src/types/settings.ts",
    "src/types/timeline.ts",
    "src/ui/classes.ts",
    "src/ui/optimized/ProPill.ts",
    "src/ui/ui.ts",
    "src/ui/validator.ts",
    "src/utils/acts.ts",
    "src/utils/aiOutput.ts",
    "src/utils/aprPaletteGenerator.ts",
    "src/utils/aprPaths.ts",
    "src/utils/beatsInputNormalize.ts",
    "src/utils/beatsSystems.ts",
    "src/utils/beatsTemplates.ts",
    "src/utils/books.test.ts",
    "src/utils/books.ts",
    "src/utils/colour.test.ts",
    "src/utils/colour.ts",
    "src/utils/constants.ts",
    "src/utils/date.test.ts",
    "src/utils/date.ts",
    "src/utils/draftBook.ts",
    "src/utils/exportContext.ts",
    "src/utils/exportFormats.ts",
    "src/utils/fileUtils.ts",
    "src/utils/frontmatter.ts",
    "src/utils/gossamer.ts",
    "src/utils/manuscript.ts",
    "src/utils/modelResolver.ts",
    "src/utils/numberSquareHelpers.ts",
    "src/utils/pathScope.ts",
    "src/utils/planetaryTime.ts",
    "src/utils/pov.ts",
    "src/utils/rangeValidation.ts",
    "src/utils/readability.ts",
    "src/utils/regex.ts",
    "src/utils/releaseNotesRenderer.ts",
    "src/utils/releases.ts",
    "src/utils/runtimeEstimator.ts",
    "src/utils/sceneCreation.ts",
    "src/utils/sceneGenerator.ts",
    "src/utils/sceneHelpers.ts",
    "src/utils/sceneIds.test.ts",
    "src/utils/sceneIds.ts",
    "src/utils/simulatedProgress.ts",
    "src/utils/svg.ts",
    "src/utils/svgDom.ts",
    "src/utils/synopsisLimits.ts",
    "src/utils/text.ts",
    "src/utils/tooltip.ts",
    "src/utils/yamlAudit.ts",
    "src/utils/yamlBackfill.ts",
    "src/utils/yamlManager.ts",
    "src/utils/yamlSafety.ts",
    "src/utils/yamlTemplateNormalize.ts",
    "src/view/TimeLineView.ts",
    "src/view/WelcomeScreen.ts",
    "src/view/interactions/ChronologueShiftController.ts",
    "src/view/interactions/DominantSubplotHandler.ts",
    "src/view/interactions/HelpIconController.ts",
    "src/view/interactions/ModeToggleController.ts",
    "src/view/interactions/OuterRingDragController.ts",
    "src/view/interactions/RotationController.ts",
    "src/view/interactions/SceneInteractionManager.ts",
    "src/view/interactions/SceneTitleExpansion.ts",
    "src/view/interactions/SearchInteractions.ts",
    "src/view/interactions/SynopsisTitleColorManager.ts",
    "src/view/interactions/TooltipController.ts",
    "src/view/interactions/VersionIndicatorController.ts",
    "src/view/interactions/ZeroDraftHandler.ts",
    "src/view/interactions/index.ts",
    "src/view/modes/AllScenesMode.ts",
    "src/view/modes/ChronologueMode.ts",
    "src/view/modes/GossamerMode.ts",
    "src/view/modes/MainPlotMode.ts",
    "src/view/modes/index.ts"
  ],
  "tokenDefinitions": [
    {
      "token": "TODO",
      "category": "stale-comment"
    },
    {
      "token": "FIXME",
      "category": "stale-comment"
    },
    {
      "token": "HACK",
      "category": "stale-comment"
    },
    {
      "token": "WORKAROUND",
      "category": "stale-comment"
    },
    {
      "token": "TEMP",
      "category": "stale-comment"
    },
    {
      "token": "DEPRECATED",
      "category": "stale-comment"
    },
    {
      "token": "NOTE",
      "category": "stale-comment"
    },
    {
      "token": "IMPORTANT",
      "category": "stale-comment"
    },
    {
      "token": "Synopsis",
      "category": "drift-term"
    },
    {
      "token": "legacy key",
      "category": "drift-term"
    },
    {
      "token": "plaintext key",
      "category": "drift-term"
    },
    {
      "token": "api key in settings",
      "category": "drift-term"
    },
    {
      "token": "mergeTemplates",
      "category": "drift-term"
    },
    {
      "token": "getMergedBeatYaml",
      "category": "drift-term"
    },
    {
      "token": "advanced template cleanup",
      "category": "drift-term"
    },
    {
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term"
    },
    {
      "token": "ChangeType.SETTINGS",
      "category": "drift-term"
    },
    {
      "token": "Ripple Rename",
      "category": "drift-term"
    },
    {
      "token": "prefix normalization",
      "category": "drift-term"
    }
  ],
  "summary": {
    "totalHits": 1377,
    "totalFilesScanned": 355,
    "filesWithHits": 140,
    "totalsByToken": {
      "api key in settings": 1,
      "ChangeType.SETTINGS": 6,
      "DEPRECATED": 59,
      "getMergedBeatYaml": 4,
      "HACK": 1,
      "IMPORTANT": 14,
      "legacy key": 2,
      "mergeTemplates": 8,
      "NOTE": 301,
      "plaintext key": 2,
      "refreshTimelineIfNeeded": 32,
      "Ripple Rename": 9,
      "Synopsis": 855,
      "TEMP": 14,
      "TODO": 68,
      "WORKAROUND": 1
    },
    "totalsByCategory": {
      "drift-term": 919,
      "stale-comment": 458
    },
    "hotspots": [
      {
        "filePath": "src/SynopsisManager.ts",
        "hitCount": 204
      },
      {
        "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
        "hitCount": 126
      },
      {
        "filePath": "src/inquiry/InquiryView.ts",
        "hitCount": 101
      },
      {
        "filePath": "src/settings/sections/BeatPropertiesSection.ts",
        "hitCount": 91
      },
      {
        "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
        "hitCount": 66
      },
      {
        "filePath": "src/services/CommandRegistrar.ts",
        "hitCount": 30
      },
      {
        "filePath": "src/utils/yamlAudit.ts",
        "hitCount": 27
      },
      {
        "filePath": "src/utils/beatsTemplates.ts",
        "hitCount": 21
      },
      {
        "filePath": "src/utils/yamlTemplateNormalize.ts",
        "hitCount": 21
      },
      {
        "filePath": "src/i18n/locales/en.ts",
        "hitCount": 20
      },
      {
        "filePath": "src/modals/ManuscriptOptionsModal.ts",
        "hitCount": 20
      },
      {
        "filePath": "src/view/modes/ChronologueMode.ts",
        "hitCount": 20
      },
      {
        "filePath": "src/types/settings.ts",
        "hitCount": 19
      },
      {
        "filePath": "src/view/interactions/SceneInteractionManager.ts",
        "hitCount": 19
      },
      {
        "filePath": "src/view/modes/GossamerMode.ts",
        "hitCount": 18
      },
      {
        "filePath": "src/main.ts",
        "hitCount": 16
      },
      {
        "filePath": "src/renderer/utils/SynopsisBuilder.ts",
        "hitCount": 16
      },
      {
        "filePath": "src/utils/exportFormats.ts",
        "hitCount": 16
      },
      {
        "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
        "hitCount": 15
      },
      {
        "filePath": "src/settings/sections/AiSection.ts",
        "hitCount": 15
      },
      {
        "filePath": "src/settings/sections/InquirySection.ts",
        "hitCount": 15
      },
      {
        "filePath": "src/ai/prompts/synopsis.ts",
        "hitCount": 14
      },
      {
        "filePath": "src/renderer/apr/AprRenderer.ts",
        "hitCount": 14
      },
      {
        "filePath": "src/view/interactions/ChronologueShiftController.ts",
        "hitCount": 14
      },
      {
        "filePath": "src/services/SceneDataService.ts",
        "hitCount": 13
      },
      {
        "filePath": "src/renderer/components/Grid.ts",
        "hitCount": 12
      },
      {
        "filePath": "src/renderer/TimelineRenderer.ts",
        "hitCount": 12
      },
      {
        "filePath": "src/sceneAnalysis/aiProvider.ts",
        "hitCount": 12
      },
      {
        "filePath": "src/sceneAnalysis/synopsisQuality.ts",
        "hitCount": 12
      },
      {
        "filePath": "src/services/RendererService.ts",
        "hitCount": 12
      },
      {
        "filePath": "src/settings/sections/ConfigurationSection.ts",
        "hitCount": 12
      },
      {
        "filePath": "src/utils/synopsisLimits.ts",
        "hitCount": 12
      },
      {
        "filePath": "src/settings/defaults.ts",
        "hitCount": 11
      },
      {
        "filePath": "src/types/timeline.ts",
        "hitCount": 10
      },
      {
        "filePath": "src/view/TimeLineView.ts",
        "hitCount": 10
      },
      {
        "filePath": "src/GossamerCommands.ts",
        "hitCount": 9
      },
      {
        "filePath": "src/renderer/components/BackdropRing.ts",
        "hitCount": 9
      },
      {
        "filePath": "src/inquiry/services/InquiryCorpusResolver.ts",
        "hitCount": 8
      },
      {
        "filePath": "src/modals/GossamerScoreModal.ts",
        "hitCount": 8
      },
      {
        "filePath": "src/renderer/utils/GridData.ts",
        "hitCount": 8
      },
      {
        "filePath": "src/synopsis/SynopsisData.ts",
        "hitCount": 8
      },
      {
        "filePath": "src/utils/manuscript.ts",
        "hitCount": 8
      },
      {
        "filePath": "src/sceneAnalysis/data.ts",
        "hitCount": 7
      },
      {
        "filePath": "src/services/AuthorProgressService.ts",
        "hitCount": 7
      },
      {
        "filePath": "src/settings/sections/AuthorProgressSection.ts",
        "hitCount": 7
      },
      {
        "filePath": "src/inquiry/runner/InquiryRunnerService.ts",
        "hitCount": 6
      },
      {
        "filePath": "src/renderer/ChangeDetection.ts",
        "hitCount": 6
      },
      {
        "filePath": "src/renderer/layout/LayoutConstants.ts",
        "hitCount": 6
      },
      {
        "filePath": "src/services/SceneAnalysisService.ts",
        "hitCount": 6
      },
      {
        "filePath": "src/services/SceneReorderService.ts",
        "hitCount": 6
      }
    ]
  },
  "hits": [
    {
      "filePath": "src/GossamerCommands.ts",
      "line": 185,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Helper to find Beat note by beat title (prefers Beat over Plot)",
      "context": {
        "before": {
          "line": 184,
          "text": ""
        },
        "current": {
          "line": 185,
          "text": "// Helper to find Beat note by beat title (prefers Beat over Plot)"
        },
        "after": {
          "line": 186,
          "text": "function findBeatNoteByTitle(files: TFile[], beatTitle: string, app: App): TFile | null {"
        }
      }
    },
    {
      "filePath": "src/GossamerCommands.ts",
      "line": 200,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Save Gossamer scores to Beat note frontmatter with appending (G1=oldest, newest=highest number)",
      "context": {
        "before": {
          "line": 199,
          "text": "/**"
        },
        "current": {
          "line": 200,
          "text": "* Save Gossamer scores to Beat note frontmatter with appending (G1=oldest, newest=highest number)"
        },
        "after": {
          "line": 201,
          "text": "* Also saves the dominant publish stage at the time of the run."
        }
      }
    },
    {
      "filePath": "src/GossamerCommands.ts",
      "line": 243,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// Clean up old/deprecated fields",
      "context": {
        "before": {
          "line": 242,
          "text": ""
        },
        "current": {
          "line": 243,
          "text": "// Clean up old/deprecated fields"
        },
        "after": {
          "line": 244,
          "text": "delete fm.GossamerLocation;"
        }
      }
    },
    {
      "filePath": "src/GossamerCommands.ts",
      "line": 511,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "plugin.refreshTimelineIfNeeded(undefined);",
      "context": {
        "before": {
          "line": 510,
          "text": "// Fall back to full refresh if selective failed"
        },
        "current": {
          "line": 511,
          "text": "plugin.refreshTimelineIfNeeded(undefined);"
        },
        "after": {
          "line": 512,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/GossamerCommands.ts",
      "line": 583,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 582,
          "text": "// Fallback to plugin refresh"
        },
        "current": {
          "line": 583,
          "text": "plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 584,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/GossamerCommands.ts",
      "line": 669,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// If Custom is selected, try to get the custom name from the first beat note's Beat Model field",
      "context": {
        "before": {
          "line": 668,
          "text": ""
        },
        "current": {
          "line": 669,
          "text": "// If Custom is selected, try to get the custom name from the first beat note's Beat Model field"
        },
        "after": {
          "line": 670,
          "text": "let beatSystemDisplayName = settingsBeatSystem;"
        }
      }
    },
    {
      "filePath": "src/GossamerCommands.ts",
      "line": 731,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Get cache for this beat note to read Range field",
      "context": {
        "before": {
          "line": 730,
          "text": ""
        },
        "current": {
          "line": 731,
          "text": "// Get cache for this beat note to read Range field"
        },
        "after": {
          "line": 732,
          "text": "const file = plugin.app.vault.getAbstractFileByPath(beat.path || '');"
        }
      }
    },
    {
      "filePath": "src/GossamerCommands.ts",
      "line": 743,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: Previous scores/justifications are intentionally NOT included",
      "context": {
        "before": {
          "line": 742,
          "text": "idealRange: rangeValue"
        },
        "current": {
          "line": 743,
          "text": "// Note: Previous scores/justifications are intentionally NOT included"
        },
        "after": {
          "line": 744,
          "text": "// to avoid anchoring bias. Each analysis is fresh based on manuscript content only."
        }
      }
    },
    {
      "filePath": "src/GossamerCommands.ts",
      "line": 938,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Update beat note with scores",
      "context": {
        "before": {
          "line": 937,
          "text": ""
        },
        "current": {
          "line": 938,
          "text": "// Update beat note with scores"
        },
        "after": {
          "line": 939,
          "text": "await plugin.app.fileManager.processFrontMatter(file, (yaml) => {"
        }
      }
    },
    {
      "filePath": "src/RuntimeCommands.ts",
      "line": 38,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const isTodo = !normalized || normalized === 'Todo';",
      "context": {
        "before": {
          "line": 37,
          "text": "// Map to our filter categories"
        },
        "current": {
          "line": 38,
          "text": "const isTodo = !normalized || normalized === 'Todo';"
        },
        "after": {
          "line": 39,
          "text": "const isWorking = normalized === 'Working';"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 11,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { getPublishStageStyle, splitSynopsisLines, decodeContentLines, isOverdueAndIncomplete } from './synopsis/SynopsisData';",
      "context": {
        "before": {
          "line": 10,
          "text": "import { decodeHtmlEntities, parseSceneTitleComponents } from './utils/text';"
        },
        "current": {
          "line": 11,
          "text": "import { getPublishStageStyle, splitSynopsisLines, decodeContentLines, isOverdueAndIncomplete } from './synopsis/SynopsisData';"
        },
        "after": {
          "line": 12,
          "text": "import { createSynopsisContainer, createTextGroup, createText } from './synopsis/SynopsisView';"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 12,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { createSynopsisContainer, createTextGroup, createText } from './synopsis/SynopsisView';",
      "context": {
        "before": {
          "line": 11,
          "text": "import { getPublishStageStyle, splitSynopsisLines, decodeContentLines, isOverdueAndIncomplete } from './synopsis/SynopsisData';"
        },
        "current": {
          "line": 12,
          "text": "import { createSynopsisContainer, createTextGroup, createText } from './synopsis/SynopsisView';"
        },
        "after": {
          "line": 13,
          "text": "import { convertFromEarth, getActivePlanetaryProfile } from './utils/planetaryTime';"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 19,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "SYNOPSIS_INSET,",
      "context": {
        "before": {
          "line": 18,
          "text": "SUBPLOT_OUTER_RADIUS_CHRONOLOGUE,"
        },
        "current": {
          "line": 19,
          "text": "SYNOPSIS_INSET,"
        },
        "after": {
          "line": 20,
          "text": "MAX_TEXT_WIDTH,"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 29,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { getSynopsisHoverLineLimit } from './utils/synopsisLimits';",
      "context": {
        "before": {
          "line": 28,
          "text": "import { getIcon } from 'obsidian';"
        },
        "current": {
          "line": 29,
          "text": "import { getSynopsisHoverLineLimit } from './utils/synopsisLimits';"
        },
        "after": {
          "line": 30,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 32,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Handles generating synopsis SVG/HTML blocks and positioning logic.",
      "context": {
        "before": {
          "line": 31,
          "text": "/**"
        },
        "current": {
          "line": 32,
          "text": "* Handles generating synopsis SVG/HTML blocks and positioning logic."
        },
        "after": {
          "line": 33,
          "text": "* (This is the class you formerly had inside main.ts, unchanged.)"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 35,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export default class SynopsisManager {",
      "context": {
        "before": {
          "line": 34,
          "text": "*/"
        },
        "current": {
          "line": 35,
          "text": "export default class SynopsisManager {"
        },
        "after": {
          "line": 36,
          "text": "private plugin: RadialTimelinePlugin;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 102,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private resetAdvancedYamlWrap(synopsis: Element): void {",
      "context": {
        "before": {
          "line": 101,
          "text": ""
        },
        "current": {
          "line": 102,
          "text": "private resetAdvancedYamlWrap(synopsis: Element): void {"
        },
        "after": {
          "line": 103,
          "text": "const lineGroups = Array.from(synopsis.querySelectorAll('.rt-hover-metadata-line')) as SVGGElement[];"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 103,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const lineGroups = Array.from(synopsis.querySelectorAll('.rt-hover-metadata-line')) as SVGGElement[];",
      "context": {
        "before": {
          "line": 102,
          "text": "private resetAdvancedYamlWrap(synopsis: Element): void {"
        },
        "current": {
          "line": 103,
          "text": "const lineGroups = Array.from(synopsis.querySelectorAll('.rt-hover-metadata-line')) as SVGGElement[];"
        },
        "after": {
          "line": 104,
          "text": "lineGroups.forEach(group => {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 123,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private resetMainSynopsisWrap(synopsis: Element): void {",
      "context": {
        "before": {
          "line": 122,
          "text": ""
        },
        "current": {
          "line": 123,
          "text": "private resetMainSynopsisWrap(synopsis: Element): void {"
        },
        "after": {
          "line": 124,
          "text": "const wrapped = Array.from(synopsis.querySelectorAll('[data-synopsis-wrap=\"true\"]')) as SVGTextElement[];"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 124,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const wrapped = Array.from(synopsis.querySelectorAll('[data-synopsis-wrap=\"true\"]')) as SVGTextElement[];",
      "context": {
        "before": {
          "line": 123,
          "text": "private resetMainSynopsisWrap(synopsis: Element): void {"
        },
        "current": {
          "line": 124,
          "text": "const wrapped = Array.from(synopsis.querySelectorAll('[data-synopsis-wrap=\"true\"]')) as SVGTextElement[];"
        },
        "after": {
          "line": 125,
          "text": "wrapped.forEach(el => el.remove());"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 127,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const lines = Array.from(synopsis.querySelectorAll('[data-synopsis-line=\"true\"]')) as SVGTextElement[];",
      "context": {
        "before": {
          "line": 126,
          "text": ""
        },
        "current": {
          "line": 127,
          "text": "const lines = Array.from(synopsis.querySelectorAll('[data-synopsis-line=\"true\"]')) as SVGTextElement[];"
        },
        "after": {
          "line": 128,
          "text": "lines.forEach(line => {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 129,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const raw = line.getAttribute('data-synopsis-raw');",
      "context": {
        "before": {
          "line": 128,
          "text": "lines.forEach(line => {"
        },
        "current": {
          "line": 129,
          "text": "const raw = line.getAttribute('data-synopsis-raw');"
        },
        "after": {
          "line": 130,
          "text": "if (raw !== null) {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 136,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private resetPendingEditsWrap(synopsis: Element): void {",
      "context": {
        "before": {
          "line": 135,
          "text": ""
        },
        "current": {
          "line": 136,
          "text": "private resetPendingEditsWrap(synopsis: Element): void {"
        },
        "after": {
          "line": 137,
          "text": "const wrapped = Array.from(synopsis.querySelectorAll('[data-pending-wrap=\"true\"]')) as SVGTextElement[];"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 137,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const wrapped = Array.from(synopsis.querySelectorAll('[data-pending-wrap=\"true\"]')) as SVGTextElement[];",
      "context": {
        "before": {
          "line": 136,
          "text": "private resetPendingEditsWrap(synopsis: Element): void {"
        },
        "current": {
          "line": 137,
          "text": "const wrapped = Array.from(synopsis.querySelectorAll('[data-pending-wrap=\"true\"]')) as SVGTextElement[];"
        },
        "after": {
          "line": 138,
          "text": "wrapped.forEach(el => el.remove());"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 140,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const lines = Array.from(synopsis.querySelectorAll('[data-pending-line=\"true\"]')) as SVGTextElement[];",
      "context": {
        "before": {
          "line": 139,
          "text": ""
        },
        "current": {
          "line": 140,
          "text": "const lines = Array.from(synopsis.querySelectorAll('[data-pending-line=\"true\"]')) as SVGTextElement[];"
        },
        "after": {
          "line": 141,
          "text": "lines.forEach(line => {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 150,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private applyMainSynopsisWrap(params: {",
      "context": {
        "before": {
          "line": 149,
          "text": ""
        },
        "current": {
          "line": 150,
          "text": "private applyMainSynopsisWrap(params: {"
        },
        "after": {
          "line": 151,
          "text": "textRows: SVGTextElement[][];"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 174,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisLineHeight = 22 * fontScale;",
      "context": {
        "before": {
          "line": 173,
          "text": "const titleLineHeight = 32 * fontScale;"
        },
        "current": {
          "line": 174,
          "text": "const synopsisLineHeight = 22 * fontScale;"
        },
        "after": {
          "line": 175,
          "text": "const scorePreGap = 46 * fontScale;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 189,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isPrevLineSynopsis = prevEl.classList.contains('rt-title-text-secondary');",
      "context": {
        "before": {
          "line": 188,
          "text": "const prevEl = textRows[rowIndex - 1][0];"
        },
        "current": {
          "line": 189,
          "text": "const isPrevLineSynopsis = prevEl.classList.contains('rt-title-text-secondary');"
        },
        "after": {
          "line": 190,
          "text": "const isPrevLineBeats = prevEl.classList.contains('pulse-text');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 194,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "} else if (isGossamerLine && isPrevLineSynopsis) {",
      "context": {
        "before": {
          "line": 193,
          "text": "yOffset += titleLineHeight;"
        },
        "current": {
          "line": 194,
          "text": "} else if (isGossamerLine && isPrevLineSynopsis) {"
        },
        "after": {
          "line": 195,
          "text": "yOffset += scorePreGap;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 199,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "yOffset += synopsisLineHeight;",
      "context": {
        "before": {
          "line": 198,
          "text": "} else {"
        },
        "current": {
          "line": 199,
          "text": "yOffset += synopsisLineHeight;"
        },
        "after": {
          "line": 200,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 203,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (primaryEl.getAttribute('data-synopsis-line') !== 'true') {",
      "context": {
        "before": {
          "line": 202,
          "text": ""
        },
        "current": {
          "line": 203,
          "text": "if (primaryEl.getAttribute('data-synopsis-line') !== 'true') {"
        },
        "after": {
          "line": 204,
          "text": "continue;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 207,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const raw = primaryEl.getAttribute('data-synopsis-raw') ?? primaryEl.textContent ?? '';",
      "context": {
        "before": {
          "line": 206,
          "text": ""
        },
        "current": {
          "line": 207,
          "text": "const raw = primaryEl.getAttribute('data-synopsis-raw') ?? primaryEl.textContent ?? '';"
        },
        "after": {
          "line": 208,
          "text": "if (!raw.trim()) continue;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 221,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const ratio = rowIndex <= 1 ? 0.5 : SynopsisManager.TEXT_HEIGHT_INSET_RATIO;",
      "context": {
        "before": {
          "line": 220,
          "text": "const fontSize = parseFloat(style.fontSize) || 16;"
        },
        "current": {
          "line": 221,
          "text": "const ratio = rowIndex <= 1 ? 0.5 : SynopsisManager.TEXT_HEIGHT_INSET_RATIO;"
        },
        "after": {
          "line": 222,
          "text": "inset = fontSize * ratio;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 226,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const rightEdge = anchorAbsoluteX - SYNOPSIS_INSET;",
      "context": {
        "before": {
          "line": 225,
          "text": "const anchorAbsoluteX = (circleX - inset) * direction;"
        },
        "current": {
          "line": 226,
          "text": "const rightEdge = anchorAbsoluteX - SYNOPSIS_INSET;"
        },
        "after": {
          "line": 227,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 239,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const leftEdge = anchorAbsoluteX + SYNOPSIS_INSET;",
      "context": {
        "before": {
          "line": 238,
          "text": "} else {"
        },
        "current": {
          "line": 239,
          "text": "const leftEdge = anchorAbsoluteX + SYNOPSIS_INSET;"
        },
        "after": {
          "line": 240,
          "text": "const leftBoundary = boundaryX > 0 ? -boundaryX : 0;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 244,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "maxWidth += SynopsisManager.WRAP_OVERFLOW_TOLERANCE * fontScale;",
      "context": {
        "before": {
          "line": 243,
          "text": ""
        },
        "current": {
          "line": 244,
          "text": "maxWidth += SynopsisManager.WRAP_OVERFLOW_TOLERANCE * fontScale;"
        },
        "after": {
          "line": 245,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 254,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "primaryEl.setAttribute('data-synopsis-line', 'true');",
      "context": {
        "before": {
          "line": 253,
          "text": "primaryEl.textContent = wrapped[0];"
        },
        "current": {
          "line": 254,
          "text": "primaryEl.setAttribute('data-synopsis-line', 'true');"
        },
        "after": {
          "line": 255,
          "text": "const insertParent = primaryEl.parentNode;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 259,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "cont.setAttribute('data-synopsis-wrap', 'true');",
      "context": {
        "before": {
          "line": 258,
          "text": "const cont = primaryEl.cloneNode(false) as SVGTextElement;"
        },
        "current": {
          "line": 259,
          "text": "cont.setAttribute('data-synopsis-wrap', 'true');"
        },
        "after": {
          "line": 260,
          "text": "cont.setAttribute('data-synopsis-line', 'true');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 260,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "cont.setAttribute('data-synopsis-line', 'true');",
      "context": {
        "before": {
          "line": 259,
          "text": "cont.setAttribute('data-synopsis-wrap', 'true');"
        },
        "current": {
          "line": 260,
          "text": "cont.setAttribute('data-synopsis-line', 'true');"
        },
        "after": {
          "line": 261,
          "text": "cont.textContent = wrapped[i];"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 320,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisLineHeight = 22 * fontScale;",
      "context": {
        "before": {
          "line": 319,
          "text": "const titleLineHeight = 32 * fontScale;"
        },
        "current": {
          "line": 320,
          "text": "const synopsisLineHeight = 22 * fontScale;"
        },
        "after": {
          "line": 321,
          "text": "const scorePreGap = 46 * fontScale;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 334,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isPrevLineSynopsis = prevEl.classList.contains('rt-title-text-secondary');",
      "context": {
        "before": {
          "line": 333,
          "text": "const prevEl = textRows[rowIndex - 1][0];"
        },
        "current": {
          "line": 334,
          "text": "const isPrevLineSynopsis = prevEl.classList.contains('rt-title-text-secondary');"
        },
        "after": {
          "line": 335,
          "text": "const isPrevLineBeats = prevEl.classList.contains('pulse-text');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 339,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "} else if (isGossamerLine && isPrevLineSynopsis) {",
      "context": {
        "before": {
          "line": 338,
          "text": "yOffset += titleLineHeight;"
        },
        "current": {
          "line": 339,
          "text": "} else if (isGossamerLine && isPrevLineSynopsis) {"
        },
        "after": {
          "line": 340,
          "text": "yOffset += scorePreGap;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 344,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "yOffset += synopsisLineHeight;",
      "context": {
        "before": {
          "line": 343,
          "text": "} else {"
        },
        "current": {
          "line": 344,
          "text": "yOffset += synopsisLineHeight;"
        },
        "after": {
          "line": 345,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 367,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const ratio = rowIndex <= 1 ? 0.5 : SynopsisManager.TEXT_HEIGHT_INSET_RATIO;",
      "context": {
        "before": {
          "line": 366,
          "text": "const fontSize = parseFloat(style.fontSize) || 16;"
        },
        "current": {
          "line": 367,
          "text": "const ratio = rowIndex <= 1 ? 0.5 : SynopsisManager.TEXT_HEIGHT_INSET_RATIO;"
        },
        "after": {
          "line": 368,
          "text": "inset = fontSize * ratio;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 372,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const rightEdge = anchorAbsoluteX - SYNOPSIS_INSET;",
      "context": {
        "before": {
          "line": 371,
          "text": "const anchorAbsoluteX = (circleX - inset) * direction;"
        },
        "current": {
          "line": 372,
          "text": "const rightEdge = anchorAbsoluteX - SYNOPSIS_INSET;"
        },
        "after": {
          "line": 373,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 385,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const leftEdge = anchorAbsoluteX + SYNOPSIS_INSET;",
      "context": {
        "before": {
          "line": 384,
          "text": "} else {"
        },
        "current": {
          "line": 385,
          "text": "const leftEdge = anchorAbsoluteX + SYNOPSIS_INSET;"
        },
        "after": {
          "line": 386,
          "text": "const leftBoundary = boundaryX > 0 ? -boundaryX : 0;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 390,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "maxWidth += SynopsisManager.WRAP_OVERFLOW_TOLERANCE * fontScale;",
      "context": {
        "before": {
          "line": 389,
          "text": ""
        },
        "current": {
          "line": 390,
          "text": "maxWidth += SynopsisManager.WRAP_OVERFLOW_TOLERANCE * fontScale;"
        },
        "after": {
          "line": 391,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 441,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisLineHeight = 22 * fontScale;",
      "context": {
        "before": {
          "line": 440,
          "text": "const titleLineHeight = 32 * fontScale;"
        },
        "current": {
          "line": 441,
          "text": "const synopsisLineHeight = 22 * fontScale;"
        },
        "after": {
          "line": 442,
          "text": "const scorePreGap = 46 * fontScale;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 456,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isPrevLineSynopsis = prevEl.classList.contains('rt-title-text-secondary');",
      "context": {
        "before": {
          "line": 455,
          "text": "const prevEl = textRows[rowIndex - 1][0];"
        },
        "current": {
          "line": 456,
          "text": "const isPrevLineSynopsis = prevEl.classList.contains('rt-title-text-secondary');"
        },
        "after": {
          "line": 457,
          "text": "const isPrevLineBeats = prevEl.classList.contains('pulse-text');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 461,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "} else if (isGossamerLine && isPrevLineSynopsis) {",
      "context": {
        "before": {
          "line": 460,
          "text": "yOffset += titleLineHeight;"
        },
        "current": {
          "line": 461,
          "text": "} else if (isGossamerLine && isPrevLineSynopsis) {"
        },
        "after": {
          "line": 462,
          "text": "yOffset += scorePreGap;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 466,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "yOffset += synopsisLineHeight;",
      "context": {
        "before": {
          "line": 465,
          "text": "} else {"
        },
        "current": {
          "line": 466,
          "text": "yOffset += synopsisLineHeight;"
        },
        "after": {
          "line": 467,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 486,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const ratio = rowIndex <= 1 ? 0.5 : SynopsisManager.TEXT_HEIGHT_INSET_RATIO;",
      "context": {
        "before": {
          "line": 485,
          "text": "const fontSize = parseFloat(style.fontSize) || 16;"
        },
        "current": {
          "line": 486,
          "text": "const ratio = rowIndex <= 1 ? 0.5 : SynopsisManager.TEXT_HEIGHT_INSET_RATIO;"
        },
        "after": {
          "line": 487,
          "text": "inset = fontSize * ratio;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 493,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const rightEdge = anchorAbsoluteX - SYNOPSIS_INSET;",
      "context": {
        "before": {
          "line": 492,
          "text": "const anchorAbsoluteX = (circleX - inset - extraRightInset) * direction;"
        },
        "current": {
          "line": 493,
          "text": "const rightEdge = anchorAbsoluteX - SYNOPSIS_INSET;"
        },
        "after": {
          "line": 494,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 506,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const leftEdge = anchorAbsoluteX + SYNOPSIS_INSET;",
      "context": {
        "before": {
          "line": 505,
          "text": "} else {"
        },
        "current": {
          "line": 506,
          "text": "const leftEdge = anchorAbsoluteX + SYNOPSIS_INSET;"
        },
        "after": {
          "line": 507,
          "text": "const leftBoundary = boundaryX > 0 ? -boundaryX : 0;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 511,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "maxWidth += SynopsisManager.WRAP_OVERFLOW_TOLERANCE * fontScale;",
      "context": {
        "before": {
          "line": 510,
          "text": ""
        },
        "current": {
          "line": 511,
          "text": "maxWidth += SynopsisManager.WRAP_OVERFLOW_TOLERANCE * fontScale;"
        },
        "after": {
          "line": 512,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 729,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Create a DOM element for a scene synopsis with consistent formatting",
      "context": {
        "before": {
          "line": 728,
          "text": "/**"
        },
        "current": {
          "line": 729,
          "text": "* Create a DOM element for a scene synopsis with consistent formatting"
        },
        "after": {
          "line": 730,
          "text": "* @returns An SVG group element containing the formatted synopsis"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 730,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* @returns An SVG group element containing the formatted synopsis",
      "context": {
        "before": {
          "line": 729,
          "text": "* Create a DOM element for a scene synopsis with consistent formatting"
        },
        "current": {
          "line": 730,
          "text": "* @returns An SVG group element containing the formatted synopsis"
        },
        "after": {
          "line": 731,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 761,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const { synopsisEndIndex, metadataItems } = splitSynopsisLines(contentLines);",
      "context": {
        "before": {
          "line": 760,
          "text": ""
        },
        "current": {
          "line": 761,
          "text": "const { synopsisEndIndex, metadataItems } = splitSynopsisLines(contentLines);"
        },
        "after": {
          "line": 762,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 789,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "throw new Error(`Scene group not found for synopsis ${sceneIdentifier}.`);",
      "context": {
        "before": {
          "line": 788,
          "text": "if (!sceneGroup) {"
        },
        "current": {
          "line": 789,
          "text": "throw new Error(`Scene group not found for synopsis ${sceneIdentifier}.`);"
        },
        "after": {
          "line": 790,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 807,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisLineHeight = parseFloat(styleSource.getPropertyValue('--rt-synopsis-line-height'));",
      "context": {
        "before": {
          "line": 806,
          "text": "const styleSource = getComputedStyle(document.documentElement);"
        },
        "current": {
          "line": 807,
          "text": "const synopsisLineHeight = parseFloat(styleSource.getPropertyValue('--rt-synopsis-line-height'));"
        },
        "after": {
          "line": 808,
          "text": "const pulseLineHeightRaw = parseFloat(styleSource.getPropertyValue('--rt-pulse-line-height'));"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 809,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const metadataLineHeight = parseFloat(styleSource.getPropertyValue('--rt-synopsis-metadata-line-height'));",
      "context": {
        "before": {
          "line": 808,
          "text": "const pulseLineHeightRaw = parseFloat(styleSource.getPropertyValue('--rt-pulse-line-height'));"
        },
        "current": {
          "line": 809,
          "text": "const metadataLineHeight = parseFloat(styleSource.getPropertyValue('--rt-synopsis-metadata-line-height'));"
        },
        "after": {
          "line": 810,
          "text": "const lineHeight = synopsisLineHeight * fontScale;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 810,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const lineHeight = synopsisLineHeight * fontScale;",
      "context": {
        "before": {
          "line": 809,
          "text": "const metadataLineHeight = parseFloat(styleSource.getPropertyValue('--rt-synopsis-metadata-line-height'));"
        },
        "current": {
          "line": 810,
          "text": "const lineHeight = synopsisLineHeight * fontScale;"
        },
        "after": {
          "line": 811,
          "text": "const pulseLineHeight = pulseLineHeightRaw * fontScale;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 814,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const containerGroup = createSynopsisContainer(sceneId, scene.path);",
      "context": {
        "before": {
          "line": 813,
          "text": "// Create the main container group"
        },
        "current": {
          "line": 814,
          "text": "const containerGroup = createSynopsisContainer(sceneId, scene.path);"
        },
        "after": {
          "line": 815,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 816,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Store publish stage color on synopsis for hover title color updates in Subplot mode",
      "context": {
        "before": {
          "line": 815,
          "text": ""
        },
        "current": {
          "line": 816,
          "text": "// Store publish stage color on synopsis for hover title color updates in Subplot mode"
        },
        "after": {
          "line": 817,
          "text": "containerGroup.setAttribute('data-stage-color', titleColor);"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 819,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Create the synopsis text group",
      "context": {
        "before": {
          "line": 818,
          "text": ""
        },
        "current": {
          "line": 819,
          "text": "// Create the synopsis text group"
        },
        "after": {
          "line": 820,
          "text": "const synopsisTextGroup = createTextGroup();"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 820,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisTextGroup = createTextGroup();",
      "context": {
        "before": {
          "line": 819,
          "text": "// Create the synopsis text group"
        },
        "current": {
          "line": 820,
          "text": "const synopsisTextGroup = createTextGroup();"
        },
        "after": {
          "line": 821,
          "text": "containerGroup.appendChild(synopsisTextGroup);"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 821,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "containerGroup.appendChild(synopsisTextGroup);",
      "context": {
        "before": {
          "line": 820,
          "text": "const synopsisTextGroup = createTextGroup();"
        },
        "current": {
          "line": 821,
          "text": "containerGroup.appendChild(synopsisTextGroup);"
        },
        "after": {
          "line": 822,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 866,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisTextGroup.appendChild(titleTextElement);",
      "context": {
        "before": {
          "line": 865,
          "text": ""
        },
        "current": {
          "line": 866,
          "text": "synopsisTextGroup.appendChild(titleTextElement);"
        },
        "after": {
          "line": 867,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 870,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisTextGroup.appendChild(metadataElement);",
      "context": {
        "before": {
          "line": 869,
          "text": "if (metadataElement) {"
        },
        "current": {
          "line": 870,
          "text": "synopsisTextGroup.appendChild(metadataElement);"
        },
        "after": {
          "line": 871,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 873,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Insert special extra lines right after the title (Due/Pending Edits), then the regular synopsis lines",
      "context": {
        "before": {
          "line": 872,
          "text": ""
        },
        "current": {
          "line": 873,
          "text": "// Insert special extra lines right after the title (Due/Pending Edits), then the regular synopsis lines"
        },
        "after": {
          "line": 874,
          "text": "let extraLineCount = 0;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 878,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisTextGroup.appendChild(createText(0, y, className, text));",
      "context": {
        "before": {
          "line": 877,
          "text": "const y = (1 + extraLineCount) * metadataLineHeight;"
        },
        "current": {
          "line": 878,
          "text": "synopsisTextGroup.appendChild(createText(0, y, className, text));"
        },
        "after": {
          "line": 879,
          "text": "extraLineCount += 1;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 903,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: y position is overridden by positionRowColumns using PLANETARY_RECT_Y_OFFSET",
      "context": {
        "before": {
          "line": 902,
          "text": "// Border starts at x=0 like other text lines (parent group handles positioning)"
        },
        "current": {
          "line": 903,
          "text": "// Note: y position is overridden by positionRowColumns using PLANETARY_RECT_Y_OFFSET"
        },
        "after": {
          "line": 904,
          "text": "rect.setAttribute('x', '0');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 905,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "rect.setAttribute('y', String(y - SynopsisManager.PLANETARY_RECT_Y_OFFSET));",
      "context": {
        "before": {
          "line": 904,
          "text": "rect.setAttribute('x', '0');"
        },
        "current": {
          "line": 905,
          "text": "rect.setAttribute('y', String(y - SynopsisManager.PLANETARY_RECT_Y_OFFSET));"
        },
        "after": {
          "line": 906,
          "text": "rect.setAttribute('width', String(estWidth + padX));"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 913,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisTextGroup.appendChild(group);",
      "context": {
        "before": {
          "line": 912,
          "text": "group.appendChild(textEl);"
        },
        "current": {
          "line": 913,
          "text": "synopsisTextGroup.appendChild(group);"
        },
        "after": {
          "line": 914,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 943,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisTextGroup.appendChild(textEl);",
      "context": {
        "before": {
          "line": 942,
          "text": "textEl.setAttribute('data-pending-prefix', prefix);"
        },
        "current": {
          "line": 943,
          "text": "synopsisTextGroup.appendChild(textEl);"
        },
        "after": {
          "line": 944,
          "text": "extraLineCount += 1;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 947,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Add synopsis lines with precise vertical spacing, offset by the number of extra lines",
      "context": {
        "before": {
          "line": 946,
          "text": ""
        },
        "current": {
          "line": 947,
          "text": "// Add synopsis lines with precise vertical spacing, offset by the number of extra lines"
        },
        "after": {
          "line": 948,
          "text": "for (let i = 1; i < synopsisEndIndex; i++) {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 948,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "for (let i = 1; i < synopsisEndIndex; i++) {",
      "context": {
        "before": {
          "line": 947,
          "text": "// Add synopsis lines with precise vertical spacing, offset by the number of extra lines"
        },
        "current": {
          "line": 948,
          "text": "for (let i = 1; i < synopsisEndIndex; i++) {"
        },
        "after": {
          "line": 949,
          "text": "const lineContent = decodedContentLines[i];"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 963,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisLineElement = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");",
      "context": {
        "before": {
          "line": 962,
          "text": "const lineY = (i + extraLineCount) * lineHeight; // shift down by inserted lines"
        },
        "current": {
          "line": 963,
          "text": "const synopsisLineElement = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");"
        },
        "after": {
          "line": 964,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 968,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text rt-gossamer-spacer\");",
      "context": {
        "before": {
          "line": 967,
          "text": "// Create an invisible spacer element that adds vertical space"
        },
        "current": {
          "line": 968,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text rt-gossamer-spacer\");"
        },
        "after": {
          "line": 969,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 969,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"x\", \"0\");",
      "context": {
        "before": {
          "line": 968,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text rt-gossamer-spacer\");"
        },
        "current": {
          "line": 969,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        },
        "after": {
          "line": 970,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 970,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"y\", String(lineY));",
      "context": {
        "before": {
          "line": 969,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        },
        "current": {
          "line": 970,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        },
        "after": {
          "line": 971,
          "text": "synopsisLineElement.setAttribute(\"font-size\", \"2px\");"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 971,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"font-size\", \"2px\");",
      "context": {
        "before": {
          "line": 970,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        },
        "current": {
          "line": 971,
          "text": "synopsisLineElement.setAttribute(\"font-size\", \"2px\");"
        },
        "after": {
          "line": 972,
          "text": "synopsisLineElement.textContent = \"\\u00A0\"; // Non-breaking space"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 972,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.textContent = \"\\u00A0\"; // Non-breaking space",
      "context": {
        "before": {
          "line": 971,
          "text": "synopsisLineElement.setAttribute(\"font-size\", \"2px\");"
        },
        "current": {
          "line": 972,
          "text": "synopsisLineElement.textContent = \"\\u00A0\"; // Non-breaking space"
        },
        "after": {
          "line": 973,
          "text": "synopsisLineElement.classList.add('rt-invisible-spacer');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 973,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.classList.add('rt-invisible-spacer');",
      "context": {
        "before": {
          "line": 972,
          "text": "synopsisLineElement.textContent = \"\\u00A0\"; // Non-breaking space"
        },
        "current": {
          "line": 973,
          "text": "synopsisLineElement.classList.add('rt-invisible-spacer');"
        },
        "after": {
          "line": 974,
          "text": "// The lineY increment will create the gap for the next line"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 977,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text rt-title-text-main rt-gossamer-score-line\");",
      "context": {
        "before": {
          "line": 976,
          "text": "// Apply title styling for Gossamer lines"
        },
        "current": {
          "line": 977,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text rt-title-text-main rt-gossamer-score-line\");"
        },
        "after": {
          "line": 978,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 978,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"x\", \"0\");",
      "context": {
        "before": {
          "line": 977,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text rt-title-text-main rt-gossamer-score-line\");"
        },
        "current": {
          "line": 978,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        },
        "after": {
          "line": 979,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 979,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"y\", String(lineY));",
      "context": {
        "before": {
          "line": 978,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        },
        "current": {
          "line": 979,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        },
        "after": {
          "line": 980,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 990,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.appendChild(gossamerTspan);",
      "context": {
        "before": {
          "line": 989,
          "text": "gossamerTspan.textContent = gossamerContent;"
        },
        "current": {
          "line": 990,
          "text": "synopsisLineElement.appendChild(gossamerTspan);"
        },
        "after": {
          "line": 991,
          "text": "} else if (isGossamerJustificationLine) {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 993,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text pulse-text rt-gossamer-justification-line\");",
      "context": {
        "before": {
          "line": 992,
          "text": "// Style Gossamer justification like pulse analysis (gray, uppercase, same line height)"
        },
        "current": {
          "line": 993,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text pulse-text rt-gossamer-justification-line\");"
        },
        "after": {
          "line": 994,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 994,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"x\", \"0\");",
      "context": {
        "before": {
          "line": 993,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text pulse-text rt-gossamer-justification-line\");"
        },
        "current": {
          "line": 994,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        },
        "after": {
          "line": 995,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 995,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"y\", String(lineY));",
      "context": {
        "before": {
          "line": 994,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        },
        "current": {
          "line": 995,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        },
        "after": {
          "line": 996,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 999,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.textContent = justificationContent;",
      "context": {
        "before": {
          "line": 998,
          "text": "const justificationContent = contentLines[i].replace(/<gossamer-justification>/g, '').replace(/<\\/gossamer-justification>/g, '');"
        },
        "current": {
          "line": 999,
          "text": "synopsisLineElement.textContent = justificationContent;"
        },
        "after": {
          "line": 1000,
          "text": "} else if (isGossamerPulseLine) {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1002,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text gossamer-grade\");",
      "context": {
        "before": {
          "line": 1001,
          "text": "// Format: \"80/100  JUSTIFICATION\" with beat-stage grade styling"
        },
        "current": {
          "line": 1002,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text gossamer-grade\");"
        },
        "after": {
          "line": 1003,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1003,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"x\", \"0\");",
      "context": {
        "before": {
          "line": 1002,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text gossamer-grade\");"
        },
        "current": {
          "line": 1003,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        },
        "after": {
          "line": 1004,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1004,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"y\", String(lineY));",
      "context": {
        "before": {
          "line": 1003,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        },
        "current": {
          "line": 1004,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        },
        "after": {
          "line": 1005,
          "text": "if (beatStageColor) {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1006,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.style.setProperty('--rt-gossamer-stage-color', beatStageColor);",
      "context": {
        "before": {
          "line": 1005,
          "text": "if (beatStageColor) {"
        },
        "current": {
          "line": 1006,
          "text": "synopsisLineElement.style.setProperty('--rt-gossamer-stage-color', beatStageColor);"
        },
        "after": {
          "line": 1007,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1024,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.appendChild(scoreTspan);",
      "context": {
        "before": {
          "line": 1023,
          "text": "scoreTspan.textContent = scorePart;"
        },
        "current": {
          "line": 1024,
          "text": "synopsisLineElement.appendChild(scoreTspan);"
        },
        "after": {
          "line": 1025,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1030,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.appendChild(justificationTspan);",
      "context": {
        "before": {
          "line": 1029,
          "text": "justificationTspan.textContent = '  ' + justificationPart;"
        },
        "current": {
          "line": 1030,
          "text": "synopsisLineElement.appendChild(justificationTspan);"
        },
        "after": {
          "line": 1031,
          "text": "} else {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1036,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.appendChild(scoreTspan);",
      "context": {
        "before": {
          "line": 1035,
          "text": "scoreTspan.textContent = pulseContent;"
        },
        "current": {
          "line": 1036,
          "text": "synopsisLineElement.appendChild(scoreTspan);"
        },
        "after": {
          "line": 1037,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1040,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text gossamer-grade\");",
      "context": {
        "before": {
          "line": 1039,
          "text": "// Continuation line for wrapped Gossamer justification (same grade styling)"
        },
        "current": {
          "line": 1040,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text gossamer-grade\");"
        },
        "after": {
          "line": 1041,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1041,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"x\", \"0\");",
      "context": {
        "before": {
          "line": 1040,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text gossamer-grade\");"
        },
        "current": {
          "line": 1041,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        },
        "after": {
          "line": 1042,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1042,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"y\", String(lineY));",
      "context": {
        "before": {
          "line": 1041,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        },
        "current": {
          "line": 1042,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        },
        "after": {
          "line": 1043,
          "text": "if (beatStageColor) {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1044,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.style.setProperty('--rt-gossamer-stage-color', beatStageColor);",
      "context": {
        "before": {
          "line": 1043,
          "text": "if (beatStageColor) {"
        },
        "current": {
          "line": 1044,
          "text": "synopsisLineElement.style.setProperty('--rt-gossamer-stage-color', beatStageColor);"
        },
        "after": {
          "line": 1045,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1049,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.textContent = contContent;",
      "context": {
        "before": {
          "line": 1048,
          "text": "const contContent = contentLines[i].replace(/<gossamer-pulse-cont>/g, '').replace(/<\\/gossamer-pulse-cont>/g, '');"
        },
        "current": {
          "line": 1049,
          "text": "synopsisLineElement.textContent = contContent;"
        },
        "after": {
          "line": 1050,
          "text": "} else {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1051,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Regular synopsis line styling",
      "context": {
        "before": {
          "line": 1050,
          "text": "} else {"
        },
        "current": {
          "line": 1051,
          "text": "// Regular synopsis line styling"
        },
        "after": {
          "line": 1052,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text rt-title-text-secondary\");"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1052,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text rt-title-text-secondary\");",
      "context": {
        "before": {
          "line": 1051,
          "text": "// Regular synopsis line styling"
        },
        "current": {
          "line": 1052,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text rt-title-text-secondary\");"
        },
        "after": {
          "line": 1053,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1053,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"x\", \"0\");",
      "context": {
        "before": {
          "line": 1052,
          "text": "synopsisLineElement.setAttribute(\"class\", \"rt-info-text rt-title-text-secondary\");"
        },
        "current": {
          "line": 1053,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        },
        "after": {
          "line": 1054,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1054,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute(\"y\", String(lineY));",
      "context": {
        "before": {
          "line": 1053,
          "text": "synopsisLineElement.setAttribute(\"x\", \"0\");"
        },
        "current": {
          "line": 1054,
          "text": "synopsisLineElement.setAttribute(\"y\", String(lineY));"
        },
        "after": {
          "line": 1055,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1057,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.processContentWithTspans(lineContent, synopsisLineElement);",
      "context": {
        "before": {
          "line": 1056,
          "text": "if (lineContent.includes('<tspan')) {"
        },
        "current": {
          "line": 1057,
          "text": "this.processContentWithTspans(lineContent, synopsisLineElement);"
        },
        "after": {
          "line": 1058,
          "text": "} else {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1059,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.textContent = lineContent;",
      "context": {
        "before": {
          "line": 1058,
          "text": "} else {"
        },
        "current": {
          "line": 1059,
          "text": "synopsisLineElement.textContent = lineContent;"
        },
        "after": {
          "line": 1060,
          "text": "synopsisLineElement.setAttribute('data-synopsis-line', 'true');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1060,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute('data-synopsis-line', 'true');",
      "context": {
        "before": {
          "line": 1059,
          "text": "synopsisLineElement.textContent = lineContent;"
        },
        "current": {
          "line": 1060,
          "text": "synopsisLineElement.setAttribute('data-synopsis-line', 'true');"
        },
        "after": {
          "line": 1061,
          "text": "synopsisLineElement.setAttribute('data-synopsis-raw', lineContent);"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1061,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisLineElement.setAttribute('data-synopsis-raw', lineContent);",
      "context": {
        "before": {
          "line": 1060,
          "text": "synopsisLineElement.setAttribute('data-synopsis-line', 'true');"
        },
        "current": {
          "line": 1061,
          "text": "synopsisLineElement.setAttribute('data-synopsis-raw', lineContent);"
        },
        "after": {
          "line": 1062,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1065,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisTextGroup.appendChild(synopsisLineElement);",
      "context": {
        "before": {
          "line": 1064,
          "text": ""
        },
        "current": {
          "line": 1065,
          "text": "synopsisTextGroup.appendChild(synopsisLineElement);"
        },
        "after": {
          "line": 1066,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1076,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "spacerElement.setAttribute(\"class\", \"synopsis-spacer\");",
      "context": {
        "before": {
          "line": 1075,
          "text": "const spacerElement = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");"
        },
        "current": {
          "line": 1076,
          "text": "spacerElement.setAttribute(\"class\", \"synopsis-spacer\");"
        },
        "after": {
          "line": 1077,
          "text": "spacerElement.setAttribute(\"x\", \"0\");"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1083,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisTextGroup.appendChild(spacerElement);",
      "context": {
        "before": {
          "line": 1082,
          "text": "spacerElement.classList.add('rt-invisible-spacer'); // Make it invisible"
        },
        "current": {
          "line": 1083,
          "text": "synopsisTextGroup.appendChild(spacerElement);"
        },
        "after": {
          "line": 1084,
          "text": "// Return value now adds 0 height, placing next block immediately after previous"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1089,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// --- Add Spacer IMMEDIATELY after Synopsis Text ---",
      "context": {
        "before": {
          "line": 1088,
          "text": ""
        },
        "current": {
          "line": 1089,
          "text": "// --- Add Spacer IMMEDIATELY after Synopsis Text ---"
        },
        "after": {
          "line": 1090,
          "text": "const synopsisBottomY = synopsisEndIndex * lineHeight;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1090,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisBottomY = synopsisEndIndex * lineHeight;",
      "context": {
        "before": {
          "line": 1089,
          "text": "// --- Add Spacer IMMEDIATELY after Synopsis Text ---"
        },
        "current": {
          "line": 1090,
          "text": "const synopsisBottomY = synopsisEndIndex * lineHeight;"
        },
        "after": {
          "line": 1091,
          "text": "// Call addSpacer with height 0, and store the returned start position"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1092,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "let currentMetadataY = addSpacer(synopsisBottomY, 0);",
      "context": {
        "before": {
          "line": 1091,
          "text": "// Call addSpacer with height 0, and store the returned start position"
        },
        "current": {
          "line": 1092,
          "text": "let currentMetadataY = addSpacer(synopsisBottomY, 0);"
        },
        "after": {
          "line": 1093,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1100,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const linesAdded = this.formatBeatsText(beatsText, 'previousSceneAnalysis', synopsisTextGroup, beatsY, pulseLineHeight, 0); // Pass 'previousSceneAnalysis'",
      "context": {
        "before": {
          "line": 1099,
          "text": "const beatsText = scene[\"previousSceneAnalysis\"] || '';"
        },
        "current": {
          "line": 1100,
          "text": "const linesAdded = this.formatBeatsText(beatsText, 'previousSceneAnalysis', synopsisTextGroup, beatsY, pulseLineHeight, 0); // Pass 'previousSceneAnalysis'"
        },
        "after": {
          "line": 1101,
          "text": "currentMetadataY = beatsY + (linesAdded * pulseLineHeight);"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1112,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const linesAdded = this.formatBeatsText(beatsText, 'currentSceneAnalysis', synopsisTextGroup, beatsY, pulseLineHeight, 0); // Pass 'currentSceneAnalysis'",
      "context": {
        "before": {
          "line": 1111,
          "text": "const beatsText = scene[\"currentSceneAnalysis\"] || '';"
        },
        "current": {
          "line": 1112,
          "text": "const linesAdded = this.formatBeatsText(beatsText, 'currentSceneAnalysis', synopsisTextGroup, beatsY, pulseLineHeight, 0); // Pass 'currentSceneAnalysis'"
        },
        "after": {
          "line": 1113,
          "text": "currentMetadataY = beatsY + (linesAdded * pulseLineHeight);"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1124,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const linesAdded = this.formatBeatsText(beatsText, 'nextSceneAnalysis', synopsisTextGroup, beatsY, pulseLineHeight, 0); // Pass 'nextSceneAnalysis'",
      "context": {
        "before": {
          "line": 1123,
          "text": "const beatsText = scene[\"nextSceneAnalysis\"] || '';"
        },
        "current": {
          "line": 1124,
          "text": "const linesAdded = this.formatBeatsText(beatsText, 'nextSceneAnalysis', synopsisTextGroup, beatsY, pulseLineHeight, 0); // Pass 'nextSceneAnalysis'"
        },
        "after": {
          "line": 1125,
          "text": "currentMetadataY = beatsY + (linesAdded * pulseLineHeight);"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1259,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisTextGroup.appendChild(lineGroup);",
      "context": {
        "before": {
          "line": 1258,
          "text": ""
        },
        "current": {
          "line": 1259,
          "text": "synopsisTextGroup.appendChild(lineGroup);"
        },
        "after": {
          "line": 1260,
          "text": "hoverMetaLinesAdded++;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1304,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisTextGroup.appendChild(subplotTextElement);",
      "context": {
        "before": {
          "line": 1303,
          "text": ""
        },
        "current": {
          "line": 1304,
          "text": "synopsisTextGroup.appendChild(subplotTextElement);"
        },
        "after": {
          "line": 1305,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1372,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisTextGroup.appendChild(characterTextElement);",
      "context": {
        "before": {
          "line": 1371,
          "text": ""
        },
        "current": {
          "line": 1372,
          "text": "synopsisTextGroup.appendChild(characterTextElement);"
        },
        "after": {
          "line": 1373,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1390,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Update the position of a synopsis based on mouse position",
      "context": {
        "before": {
          "line": 1389,
          "text": "/**"
        },
        "current": {
          "line": 1390,
          "text": "* Update the position of a synopsis based on mouse position"
        },
        "after": {
          "line": 1391,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1392,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "updatePosition(synopsis: Element, event: MouseEvent, svg: SVGSVGElement, sceneId: string): void {",
      "context": {
        "before": {
          "line": 1391,
          "text": "*/"
        },
        "current": {
          "line": 1392,
          "text": "updatePosition(synopsis: Element, event: MouseEvent, svg: SVGSVGElement, sceneId: string): void {"
        },
        "after": {
          "line": 1393,
          "text": "if (!(synopsis instanceof SVGElement)) {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1393,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!(synopsis instanceof SVGElement)) {",
      "context": {
        "before": {
          "line": 1392,
          "text": "updatePosition(synopsis: Element, event: MouseEvent, svg: SVGSVGElement, sceneId: string): void {"
        },
        "current": {
          "line": 1393,
          "text": "if (!(synopsis instanceof SVGElement)) {"
        },
        "after": {
          "line": 1394,
          "text": "throw new Error('Synopsis element must be an SVGElement.');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1394,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "throw new Error('Synopsis element must be an SVGElement.');",
      "context": {
        "before": {
          "line": 1393,
          "text": "if (!(synopsis instanceof SVGElement)) {"
        },
        "current": {
          "line": 1394,
          "text": "throw new Error('Synopsis element must be an SVGElement.');"
        },
        "after": {
          "line": 1395,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1397,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "throw new Error('SVG root is required to position synopsis content.');",
      "context": {
        "before": {
          "line": 1396,
          "text": "if (!svg) {"
        },
        "current": {
          "line": 1397,
          "text": "throw new Error('SVG root is required to position synopsis content.');"
        },
        "after": {
          "line": 1398,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1422,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const adjustedRadius = subplotOuterRadius - SYNOPSIS_INSET;",
      "context": {
        "before": {
          "line": 1421,
          "text": ""
        },
        "current": {
          "line": 1422,
          "text": "const adjustedRadius = subplotOuterRadius - SYNOPSIS_INSET;"
        },
        "after": {
          "line": 1423,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1424,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis.removeAttribute('style');",
      "context": {
        "before": {
          "line": 1423,
          "text": ""
        },
        "current": {
          "line": 1424,
          "text": "synopsis.removeAttribute('style');"
        },
        "after": {
          "line": 1425,
          "text": "synopsis.classList.remove('rt-synopsis-q1', 'rt-synopsis-q2', 'rt-synopsis-q3', 'rt-synopsis-q4');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1425,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis.classList.remove('rt-synopsis-q1', 'rt-synopsis-q2', 'rt-synopsis-q3', 'rt-synopsis-q4');",
      "context": {
        "before": {
          "line": 1424,
          "text": "synopsis.removeAttribute('style');"
        },
        "current": {
          "line": 1425,
          "text": "synopsis.classList.remove('rt-synopsis-q1', 'rt-synopsis-q2', 'rt-synopsis-q3', 'rt-synopsis-q4');"
        },
        "after": {
          "line": 1426,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1428,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis.classList.add(`rt-synopsis-${position.quadrantClass}`);",
      "context": {
        "before": {
          "line": 1427,
          "text": "const position = this.getPositionForQuadrant(quadrant, adjustedRadius);"
        },
        "current": {
          "line": 1428,
          "text": "synopsis.classList.add(`rt-synopsis-${position.quadrantClass}`);"
        },
        "after": {
          "line": 1429,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1432,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "throw new Error(`Synopsis y-position ${y} exceeds radius ${adjustedRadius}`);",
      "context": {
        "before": {
          "line": 1431,
          "text": "if (Math.abs(y) >= adjustedRadius) {"
        },
        "current": {
          "line": 1432,
          "text": "throw new Error(`Synopsis y-position ${y} exceeds radius ${adjustedRadius}`);"
        },
        "after": {
          "line": 1433,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1437,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "throw new Error('Cannot compute synopsis x-position due to invalid radius difference.');",
      "context": {
        "before": {
          "line": 1436,
          "text": "if (diff < 0) {"
        },
        "current": {
          "line": 1437,
          "text": "throw new Error('Cannot compute synopsis x-position due to invalid radius difference.');"
        },
        "after": {
          "line": 1438,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1442,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis.setAttribute('transform', `translate(${x}, ${y})`);",
      "context": {
        "before": {
          "line": 1441,
          "text": ""
        },
        "current": {
          "line": 1442,
          "text": "synopsis.setAttribute('transform', `translate(${x}, ${y})`);"
        },
        "after": {
          "line": 1443,
          "text": "synopsis.classList.add('rt-visible');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1443,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis.classList.add('rt-visible');",
      "context": {
        "before": {
          "line": 1442,
          "text": "synopsis.setAttribute('transform', `translate(${x}, ${y})`);"
        },
        "current": {
          "line": 1443,
          "text": "synopsis.classList.add('rt-visible');"
        },
        "after": {
          "line": 1444,
          "text": "synopsis.setAttribute('opacity', '1');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1444,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis.setAttribute('opacity', '1');",
      "context": {
        "before": {
          "line": 1443,
          "text": "synopsis.classList.add('rt-visible');"
        },
        "current": {
          "line": 1444,
          "text": "synopsis.setAttribute('opacity', '1');"
        },
        "after": {
          "line": 1445,
          "text": "synopsis.setAttribute('pointer-events', 'all');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1445,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis.setAttribute('pointer-events', 'all');",
      "context": {
        "before": {
          "line": 1444,
          "text": "synopsis.setAttribute('opacity', '1');"
        },
        "current": {
          "line": 1445,
          "text": "synopsis.setAttribute('pointer-events', 'all');"
        },
        "after": {
          "line": 1446,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1448,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.positionTextElements(synopsis, position.isRightAligned, position.isTopHalf, adjustedRadius, sceneId, lineInnerRadius);",
      "context": {
        "before": {
          "line": 1447,
          "text": "const lineInnerRadius = this.getLineInnerRadius(svg);"
        },
        "current": {
          "line": 1448,
          "text": "this.positionTextElements(synopsis, position.isRightAligned, position.isTopHalf, adjustedRadius, sceneId, lineInnerRadius);"
        },
        "after": {
          "line": 1449,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1478,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Place synopsis in opposite quadrant from mouse position (same half)",
      "context": {
        "before": {
          "line": 1477,
          "text": "} {"
        },
        "current": {
          "line": 1478,
          "text": "// Place synopsis in opposite quadrant from mouse position (same half)"
        },
        "after": {
          "line": 1479,
          "text": "let result = {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1493,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "case \"Q1\": // Mouse in Bottom Right -> Synopsis in Q2 (Bottom Left)",
      "context": {
        "before": {
          "line": 1492,
          "text": "switch (quadrant) {"
        },
        "current": {
          "line": 1493,
          "text": "case \"Q1\": // Mouse in Bottom Right -> Synopsis in Q2 (Bottom Left)"
        },
        "after": {
          "line": 1494,
          "text": "result.x = 0;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1501,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "case \"Q2\": // Mouse in Bottom Left -> Synopsis in Q1 (Bottom Right)",
      "context": {
        "before": {
          "line": 1500,
          "text": ""
        },
        "current": {
          "line": 1501,
          "text": "case \"Q2\": // Mouse in Bottom Left -> Synopsis in Q1 (Bottom Right)"
        },
        "after": {
          "line": 1502,
          "text": "result.x = 0;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1509,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "case \"Q3\": // Mouse in Top Left -> Synopsis in Q4 (Top Right)",
      "context": {
        "before": {
          "line": 1508,
          "text": ""
        },
        "current": {
          "line": 1509,
          "text": "case \"Q3\": // Mouse in Top Left -> Synopsis in Q4 (Top Right)"
        },
        "after": {
          "line": 1510,
          "text": "result.x = 0;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1517,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "case \"Q4\": // Mouse in Top Right -> Synopsis in Q3 (Top Left)",
      "context": {
        "before": {
          "line": 1516,
          "text": ""
        },
        "current": {
          "line": 1517,
          "text": "case \"Q4\": // Mouse in Top Right -> Synopsis in Q3 (Top Left)"
        },
        "after": {
          "line": 1518,
          "text": "result.x = 0;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1552,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis: Element,",
      "context": {
        "before": {
          "line": 1551,
          "text": "private positionTextElements("
        },
        "current": {
          "line": 1552,
          "text": "synopsis: Element,"
        },
        "after": {
          "line": 1553,
          "text": "isRightAligned: boolean,"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1560,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const prevWrapMode = (synopsis as SVGElement).getAttribute('data-hover-synopsis-wrap') || '';",
      "context": {
        "before": {
          "line": 1559,
          "text": "const wrapMode = isRightAligned ? 'right' : 'left';"
        },
        "current": {
          "line": 1560,
          "text": "const prevWrapMode = (synopsis as SVGElement).getAttribute('data-hover-synopsis-wrap') || '';"
        },
        "after": {
          "line": 1561,
          "text": "const shouldRewrap = prevWrapMode !== wrapMode;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1564,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.resetAdvancedYamlWrap(synopsis);",
      "context": {
        "before": {
          "line": 1563,
          "text": "if (shouldRewrap) {"
        },
        "current": {
          "line": 1564,
          "text": "this.resetAdvancedYamlWrap(synopsis);"
        },
        "after": {
          "line": 1565,
          "text": "this.resetPendingEditsWrap(synopsis);"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1565,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.resetPendingEditsWrap(synopsis);",
      "context": {
        "before": {
          "line": 1564,
          "text": "this.resetAdvancedYamlWrap(synopsis);"
        },
        "current": {
          "line": 1565,
          "text": "this.resetPendingEditsWrap(synopsis);"
        },
        "after": {
          "line": 1566,
          "text": "this.resetMainSynopsisWrap(synopsis);"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1566,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.resetMainSynopsisWrap(synopsis);",
      "context": {
        "before": {
          "line": 1565,
          "text": "this.resetPendingEditsWrap(synopsis);"
        },
        "current": {
          "line": 1566,
          "text": "this.resetMainSynopsisWrap(synopsis);"
        },
        "after": {
          "line": 1567,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1592,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "let textElements = Array.from(synopsis.querySelectorAll('text')) as SVGTextElement[];",
      "context": {
        "before": {
          "line": 1591,
          "text": ""
        },
        "current": {
          "line": 1592,
          "text": "let textElements = Array.from(synopsis.querySelectorAll('text')) as SVGTextElement[];"
        },
        "after": {
          "line": 1593,
          "text": "if (textElements.length === 0) return;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1597,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Get the synopsis text group",
      "context": {
        "before": {
          "line": 1596,
          "text": ""
        },
        "current": {
          "line": 1597,
          "text": "// Get the synopsis text group"
        },
        "after": {
          "line": 1598,
          "text": "const synopsisTextGroup = synopsis.querySelector('.rt-synopsis-text');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1598,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisTextGroup = synopsis.querySelector('.rt-synopsis-text');",
      "context": {
        "before": {
          "line": 1597,
          "text": "// Get the synopsis text group"
        },
        "current": {
          "line": 1598,
          "text": "const synopsisTextGroup = synopsis.querySelector('.rt-synopsis-text');"
        },
        "after": {
          "line": 1599,
          "text": "if (!synopsisTextGroup) {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1599,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!synopsisTextGroup) {",
      "context": {
        "before": {
          "line": 1598,
          "text": "const synopsisTextGroup = synopsis.querySelector('.rt-synopsis-text');"
        },
        "current": {
          "line": 1599,
          "text": "if (!synopsisTextGroup) {"
        },
        "after": {
          "line": 1600,
          "text": "return;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1604,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "(synopsisTextGroup as SVGElement).removeAttribute('transform');",
      "context": {
        "before": {
          "line": 1603,
          "text": "// Reset any previous transforms"
        },
        "current": {
          "line": 1604,
          "text": "(synopsisTextGroup as SVGElement).removeAttribute('transform');"
        },
        "after": {
          "line": 1605,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1609,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisLineHeight = 22 * fontScale; // Reduced spacing for synopsis text",
      "context": {
        "before": {
          "line": 1608,
          "text": "const titleLineHeight = 32 * fontScale; // Increased spacing for title/date line"
        },
        "current": {
          "line": 1609,
          "text": "const synopsisLineHeight = 22 * fontScale; // Reduced spacing for synopsis text"
        },
        "after": {
          "line": 1610,
          "text": "const scorePreGap = 46 * fontScale; // Manual gap before the Gossamer score line; adjust as needed"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1618,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Calculate starting y-position from synopsis position",
      "context": {
        "before": {
          "line": 1617,
          "text": ""
        },
        "current": {
          "line": 1618,
          "text": "// Calculate starting y-position from synopsis position"
        },
        "after": {
          "line": 1619,
          "text": "const synopsisTransform = (synopsis as SVGElement).getAttribute('transform') || '';"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1619,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisTransform = (synopsis as SVGElement).getAttribute('transform') || '';",
      "context": {
        "before": {
          "line": 1618,
          "text": "// Calculate starting y-position from synopsis position"
        },
        "current": {
          "line": 1619,
          "text": "const synopsisTransform = (synopsis as SVGElement).getAttribute('transform') || '';"
        },
        "after": {
          "line": 1620,
          "text": "const translateMatch = synopsisTransform.match(/translate\\(([^,]+),\\s*([^)]+)\\)/);"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1620,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const translateMatch = synopsisTransform.match(/translate\\(([^,]+),\\s*([^)]+)\\)/);",
      "context": {
        "before": {
          "line": 1619,
          "text": "const synopsisTransform = (synopsis as SVGElement).getAttribute('transform') || '';"
        },
        "current": {
          "line": 1620,
          "text": "const translateMatch = synopsisTransform.match(/translate\\(([^,]+),\\s*([^)]+)\\)/);"
        },
        "after": {
          "line": 1621,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1633,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const mainWrapped = this.applyMainSynopsisWrap({",
      "context": {
        "before": {
          "line": 1632,
          "text": "if (shouldRewrap) {"
        },
        "current": {
          "line": 1633,
          "text": "const mainWrapped = this.applyMainSynopsisWrap({"
        },
        "after": {
          "line": 1634,
          "text": "textRows,"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1644,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "textElements = Array.from(synopsis.querySelectorAll('text')) as SVGTextElement[];",
      "context": {
        "before": {
          "line": 1643,
          "text": "if (mainWrapped) {"
        },
        "current": {
          "line": 1644,
          "text": "textElements = Array.from(synopsis.querySelectorAll('text')) as SVGTextElement[];"
        },
        "after": {
          "line": 1645,
          "text": "if (textElements.length === 0) return;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1662,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "textElements = Array.from(synopsis.querySelectorAll('text')) as SVGTextElement[];",
      "context": {
        "before": {
          "line": 1661,
          "text": "if (pendingWrapped) {"
        },
        "current": {
          "line": 1662,
          "text": "textElements = Array.from(synopsis.querySelectorAll('text')) as SVGTextElement[];"
        },
        "after": {
          "line": 1663,
          "text": "if (textElements.length === 0) return;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1680,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "textElements = Array.from(synopsis.querySelectorAll('text')) as SVGTextElement[];",
      "context": {
        "before": {
          "line": 1679,
          "text": "if (advancedWrapped) {"
        },
        "current": {
          "line": 1680,
          "text": "textElements = Array.from(synopsis.querySelectorAll('text')) as SVGTextElement[];"
        },
        "after": {
          "line": 1681,
          "text": "if (textElements.length === 0) return;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1689,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "(synopsis as SVGElement).setAttribute('data-hover-synopsis-wrap', wrapMode);",
      "context": {
        "before": {
          "line": 1688,
          "text": "if (shouldRewrap) {"
        },
        "current": {
          "line": 1689,
          "text": "(synopsis as SVGElement).setAttribute('data-hover-synopsis-wrap', wrapMode);"
        },
        "after": {
          "line": 1690,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1693,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis,",
      "context": {
        "before": {
          "line": 1692,
          "text": "const budgetChanged = this.enforceLineBudget({"
        },
        "current": {
          "line": 1693,
          "text": "synopsis,"
        },
        "after": {
          "line": 1694,
          "text": "radius,"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1701,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "textElements = Array.from(synopsis.querySelectorAll('text')) as SVGTextElement[];",
      "context": {
        "before": {
          "line": 1700,
          "text": "if (budgetChanged) {"
        },
        "current": {
          "line": 1701,
          "text": "textElements = Array.from(synopsis.querySelectorAll('text')) as SVGTextElement[];"
        },
        "after": {
          "line": 1702,
          "text": "if (textElements.length === 0) return;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1715,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "let currentRowLineHeight = rowIndex === 0 ? titleLineHeight : synopsisLineHeight;",
      "context": {
        "before": {
          "line": 1714,
          "text": "// Row 0 (title) uses titleLineHeight; others determined by content type"
        },
        "current": {
          "line": 1715,
          "text": "let currentRowLineHeight = rowIndex === 0 ? titleLineHeight : synopsisLineHeight;"
        },
        "after": {
          "line": 1716,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1723,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isPrevLineSynopsis = prevEl.classList.contains('rt-title-text-secondary');",
      "context": {
        "before": {
          "line": 1722,
          "text": "const prevEl = textRows[rowIndex - 1][0];"
        },
        "current": {
          "line": 1723,
          "text": "const isPrevLineSynopsis = prevEl.classList.contains('rt-title-text-secondary');"
        },
        "after": {
          "line": 1724,
          "text": "const isPrevLineBeats = prevEl.classList.contains('pulse-text');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1730,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "} else if (isGossamerLine && isPrevLineSynopsis) {",
      "context": {
        "before": {
          "line": 1729,
          "text": "currentRowLineHeight = titleLineHeight;"
        },
        "current": {
          "line": 1730,
          "text": "} else if (isGossamerLine && isPrevLineSynopsis) {"
        },
        "after": {
          "line": 1731,
          "text": "// Fixed manual gap before the Gossamer score line"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1739,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Default spacing between regular synopsis/metadata lines",
      "context": {
        "before": {
          "line": 1738,
          "text": "} else {"
        },
        "current": {
          "line": 1739,
          "text": "// Default spacing between regular synopsis/metadata lines"
        },
        "after": {
          "line": 1740,
          "text": "yOffset += synopsisLineHeight;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1740,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "yOffset += synopsisLineHeight;",
      "context": {
        "before": {
          "line": 1739,
          "text": "// Default spacing between regular synopsis/metadata lines"
        },
        "current": {
          "line": 1740,
          "text": "yOffset += synopsisLineHeight;"
        },
        "after": {
          "line": 1741,
          "text": "currentRowLineHeight = synopsisLineHeight;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1741,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "currentRowLineHeight = synopsisLineHeight;",
      "context": {
        "before": {
          "line": 1740,
          "text": "yOffset += synopsisLineHeight;"
        },
        "current": {
          "line": 1741,
          "text": "currentRowLineHeight = synopsisLineHeight;"
        },
        "after": {
          "line": 1742,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1762,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Title and first synopsis line need more inset; later rows need less",
      "context": {
        "before": {
          "line": 1761,
          "text": "// Bottom half needs no adjustment - the baseline alignment works correctly there"
        },
        "current": {
          "line": 1762,
          "text": "// Title and first synopsis line need more inset; later rows need less"
        },
        "after": {
          "line": 1763,
          "text": "let inset = 0;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1767,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Rows 0-1 (title, first synopsis) need more inset; others use base ratio",
      "context": {
        "before": {
          "line": 1766,
          "text": "const fontSize = parseFloat(style.fontSize) || 16;"
        },
        "current": {
          "line": 1767,
          "text": "// Rows 0-1 (title, first synopsis) need more inset; others use base ratio"
        },
        "after": {
          "line": 1768,
          "text": "const ratio = rowIndex <= 1 ? 0.5 : SynopsisManager.TEXT_HEIGHT_INSET_RATIO;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1768,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const ratio = rowIndex <= 1 ? 0.5 : SynopsisManager.TEXT_HEIGHT_INSET_RATIO;",
      "context": {
        "before": {
          "line": 1767,
          "text": "// Rows 0-1 (title, first synopsis) need more inset; others use base ratio"
        },
        "current": {
          "line": 1768,
          "text": "const ratio = rowIndex <= 1 ? 0.5 : SynopsisManager.TEXT_HEIGHT_INSET_RATIO;"
        },
        "after": {
          "line": 1769,
          "text": "inset = fontSize * ratio;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1798,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.updateHoverMetadataIcons(synopsis);",
      "context": {
        "before": {
          "line": 1797,
          "text": "// After positioning text, reposition advanced YAML icons to match the row start"
        },
        "current": {
          "line": 1798,
          "text": "this.updateHoverMetadataIcons(synopsis);"
        },
        "after": {
          "line": 1799,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1842,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const metadataRightEdge = anchorX - SYNOPSIS_INSET;",
      "context": {
        "before": {
          "line": 1841,
          "text": "if (isRightAligned) {"
        },
        "current": {
          "line": 1842,
          "text": "const metadataRightEdge = anchorX - SYNOPSIS_INSET;"
        },
        "after": {
          "line": 1843,
          "text": "const metadataLeftEdge = hasMetadata ? metadataRightEdge - metadataWidth : metadataRightEdge;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1865,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "prev.setAttribute('y', String(yPosition - SynopsisManager.PLANETARY_RECT_Y_OFFSET));",
      "context": {
        "before": {
          "line": 1864,
          "text": "prev.setAttribute('x', String(targetX - currentWidth));"
        },
        "current": {
          "line": 1865,
          "text": "prev.setAttribute('y', String(yPosition - SynopsisManager.PLANETARY_RECT_Y_OFFSET));"
        },
        "after": {
          "line": 1866,
          "text": "textEl.setAttribute('dx', '-6');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1875,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const rowLeftEdge = anchorX + SYNOPSIS_INSET;",
      "context": {
        "before": {
          "line": 1874,
          "text": "} else {"
        },
        "current": {
          "line": 1875,
          "text": "const rowLeftEdge = anchorX + SYNOPSIS_INSET;"
        },
        "after": {
          "line": 1876,
          "text": "const metadataLeftEdge = hasMetadata ? rowLeftEdge + primaryWidth + gap : rowLeftEdge;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1895,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "prev.setAttribute('y', String(yPosition - SynopsisManager.PLANETARY_RECT_Y_OFFSET));",
      "context": {
        "before": {
          "line": 1894,
          "text": "prev.setAttribute('x', String(x));"
        },
        "current": {
          "line": 1895,
          "text": "prev.setAttribute('y', String(yPosition - SynopsisManager.PLANETARY_RECT_Y_OFFSET));"
        },
        "after": {
          "line": 1896,
          "text": "textEl.setAttribute('dx', '6');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1917,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private updateHoverMetadataIcons(synopsis: Element): void {",
      "context": {
        "before": {
          "line": 1916,
          "text": ""
        },
        "current": {
          "line": 1917,
          "text": "private updateHoverMetadataIcons(synopsis: Element): void {"
        },
        "after": {
          "line": 1918,
          "text": "const lines = Array.from(synopsis.querySelectorAll('.rt-hover-metadata-line')) as SVGGElement[];"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1918,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const lines = Array.from(synopsis.querySelectorAll('.rt-hover-metadata-line')) as SVGGElement[];",
      "context": {
        "before": {
          "line": 1917,
          "text": "private updateHoverMetadataIcons(synopsis: Element): void {"
        },
        "current": {
          "line": 1918,
          "text": "const lines = Array.from(synopsis.querySelectorAll('.rt-hover-metadata-line')) as SVGGElement[];"
        },
        "after": {
          "line": 1919,
          "text": "if (lines.length === 0) return;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1967,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis: Element;",
      "context": {
        "before": {
          "line": 1966,
          "text": "private enforceLineBudget(params: {"
        },
        "current": {
          "line": 1967,
          "text": "synopsis: Element;"
        },
        "after": {
          "line": 1968,
          "text": "radius: number;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1973,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const { synopsis, radius, baseY, fontScale, pulseLineHeight } = params;",
      "context": {
        "before": {
          "line": 1972,
          "text": "}): boolean {"
        },
        "current": {
          "line": 1973,
          "text": "const { synopsis, radius, baseY, fontScale, pulseLineHeight } = params;"
        },
        "after": {
          "line": 1974,
          "text": "const titleLineHeight = 32 * fontScale;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1975,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisLineHeight = 22 * fontScale;",
      "context": {
        "before": {
          "line": 1974,
          "text": "const titleLineHeight = 32 * fontScale;"
        },
        "current": {
          "line": 1975,
          "text": "const synopsisLineHeight = 22 * fontScale;"
        },
        "after": {
          "line": 1976,
          "text": "const scorePreGap = 46 * fontScale;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1979,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const elements = Array.from(synopsis.querySelectorAll('text')) as SVGTextElement[];",
      "context": {
        "before": {
          "line": 1978,
          "text": "const buildRows = (): SVGTextElement[][] => {"
        },
        "current": {
          "line": 1979,
          "text": "const elements = Array.from(synopsis.querySelectorAll('text')) as SVGTextElement[];"
        },
        "after": {
          "line": 1980,
          "text": "const rows: SVGTextElement[][] = [];"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1991,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const getCategory = (textEl: SVGTextElement): { category: 'synopsis' | 'pending' | 'advanced' | 'other'; key?: string } => {",
      "context": {
        "before": {
          "line": 1990,
          "text": ""
        },
        "current": {
          "line": 1991,
          "text": "const getCategory = (textEl: SVGTextElement): { category: 'synopsis' | 'pending' | 'advanced' | 'other'; key?: string } => {"
        },
        "after": {
          "line": 1992,
          "text": "if (textEl.getAttribute('data-synopsis-line') === 'true' || textEl.getAttribute('data-synopsis-wrap') === 'true') {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1992,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (textEl.getAttribute('data-synopsis-line') === 'true' || textEl.getAttribute('data-synopsis-wrap') === 'true') {",
      "context": {
        "before": {
          "line": 1991,
          "text": "const getCategory = (textEl: SVGTextElement): { category: 'synopsis' | 'pending' | 'advanced' | 'other'; key?: string } => {"
        },
        "current": {
          "line": 1992,
          "text": "if (textEl.getAttribute('data-synopsis-line') === 'true' || textEl.getAttribute('data-synopsis-wrap') === 'true') {"
        },
        "after": {
          "line": 1993,
          "text": "return { category: 'synopsis' };"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 1993,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return { category: 'synopsis' };",
      "context": {
        "before": {
          "line": 1992,
          "text": "if (textEl.getAttribute('data-synopsis-line') === 'true' || textEl.getAttribute('data-synopsis-wrap') === 'true') {"
        },
        "current": {
          "line": 1993,
          "text": "return { category: 'synopsis' };"
        },
        "after": {
          "line": 1994,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2015,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isPrevLineSynopsis = prevEl.classList.contains('rt-title-text-secondary');",
      "context": {
        "before": {
          "line": 2014,
          "text": "const prevEl = rows[rowIndex - 1][0];"
        },
        "current": {
          "line": 2015,
          "text": "const isPrevLineSynopsis = prevEl.classList.contains('rt-title-text-secondary');"
        },
        "after": {
          "line": 2016,
          "text": "const isPrevLineBeats = prevEl.classList.contains('pulse-text');"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2020,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "} else if (isGossamerLine && isPrevLineSynopsis) {",
      "context": {
        "before": {
          "line": 2019,
          "text": "yOffset += titleLineHeight;"
        },
        "current": {
          "line": 2020,
          "text": "} else if (isGossamerLine && isPrevLineSynopsis) {"
        },
        "after": {
          "line": 2021,
          "text": "yOffset += scorePreGap;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2025,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "yOffset += synopsisLineHeight;",
      "context": {
        "before": {
          "line": 2024,
          "text": "} else {"
        },
        "current": {
          "line": 2025,
          "text": "yOffset += synopsisLineHeight;"
        },
        "after": {
          "line": 2026,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2037,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const removeOne = (): { category: 'synopsis' | 'pending' | 'advanced'; key?: string } | null => {",
      "context": {
        "before": {
          "line": 2036,
          "text": ""
        },
        "current": {
          "line": 2037,
          "text": "const removeOne = (): { category: 'synopsis' | 'pending' | 'advanced'; key?: string } | null => {"
        },
        "after": {
          "line": 2038,
          "text": "const rows = buildRows();"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2041,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisMin = Math.max(3, getSynopsisHoverLineLimit(this.plugin.settings as any));",
      "context": {
        "before": {
          "line": 2040,
          "text": ""
        },
        "current": {
          "line": 2041,
          "text": "const synopsisMin = Math.max(3, getSynopsisHoverLineLimit(this.plugin.settings as any));"
        },
        "after": {
          "line": 2042,
          "text": "const pendingMin = 3;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2044,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "let synopsisCount = 0;",
      "context": {
        "before": {
          "line": 2043,
          "text": ""
        },
        "current": {
          "line": 2044,
          "text": "let synopsisCount = 0;"
        },
        "after": {
          "line": 2045,
          "text": "let pendingCount = 0;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2052,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (info.category === 'synopsis') synopsisCount += 1;",
      "context": {
        "before": {
          "line": 2051,
          "text": "const info = getCategory(primary);"
        },
        "current": {
          "line": 2052,
          "text": "if (info.category === 'synopsis') synopsisCount += 1;"
        },
        "after": {
          "line": 2053,
          "text": "if (info.category === 'pending') pendingCount += 1;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2089,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (info.category === 'synopsis' && synopsisCount > synopsisMin) {",
      "context": {
        "before": {
          "line": 2088,
          "text": "const info = getCategory(primary);"
        },
        "current": {
          "line": 2089,
          "text": "if (info.category === 'synopsis' && synopsisCount > synopsisMin) {"
        },
        "after": {
          "line": 2090,
          "text": "primary.remove();"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2091,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return { category: 'synopsis' };",
      "context": {
        "before": {
          "line": 2090,
          "text": "primary.remove();"
        },
        "current": {
          "line": 2091,
          "text": "return { category: 'synopsis' };"
        },
        "after": {
          "line": 2092,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2099,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "let truncatedSynopsis = false;",
      "context": {
        "before": {
          "line": 2098,
          "text": "let changed = false;"
        },
        "current": {
          "line": 2099,
          "text": "let truncatedSynopsis = false;"
        },
        "after": {
          "line": 2100,
          "text": "let truncatedPending = false;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2109,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (removed.category === 'synopsis') truncatedSynopsis = true;",
      "context": {
        "before": {
          "line": 2108,
          "text": "if (!removed) break;"
        },
        "current": {
          "line": 2109,
          "text": "if (removed.category === 'synopsis') truncatedSynopsis = true;"
        },
        "after": {
          "line": 2110,
          "text": "if (removed.category === 'pending') truncatedPending = true;"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2124,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (truncatedSynopsis) {",
      "context": {
        "before": {
          "line": 2123,
          "text": ""
        },
        "current": {
          "line": 2124,
          "text": "if (truncatedSynopsis) {"
        },
        "after": {
          "line": 2125,
          "text": "const lines = Array.from(synopsis.querySelectorAll('[data-synopsis-line=\"true\"]')) as SVGTextElement[];"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2125,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const lines = Array.from(synopsis.querySelectorAll('[data-synopsis-line=\"true\"]')) as SVGTextElement[];",
      "context": {
        "before": {
          "line": 2124,
          "text": "if (truncatedSynopsis) {"
        },
        "current": {
          "line": 2125,
          "text": "const lines = Array.from(synopsis.querySelectorAll('[data-synopsis-line=\"true\"]')) as SVGTextElement[];"
        },
        "after": {
          "line": 2126,
          "text": "appendEllipsis(lines[lines.length - 1] ?? null);"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2130,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const lines = Array.from(synopsis.querySelectorAll('[data-pending-line=\"true\"]')) as SVGTextElement[];",
      "context": {
        "before": {
          "line": 2129,
          "text": "if (truncatedPending) {"
        },
        "current": {
          "line": 2130,
          "text": "const lines = Array.from(synopsis.querySelectorAll('[data-pending-line=\"true\"]')) as SVGTextElement[];"
        },
        "after": {
          "line": 2131,
          "text": "appendEllipsis(lines[lines.length - 1] ?? null);"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2135,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const groups = Array.from(synopsis.querySelectorAll('.rt-hover-metadata-line')) as SVGGElement[];",
      "context": {
        "before": {
          "line": 2134,
          "text": "if (truncatedAdvanced.size > 0) {"
        },
        "current": {
          "line": 2135,
          "text": "const groups = Array.from(synopsis.querySelectorAll('.rt-hover-metadata-line')) as SVGGElement[];"
        },
        "after": {
          "line": 2136,
          "text": "truncatedAdvanced.forEach(key => {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2159,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "throw new Error('Unable to measure text width for synopsis element.');",
      "context": {
        "before": {
          "line": 2158,
          "text": ""
        },
        "current": {
          "line": 2159,
          "text": "throw new Error('Unable to measure text width for synopsis element.');"
        },
        "after": {
          "line": 2160,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2190,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "throw new Error('Unable to create container for synopsis content.');",
      "context": {
        "before": {
          "line": 2189,
          "text": "if (!container) {"
        },
        "current": {
          "line": 2190,
          "text": "throw new Error('Unable to create container for synopsis content.');"
        },
        "after": {
          "line": 2191,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2195,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "throw new Error('Synopsis content produced no nodes to render.');",
      "context": {
        "before": {
          "line": 2194,
          "text": "if (nodes.length === 0) {"
        },
        "current": {
          "line": 2195,
          "text": "throw new Error('Synopsis content produced no nodes to render.');"
        },
        "after": {
          "line": 2196,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2217,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "throw new Error(`Unsupported element <${element.tagName}> in synopsis content.`);",
      "context": {
        "before": {
          "line": 2216,
          "text": "if (tag !== 'tspan' && tag !== 'span') {"
        },
        "current": {
          "line": 2217,
          "text": "throw new Error(`Unsupported element <${element.tagName}> in synopsis content.`);"
        },
        "after": {
          "line": 2218,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2229,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "throw new Error('Unsupported node type found in synopsis content.');",
      "context": {
        "before": {
          "line": 2228,
          "text": ""
        },
        "current": {
          "line": 2229,
          "text": "throw new Error('Unsupported node type found in synopsis content.');"
        },
        "after": {
          "line": 2230,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2233,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "throw new Error('Synopsis conversion produced no SVG tspans.');",
      "context": {
        "before": {
          "line": 2232,
          "text": "if (!parentElement.hasChildNodes()) {"
        },
        "current": {
          "line": 2233,
          "text": "throw new Error('Synopsis conversion produced no SVG tspans.');"
        },
        "after": {
          "line": 2234,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2362,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "// IMPORTANT: If the beat already includes a title/comment separator (\" / \"),",
      "context": {
        "before": {
          "line": 2361,
          "text": "// 2. Determine the correct splitter character and method."
        },
        "current": {
          "line": 2362,
          "text": "// IMPORTANT: If the beat already includes a title/comment separator (\" / \"),"
        },
        "after": {
          "line": 2363,
          "text": "// do NOT split further on commas or periods  commas belong to the comment."
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2418,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Process lines and render synopsis content",
      "context": {
        "before": {
          "line": 2417,
          "text": ""
        },
        "current": {
          "line": 2418,
          "text": "// Process lines and render synopsis content"
        },
        "after": {
          "line": 2419,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2475,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// NOTE: Title sign is implicitly removed because titleText comes from group 1 (before the sign)",
      "context": {
        "before": {
          "line": 2474,
          "text": "useSlashSeparator = true; // We found the pattern, so use the slash"
        },
        "current": {
          "line": 2475,
          "text": "// NOTE: Title sign is implicitly removed because titleText comes from group 1 (before the sign)"
        },
        "after": {
          "line": 2476,
          "text": "} else {"
        }
      }
    },
    {
      "filePath": "src/SynopsisManager.ts",
      "line": 2563,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "spacer.setAttribute(\"class\", \"synopsis-spacer\");",
      "context": {
        "before": {
          "line": 2562,
          "text": "const spacer = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");"
        },
        "current": {
          "line": 2563,
          "text": "spacer.setAttribute(\"class\", \"synopsis-spacer\");"
        },
        "after": {
          "line": 2564,
          "text": "spacer.setAttribute(\"x\", \"0\");"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 14,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import SynopsisManager from './SynopsisManager';",
      "context": {
        "before": {
          "line": 13,
          "text": "import { STATUS_COLORS, SceneNumberInfo } from './utils/constants';"
        },
        "current": {
          "line": 14,
          "text": "import SynopsisManager from './SynopsisManager';"
        },
        "after": {
          "line": 15,
          "text": "import { RadialTimelineView } from './view/TimeLineView';"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 139,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Add a synopsisManager instance",
      "context": {
        "before": {
          "line": 138,
          "text": ""
        },
        "current": {
          "line": 139,
          "text": "// Add a synopsisManager instance"
        },
        "after": {
          "line": 140,
          "text": "public synopsisManager: SynopsisManager;"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 140,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "public synopsisManager: SynopsisManager;",
      "context": {
        "before": {
          "line": 139,
          "text": "// Add a synopsisManager instance"
        },
        "current": {
          "line": 140,
          "text": "public synopsisManager: SynopsisManager;"
        },
        "after": {
          "line": 141,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 204,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "this.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 203,
          "text": "await this.saveSettings();"
        },
        "current": {
          "line": 204,
          "text": "this.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 205,
          "text": "this.updateTimelineBookHeaders();"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 211,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "this.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 210,
          "text": "await this.saveSettings();"
        },
        "current": {
          "line": 211,
          "text": "this.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 212,
          "text": "this.updateTimelineBookHeaders();"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 271,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.synopsisManager = new SynopsisManager(this);",
      "context": {
        "before": {
          "line": 270,
          "text": "this.rendererService = new RendererService(this);"
        },
        "current": {
          "line": 271,
          "text": "this.synopsisManager = new SynopsisManager(this);"
        },
        "after": {
          "line": 272,
          "text": "this.commandRegistrar = new CommandRegistrar(this, this.app);"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 338,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "this.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 337,
          "text": "// Refresh timeline to show update indicator"
        },
        "current": {
          "line": 338,
          "text": "this.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 339,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 395,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Populated during getSceneData()  returns null if no BookMeta note exists.",
      "context": {
        "before": {
          "line": 394,
          "text": "* Get the BookMeta for the active manuscript."
        },
        "current": {
          "line": 395,
          "text": "* Populated during getSceneData()  returns null if no BookMeta note exists."
        },
        "after": {
          "line": 396,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 710,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const knownBaseKeys = ['Class', 'When', 'End', 'Context', 'Synopsis'];",
      "context": {
        "before": {
          "line": 709,
          "text": "if (!this.settings.backdropYamlTemplates) {"
        },
        "current": {
          "line": 710,
          "text": "const knownBaseKeys = ['Class', 'When', 'End', 'Context', 'Synopsis'];"
        },
        "after": {
          "line": 711,
          "text": "const legacyBackdropTemplate = this.settings.backdropYamlTemplate ?? '';"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 744,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.settings.backdropYamlTemplates?.base?.includes('Synopsis:')) {",
      "context": {
        "before": {
          "line": 743,
          "text": "}"
        },
        "current": {
          "line": 744,
          "text": "if (this.settings.backdropYamlTemplates?.base?.includes('Synopsis:')) {"
        },
        "after": {
          "line": 745,
          "text": "this.settings.backdropYamlTemplates.base = this.settings.backdropYamlTemplates.base.replace(/^Synopsis:/gm, 'Context:');"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 745,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.settings.backdropYamlTemplates.base = this.settings.backdropYamlTemplates.base.replace(/^Synopsis:/gm, 'Context:');",
      "context": {
        "before": {
          "line": 744,
          "text": "if (this.settings.backdropYamlTemplates?.base?.includes('Synopsis:')) {"
        },
        "current": {
          "line": 745,
          "text": "this.settings.backdropYamlTemplates.base = this.settings.backdropYamlTemplates.base.replace(/^Synopsis:/gm, 'Context:');"
        },
        "after": {
          "line": 746,
          "text": "backdropTemplateMigrated = true;"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 749,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "event: 'backdrop_base_template_synopsis_to_context',",
      "context": {
        "before": {
          "line": 748,
          "text": "console.debug('[SchemaMigration]', {"
        },
        "current": {
          "line": 749,
          "text": "event: 'backdrop_base_template_synopsis_to_context',"
        },
        "after": {
          "line": 750,
          "text": "action: 'updated backdrop base template to write Context',"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 850,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "// Settings UI calls this instead of refreshTimelineIfNeeded(null) so",
      "context": {
        "before": {
          "line": 849,
          "text": "//  Settings-aware refresh (tiered impact model) "
        },
        "current": {
          "line": 850,
          "text": "// Settings UI calls this instead of refreshTimelineIfNeeded(null) so"
        },
        "after": {
          "line": 851,
          "text": "// that only settings with a real visual effect trigger a render."
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 868,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "this.refreshTimelineIfNeeded(null, 100);",
      "context": {
        "before": {
          "line": 867,
          "text": "// impact.kind === 'full'  debounce 100 ms to avoid flicker cascades"
        },
        "current": {
          "line": 868,
          "text": "this.refreshTimelineIfNeeded(null, 100);"
        },
        "after": {
          "line": 869,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 872,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "refreshTimelineIfNeeded(file: TAbstractFile | null | undefined, delayMs?: number) {",
      "context": {
        "before": {
          "line": 871,
          "text": "// Method to refresh the timeline if the active view exists (with debouncing)"
        },
        "current": {
          "line": 872,
          "text": "refreshTimelineIfNeeded(file: TAbstractFile | null | undefined, delayMs?: number) {"
        },
        "after": {
          "line": 873,
          "text": "// For settings changes (file=null), use 0ms delay for immediate feedback"
        }
      }
    },
    {
      "filePath": "src/main.ts",
      "line": 876,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "this.timelineService.refreshTimelineIfNeeded(file, effectiveDelay);",
      "context": {
        "before": {
          "line": 875,
          "text": "const effectiveDelay = file === null && delayMs === undefined ? 0 : (delayMs ?? 400);"
        },
        "current": {
          "line": 876,
          "text": "this.timelineService.refreshTimelineIfNeeded(file, effectiveDelay);"
        },
        "after": {
          "line": 877,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/TimeLineView.ts",
      "line": 445,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Handle synopsis text changes",
      "context": {
        "before": {
          "line": 444,
          "text": ""
        },
        "current": {
          "line": 445,
          "text": "// Handle synopsis text changes"
        },
        "after": {
          "line": 446,
          "text": "if (changeResult.changeTypes.has(ChangeType.SYNOPSIS)) {"
        }
      }
    },
    {
      "filePath": "src/view/TimeLineView.ts",
      "line": 446,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (changeResult.changeTypes.has(ChangeType.SYNOPSIS)) {",
      "context": {
        "before": {
          "line": 445,
          "text": "// Handle synopsis text changes"
        },
        "current": {
          "line": 446,
          "text": "if (changeResult.changeTypes.has(ChangeType.SYNOPSIS)) {"
        },
        "after": {
          "line": 447,
          "text": "this.rendererService.updateSynopsisDOM(container, this.plugin);"
        }
      }
    },
    {
      "filePath": "src/view/TimeLineView.ts",
      "line": 447,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.rendererService.updateSynopsisDOM(container, this.plugin);",
      "context": {
        "before": {
          "line": 446,
          "text": "if (changeResult.changeTypes.has(ChangeType.SYNOPSIS)) {"
        },
        "current": {
          "line": 447,
          "text": "this.rendererService.updateSynopsisDOM(container, this.plugin);"
        },
        "after": {
          "line": 448,
          "text": "updated = true;"
        }
      }
    },
    {
      "filePath": "src/view/TimeLineView.ts",
      "line": 530,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: Workspace events (file-open, layout-change, active-leaf-change, quick-preview)",
      "context": {
        "before": {
          "line": 529,
          "text": ""
        },
        "current": {
          "line": 530,
          "text": "// Note: Workspace events (file-open, layout-change, active-leaf-change, quick-preview)"
        },
        "after": {
          "line": 531,
          "text": "// are handled by FileTrackingService at the plugin level to avoid duplicate handlers."
        }
      }
    },
    {
      "filePath": "src/view/TimeLineView.ts",
      "line": 551,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Beat note frontmatter can affect timeline hover in multiple modes.",
      "context": {
        "before": {
          "line": 550,
          "text": ""
        },
        "current": {
          "line": 551,
          "text": "// Beat note frontmatter can affect timeline hover in multiple modes."
        },
        "after": {
          "line": 552,
          "text": "// Always refresh on Scene or Beat/Plot frontmatter change so note values"
        }
      }
    },
    {
      "filePath": "src/view/TimeLineView.ts",
      "line": 552,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Always refresh on Scene or Beat/Plot frontmatter change so note values",
      "context": {
        "before": {
          "line": 551,
          "text": "// Beat note frontmatter can affect timeline hover in multiple modes."
        },
        "current": {
          "line": 552,
          "text": "// Always refresh on Scene or Beat/Plot frontmatter change so note values"
        },
        "after": {
          "line": 553,
          "text": "// remain the source of truth over settings defaults."
        }
      }
    },
    {
      "filePath": "src/view/TimeLineView.ts",
      "line": 610,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: ModeToggleController keyboard listeners are cleaned up automatically via view.register()",
      "context": {
        "before": {
          "line": 609,
          "text": "}"
        },
        "current": {
          "line": 610,
          "text": "// Note: ModeToggleController keyboard listeners are cleaned up automatically via view.register()"
        },
        "after": {
          "line": 611,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/TimeLineView.ts",
      "line": 623,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// The user wants to see the Welcome Screen until they have at least one Scene note.",
      "context": {
        "before": {
          "line": 622,
          "text": "// Check if there are any actual scenes (not just backdrops or beats)"
        },
        "current": {
          "line": 623,
          "text": "// The user wants to see the Welcome Screen until they have at least one Scene note."
        },
        "after": {
          "line": 624,
          "text": "const hasScenes = scenes && scenes.some(item => item.itemType === 'Scene');"
        }
      }
    },
    {
      "filePath": "src/view/TimeLineView.ts",
      "line": 836,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "allSynopses.forEach(synopsis => {",
      "context": {
        "before": {
          "line": 835,
          "text": "// All synopses default to the CSS-defined hidden state (opacity 0, pointer-events none)"
        },
        "current": {
          "line": 836,
          "text": "allSynopses.forEach(synopsis => {"
        },
        "after": {
          "line": 837,
          "text": "synopsis.classList.remove('rt-visible');"
        }
      }
    },
    {
      "filePath": "src/view/TimeLineView.ts",
      "line": 837,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis.classList.remove('rt-visible');",
      "context": {
        "before": {
          "line": 836,
          "text": "allSynopses.forEach(synopsis => {"
        },
        "current": {
          "line": 837,
          "text": "synopsis.classList.remove('rt-visible');"
        },
        "after": {
          "line": 838,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/view/WelcomeScreen.ts",
      "line": 28,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "note: '(Set the active book folder in Settings \\u2192 Core \\u2192 General \\u2192 Books.)'",
      "context": {
        "before": {
          "line": 27,
          "text": "body: 'Choose where your scenes live in your vault',"
        },
        "current": {
          "line": 28,
          "text": "note: '(Set the active book folder in Settings \\u2192 Core \\u2192 General \\u2192 Books.)'"
        },
        "after": {
          "line": 29,
          "text": "},"
        }
      }
    },
    {
      "filePath": "src/view/WelcomeScreen.ts",
      "line": 32,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "body: 'Open the scene and start writing. You can leave scene details blank until you need them. As you write and the story unfolds, add characters, subplots, and other details to the note frontmatter so you can see it in the timeline.'",
      "context": {
        "before": {
          "line": 31,
          "text": "title: '2. Write prose immediately',"
        },
        "current": {
          "line": 32,
          "text": "body: 'Open the scene and start writing. You can leave scene details blank until you need them. As you write and the story unfolds, add characters, subplots, and other details to the note frontmatter so you can see it in the timeline.'"
        },
        "after": {
          "line": 33,
          "text": "},"
        }
      }
    },
    {
      "filePath": "src/view/WelcomeScreen.ts",
      "line": 96,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "commandManager?.executeCommandById?.('radial-timeline:create-basic-scene-note');",
      "context": {
        "before": {
          "line": 95,
          "text": "const commandManager = (plugin.app as unknown as { commands?: { executeCommandById?: (id: string) => void } }).commands;"
        },
        "current": {
          "line": 96,
          "text": "commandManager?.executeCommandById?.('radial-timeline:create-basic-scene-note');"
        },
        "after": {
          "line": 97,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/view/WelcomeScreen.ts",
      "line": 128,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "step1.createEl('p', { cls: 'rt-welcome-paragraph rt-welcome-footnote', text: WELCOME_COPY.step1.note });",
      "context": {
        "before": {
          "line": 127,
          "text": "step1Text.createSpan({ text: WELCOME_COPY.step1.body });"
        },
        "current": {
          "line": 128,
          "text": "step1.createEl('p', { cls: 'rt-welcome-paragraph rt-welcome-footnote', text: WELCOME_COPY.step1.note });"
        },
        "after": {
          "line": 129,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/view/modes/AllScenesMode.ts",
      "line": 6,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { updateSynopsisTitleColor } from '../interactions/SynopsisTitleColorManager';",
      "context": {
        "before": {
          "line": 5,
          "text": "import { SceneInteractionManager } from '../interactions/SceneInteractionManager';"
        },
        "current": {
          "line": 6,
          "text": "import { updateSynopsisTitleColor } from '../interactions/SynopsisTitleColorManager';"
        },
        "after": {
          "line": 7,
          "text": "import { OuterRingDragController, isDragInProgress, wasRecentlyHandledByDrag } from '../interactions/OuterRingDragController';"
        }
      }
    },
    {
      "filePath": "src/view/modes/AllScenesMode.ts",
      "line": 116,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Use manager for hover interactions - pass mouse event to position synopsis immediately",
      "context": {
        "before": {
          "line": 115,
          "text": ""
        },
        "current": {
          "line": 116,
          "text": "// Use manager for hover interactions - pass mouse event to position synopsis immediately"
        },
        "after": {
          "line": 117,
          "text": "manager.onSceneHover(g, sid, e as unknown as MouseEvent);"
        }
      }
    },
    {
      "filePath": "src/view/modes/AllScenesMode.ts",
      "line": 155,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "(view.plugin as any)?.refreshTimelineIfNeeded?.(null);",
      "context": {
        "before": {
          "line": 154,
          "text": "} else {"
        },
        "current": {
          "line": 155,
          "text": "(view.plugin as any)?.refreshTimelineIfNeeded?.(null);"
        },
        "after": {
          "line": 156,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 9,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import type SynopsisManager from '../../SynopsisManager';",
      "context": {
        "before": {
          "line": 8,
          "text": "import type { TimelineItem } from '../../types';"
        },
        "current": {
          "line": 9,
          "text": "import type SynopsisManager from '../../SynopsisManager';"
        },
        "after": {
          "line": 10,
          "text": "import { setupChronologueShiftController, isShiftModeActive, isAlienModeActive, isRuntimeModeActive } from '../interactions/ChronologueShiftController';"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 14,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { updateSynopsisTitleColor } from '../interactions/SynopsisTitleColorManager';",
      "context": {
        "before": {
          "line": 13,
          "text": "import { SceneInteractionManager } from '../interactions/SceneInteractionManager';"
        },
        "current": {
          "line": 14,
          "text": "import { updateSynopsisTitleColor } from '../interactions/SynopsisTitleColorManager';"
        },
        "after": {
          "line": 15,
          "text": "import { maybeHandleZeroDraftClick } from '../interactions/ZeroDraftHandler';"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 21,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "refreshTimelineIfNeeded?: (path: string | null) => void;",
      "context": {
        "before": {
          "line": 20,
          "text": "plugin: {"
        },
        "current": {
          "line": 21,
          "text": "refreshTimelineIfNeeded?: (path: string | null) => void;"
        },
        "after": {
          "line": 22,
          "text": "app?: App;"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 29,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisManager: SynopsisManager;",
      "context": {
        "before": {
          "line": 28,
          "text": "saveSettings?: () => Promise<void>;"
        },
        "current": {
          "line": 29,
          "text": "synopsisManager: SynopsisManager;"
        },
        "after": {
          "line": 30,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 57,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Setup scene hover interactions for synopsis display",
      "context": {
        "before": {
          "line": 56,
          "text": "/**"
        },
        "current": {
          "line": 57,
          "text": "* Setup scene hover interactions for synopsis display"
        },
        "after": {
          "line": 58,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 85,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisBySceneId = new Map<string, Element>();",
      "context": {
        "before": {
          "line": 84,
          "text": ""
        },
        "current": {
          "line": 85,
          "text": "const synopsisBySceneId = new Map<string, Element>();"
        },
        "after": {
          "line": 86,
          "text": "svg.querySelectorAll<SVGElement>('.rt-scene-info[data-for-scene]').forEach(synopsis => {"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 86,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "svg.querySelectorAll<SVGElement>('.rt-scene-info[data-for-scene]').forEach(synopsis => {",
      "context": {
        "before": {
          "line": 85,
          "text": "const synopsisBySceneId = new Map<string, Element>();"
        },
        "current": {
          "line": 86,
          "text": "svg.querySelectorAll<SVGElement>('.rt-scene-info[data-for-scene]').forEach(synopsis => {"
        },
        "after": {
          "line": 87,
          "text": "const sceneId = synopsis.getAttribute('data-for-scene');"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 87,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const sceneId = synopsis.getAttribute('data-for-scene');",
      "context": {
        "before": {
          "line": 86,
          "text": "svg.querySelectorAll<SVGElement>('.rt-scene-info[data-for-scene]').forEach(synopsis => {"
        },
        "current": {
          "line": 87,
          "text": "const sceneId = synopsis.getAttribute('data-for-scene');"
        },
        "after": {
          "line": 88,
          "text": "if (sceneId) {"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 89,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisBySceneId.set(sceneId, synopsis);",
      "context": {
        "before": {
          "line": 88,
          "text": "if (sceneId) {"
        },
        "current": {
          "line": 89,
          "text": "synopsisBySceneId.set(sceneId, synopsis);"
        },
        "after": {
          "line": 90,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 272,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Suspend hover synopsis reveal when shift/alt/runtime mode is active",
      "context": {
        "before": {
          "line": 271,
          "text": "view.registerDomEvent(svg as unknown as HTMLElement, 'pointerover', (e: PointerEvent) => {"
        },
        "current": {
          "line": 272,
          "text": "// Suspend hover synopsis reveal when shift/alt/runtime mode is active"
        },
        "after": {
          "line": 273,
          "text": "// CHECK THIS FIRST before any other work!"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 285,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const syn = synopsisBySceneId.get(sid);",
      "context": {
        "before": {
          "line": 284,
          "text": "if (currentHoveredSceneId === sid) {"
        },
        "current": {
          "line": 285,
          "text": "const syn = synopsisBySceneId.get(sid);"
        },
        "after": {
          "line": 286,
          "text": "if (syn) {"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 288,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "view.plugin.synopsisManager.updatePosition(syn, e as unknown as MouseEvent, svg, sid);",
      "context": {
        "before": {
          "line": 287,
          "text": "// Calculate position BEFORE making visible to prevent flicker"
        },
        "current": {
          "line": 288,
          "text": "view.plugin.synopsisManager.updatePosition(syn, e as unknown as MouseEvent, svg, sid);"
        },
        "after": {
          "line": 289,
          "text": "// Update title color based on Chronologue mode (use subplot color)"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 290,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "updateSynopsisTitleColor(syn, sid, 'chronologue');",
      "context": {
        "before": {
          "line": 289,
          "text": "// Update title color based on Chronologue mode (use subplot color)"
        },
        "current": {
          "line": 290,
          "text": "updateSynopsisTitleColor(syn, sid, 'chronologue');"
        },
        "after": {
          "line": 291,
          "text": "syn.classList.add('rt-visible');"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 306,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const previousSynopsis = synopsisBySceneId.get(previousSceneId);",
      "context": {
        "before": {
          "line": 305,
          "text": "if (previousSceneId) {"
        },
        "current": {
          "line": 306,
          "text": "const previousSynopsis = synopsisBySceneId.get(previousSceneId);"
        },
        "after": {
          "line": 307,
          "text": "if (previousSynopsis) {"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 307,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (previousSynopsis) {",
      "context": {
        "before": {
          "line": 306,
          "text": "const previousSynopsis = synopsisBySceneId.get(previousSceneId);"
        },
        "current": {
          "line": 307,
          "text": "if (previousSynopsis) {"
        },
        "after": {
          "line": 308,
          "text": "previousSynopsis.classList.remove('rt-visible');"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 308,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "previousSynopsis.classList.remove('rt-visible');",
      "context": {
        "before": {
          "line": 307,
          "text": "if (previousSynopsis) {"
        },
        "current": {
          "line": 308,
          "text": "previousSynopsis.classList.remove('rt-visible');"
        },
        "after": {
          "line": 309,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 316,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const syn = synopsisBySceneId.get(sid);",
      "context": {
        "before": {
          "line": 315,
          "text": ""
        },
        "current": {
          "line": 316,
          "text": "const syn = synopsisBySceneId.get(sid);"
        },
        "after": {
          "line": 317,
          "text": "if (syn) {"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 319,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "view.plugin.synopsisManager.updatePosition(syn, e as unknown as MouseEvent, svg, sid);",
      "context": {
        "before": {
          "line": 318,
          "text": "// Calculate position BEFORE making visible to prevent flicker in wrong location"
        },
        "current": {
          "line": 319,
          "text": "view.plugin.synopsisManager.updatePosition(syn, e as unknown as MouseEvent, svg, sid);"
        },
        "after": {
          "line": 320,
          "text": "// Update title color based on Chronologue mode (use subplot color)"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 321,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "updateSynopsisTitleColor(syn, sid, 'chronologue');",
      "context": {
        "before": {
          "line": 320,
          "text": "// Update title color based on Chronologue mode (use subplot color)"
        },
        "current": {
          "line": 321,
          "text": "updateSynopsisTitleColor(syn, sid, 'chronologue');"
        },
        "after": {
          "line": 322,
          "text": "syn.classList.add('rt-visible');"
        }
      }
    },
    {
      "filePath": "src/view/modes/ChronologueMode.ts",
      "line": 355,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const syn = synopsisBySceneId.get(sid);",
      "context": {
        "before": {
          "line": 354,
          "text": ""
        },
        "current": {
          "line": 355,
          "text": "const syn = synopsisBySceneId.get(sid);"
        },
        "after": {
          "line": 356,
          "text": "if (syn) {"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 7,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "let currentSynopsis: Element | null = null;",
      "context": {
        "before": {
          "line": 6,
          "text": "let currentGroup: Element | null = null;"
        },
        "current": {
          "line": 7,
          "text": "let currentSynopsis: Element | null = null;"
        },
        "after": {
          "line": 8,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 9,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const findSynopsisForScene = (sceneId: string): Element | null => {",
      "context": {
        "before": {
          "line": 8,
          "text": ""
        },
        "current": {
          "line": 9,
          "text": "const findSynopsisForScene = (sceneId: string): Element | null => {"
        },
        "after": {
          "line": 10,
          "text": "return svg.querySelector(`.rt-scene-info[data-for-scene=\"${sceneId}\"]`);"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 18,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// 1a. Beat Slice Hover (delegated fallback): Show synopsis, sync dot+spoke",
      "context": {
        "before": {
          "line": 17,
          "text": ""
        },
        "current": {
          "line": 18,
          "text": "// 1a. Beat Slice Hover (delegated fallback): Show synopsis, sync dot+spoke"
        },
        "after": {
          "line": 19,
          "text": "const beatSliceOver = (e: PointerEvent) => {"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 35,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "currentSynopsis = findSynopsisForScene(sid);",
      "context": {
        "before": {
          "line": 34,
          "text": "if (sid) {"
        },
        "current": {
          "line": 35,
          "text": "currentSynopsis = findSynopsisForScene(sid);"
        },
        "after": {
          "line": 36,
          "text": "if (currentSynopsis) {"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 36,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (currentSynopsis) {",
      "context": {
        "before": {
          "line": 35,
          "text": "currentSynopsis = findSynopsisForScene(sid);"
        },
        "current": {
          "line": 36,
          "text": "if (currentSynopsis) {"
        },
        "after": {
          "line": 37,
          "text": "currentSynopsis.classList.add('rt-visible');"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 37,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "currentSynopsis.classList.add('rt-visible');",
      "context": {
        "before": {
          "line": 36,
          "text": "if (currentSynopsis) {"
        },
        "current": {
          "line": 37,
          "text": "currentSynopsis.classList.add('rt-visible');"
        },
        "after": {
          "line": 38,
          "text": "view.plugin.synopsisManager.updatePosition(currentSynopsis, e as unknown as MouseEvent, svg, sid);"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 38,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "view.plugin.synopsisManager.updatePosition(currentSynopsis, e as unknown as MouseEvent, svg, sid);",
      "context": {
        "before": {
          "line": 37,
          "text": "currentSynopsis.classList.add('rt-visible');"
        },
        "current": {
          "line": 38,
          "text": "view.plugin.synopsisManager.updatePosition(currentSynopsis, e as unknown as MouseEvent, svg, sid);"
        },
        "after": {
          "line": 39,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 103,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (currentSynopsis) {",
      "context": {
        "before": {
          "line": 102,
          "text": "svg.classList.remove('scene-hover');"
        },
        "current": {
          "line": 103,
          "text": "if (currentSynopsis) {"
        },
        "after": {
          "line": 104,
          "text": "currentSynopsis.classList.remove('rt-visible');"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 104,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "currentSynopsis.classList.remove('rt-visible');",
      "context": {
        "before": {
          "line": 103,
          "text": "if (currentSynopsis) {"
        },
        "current": {
          "line": 104,
          "text": "currentSynopsis.classList.remove('rt-visible');"
        },
        "after": {
          "line": 105,
          "text": "currentSynopsis = null;"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 105,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "currentSynopsis = null;",
      "context": {
        "before": {
          "line": 104,
          "text": "currentSynopsis.classList.remove('rt-visible');"
        },
        "current": {
          "line": 105,
          "text": "currentSynopsis = null;"
        },
        "after": {
          "line": 106,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 161,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// 2. Gossamer Dot Hover: Show synopsis, sync plot slice+spoke+center dot",
      "context": {
        "before": {
          "line": 160,
          "text": ""
        },
        "current": {
          "line": 161,
          "text": "// 2. Gossamer Dot Hover: Show synopsis, sync plot slice+spoke+center dot"
        },
        "after": {
          "line": 162,
          "text": "const dotOver = (e: PointerEvent) => {"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 193,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "currentSynopsis = findSynopsisForScene(sid);",
      "context": {
        "before": {
          "line": 192,
          "text": "if (sid) {"
        },
        "current": {
          "line": 193,
          "text": "currentSynopsis = findSynopsisForScene(sid);"
        },
        "after": {
          "line": 194,
          "text": "if (currentSynopsis) {"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 194,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (currentSynopsis) {",
      "context": {
        "before": {
          "line": 193,
          "text": "currentSynopsis = findSynopsisForScene(sid);"
        },
        "current": {
          "line": 194,
          "text": "if (currentSynopsis) {"
        },
        "after": {
          "line": 195,
          "text": "currentSynopsis.classList.add('rt-visible');"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 195,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "currentSynopsis.classList.add('rt-visible');",
      "context": {
        "before": {
          "line": 194,
          "text": "if (currentSynopsis) {"
        },
        "current": {
          "line": 195,
          "text": "currentSynopsis.classList.add('rt-visible');"
        },
        "after": {
          "line": 196,
          "text": "view.plugin.synopsisManager.updatePosition(currentSynopsis, e as unknown as MouseEvent, svg, sid);"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 196,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "view.plugin.synopsisManager.updatePosition(currentSynopsis, e as unknown as MouseEvent, svg, sid);",
      "context": {
        "before": {
          "line": 195,
          "text": "currentSynopsis.classList.add('rt-visible');"
        },
        "current": {
          "line": 196,
          "text": "view.plugin.synopsisManager.updatePosition(currentSynopsis, e as unknown as MouseEvent, svg, sid);"
        },
        "after": {
          "line": 197,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 236,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (currentSynopsis) {",
      "context": {
        "before": {
          "line": 235,
          "text": ""
        },
        "current": {
          "line": 236,
          "text": "if (currentSynopsis) {"
        },
        "after": {
          "line": 237,
          "text": "currentSynopsis.classList.remove('rt-visible');"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 237,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "currentSynopsis.classList.remove('rt-visible');",
      "context": {
        "before": {
          "line": 236,
          "text": "if (currentSynopsis) {"
        },
        "current": {
          "line": 237,
          "text": "currentSynopsis.classList.remove('rt-visible');"
        },
        "after": {
          "line": 238,
          "text": "currentSynopsis = null;"
        }
      }
    },
    {
      "filePath": "src/view/modes/GossamerMode.ts",
      "line": 238,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "currentSynopsis = null;",
      "context": {
        "before": {
          "line": 237,
          "text": "currentSynopsis.classList.remove('rt-visible');"
        },
        "current": {
          "line": 238,
          "text": "currentSynopsis = null;"
        },
        "after": {
          "line": 239,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/modes/MainPlotMode.ts",
      "line": 4,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { updateSynopsisTitleColor } from '../interactions/SynopsisTitleColorManager';",
      "context": {
        "before": {
          "line": 3,
          "text": "import { SceneInteractionManager } from '../interactions/SceneInteractionManager';"
        },
        "current": {
          "line": 4,
          "text": "import { updateSynopsisTitleColor } from '../interactions/SynopsisTitleColorManager';"
        },
        "after": {
          "line": 5,
          "text": "import { maybeHandleZeroDraftClick } from '../interactions/ZeroDraftHandler';"
        }
      }
    },
    {
      "filePath": "src/view/modes/MainPlotMode.ts",
      "line": 23,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: Don't add 'scene-hover' class here - it hides subplot labels!",
      "context": {
        "before": {
          "line": 22,
          "text": ""
        },
        "current": {
          "line": 23,
          "text": "// Note: Don't add 'scene-hover' class here - it hides subplot labels!"
        },
        "after": {
          "line": 24,
          "text": "// The class should only be added during actual hover events"
        }
      }
    },
    {
      "filePath": "src/view/modes/MainPlotMode.ts",
      "line": 64,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Pass mouse event to position synopsis immediately and prevent flicker",
      "context": {
        "before": {
          "line": 63,
          "text": "// Use manager for hover interactions (handles title expansion and styling)"
        },
        "current": {
          "line": 64,
          "text": "// Pass mouse event to position synopsis immediately and prevent flicker"
        },
        "after": {
          "line": 65,
          "text": "manager.onSceneHover(g, sid, e as unknown as MouseEvent);"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 32,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "refreshTimelineIfNeeded?: (path: string | null) => void;",
      "context": {
        "before": {
          "line": 31,
          "text": "plugin: {"
        },
        "current": {
          "line": 32,
          "text": "refreshTimelineIfNeeded?: (path: string | null) => void;"
        },
        "after": {
          "line": 33,
          "text": "[key: string]: any; // SAFE: any type used for facade extension by downstream plugins"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 117,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Cache synopsis elements for fast lookup (avoiding querySelectorAll on every hover)",
      "context": {
        "before": {
          "line": 116,
          "text": ""
        },
        "current": {
          "line": 117,
          "text": "// Cache synopsis elements for fast lookup (avoiding querySelectorAll on every hover)"
        },
        "after": {
          "line": 118,
          "text": "const allSynopsisElements: Element[] = Array.from(svg.querySelectorAll('.rt-scene-info'));"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 118,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const allSynopsisElements: Element[] = Array.from(svg.querySelectorAll('.rt-scene-info'));",
      "context": {
        "before": {
          "line": 117,
          "text": "// Cache synopsis elements for fast lookup (avoiding querySelectorAll on every hover)"
        },
        "current": {
          "line": 118,
          "text": "const allSynopsisElements: Element[] = Array.from(svg.querySelectorAll('.rt-scene-info'));"
        },
        "after": {
          "line": 119,
          "text": "const synopsisBySceneId = new Map<string, Element>();"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 119,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisBySceneId = new Map<string, Element>();",
      "context": {
        "before": {
          "line": 118,
          "text": "const allSynopsisElements: Element[] = Array.from(svg.querySelectorAll('.rt-scene-info'));"
        },
        "current": {
          "line": 119,
          "text": "const synopsisBySceneId = new Map<string, Element>();"
        },
        "after": {
          "line": 120,
          "text": "allSynopsisElements.forEach(synopsis => {"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 120,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "allSynopsisElements.forEach(synopsis => {",
      "context": {
        "before": {
          "line": 119,
          "text": "const synopsisBySceneId = new Map<string, Element>();"
        },
        "current": {
          "line": 120,
          "text": "allSynopsisElements.forEach(synopsis => {"
        },
        "after": {
          "line": 121,
          "text": "const sceneId = synopsis.getAttribute('data-for-scene');"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 121,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const sceneId = synopsis.getAttribute('data-for-scene');",
      "context": {
        "before": {
          "line": 120,
          "text": "allSynopsisElements.forEach(synopsis => {"
        },
        "current": {
          "line": 121,
          "text": "const sceneId = synopsis.getAttribute('data-for-scene');"
        },
        "after": {
          "line": 122,
          "text": "if (sceneId) {"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 123,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisBySceneId.set(sceneId, synopsis);",
      "context": {
        "before": {
          "line": 122,
          "text": "if (sceneId) {"
        },
        "current": {
          "line": 123,
          "text": "synopsisBySceneId.set(sceneId, synopsis);"
        },
        "after": {
          "line": 124,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 245,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "if (view.plugin.refreshTimelineIfNeeded) {",
      "context": {
        "before": {
          "line": 244,
          "text": "svg.removeAttribute('data-shift-mode');"
        },
        "current": {
          "line": 245,
          "text": "if (view.plugin.refreshTimelineIfNeeded) {"
        },
        "after": {
          "line": 246,
          "text": "view.plugin.refreshTimelineIfNeeded(null);"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 246,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "view.plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 245,
          "text": "if (view.plugin.refreshTimelineIfNeeded) {"
        },
        "current": {
          "line": 246,
          "text": "view.plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 247,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 315,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Hide all synopsis elements in shift mode using cached array",
      "context": {
        "before": {
          "line": 314,
          "text": "applyShiftModeToAllScenes(svg);"
        },
        "current": {
          "line": 315,
          "text": "// Hide all synopsis elements in shift mode using cached array"
        },
        "after": {
          "line": 316,
          "text": "allSynopsisElements.forEach(syn => {"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 316,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "allSynopsisElements.forEach(syn => {",
      "context": {
        "before": {
          "line": 315,
          "text": "// Hide all synopsis elements in shift mode using cached array"
        },
        "current": {
          "line": 316,
          "text": "allSynopsisElements.forEach(syn => {"
        },
        "after": {
          "line": 317,
          "text": "if (syn.classList.contains('rt-visible')) {"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 661,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "if (view.plugin.refreshTimelineIfNeeded) {",
      "context": {
        "before": {
          "line": 660,
          "text": "const rafId = requestAnimationFrame(() => {"
        },
        "current": {
          "line": 661,
          "text": "if (view.plugin.refreshTimelineIfNeeded) {"
        },
        "after": {
          "line": 662,
          "text": "view.plugin.refreshTimelineIfNeeded(null);"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 662,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "view.plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 661,
          "text": "if (view.plugin.refreshTimelineIfNeeded) {"
        },
        "current": {
          "line": 662,
          "text": "view.plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 663,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ChronologueShiftController.ts",
      "line": 1346,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "* DEPRECATED - removed inline to reduce function call overhead",
      "context": {
        "before": {
          "line": 1345,
          "text": "/**"
        },
        "current": {
          "line": 1346,
          "text": "* DEPRECATED - removed inline to reduce function call overhead"
        },
        "after": {
          "line": 1347,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ModeToggleController.ts",
      "line": 22,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "refreshTimelineIfNeeded: (file: unknown) => void;",
      "context": {
        "before": {
          "line": 21,
          "text": "saveSettings: () => Promise<void>;"
        },
        "current": {
          "line": 22,
          "text": "refreshTimelineIfNeeded: (file: unknown) => void;"
        },
        "after": {
          "line": 23,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/view/interactions/ModeToggleController.ts",
      "line": 198,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "view.plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 197,
          "text": "} else {"
        },
        "current": {
          "line": 198,
          "text": "view.plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 199,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/interactions/OuterRingDragController.ts",
      "line": 233,
      "token": "Ripple Rename",
      "category": "drift-term",
      "lineText": "summaryLines.push('Ripple rename is enabled: scene and active-beat filenames are normalized after drop (filenames only). Decimalized prefixes are reflowed to integers.');",
      "context": {
        "before": {
          "line": 232,
          "text": "if (!this.isRippleRenameEnabled()) return;"
        },
        "current": {
          "line": 233,
          "text": "summaryLines.push('Ripple rename is enabled: scene and active-beat filenames are normalized after drop (filenames only). Decimalized prefixes are reflowed to integers.');"
        },
        "after": {
          "line": 234,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/interactions/OuterRingDragController.ts",
      "line": 857,
      "token": "Ripple Rename",
      "category": "drift-term",
      "lineText": "new Notice('Ripple rename: already normalized (filenames only; no content edits).', 2600);",
      "context": {
        "before": {
          "line": 856,
          "text": "if (plan.needRename === 0) {"
        },
        "current": {
          "line": 857,
          "text": "new Notice('Ripple rename: already normalized (filenames only; no content edits).', 2600);"
        },
        "after": {
          "line": 858,
          "text": "return;"
        }
      }
    },
    {
      "filePath": "src/view/interactions/OuterRingDragController.ts",
      "line": 861,
      "token": "Ripple Rename",
      "category": "drift-term",
      "lineText": "new Notice(`Ripple rename: ${plan.needRename} file(s) need renaming (${plan.checked} checked, filenames only).`, 3200);",
      "context": {
        "before": {
          "line": 860,
          "text": ""
        },
        "current": {
          "line": 861,
          "text": "new Notice(`Ripple rename: ${plan.needRename} file(s) need renaming (${plan.checked} checked, filenames only).`, 3200);"
        },
        "after": {
          "line": 862,
          "text": "await applySceneNumberUpdates(this.view.plugin.app, plan.updates);"
        }
      }
    },
    {
      "filePath": "src/view/interactions/OuterRingDragController.ts",
      "line": 864,
      "token": "Ripple Rename",
      "category": "drift-term",
      "lineText": "console.error('Ripple rename failed:', error);",
      "context": {
        "before": {
          "line": 863,
          "text": "} catch (error) {"
        },
        "current": {
          "line": 864,
          "text": "console.error('Ripple rename failed:', error);"
        },
        "after": {
          "line": 865,
          "text": "new Notice('Ripple rename failed. See console for details.', 3500);"
        }
      }
    },
    {
      "filePath": "src/view/interactions/OuterRingDragController.ts",
      "line": 865,
      "token": "Ripple Rename",
      "category": "drift-term",
      "lineText": "new Notice('Ripple rename failed. See console for details.', 3500);",
      "context": {
        "before": {
          "line": 864,
          "text": "console.error('Ripple rename failed:', error);"
        },
        "current": {
          "line": 865,
          "text": "new Notice('Ripple rename failed. See console for details.', 3500);"
        },
        "after": {
          "line": 866,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 10,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Manages scene hover interactions, synopsis display, and scene title auto-expansion.",
      "context": {
        "before": {
          "line": 9,
          "text": "*"
        },
        "current": {
          "line": 10,
          "text": "* Manages scene hover interactions, synopsis display, and scene title auto-expansion."
        },
        "after": {
          "line": 11,
          "text": "* Extracted from the 400-line closure in TimeLineView.ts to enable reuse across modes."
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 15,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { updateSynopsisTitleColor } from './SynopsisTitleColorManager';",
      "context": {
        "before": {
          "line": 14,
          "text": "import type { RadialTimelineView } from '../TimeLineView';"
        },
        "current": {
          "line": 15,
          "text": "import { updateSynopsisTitleColor } from './SynopsisTitleColorManager';"
        },
        "after": {
          "line": 16,
          "text": "import {"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 35,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private currentSynopsis: Element | null = null;",
      "context": {
        "before": {
          "line": 34,
          "text": "private currentGroup: Element | null = null;"
        },
        "current": {
          "line": 35,
          "text": "private currentSynopsis: Element | null = null;"
        },
        "after": {
          "line": 36,
          "text": "private currentSceneId: string | null = null;"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 142,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.currentSynopsis = this.findSynopsisForScene(sceneId);",
      "context": {
        "before": {
          "line": 141,
          "text": "this.currentSceneId = sceneId;"
        },
        "current": {
          "line": 142,
          "text": "this.currentSynopsis = this.findSynopsisForScene(sceneId);"
        },
        "after": {
          "line": 143,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 147,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Show synopsis - position it BEFORE making visible to prevent flicker",
      "context": {
        "before": {
          "line": 146,
          "text": ""
        },
        "current": {
          "line": 147,
          "text": "// Show synopsis - position it BEFORE making visible to prevent flicker"
        },
        "after": {
          "line": 148,
          "text": "if (this.currentSynopsis) {"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 148,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.currentSynopsis) {",
      "context": {
        "before": {
          "line": 147,
          "text": "// Show synopsis - position it BEFORE making visible to prevent flicker"
        },
        "current": {
          "line": 148,
          "text": "if (this.currentSynopsis) {"
        },
        "after": {
          "line": 149,
          "text": "// If mouse event provided, position immediately to prevent flicker"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 151,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "view.plugin.synopsisManager.updatePosition(",
      "context": {
        "before": {
          "line": 150,
          "text": "if (mouseEvent) {"
        },
        "current": {
          "line": 151,
          "text": "view.plugin.synopsisManager.updatePosition("
        },
        "after": {
          "line": 152,
          "text": "this.currentSynopsis,"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 152,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.currentSynopsis,",
      "context": {
        "before": {
          "line": 151,
          "text": "view.plugin.synopsisManager.updatePosition("
        },
        "current": {
          "line": 152,
          "text": "this.currentSynopsis,"
        },
        "after": {
          "line": 153,
          "text": "mouseEvent,"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 161,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "updateSynopsisTitleColor(this.currentSynopsis, sceneId, currentMode);",
      "context": {
        "before": {
          "line": 160,
          "text": "const currentMode = (view.plugin.settings as any).currentMode || 'narrative';"
        },
        "current": {
          "line": 161,
          "text": "updateSynopsisTitleColor(this.currentSynopsis, sceneId, currentMode);"
        },
        "after": {
          "line": 162,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 163,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.currentSynopsis.classList.add('rt-visible');",
      "context": {
        "before": {
          "line": 162,
          "text": ""
        },
        "current": {
          "line": 163,
          "text": "this.currentSynopsis.classList.add('rt-visible');"
        },
        "after": {
          "line": 164,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 189,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.currentSynopsis = null;",
      "context": {
        "before": {
          "line": 188,
          "text": "this.currentGroup = null;"
        },
        "current": {
          "line": 189,
          "text": "this.currentSynopsis = null;"
        },
        "after": {
          "line": 190,
          "text": "this.currentSceneId = null;"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 194,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Update synopsis position on mouse move",
      "context": {
        "before": {
          "line": 193,
          "text": "/**"
        },
        "current": {
          "line": 194,
          "text": "* Update synopsis position on mouse move"
        },
        "after": {
          "line": 195,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 203,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!view || !this.currentSynopsis || !this.currentSceneId) return;",
      "context": {
        "before": {
          "line": 202,
          "text": "const view = this.getView();"
        },
        "current": {
          "line": 203,
          "text": "if (!view || !this.currentSynopsis || !this.currentSceneId) return;"
        },
        "after": {
          "line": 204,
          "text": "if (!this.currentSynopsis.classList.contains('rt-visible')) return;"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 204,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!this.currentSynopsis.classList.contains('rt-visible')) return;",
      "context": {
        "before": {
          "line": 203,
          "text": "if (!view || !this.currentSynopsis || !this.currentSceneId) return;"
        },
        "current": {
          "line": 204,
          "text": "if (!this.currentSynopsis.classList.contains('rt-visible')) return;"
        },
        "after": {
          "line": 205,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 206,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "view.plugin.synopsisManager.updatePosition(",
      "context": {
        "before": {
          "line": 205,
          "text": ""
        },
        "current": {
          "line": 206,
          "text": "view.plugin.synopsisManager.updatePosition("
        },
        "after": {
          "line": 207,
          "text": "this.currentSynopsis,"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 207,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.currentSynopsis,",
      "context": {
        "before": {
          "line": 206,
          "text": "view.plugin.synopsisManager.updatePosition("
        },
        "current": {
          "line": 207,
          "text": "this.currentSynopsis,"
        },
        "after": {
          "line": 208,
          "text": "e,"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 243,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private findSynopsisForScene(sceneId: string): Element | null {",
      "context": {
        "before": {
          "line": 242,
          "text": ""
        },
        "current": {
          "line": 243,
          "text": "private findSynopsisForScene(sceneId: string): Element | null {"
        },
        "after": {
          "line": 244,
          "text": "return this.svg.querySelector(`.rt-scene-info[data-for-scene=\"${sceneId}\"]`);"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 257,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.currentSynopsis) {",
      "context": {
        "before": {
          "line": 256,
          "text": ""
        },
        "current": {
          "line": 257,
          "text": "if (this.currentSynopsis) {"
        },
        "after": {
          "line": 258,
          "text": "this.currentSynopsis.classList.remove('rt-visible');"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SceneInteractionManager.ts",
      "line": 258,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.currentSynopsis.classList.remove('rt-visible');",
      "context": {
        "before": {
          "line": 257,
          "text": "if (this.currentSynopsis) {"
        },
        "current": {
          "line": 258,
          "text": "this.currentSynopsis.classList.remove('rt-visible');"
        },
        "after": {
          "line": 259,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SearchInteractions.ts",
      "line": 103,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Synopsis text elements (only those without tspan children)",
      "context": {
        "before": {
          "line": 102,
          "text": ""
        },
        "current": {
          "line": 103,
          "text": "// Synopsis text elements (only those without tspan children)"
        },
        "after": {
          "line": 104,
          "text": "view.contentEl.querySelectorAll('svg .rt-synopsis-text text').forEach((textEl) => {"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SearchInteractions.ts",
      "line": 104,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "view.contentEl.querySelectorAll('svg .rt-synopsis-text text').forEach((textEl) => {",
      "context": {
        "before": {
          "line": 103,
          "text": "// Synopsis text elements (only those without tspan children)"
        },
        "current": {
          "line": 104,
          "text": "view.contentEl.querySelectorAll('svg .rt-synopsis-text text').forEach((textEl) => {"
        },
        "after": {
          "line": 105,
          "text": "if (textEl.querySelector('tspan')) return;"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SearchInteractions.ts",
      "line": 131,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Unhandled tspans under synopsis",
      "context": {
        "before": {
          "line": 130,
          "text": ""
        },
        "current": {
          "line": 131,
          "text": "// Unhandled tspans under synopsis"
        },
        "after": {
          "line": 132,
          "text": "view.contentEl.querySelectorAll('svg .rt-synopsis-text text tspan:not([data-item-type])').forEach((tspan) => {"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SearchInteractions.ts",
      "line": 132,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "view.contentEl.querySelectorAll('svg .rt-synopsis-text text tspan:not([data-item-type])').forEach((tspan) => {",
      "context": {
        "before": {
          "line": 131,
          "text": "// Unhandled tspans under synopsis"
        },
        "current": {
          "line": 132,
          "text": "view.contentEl.querySelectorAll('svg .rt-synopsis-text text tspan:not([data-item-type])').forEach((tspan) => {"
        },
        "after": {
          "line": 133,
          "text": "const originalText = tspan.textContent || '';"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SynopsisTitleColorManager.ts",
      "line": 8,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Update scene title color in synopsis based on mode",
      "context": {
        "before": {
          "line": 7,
          "text": "/**"
        },
        "current": {
          "line": 8,
          "text": "* Update scene title color in synopsis based on mode"
        },
        "after": {
          "line": 9,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SynopsisTitleColorManager.ts",
      "line": 10,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function updateSynopsisTitleColor(synopsis: Element, sceneId: string, mode: string): void {",
      "context": {
        "before": {
          "line": 9,
          "text": "*/"
        },
        "current": {
          "line": 10,
          "text": "export function updateSynopsisTitleColor(synopsis: Element, sceneId: string, mode: string): void {"
        },
        "after": {
          "line": 11,
          "text": "const titleTspans = synopsis.querySelectorAll('.rt-scene-title-bold[data-item-type=\"title\"]');"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SynopsisTitleColorManager.ts",
      "line": 11,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const titleTspans = synopsis.querySelectorAll('.rt-scene-title-bold[data-item-type=\"title\"]');",
      "context": {
        "before": {
          "line": 10,
          "text": "export function updateSynopsisTitleColor(synopsis: Element, sceneId: string, mode: string): void {"
        },
        "current": {
          "line": 11,
          "text": "const titleTspans = synopsis.querySelectorAll('.rt-scene-title-bold[data-item-type=\"title\"]');"
        },
        "after": {
          "line": 12,
          "text": "if (titleTspans.length === 0) return;"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SynopsisTitleColorManager.ts",
      "line": 34,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Use the publish stage color stored on synopsis",
      "context": {
        "before": {
          "line": 33,
          "text": "} else if (mode === 'subplot') {"
        },
        "current": {
          "line": 34,
          "text": "// Use the publish stage color stored on synopsis"
        },
        "after": {
          "line": 35,
          "text": "color = synopsis.getAttribute('data-stage-color');"
        }
      }
    },
    {
      "filePath": "src/view/interactions/SynopsisTitleColorManager.ts",
      "line": 35,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "color = synopsis.getAttribute('data-stage-color');",
      "context": {
        "before": {
          "line": 34,
          "text": "// Use the publish stage color stored on synopsis"
        },
        "current": {
          "line": 35,
          "text": "color = synopsis.getAttribute('data-stage-color');"
        },
        "after": {
          "line": 36,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/utils/beatsSystems.ts",
      "line": 127,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "description: \"The lowest point. The protagonist loses everything or believes they do. The goal seems impossible. This is often the moment of greatest despair, where hope appears lost. Something or someone important may be literally or figuratively lost. The 'whiff of death' moment.\",",
      "context": {
        "before": {
          "line": 126,
          "text": "id: \"save-the-cat:all-is-lost\","
        },
        "current": {
          "line": 127,
          "text": "description: \"The lowest point. The protagonist loses everything or believes they do. The goal seems impossible. This is often the moment of greatest despair, where hope appears lost. Something or someone important may be literally or figuratively lost. The 'whiff of death' moment.\","
        },
        "after": {
          "line": 128,
          "text": "placement: \"75%\","
        }
      }
    },
    {
      "filePath": "src/utils/beatsSystems.ts",
      "line": 386,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "{ name: 'Call to Action', act: 3, id: 'starter:youtube_explainer:call-to-action', purpose: 'The video closes with a clean next step and a satisfying final note.' },",
      "context": {
        "before": {
          "line": 385,
          "text": "{ name: 'Practical Takeaway', act: 3, id: 'starter:youtube_explainer:practical-takeaway', purpose: 'The viewer gets steps, rules of thumb, or actions they can use.' },"
        },
        "current": {
          "line": 386,
          "text": "{ name: 'Call to Action', act: 3, id: 'starter:youtube_explainer:call-to-action', purpose: 'The video closes with a clean next step and a satisfying final note.' },"
        },
        "after": {
          "line": 387,
          "text": "],"
        }
      }
    },
    {
      "filePath": "src/utils/beatsSystems.ts",
      "line": 519,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "//  Deprecated aliases (remove after v5.2) ",
      "context": {
        "before": {
          "line": 518,
          "text": ""
        },
        "current": {
          "line": 519,
          "text": "//  Deprecated aliases (remove after v5.2) "
        },
        "after": {
          "line": 520,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/utils/beatsSystems.ts",
      "line": 521,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Use PlotSystemPreset */",
      "context": {
        "before": {
          "line": 520,
          "text": ""
        },
        "current": {
          "line": 521,
          "text": "/** @deprecated Use PlotSystemPreset */"
        },
        "after": {
          "line": 522,
          "text": "export type PlotSystemTemplate = PlotSystemPreset;"
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 2,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Beat Set Note Creation",
      "context": {
        "before": {
          "line": 1,
          "text": "/*"
        },
        "current": {
          "line": 2,
          "text": "* Beat Set Note Creation"
        },
        "after": {
          "line": 3,
          "text": "*"
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 4,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "* NOTE: Legacy \"template\" terminology retained as deprecated aliases",
      "context": {
        "before": {
          "line": 3,
          "text": "*"
        },
        "current": {
          "line": 4,
          "text": "* NOTE: Legacy \"template\" terminology retained as deprecated aliases"
        },
        "after": {
          "line": 5,
          "text": "* at the bottom of this file for backward compatibility."
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 4,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* NOTE: Legacy \"template\" terminology retained as deprecated aliases",
      "context": {
        "before": {
          "line": 3,
          "text": "*"
        },
        "current": {
          "line": 4,
          "text": "* NOTE: Legacy \"template\" terminology retained as deprecated aliases"
        },
        "after": {
          "line": 5,
          "text": "* at the bottom of this file for backward compatibility."
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 10,
      "token": "mergeTemplates",
      "category": "drift-term",
      "lineText": "import { mergeTemplates } from './sceneGenerator';",
      "context": {
        "before": {
          "line": 9,
          "text": "import { PLOT_SYSTEMS, PLOT_SYSTEM_NAMES, PRO_BEAT_SETS, PlotSystemPreset, PlotBeatInfo } from './beatsSystems';"
        },
        "current": {
          "line": 10,
          "text": "import { mergeTemplates } from './sceneGenerator';"
        },
        "after": {
          "line": 11,
          "text": "import type { BeatSystemConfig, RadialTimelineSettings } from '../types/settings';"
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 35,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Used by: settings UI editor, note generation (getMergedBeatYaml).",
      "context": {
        "before": {
          "line": 34,
          "text": "* Resolve the BeatSystemConfig for the currently active system in settings."
        },
        "current": {
          "line": 35,
          "text": "* Used by: settings UI editor, note generation (getMergedBeatYaml)."
        },
        "after": {
          "line": 36,
          "text": "* Optional systemKey overrides the active system (for editor previews)."
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 35,
      "token": "getMergedBeatYaml",
      "category": "drift-term",
      "lineText": "* Used by: settings UI editor, note generation (getMergedBeatYaml).",
      "context": {
        "before": {
          "line": 34,
          "text": "* Resolve the BeatSystemConfig for the currently active system in settings."
        },
        "current": {
          "line": 35,
          "text": "* Used by: settings UI editor, note generation (getMergedBeatYaml)."
        },
        "after": {
          "line": 36,
          "text": "* Optional systemKey overrides the active system (for editor previews)."
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 85,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Resolve the BeatSystemConfig for a specific beat note by its Beat Model frontmatter value.",
      "context": {
        "before": {
          "line": 84,
          "text": "/**"
        },
        "current": {
          "line": 85,
          "text": "* Resolve the BeatSystemConfig for a specific beat note by its Beat Model frontmatter value."
        },
        "after": {
          "line": 86,
          "text": "* Used by: SynopsisManager (hover), SearchService (indexing)."
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 86,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Used by: SynopsisManager (hover), SearchService (indexing).",
      "context": {
        "before": {
          "line": 85,
          "text": "* Resolve the BeatSystemConfig for a specific beat note by its Beat Model frontmatter value."
        },
        "current": {
          "line": 86,
          "text": "* Used by: SynopsisManager (hover), SearchService (indexing)."
        },
        "after": {
          "line": 87,
          "text": "* Falls back through: exact built-in match  active custom  saved custom name match  empty."
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 175,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Build the note body (description + optional placement). Shared by both paths.",
      "context": {
        "before": {
          "line": 174,
          "text": "/**"
        },
        "current": {
          "line": 175,
          "text": "* Build the note body (description + optional placement). Shared by both paths."
        },
        "after": {
          "line": 176,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 189,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "* @deprecated Use `getTemplateParts('Beat', settings).merged` from yamlTemplateNormalize.ts",
      "context": {
        "before": {
          "line": 188,
          "text": "* Returns the merged beat YAML string (base + properties)."
        },
        "current": {
          "line": 189,
          "text": "* @deprecated Use `getTemplateParts('Beat', settings).merged` from yamlTemplateNormalize.ts"
        },
        "after": {
          "line": 190,
          "text": "* which is the single source of truth for all note types."
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 190,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* which is the single source of truth for all note types.",
      "context": {
        "before": {
          "line": 189,
          "text": "* @deprecated Use `getTemplateParts('Beat', settings).merged` from yamlTemplateNormalize.ts"
        },
        "current": {
          "line": 190,
          "text": "* which is the single source of truth for all note types."
        },
        "after": {
          "line": 191,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 192,
      "token": "getMergedBeatYaml",
      "category": "drift-term",
      "lineText": "export function getMergedBeatYaml(settings: RadialTimelineSettings): string {",
      "context": {
        "before": {
          "line": 191,
          "text": "*/"
        },
        "current": {
          "line": 192,
          "text": "export function getMergedBeatYaml(settings: RadialTimelineSettings): string {"
        },
        "after": {
          "line": 193,
          "text": "const configuredBase = settings.beatYamlTemplates?.base ?? LEGACY_BEAT_BASE;"
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 198,
      "token": "mergeTemplates",
      "category": "drift-term",
      "lineText": "return mergeTemplates(base, advanced);",
      "context": {
        "before": {
          "line": 197,
          "text": "if (!advanced.trim()) return base;"
        },
        "current": {
          "line": 198,
          "text": "return mergeTemplates(base, advanced);"
        },
        "after": {
          "line": 199,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 226,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Generate Beat note content with frontmatter and body.",
      "context": {
        "before": {
          "line": 225,
          "text": "/**"
        },
        "current": {
          "line": 226,
          "text": "* Generate Beat note content with frontmatter and body."
        },
        "after": {
          "line": 227,
          "text": "* When a template string is provided, uses {{Placeholder}} substitution."
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 434,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Generate full note content with frontmatter and body",
      "context": {
        "before": {
          "line": 433,
          "text": ""
        },
        "current": {
          "line": 434,
          "text": "// Generate full note content with frontmatter and body"
        },
        "after": {
          "line": 435,
          "text": "const content = generatePlotNoteContent(beatInfo, act, beatModelName, options?.beatTemplate);"
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 439,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const message = `[BeatTemplates] Generated beat note without Beat Model: ${filename}`;",
      "context": {
        "before": {
          "line": 438,
          "text": "if (!hasBeatModel) {"
        },
        "current": {
          "line": 439,
          "text": "const message = `[BeatTemplates] Generated beat note without Beat Model: ${filename}`;"
        },
        "after": {
          "line": 440,
          "text": "console.warn(message);"
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 458,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "//  Deprecated aliases (remove after v5.2) ",
      "context": {
        "before": {
          "line": 457,
          "text": ""
        },
        "current": {
          "line": 458,
          "text": "//  Deprecated aliases (remove after v5.2) "
        },
        "after": {
          "line": 459,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 460,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Use getMergedBeatYaml */",
      "context": {
        "before": {
          "line": 459,
          "text": ""
        },
        "current": {
          "line": 460,
          "text": "/** @deprecated Use getMergedBeatYaml */"
        },
        "after": {
          "line": 461,
          "text": "export const getMergedBeatYamlTemplate = getMergedBeatYaml;"
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 460,
      "token": "getMergedBeatYaml",
      "category": "drift-term",
      "lineText": "/** @deprecated Use getMergedBeatYaml */",
      "context": {
        "before": {
          "line": 459,
          "text": ""
        },
        "current": {
          "line": 460,
          "text": "/** @deprecated Use getMergedBeatYaml */"
        },
        "after": {
          "line": 461,
          "text": "export const getMergedBeatYamlTemplate = getMergedBeatYaml;"
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 461,
      "token": "getMergedBeatYaml",
      "category": "drift-term",
      "lineText": "export const getMergedBeatYamlTemplate = getMergedBeatYaml;",
      "context": {
        "before": {
          "line": 460,
          "text": "/** @deprecated Use getMergedBeatYaml */"
        },
        "current": {
          "line": 461,
          "text": "export const getMergedBeatYamlTemplate = getMergedBeatYaml;"
        },
        "after": {
          "line": 462,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/utils/beatsTemplates.ts",
      "line": 463,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Use createBeatNotesFromSet */",
      "context": {
        "before": {
          "line": 462,
          "text": ""
        },
        "current": {
          "line": 463,
          "text": "/** @deprecated Use createBeatNotesFromSet */"
        },
        "after": {
          "line": 464,
          "text": "export const createBeatTemplateNotes = createBeatNotesFromSet;"
        }
      }
    },
    {
      "filePath": "src/utils/colour.ts",
      "line": 22,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "* - Plaid patterns for Working/Todo scenes (stroke color)",
      "context": {
        "before": {
          "line": 21,
          "text": "* - Gossamer dot colors"
        },
        "current": {
          "line": 22,
          "text": "* - Plaid patterns for Working/Todo scenes (stroke color)"
        },
        "after": {
          "line": 23,
          "text": "* - CSS custom property: --rt-max-publish-stage-color"
        }
      }
    },
    {
      "filePath": "src/utils/constants.ts",
      "line": 13,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "Todo: 'var(--rt-color-todo, #cccccc)',",
      "context": {
        "before": {
          "line": 12,
          "text": "Working: 'var(--rt-color-working, #FF69B4)',"
        },
        "current": {
          "line": 13,
          "text": "Todo: 'var(--rt-color-todo, #cccccc)',"
        },
        "after": {
          "line": 14,
          "text": "Empty: 'var(--rt-color-empty, #ffffff)',"
        }
      }
    },
    {
      "filePath": "src/utils/constants.ts",
      "line": 31,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "export const STATUSES_FOR_GRID = [\"Todo\", \"Working\", \"Due\", \"Completed\"] as const;",
      "context": {
        "before": {
          "line": 30,
          "text": "export const STAGES_FOR_GRID = [\"Zero\", \"Author\", \"House\", \"Press\"] as const;"
        },
        "current": {
          "line": 31,
          "text": "export const STATUSES_FOR_GRID = [\"Todo\", \"Working\", \"Due\", \"Completed\"] as const;"
        },
        "after": {
          "line": 32,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/utils/date.test.ts",
      "line": 154,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: JavaScript Date constructor is lenient with overflow values",
      "context": {
        "before": {
          "line": 153,
          "text": "expect(parseWhenField('not a date')).toBeNull();"
        },
        "current": {
          "line": 154,
          "text": "// Note: JavaScript Date constructor is lenient with overflow values"
        },
        "after": {
          "line": 155,
          "text": "// (2024/13/45 becomes 2025-02-14 due to rollover)"
        }
      }
    },
    {
      "filePath": "src/utils/date.ts",
      "line": 1072,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Special cases for noon and midnight (elegant, matches synopsis treatment)",
      "context": {
        "before": {
          "line": 1071,
          "text": ""
        },
        "current": {
          "line": 1072,
          "text": "// Special cases for noon and midnight (elegant, matches synopsis treatment)"
        },
        "after": {
          "line": 1073,
          "text": "if (hour === 12 && minute === 0) {"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 10,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "import * as fs from 'fs'; // SAFE: Node fs required for Pandoc temp files",
      "context": {
        "before": {
          "line": 9,
          "text": "import { execFile } from 'child_process'; // SAFE: Node child_process for Pandoc subprocess"
        },
        "current": {
          "line": 10,
          "text": "import * as fs from 'fs'; // SAFE: Node fs required for Pandoc temp files"
        },
        "after": {
          "line": 11,
          "text": "import * as os from 'os'; // SAFE: Node os required for temp directory resolution"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 11,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "import * as os from 'os'; // SAFE: Node os required for temp directory resolution",
      "context": {
        "before": {
          "line": 10,
          "text": "import * as fs from 'fs'; // SAFE: Node fs required for Pandoc temp files"
        },
        "current": {
          "line": 11,
          "text": "import * as os from 'os'; // SAFE: Node os required for temp directory resolution"
        },
        "after": {
          "line": 12,
          "text": "import * as path from 'path'; // SAFE: Node path required for temp/absolute paths"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 12,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "import * as path from 'path'; // SAFE: Node path required for temp/absolute paths",
      "context": {
        "before": {
          "line": 11,
          "text": "import * as os from 'os'; // SAFE: Node os required for temp directory resolution"
        },
        "current": {
          "line": 12,
          "text": "import * as path from 'path'; // SAFE: Node path required for temp/absolute paths"
        },
        "after": {
          "line": 13,
          "text": "import { formatRuntimeValue, RuntimeSettings } from './runtimeEstimator';"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 289,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "includeSynopsis = false,",
      "context": {
        "before": {
          "line": 288,
          "text": "preset: OutlinePreset,"
        },
        "current": {
          "line": 289,
          "text": "includeSynopsis = false,"
        },
        "after": {
          "line": 290,
          "text": "runtimeSettings?: RuntimeSettings"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 331,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const header = includeSynopsis",
      "context": {
        "before": {
          "line": 330,
          "text": "case 'index-cards-csv': {"
        },
        "current": {
          "line": 331,
          "text": "const header = includeSynopsis"
        },
        "after": {
          "line": 332,
          "text": "? ['Scene', 'Title', 'When', 'Subplot', 'Synopsis', 'Runtime', 'Words', 'Path']"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 332,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "? ['Scene', 'Title', 'When', 'Subplot', 'Synopsis', 'Runtime', 'Words', 'Path']",
      "context": {
        "before": {
          "line": 331,
          "text": "const header = includeSynopsis"
        },
        "current": {
          "line": 332,
          "text": "? ['Scene', 'Title', 'When', 'Subplot', 'Synopsis', 'Runtime', 'Words', 'Path']"
        },
        "after": {
          "line": 333,
          "text": ": ['Scene', 'Title', 'When', 'Subplot', 'Runtime', 'Words', 'Path'];"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 347,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (includeSynopsis) {",
      "context": {
        "before": {
          "line": 346,
          "text": "];"
        },
        "current": {
          "line": 347,
          "text": "if (includeSynopsis) {"
        },
        "after": {
          "line": 348,
          "text": "base.push(formatCsvValue(synopses[idx] || ''));"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 375,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (includeSynopsis) {",
      "context": {
        "before": {
          "line": 374,
          "text": "};"
        },
        "current": {
          "line": 375,
          "text": "if (includeSynopsis) {"
        },
        "after": {
          "line": 376,
          "text": "card.synopsis = synopses[idx] || null;"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 376,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "card.synopsis = synopses[idx] || null;",
      "context": {
        "before": {
          "line": 375,
          "text": "if (includeSynopsis) {"
        },
        "current": {
          "line": 376,
          "text": "card.synopsis = synopses[idx] || null;"
        },
        "after": {
          "line": 377,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 420,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (includeSynopsis && synopses[idx]) {",
      "context": {
        "before": {
          "line": 419,
          "text": "lines.push(`${sceneLabel}. ${title}${when}${rt}`);"
        },
        "current": {
          "line": 420,
          "text": "if (includeSynopsis && synopses[idx]) {"
        },
        "after": {
          "line": 421,
          "text": "lines.push(` > ${synopses[idx]}`);"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 428,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const header = includeSynopsis",
      "context": {
        "before": {
          "line": 427,
          "text": "case 'shooting-schedule': {"
        },
        "current": {
          "line": 428,
          "text": "const header = includeSynopsis"
        },
        "after": {
          "line": 429,
          "text": "? ['# Shooting schedule', '', '| Scene | Title | When | Subplot | Runtime | Synopsis |', '|-------|-------|------|---------|---------|----------|']"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 429,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "? ['# Shooting schedule', '', '| Scene | Title | When | Subplot | Runtime | Synopsis |', '|-------|-------|------|---------|---------|----------|']",
      "context": {
        "before": {
          "line": 428,
          "text": "const header = includeSynopsis"
        },
        "current": {
          "line": 429,
          "text": "? ['# Shooting schedule', '', '| Scene | Title | When | Subplot | Runtime | Synopsis |', '|-------|-------|------|---------|---------|----------|']"
        },
        "after": {
          "line": 430,
          "text": ": ['# Shooting schedule', '', '| Scene | Title | When | Subplot | Runtime |', '|-------|-------|------|---------|---------|'];"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 436,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (includeSynopsis) {",
      "context": {
        "before": {
          "line": 435,
          "text": ""
        },
        "current": {
          "line": 436,
          "text": "if (includeSynopsis) {"
        },
        "after": {
          "line": 437,
          "text": "const synopsis = (synopses[idx] || '').replace(/\\|/g, '\\\\|'); // Escape pipes for markdown table"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 437,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsis = (synopses[idx] || '').replace(/\\|/g, '\\\\|'); // Escape pipes for markdown table",
      "context": {
        "before": {
          "line": 436,
          "text": "if (includeSynopsis) {"
        },
        "current": {
          "line": 437,
          "text": "const synopsis = (synopses[idx] || '').replace(/\\|/g, '\\\\|'); // Escape pipes for markdown table"
        },
        "after": {
          "line": 438,
          "text": "lines.push(`| ${sceneLabel} | ${title} | ${whenDates[idx] || ''} | ${subplots[idx] || ''} | ${rt} | ${synopsis} |`);"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 438,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "lines.push(`| ${sceneLabel} | ${title} | ${whenDates[idx] || ''} | ${subplots[idx] || ''} | ${rt} | ${synopsis} |`);",
      "context": {
        "before": {
          "line": 437,
          "text": "const synopsis = (synopses[idx] || '').replace(/\\|/g, '\\\\|'); // Escape pipes for markdown table"
        },
        "current": {
          "line": 438,
          "text": "lines.push(`| ${sceneLabel} | ${title} | ${whenDates[idx] || ''} | ${subplots[idx] || ''} | ${rt} | ${synopsis} |`);"
        },
        "after": {
          "line": 439,
          "text": "} else {"
        }
      }
    },
    {
      "filePath": "src/utils/exportFormats.ts",
      "line": 474,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (includeSynopsis && synopses[idx]) {",
      "context": {
        "before": {
          "line": 473,
          "text": "lines.push(`${sceneLabel}. ${title}${wc}`);"
        },
        "current": {
          "line": 474,
          "text": "if (includeSynopsis && synopses[idx]) {"
        },
        "after": {
          "line": 475,
          "text": "lines.push(` > ${synopses[idx]}`);"
        }
      }
    },
    {
      "filePath": "src/utils/frontmatter.ts",
      "line": 41,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "'synopsis': 'Synopsis',",
      "context": {
        "before": {
          "line": 40,
          "text": "'status': 'Status',"
        },
        "current": {
          "line": 41,
          "text": "'synopsis': 'Synopsis',"
        },
        "after": {
          "line": 42,
          "text": "'context': 'Context',"
        }
      }
    },
    {
      "filePath": "src/utils/frontmatter.ts",
      "line": 56,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "'revision': 'Iteration', // Deprecated: \"Revision\" renamed to \"Iteration\"",
      "context": {
        "before": {
          "line": 55,
          "text": "'iterations': 'Iteration', // Legacy plural form maps to singular"
        },
        "current": {
          "line": 56,
          "text": "'revision': 'Iteration', // Deprecated: \"Revision\" renamed to \"Iteration\""
        },
        "after": {
          "line": 57,
          "text": "'pov': 'POV',"
        }
      }
    },
    {
      "filePath": "src/utils/gossamer.ts",
      "line": 293,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "notes: `Score from Beat note frontmatter (${fieldName}).`,",
      "context": {
        "before": {
          "line": 292,
          "text": "score: parsedScore,"
        },
        "current": {
          "line": 293,
          "text": "notes: `Score from Beat note frontmatter (${fieldName}).`,"
        },
        "after": {
          "line": 294,
          "text": "status: 'present' as const,"
        }
      }
    },
    {
      "filePath": "src/utils/gossamer.ts",
      "line": 364,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const beats: GossamerBeat[] = plotNotes.map(note => {",
      "context": {
        "before": {
          "line": 363,
          "text": ""
        },
        "current": {
          "line": 364,
          "text": "const beats: GossamerBeat[] = plotNotes.map(note => {"
        },
        "after": {
          "line": 365,
          "text": "const beatTitle = (note.title || '').replace(/^\\s*\\d+(?:\\.\\d+)?\\s+/, '').trim();"
        }
      }
    },
    {
      "filePath": "src/utils/gossamer.ts",
      "line": 365,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const beatTitle = (note.title || '').replace(/^\\s*\\d+(?:\\.\\d+)?\\s+/, '').trim();",
      "context": {
        "before": {
          "line": 364,
          "text": "const beats: GossamerBeat[] = plotNotes.map(note => {"
        },
        "current": {
          "line": 365,
          "text": "const beatTitle = (note.title || '').replace(/^\\s*\\d+(?:\\.\\d+)?\\s+/, '').trim();"
        },
        "after": {
          "line": 366,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/utils/gossamer.ts",
      "line": 373,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const val = note[`Gossamer${i}`];",
      "context": {
        "before": {
          "line": 372,
          "text": "for (let i = 30; i >= 1; i--) {"
        },
        "current": {
          "line": 373,
          "text": "const val = note[`Gossamer${i}`];"
        },
        "after": {
          "line": 374,
          "text": "if (val !== undefined && val !== null && typeof val === 'number') {"
        }
      }
    },
    {
      "filePath": "src/utils/gossamer.ts",
      "line": 384,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const rangeValue = note.Range;",
      "context": {
        "before": {
          "line": 383,
          "text": "let isOutOfRange = false;"
        },
        "current": {
          "line": 384,
          "text": "const rangeValue = note.Range;"
        },
        "after": {
          "line": 385,
          "text": "if (typeof rangeValue === 'string') {"
        }
      }
    },
    {
      "filePath": "src/utils/gossamer.ts",
      "line": 459,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Look for stage in any beat note - GossamerStage fields are in rawFrontmatter",
      "context": {
        "before": {
          "line": 458,
          "text": "const stageFieldName = `GossamerStage${runIndex}`;"
        },
        "current": {
          "line": 459,
          "text": "// Look for stage in any beat note - GossamerStage fields are in rawFrontmatter"
        },
        "after": {
          "line": 460,
          "text": "for (const scene of scenes) {"
        }
      }
    },
    {
      "filePath": "src/utils/manuscript.ts",
      "line": 96,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Returns null if the file is not a Frontmatter/Backmatter/Matter note or has no Matter: block.",
      "context": {
        "before": {
          "line": 95,
          "text": "* Extract matter metadata from raw file content by parsing its YAML frontmatter."
        },
        "current": {
          "line": 96,
          "text": "* Returns null if the file is not a Frontmatter/Backmatter/Matter note or has no Matter: block."
        },
        "after": {
          "line": 97,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/utils/manuscript.ts",
      "line": 405,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Prefer Synopsis, then scene.synopsis",
      "context": {
        "before": {
          "line": 404,
          "text": ""
        },
        "current": {
          "line": 405,
          "text": "// Prefer Synopsis, then scene.synopsis"
        },
        "after": {
          "line": 406,
          "text": "let synopsis: string | null = null;"
        }
      }
    },
    {
      "filePath": "src/utils/manuscript.ts",
      "line": 406,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "let synopsis: string | null = null;",
      "context": {
        "before": {
          "line": 405,
          "text": "// Prefer Synopsis, then scene.synopsis"
        },
        "current": {
          "line": 406,
          "text": "let synopsis: string | null = null;"
        },
        "after": {
          "line": 407,
          "text": "if (rf && typeof rf.Synopsis === 'string') synopsis = rf.Synopsis as string;"
        }
      }
    },
    {
      "filePath": "src/utils/manuscript.ts",
      "line": 407,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (rf && typeof rf.Synopsis === 'string') synopsis = rf.Synopsis as string;",
      "context": {
        "before": {
          "line": 406,
          "text": "let synopsis: string | null = null;"
        },
        "current": {
          "line": 407,
          "text": "if (rf && typeof rf.Synopsis === 'string') synopsis = rf.Synopsis as string;"
        },
        "after": {
          "line": 408,
          "text": "else if (scene.synopsis && scene.synopsis.trim().length > 0) synopsis = scene.synopsis;"
        }
      }
    },
    {
      "filePath": "src/utils/manuscript.ts",
      "line": 408,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "else if (scene.synopsis && scene.synopsis.trim().length > 0) synopsis = scene.synopsis;",
      "context": {
        "before": {
          "line": 407,
          "text": "if (rf && typeof rf.Synopsis === 'string') synopsis = rf.Synopsis as string;"
        },
        "current": {
          "line": 408,
          "text": "else if (scene.synopsis && scene.synopsis.trim().length > 0) synopsis = scene.synopsis;"
        },
        "after": {
          "line": 409,
          "text": "synopses.push(synopsis);"
        }
      }
    },
    {
      "filePath": "src/utils/manuscript.ts",
      "line": 409,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopses.push(synopsis);",
      "context": {
        "before": {
          "line": 408,
          "text": "else if (scene.synopsis && scene.synopsis.trim().length > 0) synopsis = scene.synopsis;"
        },
        "current": {
          "line": 409,
          "text": "synopses.push(synopsis);"
        },
        "after": {
          "line": 410,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/utils/manuscript.ts",
      "line": 526,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Add sort order note if provided",
      "context": {
        "before": {
          "line": 525,
          "text": ""
        },
        "current": {
          "line": 526,
          "text": "// Add sort order note if provided"
        },
        "after": {
          "line": 527,
          "text": "if (sortOrder) {"
        }
      }
    },
    {
      "filePath": "src/utils/manuscript.ts",
      "line": 609,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// If this file is a matter note with a semantic role, render via",
      "context": {
        "before": {
          "line": 608,
          "text": "//  Semantic matter role intercept "
        },
        "current": {
          "line": 609,
          "text": "// If this file is a matter note with a semantic role, render via"
        },
        "after": {
          "line": 610,
          "text": "// the appropriate template instead of the default heading + body."
        }
      }
    },
    {
      "filePath": "src/utils/rangeValidation.ts",
      "line": 6,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Parse a Range field from beat note frontmatter",
      "context": {
        "before": {
          "line": 5,
          "text": "/**"
        },
        "current": {
          "line": 6,
          "text": "* Parse a Range field from beat note frontmatter"
        },
        "after": {
          "line": 7,
          "text": "* Examples: \"0-20\", \"50\", \"71-90\""
        }
      }
    },
    {
      "filePath": "src/utils/sceneCreation.ts",
      "line": 17,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Build an initial scene filename for new note creation.",
      "context": {
        "before": {
          "line": 16,
          "text": "/**"
        },
        "current": {
          "line": 17,
          "text": "* Build an initial scene filename for new note creation."
        },
        "after": {
          "line": 18,
          "text": "* Returns just the filename (not the full path)."
        }
      }
    },
    {
      "filePath": "src/utils/sceneCreation.ts",
      "line": 25,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Build an initial backdrop filename for new note creation.",
      "context": {
        "before": {
          "line": 24,
          "text": "/**"
        },
        "current": {
          "line": 25,
          "text": "* Build an initial backdrop filename for new note creation."
        },
        "after": {
          "line": 26,
          "text": "* Returns just the filename (not the full path)."
        }
      }
    },
    {
      "filePath": "src/utils/sceneGenerator.ts",
      "line": 66,
      "token": "mergeTemplates",
      "category": "drift-term",
      "lineText": "export function mergeTemplates(baseTemplate: string, advancedFields: string): string {",
      "context": {
        "before": {
          "line": 65,
          "text": "*/"
        },
        "current": {
          "line": 66,
          "text": "export function mergeTemplates(baseTemplate: string, advancedFields: string): string {"
        },
        "after": {
          "line": 67,
          "text": "// Extract field names from base template"
        }
      }
    },
    {
      "filePath": "src/utils/sceneGenerator.ts",
      "line": 128,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Generates the content of a scene note by replacing placeholders in the template.",
      "context": {
        "before": {
          "line": 127,
          "text": "/**"
        },
        "current": {
          "line": 128,
          "text": "* Generates the content of a scene note by replacing placeholders in the template."
        },
        "after": {
          "line": 129,
          "text": "* @param template The template string with {{Placeholders}}"
        }
      }
    },
    {
      "filePath": "src/utils/sceneGenerator.ts",
      "line": 131,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* @returns The final note content",
      "context": {
        "before": {
          "line": 130,
          "text": "* @param data Data to populate the template"
        },
        "current": {
          "line": 131,
          "text": "* @returns The final note content"
        },
        "after": {
          "line": 132,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/utils/sceneHelpers.ts",
      "line": 46,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Check if a scene is a beat note (supports both new 'Beat' and legacy 'Plot' itemType)",
      "context": {
        "before": {
          "line": 45,
          "text": "/**"
        },
        "current": {
          "line": 46,
          "text": "* Check if a scene is a beat note (supports both new 'Beat' and legacy 'Plot' itemType)"
        },
        "after": {
          "line": 47,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/utils/sceneHelpers.ts",
      "line": 62,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Check if item is a front-matter or back-matter note (Class: Frontmatter / Backmatter).",
      "context": {
        "before": {
          "line": 61,
          "text": "/**"
        },
        "current": {
          "line": 62,
          "text": "* Check if item is a front-matter or back-matter note (Class: Frontmatter / Backmatter)."
        },
        "after": {
          "line": 63,
          "text": "* These are included in manuscript export but excluded from timeline stats."
        }
      }
    },
    {
      "filePath": "src/utils/sceneHelpers.ts",
      "line": 70,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Check if item is a BookMeta note (Class: BookMeta).",
      "context": {
        "before": {
          "line": 69,
          "text": "/**"
        },
        "current": {
          "line": 70,
          "text": "* Check if item is a BookMeta note (Class: BookMeta)."
        },
        "after": {
          "line": 71,
          "text": "* BookMeta notes are NOT included in the timeline or manuscript  they are"
        }
      }
    },
    {
      "filePath": "src/utils/sceneHelpers.ts",
      "line": 145,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisManager: { generateElement: (scene: TimelineItem, contentLines: string[], sceneId: string, subplotIndexResolver?: (name: string) => number) => SVGGElement };",
      "context": {
        "before": {
          "line": 144,
          "text": "} | null;"
        },
        "current": {
          "line": 145,
          "text": "synopsisManager: { generateElement: (scene: TimelineItem, contentLines: string[], sceneId: string, subplotIndexResolver?: (name: string) => number) => SVGGElement };"
        },
        "after": {
          "line": 146,
          "text": "latestStatusCounts?: Record<string, number>;"
        }
      }
    },
    {
      "filePath": "src/utils/sceneHelpers.ts",
      "line": 291,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Extract a numeric position from a scene or beat note for sorting",
      "context": {
        "before": {
          "line": 290,
          "text": "/**"
        },
        "current": {
          "line": 291,
          "text": "* Extract a numeric position from a scene or beat note for sorting"
        },
        "after": {
          "line": 292,
          "text": "* Returns the filename prefix number (e.g., \"01 Scene\"  1)"
        }
      }
    },
    {
      "filePath": "src/utils/synopsisLimits.ts",
      "line": 1,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export type SynopsisLimitSettings = {",
      "context": {
        "current": {
          "line": 1,
          "text": "export type SynopsisLimitSettings = {"
        },
        "after": {
          "line": 2,
          "text": "synopsisGenerationMaxWords?: number;"
        }
      }
    },
    {
      "filePath": "src/utils/synopsisLimits.ts",
      "line": 2,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisGenerationMaxWords?: number;",
      "context": {
        "before": {
          "line": 1,
          "text": "export type SynopsisLimitSettings = {"
        },
        "current": {
          "line": 2,
          "text": "synopsisGenerationMaxWords?: number;"
        },
        "after": {
          "line": 3,
          "text": "synopsisGenerationMaxLines?: number; // @deprecated legacy fallback"
        }
      }
    },
    {
      "filePath": "src/utils/synopsisLimits.ts",
      "line": 3,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "synopsisGenerationMaxLines?: number; // @deprecated legacy fallback",
      "context": {
        "before": {
          "line": 2,
          "text": "synopsisGenerationMaxWords?: number;"
        },
        "current": {
          "line": 3,
          "text": "synopsisGenerationMaxLines?: number; // @deprecated legacy fallback"
        },
        "after": {
          "line": 4,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/utils/synopsisLimits.ts",
      "line": 3,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisGenerationMaxLines?: number; // @deprecated legacy fallback",
      "context": {
        "before": {
          "line": 2,
          "text": "synopsisGenerationMaxWords?: number;"
        },
        "current": {
          "line": 3,
          "text": "synopsisGenerationMaxLines?: number; // @deprecated legacy fallback"
        },
        "after": {
          "line": 4,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/utils/synopsisLimits.ts",
      "line": 6,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export const DEFAULT_SYNOPSIS_MAX_WORDS = 30;",
      "context": {
        "before": {
          "line": 5,
          "text": ""
        },
        "current": {
          "line": 6,
          "text": "export const DEFAULT_SYNOPSIS_MAX_WORDS = 30;"
        },
        "after": {
          "line": 7,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/utils/synopsisLimits.ts",
      "line": 8,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function getSynopsisGenerationWordLimit(settings: SynopsisLimitSettings): number {",
      "context": {
        "before": {
          "line": 7,
          "text": ""
        },
        "current": {
          "line": 8,
          "text": "export function getSynopsisGenerationWordLimit(settings: SynopsisLimitSettings): number {"
        },
        "after": {
          "line": 9,
          "text": "const raw = settings.synopsisGenerationMaxWords"
        }
      }
    },
    {
      "filePath": "src/utils/synopsisLimits.ts",
      "line": 9,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const raw = settings.synopsisGenerationMaxWords",
      "context": {
        "before": {
          "line": 8,
          "text": "export function getSynopsisGenerationWordLimit(settings: SynopsisLimitSettings): number {"
        },
        "current": {
          "line": 9,
          "text": "const raw = settings.synopsisGenerationMaxWords"
        },
        "after": {
          "line": 10,
          "text": "?? ((settings.synopsisGenerationMaxLines ?? 3) * 10);"
        }
      }
    },
    {
      "filePath": "src/utils/synopsisLimits.ts",
      "line": 10,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "?? ((settings.synopsisGenerationMaxLines ?? 3) * 10);",
      "context": {
        "before": {
          "line": 9,
          "text": "const raw = settings.synopsisGenerationMaxWords"
        },
        "current": {
          "line": 10,
          "text": "?? ((settings.synopsisGenerationMaxLines ?? 3) * 10);"
        },
        "after": {
          "line": 11,
          "text": "const parsed = Number(raw);"
        }
      }
    },
    {
      "filePath": "src/utils/synopsisLimits.ts",
      "line": 12,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!Number.isFinite(parsed)) return DEFAULT_SYNOPSIS_MAX_WORDS;",
      "context": {
        "before": {
          "line": 11,
          "text": "const parsed = Number(raw);"
        },
        "current": {
          "line": 12,
          "text": "if (!Number.isFinite(parsed)) return DEFAULT_SYNOPSIS_MAX_WORDS;"
        },
        "after": {
          "line": 13,
          "text": "return Math.max(10, Math.min(300, Math.round(parsed)));"
        }
      }
    },
    {
      "filePath": "src/utils/synopsisLimits.ts",
      "line": 16,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function getSynopsisHoverLineLimit(settings: SynopsisLimitSettings): number {",
      "context": {
        "before": {
          "line": 15,
          "text": ""
        },
        "current": {
          "line": 16,
          "text": "export function getSynopsisHoverLineLimit(settings: SynopsisLimitSettings): number {"
        },
        "after": {
          "line": 17,
          "text": "// Keep hover compact while scaling with configured synopsis cap."
        }
      }
    },
    {
      "filePath": "src/utils/synopsisLimits.ts",
      "line": 17,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Keep hover compact while scaling with configured synopsis cap.",
      "context": {
        "before": {
          "line": 16,
          "text": "export function getSynopsisHoverLineLimit(settings: SynopsisLimitSettings): number {"
        },
        "current": {
          "line": 17,
          "text": "// Keep hover compact while scaling with configured synopsis cap."
        },
        "after": {
          "line": 18,
          "text": "const words = getSynopsisGenerationWordLimit(settings);"
        }
      }
    },
    {
      "filePath": "src/utils/synopsisLimits.ts",
      "line": 18,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const words = getSynopsisGenerationWordLimit(settings);",
      "context": {
        "before": {
          "line": 17,
          "text": "// Keep hover compact while scaling with configured synopsis cap."
        },
        "current": {
          "line": 18,
          "text": "const words = getSynopsisGenerationWordLimit(settings);"
        },
        "after": {
          "line": 19,
          "text": "return Math.max(3, Math.min(12, Math.ceil(words / 8) + 1));"
        }
      }
    },
    {
      "filePath": "src/utils/text.ts",
      "line": 329,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "export type NormalizedStatus = 'Todo' | 'Working' | 'Due' | 'Completed';",
      "context": {
        "before": {
          "line": 328,
          "text": ""
        },
        "current": {
          "line": 329,
          "text": "export type NormalizedStatus = 'Todo' | 'Working' | 'Due' | 'Completed';"
        },
        "after": {
          "line": 330,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/utils/text.ts",
      "line": 332,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "if (raw == null) return 'Todo';",
      "context": {
        "before": {
          "line": 331,
          "text": "export function normalizeStatus(raw: unknown): NormalizedStatus | null {"
        },
        "current": {
          "line": 332,
          "text": "if (raw == null) return 'Todo';"
        },
        "after": {
          "line": 333,
          "text": "const v = Array.isArray(raw) ? String(raw[0] ?? '').trim().toLowerCase() : String(raw).trim().toLowerCase();"
        }
      }
    },
    {
      "filePath": "src/utils/text.ts",
      "line": 334,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "if (!v) return 'Todo';",
      "context": {
        "before": {
          "line": 333,
          "text": "const v = Array.isArray(raw) ? String(raw[0] ?? '').trim().toLowerCase() : String(raw).trim().toLowerCase();"
        },
        "current": {
          "line": 334,
          "text": "if (!v) return 'Todo';"
        },
        "after": {
          "line": 335,
          "text": "if (v === 'complete' || v === 'done' || v === 'completed') return 'Completed';"
        }
      }
    },
    {
      "filePath": "src/utils/text.ts",
      "line": 337,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "if (v === 'todo' || v === 'to do' || v === 'tbd') return 'Todo';",
      "context": {
        "before": {
          "line": 336,
          "text": "if (v === 'working' || v === 'in progress' || v === 'progress') return 'Working';"
        },
        "current": {
          "line": 337,
          "text": "if (v === 'todo' || v === 'to do' || v === 'tbd') return 'Todo';"
        },
        "after": {
          "line": 338,
          "text": "return null; // let caller decide Due based on date, or default"
        }
      }
    },
    {
      "filePath": "src/utils/text.ts",
      "line": 389,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Used for display-only truncation (e.g., hover synopsis preview).",
      "context": {
        "before": {
          "line": 388,
          "text": "* Truncate text to a maximum word count, adding ellipsis if truncated."
        },
        "current": {
          "line": 389,
          "text": "* Used for display-only truncation (e.g., hover synopsis preview)."
        },
        "after": {
          "line": 390,
          "text": "* @param text - The text to truncate"
        }
      }
    },
    {
      "filePath": "src/utils/tooltip.ts",
      "line": 16,
      "token": "HACK",
      "category": "stale-comment",
      "lineText": "* and the previous hack of creating anchor elements caused modal focus issues.",
      "context": {
        "before": {
          "line": 15,
          "text": "* because Obsidian's API relies on getBoundingClientRect() which can be flaky with SVG transforms,"
        },
        "current": {
          "line": 16,
          "text": "* and the previous hack of creating anchor elements caused modal focus issues."
        },
        "after": {
          "line": 17,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 4,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Compares note frontmatter against template-defined base + custom keys",
      "context": {
        "before": {
          "line": 3,
          "text": "*"
        },
        "current": {
          "line": 4,
          "text": "* Compares note frontmatter against template-defined base + custom keys"
        },
        "after": {
          "line": 5,
          "text": "* and reports schema drift: missing fields, extra keys, and cosmetic order drift."
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 48,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "/** Only counted when missingFields.length === 0 for a note. */",
      "context": {
        "before": {
          "line": 47,
          "text": "notesWithExtra: number;"
        },
        "current": {
          "line": 48,
          "text": "/** Only counted when missingFields.length === 0 for a note. */"
        },
        "after": {
          "line": 49,
          "text": "notesWithDrift: number;"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 74,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const SCENE_SYNOPSIS_SOFT_CHAR_LIMIT = 500;",
      "context": {
        "before": {
          "line": 73,
          "text": ""
        },
        "current": {
          "line": 74,
          "text": "const SCENE_SYNOPSIS_SOFT_CHAR_LIMIT = 500;"
        },
        "after": {
          "line": 75,
          "text": "const SCENE_SYNOPSIS_SOFT_SENTENCE_LIMIT = 3;"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 75,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const SCENE_SYNOPSIS_SOFT_SENTENCE_LIMIT = 3;",
      "context": {
        "before": {
          "line": 74,
          "text": "const SCENE_SYNOPSIS_SOFT_CHAR_LIMIT = 500;"
        },
        "current": {
          "line": 75,
          "text": "const SCENE_SYNOPSIS_SOFT_SENTENCE_LIMIT = 3;"
        },
        "after": {
          "line": 76,
          "text": "const BEAT_PURPOSE_SOFT_MAX_LINES = 3;"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 135,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsis = getStringField(fm, 'Synopsis');",
      "context": {
        "before": {
          "line": 134,
          "text": "if (noteType === 'Scene') {"
        },
        "current": {
          "line": 135,
          "text": "const synopsis = getStringField(fm, 'Synopsis');"
        },
        "after": {
          "line": 136,
          "text": "if (synopsis) {"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 136,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (synopsis) {",
      "context": {
        "before": {
          "line": 135,
          "text": "const synopsis = getStringField(fm, 'Synopsis');"
        },
        "current": {
          "line": 136,
          "text": "if (synopsis) {"
        },
        "after": {
          "line": 137,
          "text": "if (synopsis.length > SCENE_SYNOPSIS_SOFT_CHAR_LIMIT) {"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 137,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (synopsis.length > SCENE_SYNOPSIS_SOFT_CHAR_LIMIT) {",
      "context": {
        "before": {
          "line": 136,
          "text": "if (synopsis) {"
        },
        "current": {
          "line": 137,
          "text": "if (synopsis.length > SCENE_SYNOPSIS_SOFT_CHAR_LIMIT) {"
        },
        "after": {
          "line": 138,
          "text": "warnings.push(`Scene Synopsis is ${synopsis.length} chars (soft limit ${SCENE_SYNOPSIS_SOFT_CHAR_LIMIT}).`);"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 138,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "warnings.push(`Scene Synopsis is ${synopsis.length} chars (soft limit ${SCENE_SYNOPSIS_SOFT_CHAR_LIMIT}).`);",
      "context": {
        "before": {
          "line": 137,
          "text": "if (synopsis.length > SCENE_SYNOPSIS_SOFT_CHAR_LIMIT) {"
        },
        "current": {
          "line": 138,
          "text": "warnings.push(`Scene Synopsis is ${synopsis.length} chars (soft limit ${SCENE_SYNOPSIS_SOFT_CHAR_LIMIT}).`);"
        },
        "after": {
          "line": 139,
          "text": "} else {"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 140,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const sentenceCount = countSentences(synopsis);",
      "context": {
        "before": {
          "line": 139,
          "text": "} else {"
        },
        "current": {
          "line": 140,
          "text": "const sentenceCount = countSentences(synopsis);"
        },
        "after": {
          "line": 141,
          "text": "if (sentenceCount > SCENE_SYNOPSIS_SOFT_SENTENCE_LIMIT) {"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 141,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (sentenceCount > SCENE_SYNOPSIS_SOFT_SENTENCE_LIMIT) {",
      "context": {
        "before": {
          "line": 140,
          "text": "const sentenceCount = countSentences(synopsis);"
        },
        "current": {
          "line": 141,
          "text": "if (sentenceCount > SCENE_SYNOPSIS_SOFT_SENTENCE_LIMIT) {"
        },
        "after": {
          "line": 142,
          "text": "warnings.push(`Scene Synopsis has ${sentenceCount} sentences (target is 1-${SCENE_SYNOPSIS_SOFT_SENTENCE_LIMIT}).`);"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 142,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "warnings.push(`Scene Synopsis has ${sentenceCount} sentences (target is 1-${SCENE_SYNOPSIS_SOFT_SENTENCE_LIMIT}).`);",
      "context": {
        "before": {
          "line": 141,
          "text": "if (sentenceCount > SCENE_SYNOPSIS_SOFT_SENTENCE_LIMIT) {"
        },
        "current": {
          "line": 142,
          "text": "warnings.push(`Scene Synopsis has ${sentenceCount} sentences (target is 1-${SCENE_SYNOPSIS_SOFT_SENTENCE_LIMIT}).`);"
        },
        "after": {
          "line": 143,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 164,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const context = getStringField(fm, 'Context') ?? getStringField(fm, 'Synopsis');",
      "context": {
        "before": {
          "line": 163,
          "text": "if (noteType === 'Backdrop') {"
        },
        "current": {
          "line": 164,
          "text": "const context = getStringField(fm, 'Context') ?? getStringField(fm, 'Synopsis');"
        },
        "after": {
          "line": 165,
          "text": "if (getStringField(fm, 'Synopsis') && !getStringField(fm, 'Context')) {"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 165,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (getStringField(fm, 'Synopsis') && !getStringField(fm, 'Context')) {",
      "context": {
        "before": {
          "line": 164,
          "text": "const context = getStringField(fm, 'Context') ?? getStringField(fm, 'Synopsis');"
        },
        "current": {
          "line": 165,
          "text": "if (getStringField(fm, 'Synopsis') && !getStringField(fm, 'Context')) {"
        },
        "after": {
          "line": 166,
          "text": "warnings.push('Legacy \"Synopsis\" detected; migrate to \"Context\" (non-destructive, optional cleanup).');"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 166,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "warnings.push('Legacy \"Synopsis\" detected; migrate to \"Context\" (non-destructive, optional cleanup).');",
      "context": {
        "before": {
          "line": 165,
          "text": "if (getStringField(fm, 'Synopsis') && !getStringField(fm, 'Context')) {"
        },
        "current": {
          "line": 166,
          "text": "warnings.push('Legacy \"Synopsis\" detected; migrate to \"Context\" (non-destructive, optional cleanup).');"
        },
        "after": {
          "line": 167,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 188,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Determine whether the order of `presentKeys` (as they appear in the note)",
      "context": {
        "before": {
          "line": 187,
          "text": "/**"
        },
        "current": {
          "line": 188,
          "text": "* Determine whether the order of `presentKeys` (as they appear in the note)"
        },
        "after": {
          "line": 189,
          "text": "* matches the subsequence they would occupy in `canonicalOrder`."
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 286,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Get the keys actually present in the note's frontmatter",
      "context": {
        "before": {
          "line": 285,
          "text": ""
        },
        "current": {
          "line": 286,
          "text": "// Get the keys actually present in the note's frontmatter"
        },
        "after": {
          "line": 287,
          "text": "const noteKeys = Object.keys(fm).filter(k => k !== 'position'); // Obsidian injects 'position'"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 289,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Missing: template keys not present in note",
      "context": {
        "before": {
          "line": 288,
          "text": ""
        },
        "current": {
          "line": 289,
          "text": "// Missing: template keys not present in note"
        },
        "after": {
          "line": 290,
          "text": "const missingFields = [...allTemplateKeys].filter(k => !noteKeys.includes(k));"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 292,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Extra: note keys not in any template and not excluded",
      "context": {
        "before": {
          "line": 291,
          "text": ""
        },
        "current": {
          "line": 292,
          "text": "// Extra: note keys not in any template and not excluded"
        },
        "after": {
          "line": 293,
          "text": "const extraKeys = noteKeys.filter(k =>"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 326,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Clean note  don't add to results",
      "context": {
        "before": {
          "line": 325,
          "text": "if (!hasSchemaIssues && !hasSafetyIssues) {"
        },
        "current": {
          "line": 326,
          "text": "// Clean note  don't add to results"
        },
        "after": {
          "line": 327,
          "text": "continue;"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 369,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Collect vault files matching a note type, scoped to the active book folder.",
      "context": {
        "before": {
          "line": 368,
          "text": "/**"
        },
        "current": {
          "line": 369,
          "text": "* Collect vault files matching a note type, scoped to the active book folder."
        },
        "after": {
          "line": 370,
          "text": "* Uses metadataCache for fast classification (no file I/O)."
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 441,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "lines.push(`Missing fields: ${s.notesWithMissing} note(s)`);",
      "context": {
        "before": {
          "line": 440,
          "text": "lines.push(`Clean: ${s.clean}`);"
        },
        "current": {
          "line": 441,
          "text": "lines.push(`Missing fields: ${s.notesWithMissing} note(s)`);"
        },
        "after": {
          "line": 442,
          "text": "lines.push(`Extra keys: ${s.notesWithExtra} note(s)`);"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 442,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "lines.push(`Extra keys: ${s.notesWithExtra} note(s)`);",
      "context": {
        "before": {
          "line": 441,
          "text": "lines.push(`Missing fields: ${s.notesWithMissing} note(s)`);"
        },
        "current": {
          "line": 442,
          "text": "lines.push(`Extra keys: ${s.notesWithExtra} note(s)`);"
        },
        "after": {
          "line": 443,
          "text": "lines.push(`Order drift: ${s.notesWithDrift} note(s)`);"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 443,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "lines.push(`Order drift: ${s.notesWithDrift} note(s)`);",
      "context": {
        "before": {
          "line": 442,
          "text": "lines.push(`Extra keys: ${s.notesWithExtra} note(s)`);"
        },
        "current": {
          "line": 443,
          "text": "lines.push(`Order drift: ${s.notesWithDrift} note(s)`);"
        },
        "after": {
          "line": 444,
          "text": "lines.push(`Warnings: ${s.notesWithWarnings} note(s)`);"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 444,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "lines.push(`Warnings: ${s.notesWithWarnings} note(s)`);",
      "context": {
        "before": {
          "line": 443,
          "text": "lines.push(`Order drift: ${s.notesWithDrift} note(s)`);"
        },
        "current": {
          "line": 444,
          "text": "lines.push(`Warnings: ${s.notesWithWarnings} note(s)`);"
        },
        "after": {
          "line": 445,
          "text": "if (s.notesUnsafe > 0) {"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 446,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "lines.push(`Unsafe: ${s.notesUnsafe} note(s)`);",
      "context": {
        "before": {
          "line": 445,
          "text": "if (s.notesUnsafe > 0) {"
        },
        "current": {
          "line": 446,
          "text": "lines.push(`Unsafe: ${s.notesUnsafe} note(s)`);"
        },
        "after": {
          "line": 447,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 449,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "lines.push(`Suspicious: ${s.notesSuspicious} note(s)`);",
      "context": {
        "before": {
          "line": 448,
          "text": "if (s.notesSuspicious > 0) {"
        },
        "current": {
          "line": 449,
          "text": "lines.push(`Suspicious: ${s.notesSuspicious} note(s)`);"
        },
        "after": {
          "line": 450,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/utils/yamlAudit.ts",
      "line": 452,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "lines.push(`Unread (stale): ${s.unreadNotes} note(s)`);",
      "context": {
        "before": {
          "line": 451,
          "text": "if (s.unreadNotes > 0) {"
        },
        "current": {
          "line": 452,
          "text": "lines.push(`Unread (stale): ${s.unreadNotes} note(s)`);"
        },
        "after": {
          "line": 453,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 12,
      "token": "mergeTemplates",
      "category": "drift-term",
      "lineText": "import { mergeTemplates } from './sceneGenerator';",
      "context": {
        "before": {
          "line": 11,
          "text": "import { getBeatConfigForSystem, sanitizeBeatAdvancedForWrite } from './beatsTemplates';"
        },
        "current": {
          "line": 12,
          "text": "import { mergeTemplates } from './sceneGenerator';"
        },
        "after": {
          "line": 13,
          "text": "import { DEFAULT_SETTINGS } from '../settings/defaults';"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 18,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Use FieldEntryValue */",
      "context": {
        "before": {
          "line": 17,
          "text": "export type FieldEntryValue = string | string[];"
        },
        "current": {
          "line": 18,
          "text": "/** @deprecated Use FieldEntryValue */"
        },
        "after": {
          "line": 19,
          "text": "export type TemplateEntryValue = FieldEntryValue;"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 91,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "/** Resolved template strings for a note type. */",
      "context": {
        "before": {
          "line": 90,
          "text": ""
        },
        "current": {
          "line": 91,
          "text": "/** Resolved template strings for a note type. */"
        },
        "after": {
          "line": 92,
          "text": "export interface TemplateParts {"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 97,
      "token": "mergeTemplates",
      "category": "drift-term",
      "lineText": "/** Fully merged template string (base + advanced, via `mergeTemplates`). */",
      "context": {
        "before": {
          "line": 96,
          "text": "advanced: string;"
        },
        "current": {
          "line": 97,
          "text": "/** Fully merged template string (base + advanced, via `mergeTemplates`). */"
        },
        "after": {
          "line": 98,
          "text": "merged: string;"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 102,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Resolve the base, advanced, and merged template strings for a note type.",
      "context": {
        "before": {
          "line": 101,
          "text": "/**"
        },
        "current": {
          "line": 102,
          "text": "* Resolve the base, advanced, and merged template strings for a note type."
        },
        "after": {
          "line": 103,
          "text": "*"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 121,
      "token": "mergeTemplates",
      "category": "drift-term",
      "lineText": "? mergeTemplates(base, advanced)",
      "context": {
        "before": {
          "line": 120,
          "text": "const merged = advanced.trim()"
        },
        "current": {
          "line": 121,
          "text": "? mergeTemplates(base, advanced)"
        },
        "after": {
          "line": 122,
          "text": ": base;"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 132,
      "token": "mergeTemplates",
      "category": "drift-term",
      "lineText": "? mergeTemplates(base, advanced)",
      "context": {
        "before": {
          "line": 131,
          "text": "const merged = advanced.trim()"
        },
        "current": {
          "line": 132,
          "text": "? mergeTemplates(base, advanced)"
        },
        "after": {
          "line": 133,
          "text": ": base;"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 142,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// Filter deprecated Synopsis from advanced writes",
      "context": {
        "before": {
          "line": 141,
          "text": "const advancedRaw = templates?.advanced ?? '';"
        },
        "current": {
          "line": 142,
          "text": "// Filter deprecated Synopsis from advanced writes"
        },
        "after": {
          "line": 143,
          "text": "const advanced = filterDeprecatedBackdropKeys(advancedRaw);"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 142,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Filter deprecated Synopsis from advanced writes",
      "context": {
        "before": {
          "line": 141,
          "text": "const advancedRaw = templates?.advanced ?? '';"
        },
        "current": {
          "line": 142,
          "text": "// Filter deprecated Synopsis from advanced writes"
        },
        "after": {
          "line": 143,
          "text": "const advanced = filterDeprecatedBackdropKeys(advancedRaw);"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 145,
      "token": "mergeTemplates",
      "category": "drift-term",
      "lineText": "? mergeTemplates(base, advanced)",
      "context": {
        "before": {
          "line": 144,
          "text": "const merged = advanced.trim()"
        },
        "current": {
          "line": 145,
          "text": "? mergeTemplates(base, advanced)"
        },
        "after": {
          "line": 146,
          "text": ": base;"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 153,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Return the fully merged template string for a note type.",
      "context": {
        "before": {
          "line": 152,
          "text": "/**"
        },
        "current": {
          "line": 153,
          "text": "* Return the fully merged template string for a note type."
        },
        "after": {
          "line": 154,
          "text": "* Convenience wrapper around `getTemplateParts().merged`."
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 164,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** Filter deprecated keys (Synopsis) from backdrop advanced templates. */",
      "context": {
        "before": {
          "line": 163,
          "text": ""
        },
        "current": {
          "line": 164,
          "text": "/** Filter deprecated keys (Synopsis) from backdrop advanced templates. */"
        },
        "after": {
          "line": 165,
          "text": "function filterDeprecatedBackdropKeys(advancedRaw: string): string {"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 164,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "/** Filter deprecated keys (Synopsis) from backdrop advanced templates. */",
      "context": {
        "before": {
          "line": 163,
          "text": ""
        },
        "current": {
          "line": 164,
          "text": "/** Filter deprecated keys (Synopsis) from backdrop advanced templates. */"
        },
        "after": {
          "line": 165,
          "text": "function filterDeprecatedBackdropKeys(advancedRaw: string): string {"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 173,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (fieldName === 'Synopsis') {",
      "context": {
        "before": {
          "line": 172,
          "text": "const fieldName = fieldMatch[1].trim();"
        },
        "current": {
          "line": 173,
          "text": "if (fieldName === 'Synopsis') {"
        },
        "after": {
          "line": 174,
          "text": "skipUntilNextField = true;"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 187,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "//  High-level per-note-type helpers ",
      "context": {
        "before": {
          "line": 186,
          "text": ""
        },
        "current": {
          "line": 187,
          "text": "//  High-level per-note-type helpers "
        },
        "after": {
          "line": 188,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 190,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Return the base template keys for a given note type.",
      "context": {
        "before": {
          "line": 189,
          "text": "/**"
        },
        "current": {
          "line": 190,
          "text": "* Return the base template keys for a given note type."
        },
        "after": {
          "line": 191,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 197,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Return the custom/advanced template keys for a given note type,",
      "context": {
        "before": {
          "line": 196,
          "text": "/**"
        },
        "current": {
          "line": 197,
          "text": "* Return the custom/advanced template keys for a given note type,"
        },
        "after": {
          "line": 198,
          "text": "* filtering out any base keys."
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 212,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Compute the canonical key order for a note type.",
      "context": {
        "before": {
          "line": 211,
          "text": "/**"
        },
        "current": {
          "line": 212,
          "text": "* Compute the canonical key order for a note type."
        },
        "after": {
          "line": 213,
          "text": "*"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 215,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* exact merged template that note-creation paths produce.",
      "context": {
        "before": {
          "line": 214,
          "text": "* Delegates to `getTemplateParts().merged` so the order mirrors the"
        },
        "current": {
          "line": 215,
          "text": "* exact merged template that note-creation paths produce."
        },
        "after": {
          "line": 216,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 254,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Returns a predicate that identifies \"known dynamic\" keys for a note type ",
      "context": {
        "before": {
          "line": 253,
          "text": "/**"
        },
        "current": {
          "line": 254,
          "text": "* Returns a predicate that identifies \"known dynamic\" keys for a note type "
        },
        "after": {
          "line": 255,
          "text": "* keys that may appear in frontmatter but are NOT part of the base or custom"
        }
      }
    },
    {
      "filePath": "src/utils/yamlTemplateNormalize.ts",
      "line": 297,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (key === 'Synopsis') return true;",
      "context": {
        "before": {
          "line": 296,
          "text": "// Legacy backdrop narrative field (renamed to Context)"
        },
        "current": {
          "line": 297,
          "text": "if (key === 'Synopsis') return true;"
        },
        "after": {
          "line": 298,
          "text": "// Obsidian-internal keys"
        }
      }
    },
    {
      "filePath": "src/ui/classes.ts",
      "line": 37,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "FIELD_NOTE: 'ert-field-note',",
      "context": {
        "before": {
          "line": 36,
          "text": "SKIN_PRO: 'ert-skin--pro',"
        },
        "current": {
          "line": 37,
          "text": "FIELD_NOTE: 'ert-field-note',"
        },
        "after": {
          "line": 38,
          "text": "TOGGLE_ITEM: 'ert-toggle-item',"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 86,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "enabled: boolean; // Show in hover synopsis",
      "context": {
        "before": {
          "line": 85,
          "text": "icon: string; // Lucide icon name"
        },
        "current": {
          "line": 86,
          "text": "enabled: boolean; // Show in hover synopsis"
        },
        "after": {
          "line": 87,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 97,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "export type AuthorProgressPublishTarget = 'folder' | 'github_pages' | 'note';",
      "context": {
        "before": {
          "line": 96,
          "text": ""
        },
        "current": {
          "line": 97,
          "text": "export type AuthorProgressPublishTarget = 'folder' | 'github_pages' | 'note';"
        },
        "after": {
          "line": 98,
          "text": "export type AuthorProgressFrequency = 'manual' | 'daily' | 'weekly' | 'monthly';"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 104,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "customNoteTemplatePath?: string; // Path to custom note template (Pro feature)",
      "context": {
        "before": {
          "line": 103,
          "text": "defaultPublishTarget: AuthorProgressPublishTarget;"
        },
        "current": {
          "line": 104,
          "text": "customNoteTemplatePath?: string; // Path to custom note template (Pro feature)"
        },
        "after": {
          "line": 105,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 336,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Legacy toggle. Book title now comes from BookProfile. Kept for migration. */",
      "context": {
        "before": {
          "line": 335,
          "text": "sourcePath: string;"
        },
        "current": {
          "line": 336,
          "text": "/** @deprecated Legacy toggle. Book title now comes from BookProfile. Kept for migration. */"
        },
        "after": {
          "line": 337,
          "text": "showSourcePathAsTitle?: boolean;"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 398,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "synopsisHoverMaxLines?: number; // @deprecated Legacy hover line limit, now derived from Synopsis max words",
      "context": {
        "before": {
          "line": 397,
          "text": "enableManuscriptRippleRename?: boolean;"
        },
        "current": {
          "line": 398,
          "text": "synopsisHoverMaxLines?: number; // @deprecated Legacy hover line limit, now derived from Synopsis max words"
        },
        "after": {
          "line": 399,
          "text": "enableHoverDebugLogging?: boolean;"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 398,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisHoverMaxLines?: number; // @deprecated Legacy hover line limit, now derived from Synopsis max words",
      "context": {
        "before": {
          "line": 397,
          "text": "enableManuscriptRippleRename?: boolean;"
        },
        "current": {
          "line": 398,
          "text": "synopsisHoverMaxLines?: number; // @deprecated Legacy hover line limit, now derived from Synopsis max words"
        },
        "after": {
          "line": 399,
          "text": "enableHoverDebugLogging?: boolean;"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 417,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Synopsis generation settings (legacy names  now control Summary generation)",
      "context": {
        "before": {
          "line": 416,
          "text": "lastSeenReleaseNotesVersion?: string;"
        },
        "current": {
          "line": 417,
          "text": "// Synopsis generation settings (legacy names  now control Summary generation)"
        },
        "after": {
          "line": 418,
          "text": "synopsisTargetWords?: number; // Target word count for AI-generated summaries (default: 200)"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 418,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisTargetWords?: number; // Target word count for AI-generated summaries (default: 200)",
      "context": {
        "before": {
          "line": 417,
          "text": "// Synopsis generation settings (legacy names  now control Summary generation)"
        },
        "current": {
          "line": 418,
          "text": "synopsisTargetWords?: number; // Target word count for AI-generated summaries (default: 200)"
        },
        "after": {
          "line": 419,
          "text": "synopsisWeakThreshold?: number; // Word count below which a summary is considered \"weak\" (default: 75)"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 419,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisWeakThreshold?: number; // Word count below which a summary is considered \"weak\" (default: 75)",
      "context": {
        "before": {
          "line": 418,
          "text": "synopsisTargetWords?: number; // Target word count for AI-generated summaries (default: 200)"
        },
        "current": {
          "line": 419,
          "text": "synopsisWeakThreshold?: number; // Word count below which a summary is considered \"weak\" (default: 75)"
        },
        "after": {
          "line": 420,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 421,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Summary & Synopsis generation settings",
      "context": {
        "before": {
          "line": 420,
          "text": ""
        },
        "current": {
          "line": 421,
          "text": "// Summary & Synopsis generation settings"
        },
        "after": {
          "line": 422,
          "text": "alsoUpdateSynopsis?: boolean; // When running Summary refresh, also generate Synopsis (default: false)"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 422,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "alsoUpdateSynopsis?: boolean; // When running Summary refresh, also generate Synopsis (default: false)",
      "context": {
        "before": {
          "line": 421,
          "text": "// Summary & Synopsis generation settings"
        },
        "current": {
          "line": 422,
          "text": "alsoUpdateSynopsis?: boolean; // When running Summary refresh, also generate Synopsis (default: false)"
        },
        "after": {
          "line": 423,
          "text": "synopsisGenerationMaxWords?: number; // Max words for AI-generated Synopsis (default: 30)"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 423,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisGenerationMaxWords?: number; // Max words for AI-generated Synopsis (default: 30)",
      "context": {
        "before": {
          "line": 422,
          "text": "alsoUpdateSynopsis?: boolean; // When running Summary refresh, also generate Synopsis (default: false)"
        },
        "current": {
          "line": 423,
          "text": "synopsisGenerationMaxWords?: number; // Max words for AI-generated Synopsis (default: 30)"
        },
        "after": {
          "line": 424,
          "text": "synopsisGenerationMaxLines?: number; // @deprecated Legacy line-based synopsis limiter"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 424,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "synopsisGenerationMaxLines?: number; // @deprecated Legacy line-based synopsis limiter",
      "context": {
        "before": {
          "line": 423,
          "text": "synopsisGenerationMaxWords?: number; // Max words for AI-generated Synopsis (default: 30)"
        },
        "current": {
          "line": 424,
          "text": "synopsisGenerationMaxLines?: number; // @deprecated Legacy line-based synopsis limiter"
        },
        "after": {
          "line": 425,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 424,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisGenerationMaxLines?: number; // @deprecated Legacy line-based synopsis limiter",
      "context": {
        "before": {
          "line": 423,
          "text": "synopsisGenerationMaxWords?: number; // Max words for AI-generated Synopsis (default: 30)"
        },
        "current": {
          "line": 424,
          "text": "synopsisGenerationMaxLines?: number; // @deprecated Legacy line-based synopsis limiter"
        },
        "after": {
          "line": 425,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 427,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "aiUpdateTimestamps?: Record<string, { synopsisUpdated?: string; summaryUpdated?: string }>",
      "context": {
        "before": {
          "line": 426,
          "text": "// Internal AI update timestamps (per-scene, keyed by file path)"
        },
        "current": {
          "line": 427,
          "text": "aiUpdateTimestamps?: Record<string, { synopsisUpdated?: string; summaryUpdated?: string }>"
        },
        "after": {
          "line": 428,
          "text": "cachedReleaseNotes?: EmbeddedReleaseNotesBundle | null;"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 441,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Use backdropYamlTemplates instead. Kept for migration. */",
      "context": {
        "before": {
          "line": 440,
          "text": "bookDesignerTemplates?: BookDesignerTemplate[];"
        },
        "current": {
          "line": 441,
          "text": "/** @deprecated Use backdropYamlTemplates instead. Kept for migration. */"
        },
        "after": {
          "line": 442,
          "text": "backdropYamlTemplate?: string;"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 457,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// Legacy beat YAML fields  deprecated, migrated into beatSystemConfigs on load",
      "context": {
        "before": {
          "line": 456,
          "text": "activeCustomBeatSystemId?: string; // Which custom system is active (default: 'default')"
        },
        "current": {
          "line": 457,
          "text": "// Legacy beat YAML fields  deprecated, migrated into beatSystemConfigs on load"
        },
        "after": {
          "line": 458,
          "text": "beatYamlTemplates?: {"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 491,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Migrated to BookProfile.lastUsedPandocLayoutByPreset. Kept for one migration cycle. */",
      "context": {
        "before": {
          "line": 490,
          "text": "pandocLayouts?: PandocLayoutTemplate[];"
        },
        "current": {
          "line": 491,
          "text": "/** @deprecated Migrated to BookProfile.lastUsedPandocLayoutByPreset. Kept for one migration cycle. */"
        },
        "after": {
          "line": 492,
          "text": "lastUsedPandocLayoutByPreset?: Record<string, string>;"
        }
      }
    },
    {
      "filePath": "src/types/settings.ts",
      "line": 494,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Migrated to pandocLayouts on load. Kept for one release cycle. */",
      "context": {
        "before": {
          "line": 493,
          "text": ""
        },
        "current": {
          "line": 494,
          "text": "/** @deprecated Migrated to pandocLayouts on load. Kept for one release cycle. */"
        },
        "after": {
          "line": 495,
          "text": "pandocTemplates?: {"
        }
      }
    },
    {
      "filePath": "src/types/timeline.ts",
      "line": 7,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Exactly one BookMeta note per manuscript.",
      "context": {
        "before": {
          "line": 6,
          "text": "* Central metadata for a book/manuscript."
        },
        "current": {
          "line": 7,
          "text": "* Exactly one BookMeta note per manuscript."
        },
        "after": {
          "line": 8,
          "text": "* Parsed from a note with Class: BookMeta."
        }
      }
    },
    {
      "filePath": "src/types/timeline.ts",
      "line": 8,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Parsed from a note with Class: BookMeta.",
      "context": {
        "before": {
          "line": 7,
          "text": "* Exactly one BookMeta note per manuscript."
        },
        "current": {
          "line": 8,
          "text": "* Parsed from a note with Class: BookMeta."
        },
        "after": {
          "line": 9,
          "text": "* Ignored by Timeline  used only during export."
        }
      }
    },
    {
      "filePath": "src/types/timeline.ts",
      "line": 29,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "/** Path to the BookMeta note in the vault */",
      "context": {
        "before": {
          "line": 28,
          "text": "};"
        },
        "current": {
          "line": 29,
          "text": "/** Path to the BookMeta note in the vault */"
        },
        "after": {
          "line": 30,
          "text": "sourcePath?: string;"
        }
      }
    },
    {
      "filePath": "src/types/timeline.ts",
      "line": 34,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Metadata extracted from a Matter note's nested Matter: YAML block.",
      "context": {
        "before": {
          "line": 33,
          "text": "/**"
        },
        "current": {
          "line": 34,
          "text": "* Metadata extracted from a Matter note's nested Matter: YAML block."
        },
        "after": {
          "line": 35,
          "text": "* Used to drive role-based rendering during export."
        }
      }
    },
    {
      "filePath": "src/types/timeline.ts",
      "line": 42,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "/** Whether this matter note should pull data from BookMeta */",
      "context": {
        "before": {
          "line": 41,
          "text": "role?: string;"
        },
        "current": {
          "line": 42,
          "text": "/** Whether this matter note should pull data from BookMeta */"
        },
        "after": {
          "line": 43,
          "text": "usesBookMeta?: boolean;"
        }
      }
    },
    {
      "filePath": "src/types/timeline.ts",
      "line": 46,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Matter ordering now uses filename prefixes only (0.* / 200.*). */",
      "context": {
        "before": {
          "line": 45,
          "text": "bodyMode?: 'latex' | 'plain' | 'auto';"
        },
        "current": {
          "line": 46,
          "text": "/** @deprecated Matter ordering now uses filename prefixes only (0.* / 200.*). */"
        },
        "after": {
          "line": 47,
          "text": "order?: number;"
        }
      }
    },
    {
      "filePath": "src/types/timeline.ts",
      "line": 62,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* - Synopsis: concise present-tense snapshot (word-capped).",
      "context": {
        "before": {
          "line": 61,
          "text": "* Scene narrative unit fields:"
        },
        "current": {
          "line": 62,
          "text": "* - Synopsis: concise present-tense snapshot (word-capped)."
        },
        "after": {
          "line": 63,
          "text": "* - Summary: extended scene write-up (emotion/subtext/outcome allowed)."
        }
      }
    },
    {
      "filePath": "src/types/timeline.ts",
      "line": 65,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis?: string;",
      "context": {
        "before": {
          "line": 64,
          "text": "*/"
        },
        "current": {
          "line": 65,
          "text": "synopsis?: string;"
        },
        "after": {
          "line": 66,
          "text": "Summary?: string;"
        }
      }
    },
    {
      "filePath": "src/types/timeline.ts",
      "line": 86,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Legacy beat field. Read for compatibility; new writes should use Purpose. */",
      "context": {
        "before": {
          "line": 85,
          "text": "Purpose?: string;"
        },
        "current": {
          "line": 86,
          "text": "/** @deprecated Legacy beat field. Read for compatibility; new writes should use Purpose. */"
        },
        "after": {
          "line": 87,
          "text": "Description?: string;"
        }
      }
    },
    {
      "filePath": "src/types/timeline.ts",
      "line": 92,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "/** Beat note is missing required Beat Model frontmatter value. */",
      "context": {
        "before": {
          "line": 91,
          "text": "\"Beat Id\"?: string;"
        },
        "current": {
          "line": 92,
          "text": "/** Beat note is missing required Beat Model frontmatter value. */"
        },
        "after": {
          "line": 93,
          "text": "missingBeatModel?: boolean;"
        }
      }
    },
    {
      "filePath": "src/timelineRepair/RepairPipeline.ts",
      "line": 112,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "{ includeSynopsis: true }",
      "context": {
        "before": {
          "line": 111,
          "text": "(entry) => getSceneBodyText(vault, entry),"
        },
        "current": {
          "line": 112,
          "text": "{ includeSynopsis: true }"
        },
        "after": {
          "line": 113,
          "text": ");"
        }
      }
    },
    {
      "filePath": "src/timelineRepair/aiTemporalParse.ts",
      "line": 31,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "IMPORTANT RULES:",
      "context": {
        "before": {
          "line": 30,
          "text": ""
        },
        "current": {
          "line": 31,
          "text": "IMPORTANT RULES:"
        },
        "after": {
          "line": 32,
          "text": "- Only suggest changes if you find clear textual evidence"
        }
      }
    },
    {
      "filePath": "src/timelineRepair/keywordSweep.ts",
      "line": 170,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "/** Include scene synopsis in scan */",
      "context": {
        "before": {
          "line": 169,
          "text": ""
        },
        "current": {
          "line": 170,
          "text": "/** Include scene synopsis in scan */"
        },
        "after": {
          "line": 171,
          "text": "includeSynopsis?: boolean;"
        }
      }
    },
    {
      "filePath": "src/timelineRepair/keywordSweep.ts",
      "line": 171,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "includeSynopsis?: boolean;",
      "context": {
        "before": {
          "line": 170,
          "text": "/** Include scene synopsis in scan */"
        },
        "current": {
          "line": 171,
          "text": "includeSynopsis?: boolean;"
        },
        "after": {
          "line": 172,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/timelineRepair/keywordSweep.ts",
      "line": 176,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "includeSynopsis: true",
      "context": {
        "before": {
          "line": 175,
          "text": "excerptWindow: 2000, // First 2000 chars usually contain temporal setup"
        },
        "current": {
          "line": 176,
          "text": "includeSynopsis: true"
        },
        "after": {
          "line": 177,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/timelineRepair/keywordSweep.ts",
      "line": 211,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Add synopsis if available and enabled",
      "context": {
        "before": {
          "line": 210,
          "text": ""
        },
        "current": {
          "line": 211,
          "text": "// Add synopsis if available and enabled"
        },
        "after": {
          "line": 212,
          "text": "if (opts.includeSynopsis && entry.scene.synopsis) {"
        }
      }
    },
    {
      "filePath": "src/timelineRepair/keywordSweep.ts",
      "line": 212,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (opts.includeSynopsis && entry.scene.synopsis) {",
      "context": {
        "before": {
          "line": 211,
          "text": "// Add synopsis if available and enabled"
        },
        "current": {
          "line": 212,
          "text": "if (opts.includeSynopsis && entry.scene.synopsis) {"
        },
        "after": {
          "line": 213,
          "text": "text = entry.scene.synopsis + '\\n' + text;"
        }
      }
    },
    {
      "filePath": "src/timelineRepair/keywordSweep.ts",
      "line": 213,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "text = entry.scene.synopsis + '\\n' + text;",
      "context": {
        "before": {
          "line": 212,
          "text": "if (opts.includeSynopsis && entry.scene.synopsis) {"
        },
        "current": {
          "line": 213,
          "text": "text = entry.scene.synopsis + '\\n' + text;"
        },
        "after": {
          "line": 214,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/synopsis/SynopsisData.ts",
      "line": 3,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export interface SynopsisScene {",
      "context": {
        "before": {
          "line": 2,
          "text": ""
        },
        "current": {
          "line": 3,
          "text": "export interface SynopsisScene {"
        },
        "after": {
          "line": 4,
          "text": "title?: string;"
        }
      }
    },
    {
      "filePath": "src/synopsis/SynopsisData.ts",
      "line": 12,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis?: string;",
      "context": {
        "before": {
          "line": 11,
          "text": "number?: number;"
        },
        "current": {
          "line": 12,
          "text": "synopsis?: string;"
        },
        "after": {
          "line": 13,
          "text": "when?: Date;"
        }
      }
    },
    {
      "filePath": "src/synopsis/SynopsisData.ts",
      "line": 29,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function splitSynopsisLines(contentLines: string[]): { synopsisEndIndex: number; metadataItems: string[] } {",
      "context": {
        "before": {
          "line": 28,
          "text": ""
        },
        "current": {
          "line": 29,
          "text": "export function splitSynopsisLines(contentLines: string[]): { synopsisEndIndex: number; metadataItems: string[] } {"
        },
        "after": {
          "line": 30,
          "text": "let synopsisEndIndex = contentLines.findIndex(line => line === '\\u00A0' || line === '');"
        }
      }
    },
    {
      "filePath": "src/synopsis/SynopsisData.ts",
      "line": 30,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "let synopsisEndIndex = contentLines.findIndex(line => line === '\\u00A0' || line === '');",
      "context": {
        "before": {
          "line": 29,
          "text": "export function splitSynopsisLines(contentLines: string[]): { synopsisEndIndex: number; metadataItems: string[] } {"
        },
        "current": {
          "line": 30,
          "text": "let synopsisEndIndex = contentLines.findIndex(line => line === '\\u00A0' || line === '');"
        },
        "after": {
          "line": 31,
          "text": "if (synopsisEndIndex === -1) synopsisEndIndex = Math.max(0, contentLines.length - 2);"
        }
      }
    },
    {
      "filePath": "src/synopsis/SynopsisData.ts",
      "line": 31,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (synopsisEndIndex === -1) synopsisEndIndex = Math.max(0, contentLines.length - 2);",
      "context": {
        "before": {
          "line": 30,
          "text": "let synopsisEndIndex = contentLines.findIndex(line => line === '\\u00A0' || line === '');"
        },
        "current": {
          "line": 31,
          "text": "if (synopsisEndIndex === -1) synopsisEndIndex = Math.max(0, contentLines.length - 2);"
        },
        "after": {
          "line": 32,
          "text": "const metadataItems = contentLines.slice(synopsisEndIndex + 1);"
        }
      }
    },
    {
      "filePath": "src/synopsis/SynopsisData.ts",
      "line": 32,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const metadataItems = contentLines.slice(synopsisEndIndex + 1);",
      "context": {
        "before": {
          "line": 31,
          "text": "if (synopsisEndIndex === -1) synopsisEndIndex = Math.max(0, contentLines.length - 2);"
        },
        "current": {
          "line": 32,
          "text": "const metadataItems = contentLines.slice(synopsisEndIndex + 1);"
        },
        "after": {
          "line": 33,
          "text": "return { synopsisEndIndex, metadataItems };"
        }
      }
    },
    {
      "filePath": "src/synopsis/SynopsisData.ts",
      "line": 33,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return { synopsisEndIndex, metadataItems };",
      "context": {
        "before": {
          "line": 32,
          "text": "const metadataItems = contentLines.slice(synopsisEndIndex + 1);"
        },
        "current": {
          "line": 33,
          "text": "return { synopsisEndIndex, metadataItems };"
        },
        "after": {
          "line": 34,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/synopsis/SynopsisData.ts",
      "line": 40,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function isOverdueAndIncomplete(scene: SynopsisScene, today: Date = new Date()): boolean {",
      "context": {
        "before": {
          "line": 39,
          "text": ""
        },
        "current": {
          "line": 40,
          "text": "export function isOverdueAndIncomplete(scene: SynopsisScene, today: Date = new Date()): boolean {"
        },
        "after": {
          "line": 41,
          "text": "const dueString = scene.due;"
        }
      }
    },
    {
      "filePath": "src/synopsis/SynopsisView.ts",
      "line": 2,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import type { SynopsisScene } from './SynopsisData';",
      "context": {
        "before": {
          "line": 1,
          "text": "// Focuses on building SVG elements for synopses (no data rules)"
        },
        "current": {
          "line": 2,
          "text": "import type { SynopsisScene } from './SynopsisData';"
        },
        "after": {
          "line": 3,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/synopsis/SynopsisView.ts",
      "line": 4,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function createSynopsisContainer(sceneId: string, scenePath?: string): SVGGElement {",
      "context": {
        "before": {
          "line": 3,
          "text": ""
        },
        "current": {
          "line": 4,
          "text": "export function createSynopsisContainer(sceneId: string, scenePath?: string): SVGGElement {"
        },
        "after": {
          "line": 5,
          "text": "const containerGroup = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");"
        }
      }
    },
    {
      "filePath": "src/synopsis/SynopsisView.ts",
      "line": 17,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "group.setAttribute(\"class\", \"rt-synopsis-text\");",
      "context": {
        "before": {
          "line": 16,
          "text": "const group = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");"
        },
        "current": {
          "line": 17,
          "text": "group.setAttribute(\"class\", \"rt-synopsis-text\");"
        },
        "after": {
          "line": 18,
          "text": "return group;"
        }
      }
    },
    {
      "filePath": "src/settings/AiContextModal.ts",
      "line": 61,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: Modal classes don't have registerDomEvent, use addEventListener instead",
      "context": {
        "before": {
          "line": 60,
          "text": "};"
        },
        "current": {
          "line": 61,
          "text": "// Note: Modal classes don't have registerDomEvent, use addEventListener instead"
        },
        "after": {
          "line": 62,
          "text": "// Cleanup handled in onClose()"
        }
      }
    },
    {
      "filePath": "src/settings/AiContextModal.ts",
      "line": 149,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const infoEl = contentEl.createDiv({ cls: 'ert-field-note ert-ai-context-info' });",
      "context": {
        "before": {
          "line": 148,
          "text": "// Info section"
        },
        "current": {
          "line": 149,
          "text": "const infoEl = contentEl.createDiv({ cls: 'ert-field-note ert-ai-context-info' });"
        },
        "after": {
          "line": 150,
          "text": "infoEl.setText('Define context for AI LLM analysis and pulse triplet editorial feedback. This text prepends select prompts to establish role and context and is used for the copy template button to generate Gossamer scores.');"
        }
      }
    },
    {
      "filePath": "src/settings/AiContextModal.ts",
      "line": 221,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: Modal classes don't have registerDomEvent, use addEventListener instead",
      "context": {
        "before": {
          "line": 220,
          "text": "};"
        },
        "current": {
          "line": 221,
          "text": "// Note: Modal classes don't have registerDomEvent, use addEventListener instead"
        },
        "after": {
          "line": 222,
          "text": "// Cleanup handled in onClose()"
        }
      }
    },
    {
      "filePath": "src/settings/SettingImpact.ts",
      "line": 33,
      "token": "ChangeType.SETTINGS",
      "category": "drift-term",
      "lineText": "changeTypes: [ChangeType.SETTINGS],",
      "context": {
        "before": {
          "line": 32,
          "text": "kind: 'selective',"
        },
        "current": {
          "line": 33,
          "text": "changeTypes: [ChangeType.SETTINGS],"
        },
        "after": {
          "line": 34,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/settings/defaults.ts",
      "line": 16,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "showSourcePathAsTitle: true, // @deprecated Legacy  book title from BookProfile after migration",
      "context": {
        "before": {
          "line": 15,
          "text": "sourcePath: '',"
        },
        "current": {
          "line": 16,
          "text": "showSourcePathAsTitle: true, // @deprecated Legacy  book title from BookProfile after migration"
        },
        "after": {
          "line": 17,
          "text": "validFolderPaths: [], // Default empty array for folder path history"
        }
      }
    },
    {
      "filePath": "src/settings/defaults.ts",
      "line": 95,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisTargetWords: 200, // Target word count for generated summaries (legacy name)",
      "context": {
        "before": {
          "line": 94,
          "text": "enableZeroDraftMode: false,"
        },
        "current": {
          "line": 95,
          "text": "synopsisTargetWords: 200, // Target word count for generated summaries (legacy name)"
        },
        "after": {
          "line": 96,
          "text": "synopsisWeakThreshold: 75, // Summaries under this word count are considered \"weak\" (legacy name)"
        }
      }
    },
    {
      "filePath": "src/settings/defaults.ts",
      "line": 96,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisWeakThreshold: 75, // Summaries under this word count are considered \"weak\" (legacy name)",
      "context": {
        "before": {
          "line": 95,
          "text": "synopsisTargetWords: 200, // Target word count for generated summaries (legacy name)"
        },
        "current": {
          "line": 96,
          "text": "synopsisWeakThreshold: 75, // Summaries under this word count are considered \"weak\" (legacy name)"
        },
        "after": {
          "line": 97,
          "text": "alsoUpdateSynopsis: false, // When running Summary refresh, also generate Synopsis"
        }
      }
    },
    {
      "filePath": "src/settings/defaults.ts",
      "line": 97,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "alsoUpdateSynopsis: false, // When running Summary refresh, also generate Synopsis",
      "context": {
        "before": {
          "line": 96,
          "text": "synopsisWeakThreshold: 75, // Summaries under this word count are considered \"weak\" (legacy name)"
        },
        "current": {
          "line": 97,
          "text": "alsoUpdateSynopsis: false, // When running Summary refresh, also generate Synopsis"
        },
        "after": {
          "line": 98,
          "text": "synopsisGenerationMaxWords: 30, // Max words for AI-generated Synopsis"
        }
      }
    },
    {
      "filePath": "src/settings/defaults.ts",
      "line": 98,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisGenerationMaxWords: 30, // Max words for AI-generated Synopsis",
      "context": {
        "before": {
          "line": 97,
          "text": "alsoUpdateSynopsis: false, // When running Summary refresh, also generate Synopsis"
        },
        "current": {
          "line": 98,
          "text": "synopsisGenerationMaxWords: 30, // Max words for AI-generated Synopsis"
        },
        "after": {
          "line": 99,
          "text": "synopsisGenerationMaxLines: 3, // @deprecated Legacy line-based synopsis limiter"
        }
      }
    },
    {
      "filePath": "src/settings/defaults.ts",
      "line": 99,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "synopsisGenerationMaxLines: 3, // @deprecated Legacy line-based synopsis limiter",
      "context": {
        "before": {
          "line": 98,
          "text": "synopsisGenerationMaxWords: 30, // Max words for AI-generated Synopsis"
        },
        "current": {
          "line": 99,
          "text": "synopsisGenerationMaxLines: 3, // @deprecated Legacy line-based synopsis limiter"
        },
        "after": {
          "line": 100,
          "text": "aiUpdateTimestamps: {}, // Internal AI update timestamps (per-scene)"
        }
      }
    },
    {
      "filePath": "src/settings/defaults.ts",
      "line": 99,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisGenerationMaxLines: 3, // @deprecated Legacy line-based synopsis limiter",
      "context": {
        "before": {
          "line": 98,
          "text": "synopsisGenerationMaxWords: 30, // Max words for AI-generated Synopsis"
        },
        "current": {
          "line": 99,
          "text": "synopsisGenerationMaxLines: 3, // @deprecated Legacy line-based synopsis limiter"
        },
        "after": {
          "line": 100,
          "text": "aiUpdateTimestamps: {}, // Internal AI update timestamps (per-scene)"
        }
      }
    },
    {
      "filePath": "src/settings/defaults.ts",
      "line": 105,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "synopsisHoverMaxLines: 5, // @deprecated Legacy fallback; hover lines now derive from synopsis word limit",
      "context": {
        "before": {
          "line": 104,
          "text": "enableManuscriptRippleRename: false,"
        },
        "current": {
          "line": 105,
          "text": "synopsisHoverMaxLines: 5, // @deprecated Legacy fallback; hover lines now derive from synopsis word limit"
        },
        "after": {
          "line": 106,
          "text": "enableHoverDebugLogging: false,"
        }
      }
    },
    {
      "filePath": "src/settings/defaults.ts",
      "line": 105,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisHoverMaxLines: 5, // @deprecated Legacy fallback; hover lines now derive from synopsis word limit",
      "context": {
        "before": {
          "line": 104,
          "text": "enableManuscriptRippleRename: false,"
        },
        "current": {
          "line": 105,
          "text": "synopsisHoverMaxLines: 5, // @deprecated Legacy fallback; hover lines now derive from synopsis word limit"
        },
        "after": {
          "line": 106,
          "text": "enableHoverDebugLogging: false,"
        }
      }
    },
    {
      "filePath": "src/settings/defaults.ts",
      "line": 178,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "Synopsis:",
      "context": {
        "before": {
          "line": 177,
          "text": "Duration: 1 hour"
        },
        "current": {
          "line": 178,
          "text": "Synopsis:"
        },
        "after": {
          "line": 179,
          "text": "Summary:"
        }
      }
    },
    {
      "filePath": "src/settings/defaults.ts",
      "line": 187,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "Status: Todo",
      "context": {
        "before": {
          "line": 186,
          "text": "Publish Stage: Zero"
        },
        "current": {
          "line": 187,
          "text": "Status: Todo"
        },
        "after": {
          "line": 188,
          "text": "Due: {{When}}"
        }
      }
    },
    {
      "filePath": "src/settings/refactorAlerts.ts",
      "line": 44,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "'Class', 'Act', 'When', 'Duration', 'Synopsis', 'Summary', 'Pending Edits',",
      "context": {
        "before": {
          "line": 43,
          "text": "export const BASE_BEAT_FIELDS = ["
        },
        "current": {
          "line": 44,
          "text": "'Class', 'Act', 'When', 'Duration', 'Synopsis', 'Summary', 'Pending Edits',"
        },
        "after": {
          "line": 45,
          "text": "'Subplot', 'Character', 'POV', 'Words', 'Runtime', 'Publish Stage',"
        }
      }
    },
    {
      "filePath": "src/settings/refactorAlerts.ts",
      "line": 93,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "description: '\"Pending Edits\" is no longer a boolean. It is now a string so it can act as both a yes/no flag and record the last AI API hit (timestamp and AI used). The YAML field \"Summary Update\" (formerly \"Synopsis Update\") works identically: string value with timestamp and AI used.',",
      "context": {
        "before": {
          "line": 92,
          "text": "title: 'YAML Type Change: Pending Edits & Summary Update',"
        },
        "current": {
          "line": 93,
          "text": "description: '\"Pending Edits\" is no longer a boolean. It is now a string so it can act as both a yes/no flag and record the last AI API hit (timestamp and AI used). The YAML field \"Summary Update\" (formerly \"Synopsis Update\") works identically: string value with timestamp and AI used.',"
        },
        "after": {
          "line": 94,
          "text": "},"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 209,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'ert-field-note',",
      "context": {
        "before": {
          "line": 208,
          "text": "largeHandlingBody.createDiv({"
        },
        "current": {
          "line": 209,
          "text": "cls: 'ert-field-note',"
        },
        "after": {
          "line": 210,
          "text": "text: 'A small buffer is reserved so structured answers do not get cut off.'"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 255,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const executionPreferenceNote = largeHandlingBody.createDiv({ cls: 'ert-field-note' });",
      "context": {
        "before": {
          "line": 254,
          "text": "});"
        },
        "current": {
          "line": 255,
          "text": "const executionPreferenceNote = largeHandlingBody.createDiv({ cls: 'ert-field-note' });"
        },
        "after": {
          "line": 256,
          "text": "const updateExecutionPreferenceNote = (): void => {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 363,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": ".filter(model => model.provider === provider && model.status !== 'deprecated')",
      "context": {
        "before": {
          "line": 362,
          "text": "BUILTIN_MODELS"
        },
        "current": {
          "line": 363,
          "text": ".filter(model => model.provider === provider && model.status !== 'deprecated')"
        },
        "after": {
          "line": 364,
          "text": ".map(model => model.alias);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 969,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const modelsHintEl = modelsPanel.createDiv({ cls: 'ert-field-note' });",
      "context": {
        "before": {
          "line": 968,
          "text": "const modelsRefreshedEl = modelsHeader.createDiv({ cls: 'ert-ai-models-refreshed' });"
        },
        "current": {
          "line": 969,
          "text": "const modelsHintEl = modelsPanel.createDiv({ cls: 'ert-field-note' });"
        },
        "after": {
          "line": 970,
          "text": "const recommendationsEl = modelsPanel.createDiv({ cls: 'ert-ai-recommendations ert-stack' });"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 1129,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "modelDetailsEl.createDiv({ cls: 'ert-field-note', text: `Alias: ${model.alias}  Provider ID: ${model.providerModelId}` });",
      "context": {
        "before": {
          "line": 1128,
          "text": "heading.setText(`${providerLabel[model.provider]}  ${model.label}`);"
        },
        "current": {
          "line": 1129,
          "text": "modelDetailsEl.createDiv({ cls: 'ert-field-note', text: `Alias: ${model.alias}  Provider ID: ${model.providerModelId}` });"
        },
        "after": {
          "line": 1130,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 1136,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const providerDetails = modelDetailsEl.createDiv({ cls: 'ert-field-note' });",
      "context": {
        "before": {
          "line": 1135,
          "text": ""
        },
        "current": {
          "line": 1136,
          "text": "const providerDetails = modelDetailsEl.createDiv({ cls: 'ert-field-note' });"
        },
        "after": {
          "line": 1137,
          "text": "providerDetails.setText("
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 1141,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const personality = modelDetailsEl.createDiv({ cls: 'ert-field-note' });",
      "context": {
        "before": {
          "line": 1140,
          "text": ""
        },
        "current": {
          "line": 1141,
          "text": "const personality = modelDetailsEl.createDiv({ cls: 'ert-field-note' });"
        },
        "after": {
          "line": 1142,
          "text": "personality.setText("
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 1158,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'ert-field-note',",
      "context": {
        "before": {
          "line": 1157,
          "text": "modelDetailsEl.createDiv({"
        },
        "current": {
          "line": 1158,
          "text": "cls: 'ert-field-note',"
        },
        "after": {
          "line": 1159,
          "text": "text: `Effective caps preview: input=${effective.maxInputTokens.toLocaleString()}, output=${effective.maxOutputTokens.toLocaleString()}, tier=${tier}`"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 1162,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const why = modelDetailsEl.createDiv({ cls: 'ert-field-note' });",
      "context": {
        "before": {
          "line": 1161,
          "text": ""
        },
        "current": {
          "line": 1162,
          "text": "const why = modelDetailsEl.createDiv({ cls: 'ert-field-note' });"
        },
        "after": {
          "line": 1163,
          "text": "if (selection && selection.alias === model.alias) {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 1321,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const resolvedPreviewDetailsBody = resolvedPreviewDetails.createDiv({ cls: 'ert-field-note ert-ai-resolved-preview-details-body' });",
      "context": {
        "before": {
          "line": 1320,
          "text": "resolvedPreviewDetails.createEl('summary', { text: 'Details' });"
        },
        "current": {
          "line": 1321,
          "text": "const resolvedPreviewDetailsBody = resolvedPreviewDetails.createDiv({ cls: 'ert-field-note ert-ai-resolved-preview-details-body' });"
        },
        "after": {
          "line": 1322,
          "text": "params.addAiRelatedElement(resolvedPreviewFrame);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 1776,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'ert-field-note',",
      "context": {
        "before": {
          "line": 1775,
          "text": "legacyHost.createDiv({"
        },
        "current": {
          "line": 1776,
          "text": "cls: 'ert-field-note',"
        },
        "after": {
          "line": 1777,
          "text": "text: 'Older key fields are disabled on this Obsidian version.'"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 1874,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Advisory note as separate section",
      "context": {
        "before": {
          "line": 1873,
          "text": ""
        },
        "current": {
          "line": 1874,
          "text": "// Advisory note as separate section"
        },
        "after": {
          "line": 1875,
          "text": "const localWarningSection = localBaseStack.createDiv({ cls: ['ert-local-llm-advisory', ERT_CLASSES.ROW] });"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 1876,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "localWarningSection.createEl('strong', { text: 'Advisory Note', cls: 'ert-local-llm-advisory-title' });",
      "context": {
        "before": {
          "line": 1875,
          "text": "const localWarningSection = localBaseStack.createDiv({ cls: ['ert-local-llm-advisory', ERT_CLASSES.ROW] });"
        },
        "current": {
          "line": 1876,
          "text": "localWarningSection.createEl('strong', { text: 'Advisory Note', cls: 'ert-local-llm-advisory-title' });"
        },
        "after": {
          "line": 1877,
          "text": "const aiLogFolder = resolveAiLogFolder();"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 1982,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": ".setDesc('Default is enabled. Local LLM triplet pulse analysis skips writing to the scene note and saves results in the AI log report instead. Recommended for local models.')",
      "context": {
        "before": {
          "line": 1981,
          "text": ".setName('Bypass scene hover Fields writes')"
        },
        "current": {
          "line": 1982,
          "text": ".setDesc('Default is enabled. Local LLM triplet pulse analysis skips writing to the scene note and saves results in the AI log report instead. Recommended for local models.')"
        },
        "after": {
          "line": 1983,
          "text": ".addToggle(toggle => toggle"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AiSection.ts",
      "line": 2077,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'ert-field-note',",
      "context": {
        "before": {
          "line": 2076,
          "text": "localApiContainer.createDiv({"
        },
        "current": {
          "line": 2077,
          "text": "cls: 'ert-field-note',"
        },
        "after": {
          "line": 2078,
          "text": "text: 'Older local key field is disabled on this Obsidian version.'"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AuthorProgressSection.ts",
      "line": 1518,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "note: string;",
      "context": {
        "before": {
          "line": 1517,
          "text": "total: number;"
        },
        "current": {
          "line": 1518,
          "text": "note: string;"
        },
        "after": {
          "line": 1519,
          "text": "} => {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AuthorProgressSection.ts",
      "line": 1533,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "note: total === 0 ? 'No scenes found yet; assuming Zero stage.' : 'No progress estimate available yet.'",
      "context": {
        "before": {
          "line": 1532,
          "text": "total,"
        },
        "current": {
          "line": 1533,
          "text": "note: total === 0 ? 'No scenes found yet; assuming Zero stage.' : 'No progress estimate available yet.'"
        },
        "after": {
          "line": 1534,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AuthorProgressSection.ts",
      "line": 1536,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "return { stage, total, note: 'Based on the progress estimate (active publish stage).' };",
      "context": {
        "before": {
          "line": 1535,
          "text": "}"
        },
        "current": {
          "line": 1536,
          "text": "return { stage, total, note: 'Based on the progress estimate (active publish stage).' };"
        },
        "after": {
          "line": 1537,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AuthorProgressSection.ts",
      "line": 1609,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "'Zero Mode (recommended): create a placeholder final scene note with a high prefix number (e.g., \"60 The End\") to set intended total scene count.',",
      "context": {
        "before": {
          "line": 1608,
          "text": "setGuidanceLines(["
        },
        "current": {
          "line": 1609,
          "text": "'Zero Mode (recommended): create a placeholder final scene note with a high prefix number (e.g., \"60 The End\") to set intended total scene count.',"
        },
        "after": {
          "line": 1610,
          "text": "'Date Mode: choose a start date and target completion date.'"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AuthorProgressSection.ts",
      "line": 1623,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const updateStageUI = (stage: (typeof STAGE_ORDER)[number], total: number, note: string) => {",
      "context": {
        "before": {
          "line": 1622,
          "text": ""
        },
        "current": {
          "line": 1623,
          "text": "const updateStageUI = (stage: (typeof STAGE_ORDER)[number], total: number, note: string) => {"
        },
        "after": {
          "line": 1624,
          "text": "isZeroStage = stage === 'Zero';"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AuthorProgressSection.ts",
      "line": 1627,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "stageNote.setText(note);",
      "context": {
        "before": {
          "line": 1626,
          "text": "applyStageBadgeTone(stage);"
        },
        "current": {
          "line": 1627,
          "text": "stageNote.setText(note);"
        },
        "after": {
          "line": 1628,
          "text": "updateModeUI();"
        }
      }
    },
    {
      "filePath": "src/settings/sections/AuthorProgressSection.ts",
      "line": 1684,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "updateStageUI(result.stage, result.total, result.note);",
      "context": {
        "before": {
          "line": 1683,
          "text": "const result = detectPublishStage(scenes);"
        },
        "current": {
          "line": 1684,
          "text": "updateStageUI(result.stage, result.total, result.note);"
        },
        "after": {
          "line": 1685,
          "text": "seedDateRange();"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 116,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "header.createDiv({ cls: 'ert-modal-subtitle', text: 'This name identifies your beat system and appears in each beat note\\'s frontmatter.' });",
      "context": {
        "before": {
          "line": 115,
          "text": "header.createDiv({ cls: 'ert-modal-title', text: 'Edit custom system details' });"
        },
        "current": {
          "line": 116,
          "text": "header.createDiv({ cls: 'ert-modal-subtitle', text: 'This name identifies your beat system and appears in each beat note\\'s frontmatter.' });"
        },
        "after": {
          "line": 117,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 192,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Use InnerStage. Kept for backward compatibility in string literals. */",
      "context": {
        "before": {
          "line": 191,
          "text": ""
        },
        "current": {
          "line": 192,
          "text": "/** @deprecated Use InnerStage. Kept for backward compatibility in string literals. */"
        },
        "after": {
          "line": 193,
          "text": "type CustomStage = InnerStage;"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 632,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "tooltip: 'Custom beat note status not yet checked.'",
      "context": {
        "before": {
          "line": 631,
          "text": "statusClass: '',"
        },
        "current": {
          "line": 632,
          "text": "tooltip: 'Custom beat note status not yet checked.'"
        },
        "after": {
          "line": 633,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 645,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "tooltip: `${existingBeatDuplicateCount} duplicate beat note${existingBeatDuplicateCount !== 1 ? 's' : ''} found. Manually delete duplicate notes to resolve.`",
      "context": {
        "before": {
          "line": 644,
          "text": "statusClass: 'ert-beat-health-icon--critical',"
        },
        "current": {
          "line": 645,
          "text": "tooltip: `${existingBeatDuplicateCount} duplicate beat note${existingBeatDuplicateCount !== 1 ? 's' : ''} found. Manually delete duplicate notes to resolve.`"
        },
        "after": {
          "line": 646,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 652,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "tooltip: `${existingBeatMisalignedCount} beat note${existingBeatMisalignedCount !== 1 ? 's' : ''} need repair.`",
      "context": {
        "before": {
          "line": 651,
          "text": "statusClass: 'ert-beat-health-icon--warning',"
        },
        "current": {
          "line": 652,
          "text": "tooltip: `${existingBeatMisalignedCount} beat note${existingBeatMisalignedCount !== 1 ? 's' : ''} need repair.`"
        },
        "after": {
          "line": 653,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 666,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "tooltip: `${existingBeatNewCount} beat note${existingBeatNewCount !== 1 ? 's' : ''} not yet created.`",
      "context": {
        "before": {
          "line": 665,
          "text": "statusClass: 'ert-beat-health-icon--warning',"
        },
        "current": {
          "line": 666,
          "text": "tooltip: `${existingBeatNewCount} beat note${existingBeatNewCount !== 1 ? 's' : ''} not yet created.`"
        },
        "after": {
          "line": 667,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 673,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "tooltip: `${existingBeatLegacyMatchedCount} beat note${existingBeatLegacyMatchedCount !== 1 ? 's' : ''} matched by filename (run Repair to lock Beat Id).`",
      "context": {
        "before": {
          "line": 672,
          "text": "statusClass: 'ert-beat-health-icon--warning',"
        },
        "current": {
          "line": 673,
          "text": "tooltip: `${existingBeatLegacyMatchedCount} beat note${existingBeatLegacyMatchedCount !== 1 ? 's' : ''} matched by filename (run Repair to lock Beat Id).`"
        },
        "after": {
          "line": 674,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 686,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "tooltip: 'Custom beat note status not yet checked.'",
      "context": {
        "before": {
          "line": 685,
          "text": "statusClass: '',"
        },
        "current": {
          "line": 686,
          "text": "tooltip: 'Custom beat note status not yet checked.'"
        },
        "after": {
          "line": 687,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 960,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Starts neutral; updates after async beat-note lookup.",
      "context": {
        "before": {
          "line": 959,
          "text": "// Health status icon  mirrors Book card check pattern."
        },
        "current": {
          "line": 960,
          "text": "// Starts neutral; updates after async beat-note lookup."
        },
        "after": {
          "line": 961,
          "text": "const healthIcon = titleEl.createDiv({ cls: 'ert-beat-health-icon' });"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 1027,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Update health icon from current beat-note audit counters.",
      "context": {
        "before": {
          "line": 1026,
          "text": ""
        },
        "current": {
          "line": 1027,
          "text": "// Update health icon from current beat-note audit counters."
        },
        "after": {
          "line": 1028,
          "text": "// Called immediately (from cached state) and again after async lookup."
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 1034,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "setTooltip(healthIcon, 'Beat note status not yet checked.');",
      "context": {
        "before": {
          "line": 1033,
          "text": "setIcon(healthIcon, 'circle-dashed');"
        },
        "current": {
          "line": 1034,
          "text": "setTooltip(healthIcon, 'Beat note status not yet checked.');"
        },
        "after": {
          "line": 1035,
          "text": "return;"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 1048,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "setTooltip(healthIcon, `${existingBeatDuplicateCount} duplicate beat note${existingBeatDuplicateCount !== 1 ? 's' : ''} found. Manually delete duplicate notes to resolve.`);",
      "context": {
        "before": {
          "line": 1047,
          "text": "setIcon(healthIcon, 'alert-circle');"
        },
        "current": {
          "line": 1048,
          "text": "setTooltip(healthIcon, `${existingBeatDuplicateCount} duplicate beat note${existingBeatDuplicateCount !== 1 ? 's' : ''} found. Manually delete duplicate notes to resolve.`);"
        },
        "after": {
          "line": 1049,
          "text": "} else if (hasMisaligned) {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 1052,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "setTooltip(healthIcon, `${existingBeatMisalignedCount} beat note${existingBeatMisalignedCount !== 1 ? 's' : ''} have wrong Act. Use Repair to update frontmatter.`);",
      "context": {
        "before": {
          "line": 1051,
          "text": "setIcon(healthIcon, 'alert-triangle');"
        },
        "current": {
          "line": 1052,
          "text": "setTooltip(healthIcon, `${existingBeatMisalignedCount} beat note${existingBeatMisalignedCount !== 1 ? 's' : ''} have wrong Act. Use Repair to update frontmatter.`);"
        },
        "after": {
          "line": 1053,
          "text": "} else if (hasMissingModel) {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 1060,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "setTooltip(healthIcon, `${existingBeatNewCount} beat note${existingBeatNewCount !== 1 ? 's' : ''} not yet created.`);",
      "context": {
        "before": {
          "line": 1059,
          "text": "setIcon(healthIcon, 'alert-triangle');"
        },
        "current": {
          "line": 1060,
          "text": "setTooltip(healthIcon, `${existingBeatNewCount} beat note${existingBeatNewCount !== 1 ? 's' : ''} not yet created.`);"
        },
        "after": {
          "line": 1061,
          "text": "} else if (allGood && hasLegacy) {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 1064,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "setTooltip(healthIcon, `${existingBeatLegacyMatchedCount} beat note${existingBeatLegacyMatchedCount !== 1 ? 's' : ''} matched by filename (run Repair to lock Beat Id).`);",
      "context": {
        "before": {
          "line": 1063,
          "text": "setIcon(healthIcon, 'alert-triangle');"
        },
        "current": {
          "line": 1064,
          "text": "setTooltip(healthIcon, `${existingBeatLegacyMatchedCount} beat note${existingBeatLegacyMatchedCount !== 1 ? 's' : ''} matched by filename (run Repair to lock Beat Id).`);"
        },
        "after": {
          "line": 1065,
          "text": "} else if (allGood) {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 1072,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "setTooltip(healthIcon, 'Beat note status not yet checked.');",
      "context": {
        "before": {
          "line": 1071,
          "text": "setIcon(healthIcon, 'circle-dashed');"
        },
        "current": {
          "line": 1072,
          "text": "setTooltip(healthIcon, 'Beat note status not yet checked.');"
        },
        "after": {
          "line": 1073,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 1313,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "rowNotices.push('Beat note aligned (Act matches). Prefix numbers are cosmetic.');",
      "context": {
        "before": {
          "line": 1312,
          "text": "rowState = 'synced';"
        },
        "current": {
          "line": 1313,
          "text": "rowNotices.push('Beat note aligned (Act matches). Prefix numbers are cosmetic.');"
        },
        "after": {
          "line": 1314,
          "text": "} else {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 1688,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": ".setDesc('Create beat note files in your vault based on the selected story structure system.')",
      "context": {
        "before": {
          "line": 1687,
          "text": ".setName('Beat notes')"
        },
        "current": {
          "line": 1688,
          "text": ".setDesc('Create beat note files in your vault based on the selected story structure system.')"
        },
        "after": {
          "line": 1689,
          "text": ".addButton(button => {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 1693,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": ".setTooltip('Create beat note files in your source path')",
      "context": {
        "before": {
          "line": 1692,
          "text": ".setButtonText('Create beat notes')"
        },
        "current": {
          "line": 1693,
          "text": ".setTooltip('Create beat note files in your source path')"
        },
        "after": {
          "line": 1694,
          "text": ".onClick(() => { void primaryDesignAction(); });"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 2028,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setTooltip(iconInput, fieldsReadOnly ? 'Requires Pro' : 'Lucide icon name for hover synopsis');",
      "context": {
        "before": {
          "line": 2027,
          "text": "iconInput.disabled = fieldsReadOnly;"
        },
        "current": {
          "line": 2028,
          "text": "setTooltip(iconInput, fieldsReadOnly ? 'Requires Pro' : 'Lucide icon name for hover synopsis');"
        },
        "after": {
          "line": 2029,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 2038,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setTooltip(checkbox, fieldsReadOnly ? 'Requires Pro' : 'Show in beat hover synopsis');",
      "context": {
        "before": {
          "line": 2037,
          "text": "checkbox.disabled = fieldsReadOnly;"
        },
        "current": {
          "line": 2038,
          "text": "setTooltip(checkbox, fieldsReadOnly ? 'Requires Pro' : 'Show in beat hover synopsis');"
        },
        "after": {
          "line": 2039,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 2184,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setTooltip(addIconInput, 'Lucide icon name for beat hover synopsis');",
      "context": {
        "before": {
          "line": 2183,
          "text": "addIconInput.value = DEFAULT_HOVER_ICON;"
        },
        "current": {
          "line": 2184,
          "text": "setTooltip(addIconInput, 'Lucide icon name for beat hover synopsis');"
        },
        "after": {
          "line": 2185,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 2207,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setTooltip(addCheckbox, 'Show in beat hover synopsis');",
      "context": {
        "before": {
          "line": 2206,
          "text": "addCheckbox.checked = false;"
        },
        "current": {
          "line": 2207,
          "text": "setTooltip(addCheckbox, 'Show in beat hover synopsis');"
        },
        "after": {
          "line": 2208,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 2335,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "beatHoverPreviewBody.createDiv({ text: 'Enable fields using the checkboxes above to show them in beat hover synopsis.', cls: 'ert-hover-preview-empty' });",
      "context": {
        "before": {
          "line": 2334,
          "text": "beatHoverPreviewHeading.setText('Beat Hover Metadata Preview (none enabled)');"
        },
        "current": {
          "line": 2335,
          "text": "beatHoverPreviewBody.createDiv({ text: 'Enable fields using the checkboxes above to show them in beat hover synopsis.', cls: 'ert-hover-preview-empty' });"
        },
        "after": {
          "line": 2336,
          "text": "return;"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 2921,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": ".setDesc('Set up custom scene YAML keys for the advanced YAML set. Enable fields to reveal in scene hover synopsis. Type any keyword to search for a perfect lucide icon. Reorder fields to match your preferred order.');",
      "context": {
        "before": {
          "line": 2920,
          "text": ".setName('Advanced YAML editor')"
        },
        "current": {
          "line": 2921,
          "text": ".setDesc('Set up custom scene YAML keys for the advanced YAML set. Enable fields to reveal in scene hover synopsis. Type any keyword to search for a perfect lucide icon. Reorder fields to match your preferred order.');"
        },
        "after": {
          "line": 2922,
          "text": "const advancedToggleButton = advancedYamlSetting.controlEl.createEl('button', {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3187,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// 3. Icon input with preview (for hover synopsis)",
      "context": {
        "before": {
          "line": 3186,
          "text": ""
        },
        "current": {
          "line": 3187,
          "text": "// 3. Icon input with preview (for hover synopsis)"
        },
        "after": {
          "line": 3188,
          "text": "const iconWrapper = row.createDiv({ cls: 'ert-hover-icon-wrapper' });"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3197,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setTooltip(iconInput, 'Lucide icon name for hover synopsis');",
      "context": {
        "before": {
          "line": 3196,
          "text": "iconInput.value = currentIcon;"
        },
        "current": {
          "line": 3197,
          "text": "setTooltip(iconInput, 'Lucide icon name for hover synopsis');"
        },
        "after": {
          "line": 3198,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3199,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// 4. Checkbox to enable in hover synopsis (defined before icon handlers so they can reference it)",
      "context": {
        "before": {
          "line": 3198,
          "text": ""
        },
        "current": {
          "line": 3199,
          "text": "// 4. Checkbox to enable in hover synopsis (defined before icon handlers so they can reference it)"
        },
        "after": {
          "line": 3200,
          "text": "const checkboxWrapper = row.createDiv({ cls: 'ert-hover-checkbox-wrapper' });"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3206,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setTooltip(checkbox, 'Show in hover synopsis');",
      "context": {
        "before": {
          "line": 3205,
          "text": "checkbox.checked = currentEnabled;"
        },
        "current": {
          "line": 3206,
          "text": "setTooltip(checkbox, 'Show in hover synopsis');"
        },
        "after": {
          "line": 3207,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3402,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setTooltip(addIconInput, 'Lucide icon name for hover synopsis');",
      "context": {
        "before": {
          "line": 3401,
          "text": "addIconInput.value = DEFAULT_HOVER_ICON;"
        },
        "current": {
          "line": 3402,
          "text": "setTooltip(addIconInput, 'Lucide icon name for hover synopsis');"
        },
        "after": {
          "line": 3403,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3426,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setTooltip(addCheckbox, 'Show in hover synopsis');",
      "context": {
        "before": {
          "line": 3425,
          "text": "addCheckbox.checked = false;"
        },
        "current": {
          "line": 3426,
          "text": "setTooltip(addCheckbox, 'Show in hover synopsis');"
        },
        "after": {
          "line": 3427,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3542,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "hoverPreviewBody.createDiv({ text: 'Enable fields using the checkboxes above to show them in hover synopsis.', cls: 'ert-hover-preview-empty' });",
      "context": {
        "before": {
          "line": 3541,
          "text": "hoverPreviewHeading.setText('Hover Metadata Preview (none enabled)');"
        },
        "current": {
          "line": 3542,
          "text": "hoverPreviewBody.createDiv({ text: 'Enable fields using the checkboxes above to show them in hover synopsis.', cls: 'ert-hover-preview-empty' });"
        },
        "after": {
          "line": 3543,
          "text": "return;"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3582,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": ".setDesc('Customize additional YAML keys for backdrop notes. Enable fields to show in backdrop hover synopsis.');",
      "context": {
        "before": {
          "line": 3581,
          "text": ".setName('Backdrop YAML editor')"
        },
        "current": {
          "line": 3582,
          "text": ".setDesc('Customize additional YAML keys for backdrop notes. Enable fields to show in backdrop hover synopsis.');"
        },
        "after": {
          "line": 3583,
          "text": "const backdropYamlToggleBtn = backdropYamlHeading.controlEl.createEl('button', {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3637,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// `Synopsis` is legacy for Backdrop and should not be written by new templates.",
      "context": {
        "before": {
          "line": 3636,
          "text": "const backdropBaseKeys = extractKeysInOrder(backdropBaseTemplate);"
        },
        "current": {
          "line": 3637,
          "text": "// `Synopsis` is legacy for Backdrop and should not be written by new templates."
        },
        "after": {
          "line": 3638,
          "text": "const backdropDisallowedNewWriteKeys = new Set(['Synopsis']);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3638,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const backdropDisallowedNewWriteKeys = new Set(['Synopsis']);",
      "context": {
        "before": {
          "line": 3637,
          "text": "// `Synopsis` is legacy for Backdrop and should not be written by new templates."
        },
        "current": {
          "line": 3638,
          "text": "const backdropDisallowedNewWriteKeys = new Set(['Synopsis']);"
        },
        "after": {
          "line": 3639,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3720,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setTooltip(iconInput, 'Lucide icon name for hover synopsis');",
      "context": {
        "before": {
          "line": 3719,
          "text": "iconInput.value = currentIcon;"
        },
        "current": {
          "line": 3720,
          "text": "setTooltip(iconInput, 'Lucide icon name for hover synopsis');"
        },
        "after": {
          "line": 3721,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3729,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setTooltip(checkbox, 'Show in backdrop hover synopsis');",
      "context": {
        "before": {
          "line": 3728,
          "text": "checkbox.checked = currentEnabled;"
        },
        "current": {
          "line": 3729,
          "text": "setTooltip(checkbox, 'Show in backdrop hover synopsis');"
        },
        "after": {
          "line": 3730,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3853,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setTooltip(addIconInput, 'Lucide icon name for hover synopsis');",
      "context": {
        "before": {
          "line": 3852,
          "text": "addIconInput.value = DEFAULT_HOVER_ICON;"
        },
        "current": {
          "line": 3853,
          "text": "setTooltip(addIconInput, 'Lucide icon name for hover synopsis');"
        },
        "after": {
          "line": 3854,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3876,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setTooltip(addCheckbox, 'Show in backdrop hover synopsis');",
      "context": {
        "before": {
          "line": 3875,
          "text": "addCheckbox.checked = false;"
        },
        "current": {
          "line": 3876,
          "text": "setTooltip(addCheckbox, 'Show in backdrop hover synopsis');"
        },
        "after": {
          "line": 3877,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 3963,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "backdropHoverPreviewBody.createDiv({ text: 'Enable fields using the checkboxes above to show them in backdrop hover synopsis.', cls: 'ert-hover-preview-empty' });",
      "context": {
        "before": {
          "line": 3962,
          "text": "backdropHoverPreviewHeading.setText('Backdrop Hover Metadata Preview (none enabled)');"
        },
        "current": {
          "line": 3963,
          "text": "backdropHoverPreviewBody.createDiv({ text: 'Enable fields using the checkboxes above to show them in backdrop hover synopsis.', cls: 'ert-hover-preview-empty' });"
        },
        "after": {
          "line": 3964,
          "text": "return;"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4280,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "`Fill ${fillEmptyPlan.filledFields} empty value${fillEmptyPlan.filledFields !== 1 ? 's' : ''} in ${fillEmptyPlan.files.length} note${fillEmptyPlan.files.length !== 1 ? 's' : ''}`",
      "context": {
        "before": {
          "line": 4279,
          "text": "'aria-label',"
        },
        "current": {
          "line": 4280,
          "text": "`Fill ${fillEmptyPlan.filledFields} empty value${fillEmptyPlan.filledFields !== 1 ? 's' : ''} in ${fillEmptyPlan.files.length} note${fillEmptyPlan.files.length !== 1 ? 's' : ''}`"
        },
        "after": {
          "line": 4281,
          "text": ");"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4294,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "`Delete extra fields from ${safeExtraNotes.length} note${safeExtraNotes.length !== 1 ? 's' : ''}`",
      "context": {
        "before": {
          "line": 4293,
          "text": "'aria-label',"
        },
        "current": {
          "line": 4294,
          "text": "`Delete extra fields from ${safeExtraNotes.length} note${safeExtraNotes.length !== 1 ? 's' : ''}`"
        },
        "after": {
          "line": 4295,
          "text": ");"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4301,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// at least one safe note has any of those advanced keys",
      "context": {
        "before": {
          "line": 4300,
          "text": "// Show delete-advanced button when an advanced template exists and"
        },
        "current": {
          "line": 4301,
          "text": "// at least one safe note has any of those advanced keys"
        },
        "after": {
          "line": 4302,
          "text": "const advancedKeySet = new Set(getCustomKeys(noteType, plugin.settings, activeBeatSystemKey));"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4314,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "`Delete advanced fields from ${notesWithAdvKeys.length} note${notesWithAdvKeys.length !== 1 ? 's' : ''}`",
      "context": {
        "before": {
          "line": 4313,
          "text": "'aria-label',"
        },
        "current": {
          "line": 4314,
          "text": "`Delete advanced fields from ${notesWithAdvKeys.length} note${notesWithAdvKeys.length !== 1 ? 's' : ''}`"
        },
        "after": {
          "line": 4315,
          "text": ");"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4331,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "`Reorder fields in ${safeDriftNotes.length} note${safeDriftNotes.length !== 1 ? 's' : ''}`",
      "context": {
        "before": {
          "line": 4330,
          "text": "'aria-label',"
        },
        "current": {
          "line": 4331,
          "text": "`Reorder fields in ${safeDriftNotes.length} note${safeDriftNotes.length !== 1 ? 's' : ''}`"
        },
        "after": {
          "line": 4332,
          "text": ");"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4382,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "headerEl.createSpan({ text: `  ${s.totalNotes} note${s.totalNotes !== 1 ? 's' : ''} scanned`, cls: 'ert-audit-summary' });",
      "context": {
        "before": {
          "line": 4381,
          "text": "healthEl.textContent = `Schema health: ${healthLabels[healthLevel]}`;"
        },
        "current": {
          "line": 4382,
          "text": "headerEl.createSpan({ text: `  ${s.totalNotes} note${s.totalNotes !== 1 ? 's' : ''} scanned`, cls: 'ert-audit-summary' });"
        },
        "after": {
          "line": 4383,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4388,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "text: `${s.notesUnsafe} note${s.notesUnsafe !== 1 ? 's have' : ' has'} dangerous frontmatter (broken YAML, code injection, or suspicious content). These notes are excluded from all batch operations. Open each file to inspect and fix manually.`",
      "context": {
        "before": {
          "line": 4387,
          "text": "unsafeBanner.createSpan({"
        },
        "current": {
          "line": 4388,
          "text": "text: `${s.notesUnsafe} note${s.notesUnsafe !== 1 ? 's have' : ' has'} dangerous frontmatter (broken YAML, code injection, or suspicious content). These notes are excluded from all batch operations. Open each file to inspect and fix manually.`"
        },
        "after": {
          "line": 4389,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4396,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "text: `${s.notesSuspicious} note${s.notesSuspicious !== 1 ? 's have' : ' has'} suspicious frontmatter  review before running batch operations.`",
      "context": {
        "before": {
          "line": 4395,
          "text": "suspectBanner.createSpan({"
        },
        "current": {
          "line": 4396,
          "text": "text: `${s.notesSuspicious} note${s.notesSuspicious !== 1 ? 's have' : ' has'} suspicious frontmatter  review before running batch operations.`"
        },
        "after": {
          "line": 4397,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4403,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "unreadEl.textContent = `${s.unreadNotes} note${s.unreadNotes !== 1 ? 's' : ''} not yet indexed  rerun audit after Obsidian finishes indexing.`;",
      "context": {
        "before": {
          "line": 4402,
          "text": "const unreadEl = resultsEl.createDiv({ cls: 'ert-audit-unread-warn' });"
        },
        "current": {
          "line": 4403,
          "text": "unreadEl.textContent = `${s.unreadNotes} note${s.unreadNotes !== 1 ? 's' : ''} not yet indexed  rerun audit after Obsidian finishes indexing.`;"
        },
        "after": {
          "line": 4404,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4408,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "emptyEl.textContent = `${emptyValueNotes} note${emptyValueNotes !== 1 ? 's' : ''} have ${emptyValueFields} empty custom field value${emptyValueFields !== 1 ? 's' : ''}.`;",
      "context": {
        "before": {
          "line": 4407,
          "text": "const emptyEl = resultsEl.createDiv({ cls: 'ert-audit-unread-warn' });"
        },
        "current": {
          "line": 4408,
          "text": "emptyEl.textContent = `${emptyValueNotes} note${emptyValueNotes !== 1 ? 's' : ''} have ${emptyValueFields} empty custom field value${emptyValueFields !== 1 ? 's' : ''}.`;"
        },
        "after": {
          "line": 4409,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4410,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const emptyDetails = resultsEl.createDiv({ cls: 'ert-audit-note-pills' });",
      "context": {
        "before": {
          "line": 4409,
          "text": ""
        },
        "current": {
          "line": 4410,
          "text": "const emptyDetails = resultsEl.createDiv({ cls: 'ert-audit-note-pills' });"
        },
        "after": {
          "line": 4411,
          "text": "for (const entry of fillEmptyPlan!.entries.slice(0, AUDIT_OPEN_ALL_MAX)) {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4414,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'ert-audit-note-pill ert-audit-note-pill--warning',",
      "context": {
        "before": {
          "line": 4413,
          "text": "const pillEl = emptyDetails.createEl('button', {"
        },
        "current": {
          "line": 4414,
          "text": "cls: 'ert-audit-note-pill ert-audit-note-pill--warning',"
        },
        "after": {
          "line": 4415,
          "text": "attr: { type: 'button' }"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4417,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "pillEl.createSpan({ text: entry.file.basename, cls: 'ert-audit-note-pill-name' });",
      "context": {
        "before": {
          "line": 4416,
          "text": "});"
        },
        "current": {
          "line": 4417,
          "text": "pillEl.createSpan({ text: entry.file.basename, cls: 'ert-audit-note-pill-name' });"
        },
        "after": {
          "line": 4418,
          "text": "pillEl.createSpan({ text: `  empty: ${keys}`, cls: 'ert-audit-note-pill-reason' });"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4418,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "pillEl.createSpan({ text: `  empty: ${keys}`, cls: 'ert-audit-note-pill-reason' });",
      "context": {
        "before": {
          "line": 4417,
          "text": "pillEl.createSpan({ text: entry.file.basename, cls: 'ert-audit-note-pill-name' });"
        },
        "current": {
          "line": 4418,
          "text": "pillEl.createSpan({ text: `  empty: ${keys}`, cls: 'ert-audit-note-pill-reason' });"
        },
        "after": {
          "line": 4419,
          "text": "setTooltip(pillEl, `${entry.file.basename}: empty values in ${keys}`);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4485,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note pills  flat list across the row, wrapping, up to 5 per page",
      "context": {
        "before": {
          "line": 4484,
          "text": ""
        },
        "current": {
          "line": 4485,
          "text": "// Note pills  flat list across the row, wrapping, up to 5 per page"
        },
        "after": {
          "line": 4486,
          "text": "let page = 0;"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4500,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note pills in a flowing row",
      "context": {
        "before": {
          "line": 4499,
          "text": ""
        },
        "current": {
          "line": 4500,
          "text": "// Note pills in a flowing row"
        },
        "after": {
          "line": 4501,
          "text": "const pillsEl = detailsEl.createDiv({ cls: 'ert-audit-note-pills' });"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4501,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const pillsEl = detailsEl.createDiv({ cls: 'ert-audit-note-pills' });",
      "context": {
        "before": {
          "line": 4500,
          "text": "// Note pills in a flowing row"
        },
        "current": {
          "line": 4501,
          "text": "const pillsEl = detailsEl.createDiv({ cls: 'ert-audit-note-pills' });"
        },
        "after": {
          "line": 4502,
          "text": "for (const entry of pageEntries) {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4526,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: `ert-audit-note-pill ert-audit-note-pill--${activeChip.kind}`,",
      "context": {
        "before": {
          "line": 4525,
          "text": "const pillEl = pillsEl.createEl('button', {"
        },
        "current": {
          "line": 4526,
          "text": "cls: `ert-audit-note-pill ert-audit-note-pill--${activeChip.kind}`,"
        },
        "after": {
          "line": 4527,
          "text": "attr: { type: 'button' }"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4541,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "pillEl.createSpan({ text: entry.file.basename, cls: 'ert-audit-note-pill-name' });",
      "context": {
        "before": {
          "line": 4540,
          "text": ""
        },
        "current": {
          "line": 4541,
          "text": "pillEl.createSpan({ text: entry.file.basename, cls: 'ert-audit-note-pill-name' });"
        },
        "after": {
          "line": 4542,
          "text": "pillEl.createSpan({ text: `  ${reasonShort}`, cls: 'ert-audit-note-pill-reason' });"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4542,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "pillEl.createSpan({ text: `  ${reasonShort}`, cls: 'ert-audit-note-pill-reason' });",
      "context": {
        "before": {
          "line": 4541,
          "text": "pillEl.createSpan({ text: entry.file.basename, cls: 'ert-audit-note-pill-name' });"
        },
        "current": {
          "line": 4542,
          "text": "pillEl.createSpan({ text: `  ${reasonShort}`, cls: 'ert-audit-note-pill-reason' });"
        },
        "after": {
          "line": 4543,
          "text": "setTooltip(pillEl, `${entry.file.basename}: ${reason}`);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4627,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "text: `Insert fields into ${targetFiles.length} ${noteType.toLowerCase()} note${targetFiles.length !== 1 ? 's' : ''}.`",
      "context": {
        "before": {
          "line": 4626,
          "text": "cls: 'ert-modal-subtitle',"
        },
        "current": {
          "line": 4627,
          "text": "text: `Insert fields into ${targetFiles.length} ${noteType.toLowerCase()} note${targetFiles.length !== 1 ? 's' : ''}.`"
        },
        "after": {
          "line": 4628,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4663,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "if (result.updated > 0) parts.push(`Updated ${result.updated} note${result.updated !== 1 ? 's' : ''}`);",
      "context": {
        "before": {
          "line": 4662,
          "text": "const parts: string[] = [];"
        },
        "current": {
          "line": 4663,
          "text": "if (result.updated > 0) parts.push(`Updated ${result.updated} note${result.updated !== 1 ? 's' : ''}`);"
        },
        "after": {
          "line": 4664,
          "text": "if (result.skipped > 0) parts.push(`${result.skipped} already had all fields`);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4698,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "text: `Fill ${fillEmptyPlan!.filledFields} empty value${fillEmptyPlan!.filledFields !== 1 ? 's' : ''} in ${fillEmptyPlan!.files.length} beat note${fillEmptyPlan!.files.length !== 1 ? 's' : ''}.`",
      "context": {
        "before": {
          "line": 4697,
          "text": "cls: 'ert-modal-subtitle',"
        },
        "current": {
          "line": 4698,
          "text": "text: `Fill ${fillEmptyPlan!.filledFields} empty value${fillEmptyPlan!.filledFields !== 1 ? 's' : ''} in ${fillEmptyPlan!.files.length} beat note${fillEmptyPlan!.files.length !== 1 ? 's' : ''}.`"
        },
        "after": {
          "line": 4699,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4739,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "if (result.updated > 0) parts.push(`Updated ${result.updated} note${result.updated !== 1 ? 's' : ''}`);",
      "context": {
        "before": {
          "line": 4738,
          "text": "const parts: string[] = [];"
        },
        "current": {
          "line": 4739,
          "text": "if (result.updated > 0) parts.push(`Updated ${result.updated} note${result.updated !== 1 ? 's' : ''}`);"
        },
        "after": {
          "line": 4740,
          "text": "if (result.filledFields > 0) parts.push(`Filled ${result.filledFields} value${result.filledFields !== 1 ? 's' : ''}`);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4828,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "text: `Remove ${totalFieldCount} extra field${totalFieldCount !== 1 ? 's' : ''} from ${notesWithExtra.length} ${noteType.toLowerCase()} note${notesWithExtra.length !== 1 ? 's' : ''}.`",
      "context": {
        "before": {
          "line": 4827,
          "text": "cls: 'ert-modal-subtitle',"
        },
        "current": {
          "line": 4828,
          "text": "text: `Remove ${totalFieldCount} extra field${totalFieldCount !== 1 ? 's' : ''} from ${notesWithExtra.length} ${noteType.toLowerCase()} note${notesWithExtra.length !== 1 ? 's' : ''}.`"
        },
        "after": {
          "line": 4829,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4834,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "banner.createSpan({ text: `${unsafeSkippedCount} note${unsafeSkippedCount !== 1 ? 's' : ''} with unsafe frontmatter excluded from this operation.` });",
      "context": {
        "before": {
          "line": 4833,
          "text": "const banner = modal.contentEl.createDiv({ cls: 'ert-audit-safety-banner ert-audit-safety-banner--danger' });"
        },
        "current": {
          "line": 4834,
          "text": "banner.createSpan({ text: `${unsafeSkippedCount} note${unsafeSkippedCount !== 1 ? 's' : ''} with unsafe frontmatter excluded from this operation.` });"
        },
        "after": {
          "line": 4835,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4841,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "banner.createSpan({ text: `${suspiciousCount} note${suspiciousCount !== 1 ? 's have' : ' has'} suspicious frontmatter  review carefully.` });",
      "context": {
        "before": {
          "line": 4840,
          "text": "const banner = modal.contentEl.createDiv({ cls: 'ert-audit-safety-banner ert-audit-safety-banner--warning' });"
        },
        "current": {
          "line": 4841,
          "text": "banner.createSpan({ text: `${suspiciousCount} note${suspiciousCount !== 1 ? 's have' : ' has'} suspicious frontmatter  review carefully.` });"
        },
        "after": {
          "line": 4842,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 4924,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "if (result.deleted > 0) parts.push(`Cleaned ${result.deleted} note${result.deleted !== 1 ? 's' : ''}`);",
      "context": {
        "before": {
          "line": 4923,
          "text": "const parts: string[] = [];"
        },
        "current": {
          "line": 4924,
          "text": "if (result.deleted > 0) parts.push(`Cleaned ${result.deleted} note${result.deleted !== 1 ? 's' : ''}`);"
        },
        "after": {
          "line": 4925,
          "text": "if (result.safetySkipped > 0) parts.push(`${result.safetySkipped} skipped (unsafe)`);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5017,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "text: `Remove ${totalFieldCount} advanced field${totalFieldCount !== 1 ? 's' : ''} from ${targetNotes.length} ${noteType.toLowerCase()} note${targetNotes.length !== 1 ? 's' : ''}. Base fields are never touched.`",
      "context": {
        "before": {
          "line": 5016,
          "text": "cls: 'ert-modal-subtitle',"
        },
        "current": {
          "line": 5017,
          "text": "text: `Remove ${totalFieldCount} advanced field${totalFieldCount !== 1 ? 's' : ''} from ${targetNotes.length} ${noteType.toLowerCase()} note${targetNotes.length !== 1 ? 's' : ''}. Base fields are never touched.`"
        },
        "after": {
          "line": 5018,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5022,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "banner.createSpan({ text: `${unsafeSkippedCount} note${unsafeSkippedCount !== 1 ? 's' : ''} with unsafe frontmatter excluded from this operation.` });",
      "context": {
        "before": {
          "line": 5021,
          "text": "const banner = modal.contentEl.createDiv({ cls: 'ert-audit-safety-banner ert-audit-safety-banner--danger' });"
        },
        "current": {
          "line": 5022,
          "text": "banner.createSpan({ text: `${unsafeSkippedCount} note${unsafeSkippedCount !== 1 ? 's' : ''} with unsafe frontmatter excluded from this operation.` });"
        },
        "after": {
          "line": 5023,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5028,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "banner.createSpan({ text: `${suspiciousCount} note${suspiciousCount !== 1 ? 's have' : ' has'} suspicious frontmatter  review carefully.` });",
      "context": {
        "before": {
          "line": 5027,
          "text": "const banner = modal.contentEl.createDiv({ cls: 'ert-audit-safety-banner ert-audit-safety-banner--warning' });"
        },
        "current": {
          "line": 5028,
          "text": "banner.createSpan({ text: `${suspiciousCount} note${suspiciousCount !== 1 ? 's have' : ' has'} suspicious frontmatter  review carefully.` });"
        },
        "after": {
          "line": 5029,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5118,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "if (result.deleted > 0) msgParts.push(`Cleaned ${result.deleted} note${result.deleted !== 1 ? 's' : ''}`);",
      "context": {
        "before": {
          "line": 5117,
          "text": "const msgParts: string[] = [];"
        },
        "current": {
          "line": 5118,
          "text": "if (result.deleted > 0) msgParts.push(`Cleaned ${result.deleted} note${result.deleted !== 1 ? 's' : ''}`);"
        },
        "after": {
          "line": 5119,
          "text": "if (result.safetySkipped > 0) msgParts.push(`${result.safetySkipped} skipped (unsafe)`);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5159,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "text: `Reorder fields in ${notesWithDrift.length} ${noteType.toLowerCase()} note${notesWithDrift.length !== 1 ? 's' : ''} to match the canonical template order.`",
      "context": {
        "before": {
          "line": 5158,
          "text": "cls: 'ert-modal-subtitle',"
        },
        "current": {
          "line": 5159,
          "text": "text: `Reorder fields in ${notesWithDrift.length} ${noteType.toLowerCase()} note${notesWithDrift.length !== 1 ? 's' : ''} to match the canonical template order.`"
        },
        "after": {
          "line": 5160,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5164,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "banner.createSpan({ text: `${unsafeSkippedCount} note${unsafeSkippedCount !== 1 ? 's' : ''} with unsafe frontmatter excluded from this operation.` });",
      "context": {
        "before": {
          "line": 5163,
          "text": "const banner = modal.contentEl.createDiv({ cls: 'ert-audit-safety-banner ert-audit-safety-banner--danger' });"
        },
        "current": {
          "line": 5164,
          "text": "banner.createSpan({ text: `${unsafeSkippedCount} note${unsafeSkippedCount !== 1 ? 's' : ''} with unsafe frontmatter excluded from this operation.` });"
        },
        "after": {
          "line": 5165,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5170,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "banner.createSpan({ text: `${suspiciousCount} note${suspiciousCount !== 1 ? 's have' : ' has'} suspicious frontmatter  proceed with caution.` });",
      "context": {
        "before": {
          "line": 5169,
          "text": "const banner = modal.contentEl.createDiv({ cls: 'ert-audit-safety-banner ert-audit-safety-banner--warning' });"
        },
        "current": {
          "line": 5170,
          "text": "banner.createSpan({ text: `${suspiciousCount} note${suspiciousCount !== 1 ? 's have' : ' has'} suspicious frontmatter  proceed with caution.` });"
        },
        "after": {
          "line": 5171,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5246,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "if (result.reordered > 0) parts.push(`Reordered ${result.reordered} note${result.reordered !== 1 ? 's' : ''}`);",
      "context": {
        "before": {
          "line": 5245,
          "text": "const parts: string[] = [];"
        },
        "current": {
          "line": 5246,
          "text": "if (result.reordered > 0) parts.push(`Reordered ${result.reordered} note${result.reordered !== 1 ? 's' : ''}`);"
        },
        "after": {
          "line": 5247,
          "text": "if (result.safetySkipped > 0) parts.push(`${result.safetySkipped} skipped (unsafe)`);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5264,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "`Fill ${fillEmptyPlan.filledFields} empty value${fillEmptyPlan.filledFields !== 1 ? 's' : ''} in ${fillEmptyPlan.files.length} note${fillEmptyPlan.files.length !== 1 ? 's' : ''}`",
      "context": {
        "before": {
          "line": 5263,
          "text": "'aria-label',"
        },
        "current": {
          "line": 5264,
          "text": "`Fill ${fillEmptyPlan.filledFields} empty value${fillEmptyPlan.filledFields !== 1 ? 's' : ''} in ${fillEmptyPlan.files.length} note${fillEmptyPlan.files.length !== 1 ? 's' : ''}`"
        },
        "after": {
          "line": 5265,
          "text": ");"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5341,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "baseDesc = `Create ${beats.length} beat note files for your custom system.`;",
      "context": {
        "before": {
          "line": 5340,
          "text": "setting.setName(`Beat notes in your vault for ${displayName}`);"
        },
        "current": {
          "line": 5341,
          "text": "baseDesc = `Create ${beats.length} beat note files for your custom system.`;"
        },
        "after": {
          "line": 5342,
          "text": "setting.setDesc(baseDesc);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5352,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "baseDesc = `Create ${selectedSystem} beat note files in your vault matching this system's structure.`;",
      "context": {
        "before": {
          "line": 5351,
          "text": "setting.setName(`Beat notes in your vault for ${selectedSystem}`);"
        },
        "current": {
          "line": 5352,
          "text": "baseDesc = `Create ${selectedSystem} beat note files in your vault matching this system's structure.`;"
        },
        "after": {
          "line": 5353,
          "text": "setting.setDesc(baseDesc);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5390,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "'Create beat note files in your source path',",
      "context": {
        "before": {
          "line": 5389,
          "text": "'Create beat notes',"
        },
        "current": {
          "line": 5390,
          "text": "'Create beat note files in your source path',"
        },
        "after": {
          "line": 5391,
          "text": "!hasBeats,"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5437,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "`Create ${newBeats} missing beat note${newBeats > 1 ? 's' : ''}`,",
      "context": {
        "before": {
          "line": 5436,
          "text": "setPrimaryDesignButton("
        },
        "current": {
          "line": 5437,
          "text": "`Create ${newBeats} missing beat note${newBeats > 1 ? 's' : ''}`,"
        },
        "after": {
          "line": 5438,
          "text": "`Create the remaining ${newBeats} beat note${newBeats > 1 ? 's' : ''} for ${selectedSystem}`,"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5438,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "`Create the remaining ${newBeats} beat note${newBeats > 1 ? 's' : ''} for ${selectedSystem}`,",
      "context": {
        "before": {
          "line": 5437,
          "text": "`Create ${newBeats} missing beat note${newBeats > 1 ? 's' : ''}`,"
        },
        "current": {
          "line": 5438,
          "text": "`Create the remaining ${newBeats} beat note${newBeats > 1 ? 's' : ''} for ${selectedSystem}`,"
        },
        "after": {
          "line": 5439,
          "text": "false,"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5471,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "`Create ${existingBeatExpectedCount} beat note files`,",
      "context": {
        "before": {
          "line": 5470,
          "text": "'Create beat notes',"
        },
        "current": {
          "line": 5471,
          "text": "`Create ${existingBeatExpectedCount} beat note files`,"
        },
        "after": {
          "line": 5472,
          "text": "false,"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5505,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "`Create ${newBeats} missing beat note${newBeats > 1 ? 's' : ''}`,",
      "context": {
        "before": {
          "line": 5504,
          "text": "setPrimaryDesignButton("
        },
        "current": {
          "line": 5505,
          "text": "`Create ${newBeats} missing beat note${newBeats > 1 ? 's' : ''}`,"
        },
        "after": {
          "line": 5506,
          "text": "`Create missing beat notes for ${newBeats} beat${newBeats > 1 ? 's' : ''} without files`,"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5525,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Show Repair only when the beat-note audit reports canonical mismatches.",
      "context": {
        "before": {
          "line": 5524,
          "text": ""
        },
        "current": {
          "line": 5525,
          "text": "// Show Repair only when the beat-note audit reports canonical mismatches."
        },
        "after": {
          "line": 5526,
          "text": "const hasLegacyToRepair = legacyMatched > 0;"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5531,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "repairBeatNotesButton.setButtonText(`Repair ${repairCount} beat note${repairCount > 1 ? 's' : ''}`);",
      "context": {
        "before": {
          "line": 5530,
          "text": "const repairCount = misaligned + missingModel + legacyMatched;"
        },
        "current": {
          "line": 5531,
          "text": "repairBeatNotesButton.setButtonText(`Repair ${repairCount} beat note${repairCount > 1 ? 's' : ''}`);"
        },
        "after": {
          "line": 5532,
          "text": "const repairBits: string[] = [];"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5536,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "repairBeatNotesButton.setTooltip(`Update Act, Beat Model, and Beat Id for ${repairBits.join(' and ')} beat note${repairCount > 1 ? 's' : ''}. Prefix numbers are not changed.`);",
      "context": {
        "before": {
          "line": 5535,
          "text": "if (legacyMatched > 0) repairBits.push(`${legacyMatched} missing Beat Id`);"
        },
        "current": {
          "line": 5536,
          "text": "repairBeatNotesButton.setTooltip(`Update Act, Beat Model, and Beat Id for ${repairBits.join(' and ')} beat note${repairCount > 1 ? 's' : ''}. Prefix numbers are not changed.`);"
        },
        "after": {
          "line": 5537,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5634,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Check Beat Id conflict: note already has a different Beat Id",
      "context": {
        "before": {
          "line": 5633,
          "text": ""
        },
        "current": {
          "line": 5634,
          "text": "// Check Beat Id conflict: note already has a different Beat Id"
        },
        "after": {
          "line": 5635,
          "text": "const existingBeatId = match[\"Beat Id\"];"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5705,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const modelHint = modelFixedCount > 0 ? ` Set Beat Model on ${modelFixedCount} note${modelFixedCount > 1 ? 's' : ''}.` : '';",
      "context": {
        "before": {
          "line": 5704,
          "text": "const duplicateHint = duplicates.length > 0 ? ` ${duplicates.length} duplicate title${duplicates.length > 1 ? 's' : ''} skipped (manually delete duplicate beat notes).` : '';"
        },
        "current": {
          "line": 5705,
          "text": "const modelHint = modelFixedCount > 0 ? ` Set Beat Model on ${modelFixedCount} note${modelFixedCount > 1 ? 's' : ''}.` : '';"
        },
        "after": {
          "line": 5706,
          "text": "const beatIdHint = beatIdWrittenCount > 0 ? ` Locked Beat Id on ${beatIdWrittenCount} note${beatIdWrittenCount > 1 ? 's' : ''}.` : '';"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5706,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const beatIdHint = beatIdWrittenCount > 0 ? ` Locked Beat Id on ${beatIdWrittenCount} note${beatIdWrittenCount > 1 ? 's' : ''}.` : '';",
      "context": {
        "before": {
          "line": 5705,
          "text": "const modelHint = modelFixedCount > 0 ? ` Set Beat Model on ${modelFixedCount} note${modelFixedCount > 1 ? 's' : ''}.` : '';"
        },
        "current": {
          "line": 5706,
          "text": "const beatIdHint = beatIdWrittenCount > 0 ? ` Locked Beat Id on ${beatIdWrittenCount} note${beatIdWrittenCount > 1 ? 's' : ''}.` : '';"
        },
        "after": {
          "line": 5707,
          "text": "const beatIdConflictHint = beatIdConflicts.length > 0 ? ` ${beatIdConflicts.length} Beat Id conflict${beatIdConflicts.length > 1 ? 's' : ''} (existing id differs).` : '';"
        }
      }
    },
    {
      "filePath": "src/settings/sections/BeatPropertiesSection.ts",
      "line": 5708,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "new Notice(`Repaired ${updatedCount} beat note${updatedCount > 1 ? 's' : ''} (Act, Beat Model).${modelHint}${beatIdHint}${conflictHint}${duplicateHint}${beatIdConflictHint}`);",
      "context": {
        "before": {
          "line": 5707,
          "text": "const beatIdConflictHint = beatIdConflicts.length > 0 ? ` ${beatIdConflicts.length} Beat Id conflict${beatIdConflicts.length > 1 ? 's' : ''} (existing id differs).` : '';"
        },
        "current": {
          "line": 5708,
          "text": "new Notice(`Repaired ${updatedCount} beat note${updatedCount > 1 ? 's' : ''} (Act, Beat Model).${modelHint}${beatIdHint}${conflictHint}${duplicateHint}${beatIdConflictHint}`);"
        },
        "after": {
          "line": 5709,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/settings/sections/CampaignManagerSection.ts",
      "line": 1261,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: Ring stage uses 5% for preview (shows ring) even though threshold is 0%",
      "context": {
        "before": {
          "line": 1260,
          "text": "// 4 stages with their properties (labels/icons from TEASER_LEVEL_INFO)"
        },
        "current": {
          "line": 1261,
          "text": "// Note: Ring stage uses 5% for preview (shows ring) even though threshold is 0%"
        },
        "after": {
          "line": 1262,
          "text": "const stages: {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ChronologueSection.ts",
      "line": 130,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "// Set fixed width for dropdown (override CSS with important)",
      "context": {
        "before": {
          "line": 129,
          "text": "});"
        },
        "current": {
          "line": 130,
          "text": "// Set fixed width for dropdown (override CSS with important)"
        },
        "after": {
          "line": 131,
          "text": "dropdown.selectEl.style.setProperty('width', '250px', 'important');"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ChronologueSection.ts",
      "line": 131,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "dropdown.selectEl.style.setProperty('width', '250px', 'important');",
      "context": {
        "before": {
          "line": 130,
          "text": "// Set fixed width for dropdown (override CSS with important)"
        },
        "current": {
          "line": 131,
          "text": "dropdown.selectEl.style.setProperty('width', '250px', 'important');"
        },
        "after": {
          "line": 132,
          "text": "dropdown.selectEl.style.setProperty('min-width', '250px', 'important');"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ChronologueSection.ts",
      "line": 132,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "dropdown.selectEl.style.setProperty('min-width', '250px', 'important');",
      "context": {
        "before": {
          "line": 131,
          "text": "dropdown.selectEl.style.setProperty('width', '250px', 'important');"
        },
        "current": {
          "line": 132,
          "text": "dropdown.selectEl.style.setProperty('min-width', '250px', 'important');"
        },
        "after": {
          "line": 133,
          "text": "dropdown.selectEl.style.setProperty('max-width', '250px', 'important');"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ChronologueSection.ts",
      "line": 133,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "dropdown.selectEl.style.setProperty('max-width', '250px', 'important');",
      "context": {
        "before": {
          "line": 132,
          "text": "dropdown.selectEl.style.setProperty('min-width', '250px', 'important');"
        },
        "current": {
          "line": 133,
          "text": "dropdown.selectEl.style.setProperty('max-width', '250px', 'important');"
        },
        "after": {
          "line": 134,
          "text": "plugin.registerDomEvent(dropdown.selectEl, 'focus', () => { void loadDurationOptions(true); });"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ConfigurationSection.ts",
      "line": 8,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { getSynopsisGenerationWordLimit, getSynopsisHoverLineLimit } from '../../utils/synopsisLimits';",
      "context": {
        "before": {
          "line": 7,
          "text": "import { IMPACT_FULL, IMPACT_DOMINANT_SUBPLOT } from '../SettingImpact';"
        },
        "current": {
          "line": 8,
          "text": "import { getSynopsisGenerationWordLimit, getSynopsisHoverLineLimit } from '../../utils/synopsisLimits';"
        },
        "after": {
          "line": 9,
          "text": "import { renderMetadataSection } from './MetadataSection';"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ConfigurationSection.ts",
      "line": 28,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// 1. Synopsis max words (drives generation and hover display)",
      "context": {
        "before": {
          "line": 27,
          "text": ""
        },
        "current": {
          "line": 28,
          "text": "// 1. Synopsis max words (drives generation and hover display)"
        },
        "after": {
          "line": 29,
          "text": "new Settings(stackEl)"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ConfigurationSection.ts",
      "line": 30,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": ".setName(t('settings.configuration.synopsisMaxLines.name'))",
      "context": {
        "before": {
          "line": 29,
          "text": "new Settings(stackEl)"
        },
        "current": {
          "line": 30,
          "text": ".setName(t('settings.configuration.synopsisMaxLines.name'))"
        },
        "after": {
          "line": 31,
          "text": ".setDesc(t('settings.configuration.synopsisMaxLines.desc'))"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ConfigurationSection.ts",
      "line": 31,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": ".setDesc(t('settings.configuration.synopsisMaxLines.desc'))",
      "context": {
        "before": {
          "line": 30,
          "text": ".setName(t('settings.configuration.synopsisMaxLines.name'))"
        },
        "current": {
          "line": 31,
          "text": ".setDesc(t('settings.configuration.synopsisMaxLines.desc'))"
        },
        "after": {
          "line": 32,
          "text": ".addText(text => {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ConfigurationSection.ts",
      "line": 33,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const current = String(getSynopsisGenerationWordLimit(plugin.settings));",
      "context": {
        "before": {
          "line": 32,
          "text": ".addText(text => {"
        },
        "current": {
          "line": 33,
          "text": "const current = String(getSynopsisGenerationWordLimit(plugin.settings));"
        },
        "after": {
          "line": 34,
          "text": "text.setPlaceholder(t('settings.configuration.synopsisMaxLines.placeholder'));"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ConfigurationSection.ts",
      "line": 34,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "text.setPlaceholder(t('settings.configuration.synopsisMaxLines.placeholder'));",
      "context": {
        "before": {
          "line": 33,
          "text": "const current = String(getSynopsisGenerationWordLimit(plugin.settings));"
        },
        "current": {
          "line": 34,
          "text": "text.setPlaceholder(t('settings.configuration.synopsisMaxLines.placeholder'));"
        },
        "after": {
          "line": 35,
          "text": "text.setValue(current);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ConfigurationSection.ts",
      "line": 48,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "new Notice(t('settings.configuration.synopsisMaxLines.error'));",
      "context": {
        "before": {
          "line": 47,
          "text": "if (!Number.isFinite(n) || n < 10 || n > 300) {"
        },
        "current": {
          "line": 48,
          "text": "new Notice(t('settings.configuration.synopsisMaxLines.error'));"
        },
        "after": {
          "line": 49,
          "text": "text.setValue(String(getSynopsisGenerationWordLimit(plugin.settings)));"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ConfigurationSection.ts",
      "line": 49,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "text.setValue(String(getSynopsisGenerationWordLimit(plugin.settings)));",
      "context": {
        "before": {
          "line": 48,
          "text": "new Notice(t('settings.configuration.synopsisMaxLines.error'));"
        },
        "current": {
          "line": 49,
          "text": "text.setValue(String(getSynopsisGenerationWordLimit(plugin.settings)));"
        },
        "after": {
          "line": 50,
          "text": "return;"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ConfigurationSection.ts",
      "line": 52,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "plugin.settings.synopsisGenerationMaxWords = Math.round(n);",
      "context": {
        "before": {
          "line": 51,
          "text": "}"
        },
        "current": {
          "line": 52,
          "text": "plugin.settings.synopsisGenerationMaxWords = Math.round(n);"
        },
        "after": {
          "line": 53,
          "text": "// Keep legacy line-based setting synchronized for compatibility paths."
        }
      }
    },
    {
      "filePath": "src/settings/sections/ConfigurationSection.ts",
      "line": 54,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "plugin.settings.synopsisHoverMaxLines = getSynopsisHoverLineLimit(plugin.settings);",
      "context": {
        "before": {
          "line": 53,
          "text": "// Keep legacy line-based setting synchronized for compatibility paths."
        },
        "current": {
          "line": 54,
          "text": "plugin.settings.synopsisHoverMaxLines = getSynopsisHoverLineLimit(plugin.settings);"
        },
        "after": {
          "line": 55,
          "text": "await plugin.saveSettings();"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ConfigurationSection.ts",
      "line": 56,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "plugin.onSettingChanged(IMPACT_FULL); // Tier 3: synopsis content/line limits affect hover SVG layout",
      "context": {
        "before": {
          "line": 55,
          "text": "await plugin.saveSettings();"
        },
        "current": {
          "line": 56,
          "text": "plugin.onSettingChanged(IMPACT_FULL); // Tier 3: synopsis content/line limits affect hover SVG layout"
        },
        "after": {
          "line": 57,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ConfigurationSection.ts",
      "line": 62,
      "token": "Ripple Rename",
      "category": "drift-term",
      "lineText": "// 1a. Manuscript ripple rename",
      "context": {
        "before": {
          "line": 61,
          "text": ""
        },
        "current": {
          "line": 62,
          "text": "// 1a. Manuscript ripple rename"
        },
        "after": {
          "line": 63,
          "text": "new Settings(stackEl)"
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 96,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const SYNOPSIS_CAPABLE_CLASSES = new Set(['scene', 'outline']);",
      "context": {
        "before": {
          "line": 95,
          "text": "const REFERENCE_ONLY_CLASSES = new Set(['character', 'place', 'power']);"
        },
        "current": {
          "line": 96,
          "text": "const SYNOPSIS_CAPABLE_CLASSES = new Set(['scene', 'outline']);"
        },
        "after": {
          "line": 97,
          "text": "const CONTRIBUTION_MODES: InquiryMaterialMode[] = ['none', 'summary', 'full'];"
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 111,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isSynopsisCapableClass = (className: string): boolean =>",
      "context": {
        "before": {
          "line": 110,
          "text": ""
        },
        "current": {
          "line": 111,
          "text": "const isSynopsisCapableClass = (className: string): boolean =>"
        },
        "after": {
          "line": 112,
          "text": "SYNOPSIS_CAPABLE_CLASSES.has(className.toLowerCase());"
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 112,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "SYNOPSIS_CAPABLE_CLASSES.has(className.toLowerCase());",
      "context": {
        "before": {
          "line": 111,
          "text": "const isSynopsisCapableClass = (className: string): boolean =>"
        },
        "current": {
          "line": 112,
          "text": "SYNOPSIS_CAPABLE_CLASSES.has(className.toLowerCase());"
        },
        "after": {
          "line": 113,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 115,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (mode === 'summary' && !isSynopsisCapableClass(className)) {",
      "context": {
        "before": {
          "line": 114,
          "text": "const normalizeContributionMode = (mode: InquiryMaterialMode, className: string): InquiryMaterialMode => {"
        },
        "current": {
          "line": 115,
          "text": "if (mode === 'summary' && !isSynopsisCapableClass(className)) {"
        },
        "after": {
          "line": 116,
          "text": "return 'full';"
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 122,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "isSynopsisCapableClass(className) ? ['none', 'summary', 'full'] : ['none', 'full'];",
      "context": {
        "before": {
          "line": 121,
          "text": "const getContributionModesForClass = (className: string): InquiryMaterialMode[] =>"
        },
        "current": {
          "line": 122,
          "text": "isSynopsisCapableClass(className) ? ['none', 'summary', 'full'] : ['none', 'full'];"
        },
        "after": {
          "line": 123,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 138,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isReference = !isSynopsisCapableClass(config.className);",
      "context": {
        "before": {
          "line": 137,
          "text": "const normalizeClassContribution = (config: InquiryClassConfig): InquiryClassConfig => {"
        },
        "current": {
          "line": 138,
          "text": "const isReference = !isSynopsisCapableClass(config.className);"
        },
        "after": {
          "line": 139,
          "text": "const bookScope = isReference ? 'none' : normalizeContributionMode(config.bookScope, config.className);"
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 152,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!isSynopsisCapableClass(normalized)) {",
      "context": {
        "before": {
          "line": 151,
          "text": "const normalized = className.toLowerCase();"
        },
        "current": {
          "line": 152,
          "text": "if (!isSynopsisCapableClass(normalized)) {"
        },
        "after": {
          "line": 153,
          "text": "return { book: false, saga: false, reference: true };"
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 173,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isReference = !isSynopsisCapableClass(normalized);",
      "context": {
        "before": {
          "line": 172,
          "text": "const isOutline = normalized === 'outline';"
        },
        "current": {
          "line": 173,
          "text": "const isReference = !isSynopsisCapableClass(normalized);"
        },
        "after": {
          "line": 174,
          "text": "return {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 299,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "?? (!isSynopsisCapableClass(config.className.toLowerCase()) ? true : false),",
      "context": {
        "before": {
          "line": 298,
          "text": "(config as InquiryClassConfig).referenceScope"
        },
        "current": {
          "line": 299,
          "text": "?? (!isSynopsisCapableClass(config.className.toLowerCase()) ? true : false),"
        },
        "after": {
          "line": 300,
          "text": "config.className.toLowerCase()"
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 430,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": ".setDesc('A class is the label in a note\\'s YAML (frontmatter) that says what kind of note it is (scene, outline, character, place). One class per line. Use / to allow all classes. Empty = no classes allowed.');",
      "context": {
        "before": {
          "line": 429,
          "text": ".setName('Inquiry class scope')"
        },
        "current": {
          "line": 430,
          "text": ".setDesc('A class is the label in a note\\'s YAML (frontmatter) that says what kind of note it is (scene, outline, character, place). One class per line. Use / to allow all classes. Empty = no classes allowed.');"
        },
        "after": {
          "line": 431,
          "text": "classScopeSetting.settingEl.setAttribute('data-ert-role', 'inquiry-setting:class-scope');"
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 569,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isSynopsisCapable = isSynopsisCapableClass(config.className);",
      "context": {
        "before": {
          "line": 568,
          "text": ""
        },
        "current": {
          "line": 569,
          "text": "const isSynopsisCapable = isSynopsisCapableClass(config.className);"
        },
        "after": {
          "line": 570,
          "text": "const isReference = !isSynopsisCapable;"
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 570,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isReference = !isSynopsisCapable;",
      "context": {
        "before": {
          "line": 569,
          "text": "const isSynopsisCapable = isSynopsisCapableClass(config.className);"
        },
        "current": {
          "line": 570,
          "text": "const isReference = !isSynopsisCapable;"
        },
        "after": {
          "line": 571,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 601,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!isSynopsisCapable) {",
      "context": {
        "before": {
          "line": 600,
          "text": "const bookCell = row.createDiv({ cls: 'ert-controlGroup__cell' });"
        },
        "current": {
          "line": 601,
          "text": "if (!isSynopsisCapable) {"
        },
        "after": {
          "line": 602,
          "text": "bookCell.createSpan({ cls: 'ert-controlGroup__cell--meta', text: '' });"
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 616,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!isSynopsisCapable) {",
      "context": {
        "before": {
          "line": 615,
          "text": "const sagaCell = row.createDiv({ cls: 'ert-controlGroup__cell' });"
        },
        "current": {
          "line": 616,
          "text": "if (!isSynopsisCapable) {"
        },
        "after": {
          "line": 617,
          "text": "sagaCell.createSpan({ cls: 'ert-controlGroup__cell--meta', text: '' });"
        }
      }
    },
    {
      "filePath": "src/settings/sections/InquirySection.ts",
      "line": 662,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isReference = !isSynopsisCapableClass(normalized);",
      "context": {
        "before": {
          "line": 661,
          "text": "const normalized = className.toLowerCase();"
        },
        "current": {
          "line": 662,
          "text": "const isReference = !isSynopsisCapableClass(normalized);"
        },
        "after": {
          "line": 663,
          "text": "if (preset === 'default') {"
        }
      }
    },
    {
      "filePath": "src/settings/sections/MetadataSection.ts",
      "line": 5,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "'Class', 'When', 'Subplot', 'Act', 'Duration', 'Character', 'POV', 'Place', 'Synopsis',",
      "context": {
        "before": {
          "line": 4,
          "text": "const CANONICAL_KEYS = ["
        },
        "current": {
          "line": 5,
          "text": "'Class', 'When', 'Subplot', 'Act', 'Duration', 'Character', 'POV', 'Place', 'Synopsis',"
        },
        "after": {
          "line": 6,
          "text": "'Summary', 'Status', 'Publish Stage', 'Due', 'Pending Edits', 'Beat Model', 'Range',"
        }
      }
    },
    {
      "filePath": "src/settings/sections/PovSection.ts",
      "line": 58,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "plugin.onSettingChanged(IMPACT_FULL); // Tier 3: POV superscripts baked into SVG synopsis",
      "context": {
        "before": {
          "line": 57,
          "text": "await plugin.saveSettings();"
        },
        "current": {
          "line": 58,
          "text": "plugin.onSettingChanged(IMPACT_FULL); // Tier 3: POV superscripts baked into SVG synopsis"
        },
        "after": {
          "line": 59,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ProfessionalSection.ts",
      "line": 393,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "Synopsis: 'Jane meets detective Mike at a coffee shop to discuss the Henderson case.',",
      "context": {
        "before": {
          "line": 392,
          "text": "{"
        },
        "current": {
          "line": 393,
          "text": "Synopsis: 'Jane meets detective Mike at a coffee shop to discuss the Henderson case.',"
        },
        "after": {
          "line": 394,
          "text": "POV: 'Jane',"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ProfessionalSection.ts",
      "line": 407,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "Synopsis: 'Introduction and interview with Dr. Sarah Chen about AI and creativity.',",
      "context": {
        "before": {
          "line": 406,
          "text": "{"
        },
        "current": {
          "line": 407,
          "text": "Synopsis: 'Introduction and interview with Dr. Sarah Chen about AI and creativity.',"
        },
        "after": {
          "line": 408,
          "text": "Runtime: '8:00',"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ProfessionalSection.ts",
      "line": 420,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "Synopsis: 'Emma discovers a hidden key inside a hollowed-out book in the old library.',",
      "context": {
        "before": {
          "line": 419,
          "text": "{"
        },
        "current": {
          "line": 420,
          "text": "Synopsis: 'Emma discovers a hidden key inside a hollowed-out book in the old library.',"
        },
        "after": {
          "line": 421,
          "text": "POV: 'Emma',"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ProfessionalSection.ts",
      "line": 518,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "'HOST: A perfect note to end on. Dr. Sarah Chen, thank you.',",
      "context": {
        "before": {
          "line": 517,
          "text": "'',"
        },
        "current": {
          "line": 518,
          "text": "'HOST: A perfect note to end on. Dr. Sarah Chen, thank you.',"
        },
        "after": {
          "line": 519,
          "text": "'',"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ProfessionalSection.ts",
      "line": 1018,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "// TODO(#SAN-1): Connect to license validation API when beta ends.",
      "context": {
        "before": {
          "line": 1017,
          "text": "}"
        },
        "current": {
          "line": 1018,
          "text": "// TODO(#SAN-1): Connect to license validation API when beta ends."
        },
        "after": {
          "line": 1019,
          "text": "return key.trim().length >= 16;"
        }
      }
    },
    {
      "filePath": "src/settings/sections/ProfessionalSection.ts",
      "line": 1377,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "text: 'Advanced (LaTeX in Body)  Write raw LaTeX directly inside matter note bodies.'",
      "context": {
        "before": {
          "line": 1376,
          "text": "workflowList.createEl('li', {"
        },
        "current": {
          "line": 1377,
          "text": "text: 'Advanced (LaTeX in Body)  Write raw LaTeX directly inside matter note bodies.'"
        },
        "after": {
          "line": 1378,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/settings/sections/PublicationSection.ts",
      "line": 360,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: This is the MILESTONES system, separate from TimelineMetricsService (estimation/tick tracking)",
      "context": {
        "before": {
          "line": 359,
          "text": "// This ensures the hero cards match the timeline indicator exactly"
        },
        "current": {
          "line": 360,
          "text": "// Note: This is the MILESTONES system, separate from TimelineMetricsService (estimation/tick tracking)"
        },
        "after": {
          "line": 361,
          "text": "const milestone = plugin.milestonesService.detectMilestone(scenes);"
        }
      }
    },
    {
      "filePath": "src/services/AuthorProgressService.ts",
      "line": 227,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Check if target is 'note' (Pro feature)",
      "context": {
        "before": {
          "line": 226,
          "text": "if (mode === 'dynamic') {"
        },
        "current": {
          "line": 227,
          "text": "// Check if target is 'note' (Pro feature)"
        },
        "after": {
          "line": 228,
          "text": "if (settings.defaultPublishTarget === 'note') {"
        }
      }
    },
    {
      "filePath": "src/services/AuthorProgressService.ts",
      "line": 228,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "if (settings.defaultPublishTarget === 'note') {",
      "context": {
        "before": {
          "line": 227,
          "text": "// Check if target is 'note' (Pro feature)"
        },
        "current": {
          "line": 228,
          "text": "if (settings.defaultPublishTarget === 'note') {"
        },
        "after": {
          "line": 229,
          "text": "if (!isProfessionalActive(this.plugin)) {"
        }
      }
    },
    {
      "filePath": "src/services/AuthorProgressService.ts",
      "line": 230,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "new Notice('Note publishing is a Pro feature. Upgrade to Pro to use this feature.');",
      "context": {
        "before": {
          "line": 229,
          "text": "if (!isProfessionalActive(this.plugin)) {"
        },
        "current": {
          "line": 230,
          "text": "new Notice('Note publishing is a Pro feature. Upgrade to Pro to use this feature.');"
        },
        "after": {
          "line": 231,
          "text": "return null;"
        }
      }
    },
    {
      "filePath": "src/services/AuthorProgressService.ts",
      "line": 271,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Create a note with embedded APR SVG (Pro feature).",
      "context": {
        "before": {
          "line": 270,
          "text": "/**"
        },
        "current": {
          "line": 271,
          "text": "* Create a note with embedded APR SVG (Pro feature)."
        },
        "after": {
          "line": 272,
          "text": "* Supports preset layout or custom template based on defaultNoteBehavior."
        }
      }
    },
    {
      "filePath": "src/services/AuthorProgressService.ts",
      "line": 289,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Determine note path (same folder as SVG, different filename)",
      "context": {
        "before": {
          "line": 288,
          "text": ""
        },
        "current": {
          "line": 289,
          "text": "// Determine note path (same folder as SVG, different filename)"
        },
        "after": {
          "line": 290,
          "text": "const svgFolder = svgPath.substring(0, svgPath.lastIndexOf('/')) || 'Radial Timeline/Social';"
        }
      }
    },
    {
      "filePath": "src/services/AuthorProgressService.ts",
      "line": 320,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Create or update the note",
      "context": {
        "before": {
          "line": 319,
          "text": ""
        },
        "current": {
          "line": 320,
          "text": "// Create or update the note"
        },
        "after": {
          "line": 321,
          "text": "const existingNote = this.app.vault.getAbstractFileByPath(notePath);"
        }
      }
    },
    {
      "filePath": "src/services/AuthorProgressService.ts",
      "line": 336,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Create preset note content with SVG embed and author comment placeholder.",
      "context": {
        "before": {
          "line": 335,
          "text": "/**"
        },
        "current": {
          "line": 336,
          "text": "* Create preset note content with SVG embed and author comment placeholder."
        },
        "after": {
          "line": 337,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 94,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "id: 'create-basic-scene-note',",
      "context": {
        "before": {
          "line": 93,
          "text": "this.plugin.addCommand({"
        },
        "current": {
          "line": 94,
          "text": "id: 'create-basic-scene-note',"
        },
        "after": {
          "line": 95,
          "text": "name: 'Create basic scene note',"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 95,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "name: 'Create basic scene note',",
      "context": {
        "before": {
          "line": 94,
          "text": "id: 'create-basic-scene-note',"
        },
        "current": {
          "line": 95,
          "text": "name: 'Create basic scene note',"
        },
        "after": {
          "line": 96,
          "text": "callback: async () => {"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 102,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "id: 'create-advanced-scene-note',",
      "context": {
        "before": {
          "line": 101,
          "text": "this.plugin.addCommand({"
        },
        "current": {
          "line": 102,
          "text": "id: 'create-advanced-scene-note',"
        },
        "after": {
          "line": 103,
          "text": "name: 'Create advanced scene note',"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 103,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "name: 'Create advanced scene note',",
      "context": {
        "before": {
          "line": 102,
          "text": "id: 'create-advanced-scene-note',"
        },
        "current": {
          "line": 103,
          "text": "name: 'Create advanced scene note',"
        },
        "after": {
          "line": 104,
          "text": "callback: async () => {"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 110,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "id: 'create-screenplay-scene-note',",
      "context": {
        "before": {
          "line": 109,
          "text": "this.plugin.addCommand({"
        },
        "current": {
          "line": 110,
          "text": "id: 'create-screenplay-scene-note',"
        },
        "after": {
          "line": 111,
          "text": "name: 'Create screenplay scene note',"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 111,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "name: 'Create screenplay scene note',",
      "context": {
        "before": {
          "line": 110,
          "text": "id: 'create-screenplay-scene-note',"
        },
        "current": {
          "line": 111,
          "text": "name: 'Create screenplay scene note',"
        },
        "after": {
          "line": 112,
          "text": "callback: async () => {"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 118,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "id: 'create-podcast-scene-note',",
      "context": {
        "before": {
          "line": 117,
          "text": "this.plugin.addCommand({"
        },
        "current": {
          "line": 118,
          "text": "id: 'create-podcast-scene-note',"
        },
        "after": {
          "line": 119,
          "text": "name: 'Create podcast scene note',"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 119,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "name: 'Create podcast scene note',",
      "context": {
        "before": {
          "line": 118,
          "text": "id: 'create-podcast-scene-note',"
        },
        "current": {
          "line": 119,
          "text": "name: 'Create podcast scene note',"
        },
        "after": {
          "line": 120,
          "text": "callback: async () => {"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 126,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "id: 'create-frontmatter-note',",
      "context": {
        "before": {
          "line": 125,
          "text": "this.plugin.addCommand({"
        },
        "current": {
          "line": 126,
          "text": "id: 'create-frontmatter-note',"
        },
        "after": {
          "line": 127,
          "text": "name: 'Create front matter note',"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 127,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "name: 'Create front matter note',",
      "context": {
        "before": {
          "line": 126,
          "text": "id: 'create-frontmatter-note',"
        },
        "current": {
          "line": 127,
          "text": "name: 'Create front matter note',"
        },
        "after": {
          "line": 128,
          "text": "callback: async () => {"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 134,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "id: 'create-backmatter-note',",
      "context": {
        "before": {
          "line": 133,
          "text": "this.plugin.addCommand({"
        },
        "current": {
          "line": 134,
          "text": "id: 'create-backmatter-note',"
        },
        "after": {
          "line": 135,
          "text": "name: 'Create back matter note',"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 135,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "name: 'Create back matter note',",
      "context": {
        "before": {
          "line": 134,
          "text": "id: 'create-backmatter-note',"
        },
        "current": {
          "line": 135,
          "text": "name: 'Create back matter note',"
        },
        "after": {
          "line": 136,
          "text": "callback: async () => {"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 142,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "id: 'create-bookmeta-note',",
      "context": {
        "before": {
          "line": 141,
          "text": "this.plugin.addCommand({"
        },
        "current": {
          "line": 142,
          "text": "id: 'create-bookmeta-note',"
        },
        "after": {
          "line": 143,
          "text": "name: 'Create BookMeta note',"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 143,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "name: 'Create BookMeta note',",
      "context": {
        "before": {
          "line": 142,
          "text": "id: 'create-bookmeta-note',"
        },
        "current": {
          "line": 143,
          "text": "name: 'Create BookMeta note',"
        },
        "after": {
          "line": 144,
          "text": "callback: async () => {"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 150,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "id: 'create-backdrop-note',",
      "context": {
        "before": {
          "line": 149,
          "text": "this.plugin.addCommand({"
        },
        "current": {
          "line": 150,
          "text": "id: 'create-backdrop-note',"
        },
        "after": {
          "line": 151,
          "text": "name: 'Create backdrop note',"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 151,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "name: 'Create backdrop note',",
      "context": {
        "before": {
          "line": 150,
          "text": "id: 'create-backdrop-note',"
        },
        "current": {
          "line": 151,
          "text": "name: 'Create backdrop note',"
        },
        "after": {
          "line": 152,
          "text": "callback: async () => {"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 290,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "result.includeSynopsis ?? false,",
      "context": {
        "before": {
          "line": 289,
          "text": "result.outlinePreset || 'beat-sheet',"
        },
        "current": {
          "line": 290,
          "text": "result.includeSynopsis ?? false,"
        },
        "after": {
          "line": 291,
          "text": "runtimeSettings"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 316,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "statusMessages.push('No BookMeta note found. Semantic matter pages may render incomplete.');",
      "context": {
        "before": {
          "line": 315,
          "text": "if (!bookMetaResolution.bookMeta && this.selectionRequiresBookMeta(slicedFiles, filteredSelection.matterMetaByPath)) {"
        },
        "current": {
          "line": 316,
          "text": "statusMessages.push('No BookMeta note found. Semantic matter pages may render incomplete.');"
        },
        "after": {
          "line": 317,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 576,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Create a new scene note with basic, advanced, screenplay, or podcast template.",
      "context": {
        "before": {
          "line": 575,
          "text": "/**"
        },
        "current": {
          "line": 576,
          "text": "* Create a new scene note with basic, advanced, screenplay, or podcast template."
        },
        "after": {
          "line": 577,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 648,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "new Notice(`Created ${labelMap[type]} scene note: ${filename}`);",
      "context": {
        "before": {
          "line": 647,
          "text": "};"
        },
        "current": {
          "line": 648,
          "text": "new Notice(`Created ${labelMap[type]} scene note: ${filename}`);"
        },
        "after": {
          "line": 649,
          "text": "} catch (error) {"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 651,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "new Notice('Failed to create scene note: ' + msg);",
      "context": {
        "before": {
          "line": 650,
          "text": "const msg = (error as any)?.message || String(error);"
        },
        "current": {
          "line": 651,
          "text": "new Notice('Failed to create scene note: ' + msg);"
        },
        "after": {
          "line": 652,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 656,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Create a new front-matter or back-matter note.",
      "context": {
        "before": {
          "line": 655,
          "text": "/**"
        },
        "current": {
          "line": 656,
          "text": "* Create a new front-matter or back-matter note."
        },
        "after": {
          "line": 657,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 693,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "new Notice(`Created ${defaultLabel.toLowerCase()} note: ${filename}`);",
      "context": {
        "before": {
          "line": 692,
          "text": "await leaf.openFile(newFile);"
        },
        "current": {
          "line": 693,
          "text": "new Notice(`Created ${defaultLabel.toLowerCase()} note: ${filename}`);"
        },
        "after": {
          "line": 694,
          "text": "} catch (error) {"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 696,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "new Notice(`Failed to create ${classValue.toLowerCase()} note: ${msg}`);",
      "context": {
        "before": {
          "line": 695,
          "text": "const msg = (error as any)?.message || String(error);"
        },
        "current": {
          "line": 696,
          "text": "new Notice(`Failed to create ${classValue.toLowerCase()} note: ${msg}`);"
        },
        "after": {
          "line": 697,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 733,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "new Notice(`Created BookMeta note: ${newFile.name}`);",
      "context": {
        "before": {
          "line": 732,
          "text": "await leaf.openFile(newFile);"
        },
        "current": {
          "line": 733,
          "text": "new Notice(`Created BookMeta note: ${newFile.name}`);"
        },
        "after": {
          "line": 734,
          "text": "} catch (error) {"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 736,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "new Notice(`Failed to create BookMeta note: ${msg}`);",
      "context": {
        "before": {
          "line": 735,
          "text": "const msg = (error as any)?.message || String(error);"
        },
        "current": {
          "line": 736,
          "text": "new Notice(`Failed to create BookMeta note: ${msg}`);"
        },
        "after": {
          "line": 737,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 746,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const typed = window.prompt('No active source folder found. Enter folder path for BookMeta note:', this.plugin.settings.sourcePath || '');",
      "context": {
        "before": {
          "line": 745,
          "text": ""
        },
        "current": {
          "line": 746,
          "text": "const typed = window.prompt('No active source folder found. Enter folder path for BookMeta note:', this.plugin.settings.sourcePath || '');"
        },
        "after": {
          "line": 747,
          "text": "if (typed === null) return null;"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 775,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Create a new backdrop note.",
      "context": {
        "before": {
          "line": 774,
          "text": "/**"
        },
        "current": {
          "line": 775,
          "text": "* Create a new backdrop note."
        },
        "after": {
          "line": 776,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 809,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "new Notice(`Created backdrop note: ${filename}`);",
      "context": {
        "before": {
          "line": 808,
          "text": "await leaf.openFile(newFile);"
        },
        "current": {
          "line": 809,
          "text": "new Notice(`Created backdrop note: ${filename}`);"
        },
        "after": {
          "line": 810,
          "text": "} catch (error) {"
        }
      }
    },
    {
      "filePath": "src/services/CommandRegistrar.ts",
      "line": 812,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "new Notice('Failed to create backdrop note: ' + msg);",
      "context": {
        "before": {
          "line": 811,
          "text": "const msg = (error as any)?.message || String(error);"
        },
        "current": {
          "line": 812,
          "text": "new Notice('Failed to create backdrop note: ' + msg);"
        },
        "after": {
          "line": 813,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/FileTrackingService.ts",
      "line": 76,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "this.plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 75,
          "text": "this.updateOpenFilesTracking();"
        },
        "current": {
          "line": 76,
          "text": "this.plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 77,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/FileTrackingService.ts",
      "line": 83,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "this.plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 82,
          "text": "this.updateOpenFilesTracking();"
        },
        "current": {
          "line": 83,
          "text": "this.plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 84,
          "text": "}));"
        }
      }
    },
    {
      "filePath": "src/services/FileTrackingService.ts",
      "line": 86,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "this.plugin.registerEvent(this.plugin.app.vault.on('delete', (file) => this.plugin.refreshTimelineIfNeeded(file)));",
      "context": {
        "before": {
          "line": 85,
          "text": ""
        },
        "current": {
          "line": 86,
          "text": "this.plugin.registerEvent(this.plugin.app.vault.on('delete', (file) => this.plugin.refreshTimelineIfNeeded(file)));"
        },
        "after": {
          "line": 87,
          "text": "this.plugin.registerEvent(this.plugin.app.vault.on('rename', (file, oldPath) => this.handleFileRename(file, oldPath)));"
        }
      }
    },
    {
      "filePath": "src/services/FileTrackingService.ts",
      "line": 104,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "this.plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 103,
          "text": "} catch {"
        },
        "current": {
          "line": 104,
          "text": "this.plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 105,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/FileTrackingService.ts",
      "line": 116,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "this.plugin.refreshTimelineIfNeeded(file);",
      "context": {
        "before": {
          "line": 115,
          "text": "}"
        },
        "current": {
          "line": 116,
          "text": "this.plugin.refreshTimelineIfNeeded(file);"
        },
        "after": {
          "line": 117,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/HoverHighlighter.ts",
      "line": 94,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "this.plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 93,
          "text": "this.plugin.openScenePaths.add(file.path);"
        },
        "current": {
          "line": 94,
          "text": "this.plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 95,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/MilestonesService.ts",
      "line": 44,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Note: This is binary detection (stage done or not), not continuous progress tracking.",
      "context": {
        "before": {
          "line": 43,
          "text": "*"
        },
        "current": {
          "line": 44,
          "text": "* Note: This is binary detection (stage done or not), not continuous progress tracking."
        },
        "after": {
          "line": 45,
          "text": "* For progress tracking, see TimelineMetricsService.calculateCompletionEstimate()"
        }
      }
    },
    {
      "filePath": "src/services/RendererService.ts",
      "line": 20,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { updateSynopsisText, updateSynopsisVisibility } from '../renderer/dom/SynopsisDOMUpdater';",
      "context": {
        "before": {
          "line": 19,
          "text": "import { updateNumberSquareStates, updateNumberSquareGrades } from '../renderer/dom/NumberSquareDOMUpdater';"
        },
        "current": {
          "line": 20,
          "text": "import { updateSynopsisText, updateSynopsisVisibility } from '../renderer/dom/SynopsisDOMUpdater';"
        },
        "after": {
          "line": 21,
          "text": "import { updateSubplotLabels, updateSubplotLabelVisibility } from '../renderer/dom/SubplotLabelDOMUpdater';"
        }
      }
    },
    {
      "filePath": "src/services/RendererService.ts",
      "line": 59,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Note: This is the MILESTONES system (stage completions), separate from",
      "context": {
        "before": {
          "line": 58,
          "text": "*"
        },
        "current": {
          "line": 59,
          "text": "* Note: This is the MILESTONES system (stage completions), separate from"
        },
        "after": {
          "line": 60,
          "text": "* TimelineMetricsService which handles estimation/tick tracking."
        }
      }
    },
    {
      "filePath": "src/services/RendererService.ts",
      "line": 104,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Update synopsis text content (DOM update)",
      "context": {
        "before": {
          "line": 103,
          "text": "/**"
        },
        "current": {
          "line": 104,
          "text": "* Update synopsis text content (DOM update)"
        },
        "after": {
          "line": 105,
          "text": "* Accepts either (container, scenes) or (container, plugin) for compatibility"
        }
      }
    },
    {
      "filePath": "src/services/RendererService.ts",
      "line": 107,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "updateSynopsisDOM(container: HTMLElement, pluginOrScenes: RadialTimelinePlugin | TimelineItem[]): boolean {",
      "context": {
        "before": {
          "line": 106,
          "text": "*/"
        },
        "current": {
          "line": 107,
          "text": "updateSynopsisDOM(container: HTMLElement, pluginOrScenes: RadialTimelinePlugin | TimelineItem[]): boolean {"
        },
        "after": {
          "line": 108,
          "text": "const svg = container.querySelector('.radial-timeline-svg') as SVGSVGElement | null;"
        }
      }
    },
    {
      "filePath": "src/services/RendererService.ts",
      "line": 113,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return updateSynopsisText(svg, pluginOrScenes);",
      "context": {
        "before": {
          "line": 112,
          "text": "if (Array.isArray(pluginOrScenes)) {"
        },
        "current": {
          "line": 113,
          "text": "return updateSynopsisText(svg, pluginOrScenes);"
        },
        "after": {
          "line": 114,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/RendererService.ts",
      "line": 118,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "updateSynopsisText(svg, scenes);",
      "context": {
        "before": {
          "line": 117,
          "text": "const scenes = pluginAny.lastSceneData || [];"
        },
        "current": {
          "line": 118,
          "text": "updateSynopsisText(svg, scenes);"
        },
        "after": {
          "line": 119,
          "text": "updateSynopsisVisibility(svg, pluginOrScenes.openScenePaths || new Set());"
        }
      }
    },
    {
      "filePath": "src/services/RendererService.ts",
      "line": 119,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "updateSynopsisVisibility(svg, pluginOrScenes.openScenePaths || new Set());",
      "context": {
        "before": {
          "line": 118,
          "text": "updateSynopsisText(svg, scenes);"
        },
        "current": {
          "line": 119,
          "text": "updateSynopsisVisibility(svg, pluginOrScenes.openScenePaths || new Set());"
        },
        "after": {
          "line": 120,
          "text": "return true;"
        }
      }
    },
    {
      "filePath": "src/services/RendererService.ts",
      "line": 177,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Remove existing inline tspan markers for synopsis text highlighting",
      "context": {
        "before": {
          "line": 176,
          "text": ""
        },
        "current": {
          "line": 177,
          "text": "// Remove existing inline tspan markers for synopsis text highlighting"
        },
        "after": {
          "line": 178,
          "text": "const existing = svg.querySelectorAll('.rt-search-term');"
        }
      }
    },
    {
      "filePath": "src/services/RendererService.ts",
      "line": 340,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const firstSynopsis = svg.querySelector('.rt-scene-info');",
      "context": {
        "before": {
          "line": 339,
          "text": ""
        },
        "current": {
          "line": 340,
          "text": "const firstSynopsis = svg.querySelector('.rt-scene-info');"
        },
        "after": {
          "line": 341,
          "text": "if (firstSynopsis) {"
        }
      }
    },
    {
      "filePath": "src/services/RendererService.ts",
      "line": 341,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (firstSynopsis) {",
      "context": {
        "before": {
          "line": 340,
          "text": "const firstSynopsis = svg.querySelector('.rt-scene-info');"
        },
        "current": {
          "line": 341,
          "text": "if (firstSynopsis) {"
        },
        "after": {
          "line": 342,
          "text": "if (spokesNode) firstSynopsis.parentNode?.insertBefore(spokesNode, firstSynopsis);"
        }
      }
    },
    {
      "filePath": "src/services/RendererService.ts",
      "line": 342,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (spokesNode) firstSynopsis.parentNode?.insertBefore(spokesNode, firstSynopsis);",
      "context": {
        "before": {
          "line": 341,
          "text": "if (firstSynopsis) {"
        },
        "current": {
          "line": 342,
          "text": "if (spokesNode) firstSynopsis.parentNode?.insertBefore(spokesNode, firstSynopsis);"
        },
        "after": {
          "line": 343,
          "text": "if (layerNode) firstSynopsis.parentNode?.insertBefore(layerNode, firstSynopsis);"
        }
      }
    },
    {
      "filePath": "src/services/RendererService.ts",
      "line": 343,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (layerNode) firstSynopsis.parentNode?.insertBefore(layerNode, firstSynopsis);",
      "context": {
        "before": {
          "line": 342,
          "text": "if (spokesNode) firstSynopsis.parentNode?.insertBefore(spokesNode, firstSynopsis);"
        },
        "current": {
          "line": 343,
          "text": "if (layerNode) firstSynopsis.parentNode?.insertBefore(layerNode, firstSynopsis);"
        },
        "after": {
          "line": 344,
          "text": "} else {"
        }
      }
    },
    {
      "filePath": "src/services/SceneAnalysisService.ts",
      "line": 17,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.registerSynopsisCommand();",
      "context": {
        "before": {
          "line": 16,
          "text": "this.registerSubplotCommand();"
        },
        "current": {
          "line": 17,
          "text": "this.registerSynopsisCommand();"
        },
        "after": {
          "line": 18,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/SceneAnalysisService.ts",
      "line": 20,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private registerSynopsisCommand(): void {",
      "context": {
        "before": {
          "line": 19,
          "text": ""
        },
        "current": {
          "line": 20,
          "text": "private registerSynopsisCommand(): void {"
        },
        "after": {
          "line": 21,
          "text": "this.plugin.addCommand({"
        }
      }
    },
    {
      "filePath": "src/services/SceneAnalysisService.ts",
      "line": 29,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "await this.processSynopsisAnalysis();",
      "context": {
        "before": {
          "line": 28,
          "text": "if (!this.ensureApiKey()) return;"
        },
        "current": {
          "line": 29,
          "text": "await this.processSynopsisAnalysis();"
        },
        "after": {
          "line": 30,
          "text": "})();"
        }
      }
    },
    {
      "filePath": "src/services/SceneAnalysisService.ts",
      "line": 182,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "async processSynopsisAnalysis(): Promise<void> {",
      "context": {
        "before": {
          "line": 181,
          "text": ""
        },
        "current": {
          "line": 182,
          "text": "async processSynopsisAnalysis(): Promise<void> {"
        },
        "after": {
          "line": 183,
          "text": "const { processSynopsisByManuscriptOrder } = await import('../sceneAnalysis/SynopsisCommands');"
        }
      }
    },
    {
      "filePath": "src/services/SceneAnalysisService.ts",
      "line": 183,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const { processSynopsisByManuscriptOrder } = await import('../sceneAnalysis/SynopsisCommands');",
      "context": {
        "before": {
          "line": 182,
          "text": "async processSynopsisAnalysis(): Promise<void> {"
        },
        "current": {
          "line": 183,
          "text": "const { processSynopsisByManuscriptOrder } = await import('../sceneAnalysis/SynopsisCommands');"
        },
        "after": {
          "line": 184,
          "text": "await processSynopsisByManuscriptOrder(this.plugin, this.plugin.app.vault);"
        }
      }
    },
    {
      "filePath": "src/services/SceneAnalysisService.ts",
      "line": 184,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "await processSynopsisByManuscriptOrder(this.plugin, this.plugin.app.vault);",
      "context": {
        "before": {
          "line": 183,
          "text": "const { processSynopsisByManuscriptOrder } = await import('../sceneAnalysis/SynopsisCommands');"
        },
        "current": {
          "line": 184,
          "text": "await processSynopsisByManuscriptOrder(this.plugin, this.plugin.app.vault);"
        },
        "after": {
          "line": 185,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 110,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Populated during getSceneData()  returns null if no BookMeta note exists.",
      "context": {
        "before": {
          "line": 109,
          "text": "* Get the BookMeta for the active manuscript."
        },
        "current": {
          "line": 110,
          "text": "* Populated during getSceneData()  returns null if no BookMeta note exists."
        },
        "after": {
          "line": 111,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 145,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Reset BookMeta  will be populated if a BookMeta note is found",
      "context": {
        "before": {
          "line": 144,
          "text": "const plotsToProcess: Array<{ file: TFile, metadata: Record<string, unknown>, validActNumber: number }> = [];"
        },
        "current": {
          "line": 145,
          "text": "// Reset BookMeta  will be populated if a BookMeta note is found"
        },
        "after": {
          "line": 146,
          "text": "this._bookMeta = null;"
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 205,
      "token": "legacy key",
      "category": "drift-term",
      "lineText": "// Compat: Check for legacy keys (metrics only)",
      "context": {
        "before": {
          "line": 204,
          "text": ""
        },
        "current": {
          "line": 205,
          "text": "// Compat: Check for legacy keys (metrics only)"
        },
        "after": {
          "line": 206,
          "text": "if (rawMetadata) {"
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 275,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis: metadata.Synopsis as string | undefined,",
      "context": {
        "before": {
          "line": 274,
          "text": "Character: characterList,"
        },
        "current": {
          "line": 275,
          "text": "synopsis: metadata.Synopsis as string | undefined,"
        },
        "after": {
          "line": 276,
          "text": "Summary: metadata.Summary as string | undefined,"
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 282,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: \"Iterations\" is a separate numeric field for revision count",
      "context": {
        "before": {
          "line": 281,
          "text": "// Only read Pending Edits field (text notes for next revision)"
        },
        "current": {
          "line": 282,
          "text": "// Note: \"Iterations\" is a separate numeric field for revision count"
        },
        "after": {
          "line": 283,
          "text": "const raw = metadata[\"Pending Edits\"];"
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 334,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const legacySynopsisValue = typeof metadata.Synopsis === 'string'",
      "context": {
        "before": {
          "line": 333,
          "text": ": undefined;"
        },
        "current": {
          "line": 334,
          "text": "const legacySynopsisValue = typeof metadata.Synopsis === 'string'"
        },
        "after": {
          "line": 335,
          "text": "? metadata.Synopsis"
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 335,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "? metadata.Synopsis",
      "context": {
        "before": {
          "line": 334,
          "text": "const legacySynopsisValue = typeof metadata.Synopsis === 'string'"
        },
        "current": {
          "line": 335,
          "text": "? metadata.Synopsis"
        },
        "after": {
          "line": 336,
          "text": ": undefined;"
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 337,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const backdropContext = contextValue ?? legacySynopsisValue;",
      "context": {
        "before": {
          "line": 336,
          "text": ": undefined;"
        },
        "current": {
          "line": 337,
          "text": "const backdropContext = contextValue ?? legacySynopsisValue;"
        },
        "after": {
          "line": 338,
          "text": "if (!contextValue && legacySynopsisValue) {"
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 338,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!contextValue && legacySynopsisValue) {",
      "context": {
        "before": {
          "line": 337,
          "text": "const backdropContext = contextValue ?? legacySynopsisValue;"
        },
        "current": {
          "line": 338,
          "text": "if (!contextValue && legacySynopsisValue) {"
        },
        "after": {
          "line": 339,
          "text": "this.trackCompatUsage('Backdrop.Synopsis->Context', file.path, 'Using legacy field \"Synopsis\" for backdrop Context. Consider renaming to \"Context\".');"
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 339,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.trackCompatUsage('Backdrop.Synopsis->Context', file.path, 'Using legacy field \"Synopsis\" for backdrop Context. Consider renaming to \"Context\".');",
      "context": {
        "before": {
          "line": 338,
          "text": "if (!contextValue && legacySynopsisValue) {"
        },
        "current": {
          "line": 339,
          "text": "this.trackCompatUsage('Backdrop.Synopsis->Context', file.path, 'Using legacy field \"Synopsis\" for backdrop Context. Consider renaming to \"Context\".');"
        },
        "after": {
          "line": 340,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 347,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis: backdropContext, // Backdrop hover context",
      "context": {
        "before": {
          "line": 346,
          "text": "title: file.basename, // Use filename as title, as requested"
        },
        "current": {
          "line": 347,
          "text": "synopsis: backdropContext, // Backdrop hover context"
        },
        "after": {
          "line": 348,
          "text": "Context: backdropContext,"
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 357,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// BookMeta note  central metadata source for the manuscript.",
      "context": {
        "before": {
          "line": 356,
          "text": "} else if (metadata && metadata.Class === \"BookMeta\") {"
        },
        "current": {
          "line": 357,
          "text": "// BookMeta note  central metadata source for the manuscript."
        },
        "after": {
          "line": 358,
          "text": "// Exactly one per book. Parsed and stored, NOT added to scenes array."
        }
      }
    },
    {
      "filePath": "src/services/SceneDataService.ts",
      "line": 506,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis: metadata.Synopsis as string | undefined,",
      "context": {
        "before": {
          "line": 505,
          "text": "actNumber: validActNumber,"
        },
        "current": {
          "line": 506,
          "text": "synopsis: metadata.Synopsis as string | undefined,"
        },
        "after": {
          "line": 507,
          "text": "Purpose: purpose,"
        }
      }
    },
    {
      "filePath": "src/services/SceneHighlighter.ts",
      "line": 57,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsis = svgElement.querySelector(`.rt-scene-info[data-for-scene=\"${sceneId}\"]`);",
      "context": {
        "before": {
          "line": 56,
          "text": "allScenePaths.forEach(element => element.classList.add('rt-non-selected'));"
        },
        "current": {
          "line": 57,
          "text": "const synopsis = svgElement.querySelector(`.rt-scene-info[data-for-scene=\"${sceneId}\"]`);"
        },
        "after": {
          "line": 58,
          "text": "if (synopsis) synopsis.classList.add('rt-visible');"
        }
      }
    },
    {
      "filePath": "src/services/SceneHighlighter.ts",
      "line": 58,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (synopsis) synopsis.classList.add('rt-visible');",
      "context": {
        "before": {
          "line": 57,
          "text": "const synopsis = svgElement.querySelector(`.rt-scene-info[data-for-scene=\"${sceneId}\"]`);"
        },
        "current": {
          "line": 58,
          "text": "if (synopsis) synopsis.classList.add('rt-visible');"
        },
        "after": {
          "line": 59,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/SceneHighlighter.ts",
      "line": 66,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsis = svgElement.querySelector(`.rt-scene-info[data-for-scene=\"${sceneId}\"]`);",
      "context": {
        "before": {
          "line": 65,
          "text": "const sceneId = (currentPath as SVGPathElement).id;"
        },
        "current": {
          "line": 66,
          "text": "const synopsis = svgElement.querySelector(`.rt-scene-info[data-for-scene=\"${sceneId}\"]`);"
        },
        "after": {
          "line": 67,
          "text": "if (synopsis) synopsis.classList.remove('rt-visible');"
        }
      }
    },
    {
      "filePath": "src/services/SceneHighlighter.ts",
      "line": 67,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (synopsis) synopsis.classList.remove('rt-visible');",
      "context": {
        "before": {
          "line": 66,
          "text": "const synopsis = svgElement.querySelector(`.rt-scene-info[data-for-scene=\"${sceneId}\"]`);"
        },
        "current": {
          "line": 67,
          "text": "if (synopsis) synopsis.classList.remove('rt-visible');"
        },
        "after": {
          "line": 68,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/services/SceneReorderService.ts",
      "line": 26,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "* Uses two-phase rename: ALL files go through temp namespace first.",
      "context": {
        "before": {
          "line": 25,
          "text": "* Apply scene updates - updates frontmatter and renames files."
        },
        "current": {
          "line": 26,
          "text": "* Uses two-phase rename: ALL files go through temp namespace first."
        },
        "after": {
          "line": 27,
          "text": "* This is the safest approach - never rename directly from old to new."
        }
      }
    },
    {
      "filePath": "src/services/SceneReorderService.ts",
      "line": 45,
      "token": "Ripple Rename",
      "category": "drift-term",
      "lineText": "// Ripple rename passes number-only updates and should not touch file contents.",
      "context": {
        "before": {
          "line": 44,
          "text": "// Update frontmatter only when explicitly requested."
        },
        "current": {
          "line": 45,
          "text": "// Ripple rename passes number-only updates and should not touch file contents."
        },
        "after": {
          "line": 46,
          "text": "const needsFrontmatterUpdate = update.actNumber !== undefined || update.subplots !== undefined;"
        }
      }
    },
    {
      "filePath": "src/services/SceneReorderService.ts",
      "line": 69,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "// Simple temp name: z + final basename (sorts to end, easy to spot)",
      "context": {
        "before": {
          "line": 68,
          "text": "const prefix = parentPath ? `${parentPath}/` : '';"
        },
        "current": {
          "line": 69,
          "text": "// Simple temp name: z + final basename (sorts to end, easy to spot)"
        },
        "after": {
          "line": 70,
          "text": "const tempBasename = `z${finalBasename}`;"
        }
      }
    },
    {
      "filePath": "src/services/SceneReorderService.ts",
      "line": 83,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "// Phase 1: Rename ALL files to temp namespace",
      "context": {
        "before": {
          "line": 82,
          "text": ""
        },
        "current": {
          "line": 83,
          "text": "// Phase 1: Rename ALL files to temp namespace"
        },
        "after": {
          "line": 84,
          "text": "// This clears ALL original positions"
        }
      }
    },
    {
      "filePath": "src/services/SceneReorderService.ts",
      "line": 92,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "// Phase 2: Rename ALL files from temp to final",
      "context": {
        "before": {
          "line": 91,
          "text": ""
        },
        "current": {
          "line": 92,
          "text": "// Phase 2: Rename ALL files from temp to final"
        },
        "after": {
          "line": 93,
          "text": "// All target positions are now guaranteed free"
        }
      }
    },
    {
      "filePath": "src/services/SceneReorderService.ts",
      "line": 219,
      "token": "Ripple Rename",
      "category": "drift-term",
      "lineText": "* Build a targeted manuscript-wide ripple rename plan.",
      "context": {
        "before": {
          "line": 218,
          "text": "/**"
        },
        "current": {
          "line": 219,
          "text": "* Build a targeted manuscript-wide ripple rename plan."
        },
        "after": {
          "line": 220,
          "text": "* Expects input already filtered to the active beat set."
        }
      }
    },
    {
      "filePath": "src/services/SearchService.ts",
      "line": 28,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "header.createDiv({ text: 'Search scenes by title, synopsis, characters, dates, and more.', cls: 'ert-modal-subtitle' });",
      "context": {
        "before": {
          "line": 27,
          "text": "header.createDiv({ text: 'Search timeline', cls: 'ert-modal-title' });"
        },
        "current": {
          "line": 28,
          "text": "header.createDiv({ text: 'Search scenes by title, synopsis, characters, dates, and more.', cls: 'ert-modal-subtitle' });"
        },
        "after": {
          "line": 29,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/services/SearchService.ts",
      "line": 110,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Helper to format date for display matching what's shown in the synopsis",
      "context": {
        "before": {
          "line": 109,
          "text": ""
        },
        "current": {
          "line": 110,
          "text": "// Helper to format date for display matching what's shown in the synopsis"
        },
        "after": {
          "line": 111,
          "text": "const formatDateForDisplay = (when: Date | undefined): string => {"
        }
      }
    },
    {
      "filePath": "src/services/SearchService.ts",
      "line": 163,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "scene.synopsis,",
      "context": {
        "before": {
          "line": 162,
          "text": "scene.title,"
        },
        "current": {
          "line": 163,
          "text": "scene.synopsis,"
        },
        "after": {
          "line": 164,
          "text": "...(scene.Character || []),"
        }
      }
    },
    {
      "filePath": "src/services/SubplotManagementService.ts",
      "line": 222,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// NOTE: This service doesn't persist settings to disk.",
      "context": {
        "before": {
          "line": 221,
          "text": "// For now, we update the memory object. The plugin needs to persist it."
        },
        "current": {
          "line": 222,
          "text": "// NOTE: This service doesn't persist settings to disk."
        },
        "after": {
          "line": 223,
          "text": "// The Modal usually has access to Plugin. We should return a flag or let the Modal handle settings update?"
        }
      }
    },
    {
      "filePath": "src/services/TimelineMetricsService.ts",
      "line": 162,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const normalizedStatus = scene.status?.toString().trim().toLowerCase() || 'todo';",
      "context": {
        "before": {
          "line": 161,
          "text": "const sceneStageIndex = STAGE_ORDER.indexOf(sceneStage);"
        },
        "current": {
          "line": 162,
          "text": "const normalizedStatus = scene.status?.toString().trim().toLowerCase() || 'todo';"
        },
        "after": {
          "line": 163,
          "text": "const isSceneComplete = normalizedStatus === 'complete' || normalizedStatus === 'done' || normalizedStatus === 'completed';"
        }
      }
    },
    {
      "filePath": "src/services/TimelineService.ts",
      "line": 72,
      "token": "ChangeType.SETTINGS",
      "category": "drift-term",
      "lineText": "changeTypes.includes(ChangeType.SETTINGS)) {",
      "context": {
        "before": {
          "line": 71,
          "text": "changeTypes.includes(ChangeType.MODE) ||"
        },
        "current": {
          "line": 72,
          "text": "changeTypes.includes(ChangeType.SETTINGS)) {"
        },
        "after": {
          "line": 73,
          "text": "return 0;"
        }
      }
    },
    {
      "filePath": "src/services/TimelineService.ts",
      "line": 114,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "refreshTimelineIfNeeded(file: TAbstractFile | null | undefined, delayMs?: number): void {",
      "context": {
        "before": {
          "line": 113,
          "text": "*/"
        },
        "current": {
          "line": 114,
          "text": "refreshTimelineIfNeeded(file: TAbstractFile | null | undefined, delayMs?: number): void {"
        },
        "after": {
          "line": 115,
          "text": "if (file && (!(file instanceof TFile) || file.extension !== 'md')) return;"
        }
      }
    },
    {
      "filePath": "src/services/TimelineService.ts",
      "line": 122,
      "token": "ChangeType.SETTINGS",
      "category": "drift-term",
      "lineText": "this.scheduleRender([ChangeType.SETTINGS], effectiveDelay);",
      "context": {
        "before": {
          "line": 121,
          "text": "if (!file) {"
        },
        "current": {
          "line": 122,
          "text": "this.scheduleRender([ChangeType.SETTINGS], effectiveDelay);"
        },
        "after": {
          "line": 123,
          "text": "return;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/Maintenance.ts",
      "line": 120,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "Synopsis: 'Dummy synopsis for testing YAML update.',",
      "context": {
        "before": {
          "line": 119,
          "text": "Class: 'Scene',"
        },
        "current": {
          "line": 120,
          "text": "Synopsis: 'Dummy synopsis for testing YAML update.',"
        },
        "after": {
          "line": 121,
          "text": "Subplot: ['Test Arc'],"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/Maintenance.ts",
      "line": 309,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 308,
          "text": "await plugin.saveSettings();"
        },
        "current": {
          "line": 309,
          "text": "plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 310,
          "text": "new Notice(`Purged beats from ${purgedCount} of ${allScenes.length} scene${allScenes.length !== 1 ? 's' : ''}.`);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/Maintenance.ts",
      "line": 348,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 347,
          "text": "await plugin.saveSettings();"
        },
        "current": {
          "line": 348,
          "text": "plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 349,
          "text": "new Notice(`Purged beats from ${purgedCount} of ${filtered.length} scene${filtered.length !== 1 ? 's' : ''} in subplot \"${subplotName}\".`);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/Processor.ts",
      "line": 278,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 277,
          "text": "await plugin.saveSettings();"
        },
        "current": {
          "line": 278,
          "text": "plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 279,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/Processor.ts",
      "line": 409,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 408,
          "text": "new Notice(`Subplot order processing complete: ${totalProcessedCount}/${totalTripletsAcrossSubplots} triplets processed.`);"
        },
        "current": {
          "line": 409,
          "text": "plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 410,
          "text": "} catch (error) {"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/Processor.ts",
      "line": 583,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 582,
          "text": "await plugin.saveSettings();"
        },
        "current": {
          "line": 583,
          "text": "plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 584,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/Processor.ts",
      "line": 748,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 747,
          "text": "await plugin.saveSettings();"
        },
        "current": {
          "line": 748,
          "text": "plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 749,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 7,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Synopsis = concise, skimmable navigation text (strict word-capped)  optional for scene hovers.",
      "context": {
        "before": {
          "line": 6,
          "text": "* Summary = extended AI-generated scene analysis (200300 words, configurable)  primary artifact for Inquiry corpus."
        },
        "current": {
          "line": 7,
          "text": "* Synopsis = concise, skimmable navigation text (strict word-capped)  optional for scene hovers."
        },
        "after": {
          "line": 8,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 14,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { classifySynopsis } from './synopsisQuality';",
      "context": {
        "before": {
          "line": 13,
          "text": "import { getAllSceneData, compareScenesByOrder, getSummaryUpdateFlag, hasProcessableContent } from './data';"
        },
        "current": {
          "line": 14,
          "text": "import { classifySynopsis } from './synopsisQuality';"
        },
        "after": {
          "line": 15,
          "text": "import { buildSummaryPrompt, buildSynopsisPrompt } from '../ai/prompts/synopsis';"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 15,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { buildSummaryPrompt, buildSynopsisPrompt } from '../ai/prompts/synopsis';",
      "context": {
        "before": {
          "line": 14,
          "text": "import { classifySynopsis } from './synopsisQuality';"
        },
        "current": {
          "line": 15,
          "text": "import { buildSummaryPrompt, buildSynopsisPrompt } from '../ai/prompts/synopsis';"
        },
        "after": {
          "line": 16,
          "text": "import { createAiRunner } from './RequestRunner';"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 21,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { getSynopsisGenerationWordLimit, truncateToWordLimit } from '../utils/synopsisLimits';",
      "context": {
        "before": {
          "line": 20,
          "text": "import { normalizeBooleanValue } from '../utils/sceneHelpers';"
        },
        "current": {
          "line": 21,
          "text": "import { getSynopsisGenerationWordLimit, truncateToWordLimit } from '../utils/synopsisLimits';"
        },
        "after": {
          "line": 22,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 68,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "function placeSummaryAfterSynopsis(frontmatter: Record<string, unknown>): void {",
      "context": {
        "before": {
          "line": 67,
          "text": ""
        },
        "current": {
          "line": 68,
          "text": "function placeSummaryAfterSynopsis(frontmatter: Record<string, unknown>): void {"
        },
        "after": {
          "line": 69,
          "text": "const keys = Object.keys(frontmatter);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 71,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisKey = keys.find(key => key.toLowerCase() === 'synopsis');",
      "context": {
        "before": {
          "line": 70,
          "text": "const summaryKey = keys.find(key => key.toLowerCase() === 'summary');"
        },
        "current": {
          "line": 71,
          "text": "const synopsisKey = keys.find(key => key.toLowerCase() === 'synopsis');"
        },
        "after": {
          "line": 72,
          "text": "if (!summaryKey || !synopsisKey) return;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 72,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!summaryKey || !synopsisKey) return;",
      "context": {
        "before": {
          "line": 71,
          "text": "const synopsisKey = keys.find(key => key.toLowerCase() === 'synopsis');"
        },
        "current": {
          "line": 72,
          "text": "if (!summaryKey || !synopsisKey) return;"
        },
        "after": {
          "line": 73,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 75,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisIndex = keys.indexOf(synopsisKey);",
      "context": {
        "before": {
          "line": 74,
          "text": "const summaryIndex = keys.indexOf(summaryKey);"
        },
        "current": {
          "line": 75,
          "text": "const synopsisIndex = keys.indexOf(synopsisKey);"
        },
        "after": {
          "line": 76,
          "text": "if (summaryIndex === synopsisIndex + 1) return;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 76,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (summaryIndex === synopsisIndex + 1) return;",
      "context": {
        "before": {
          "line": 75,
          "text": "const synopsisIndex = keys.indexOf(synopsisKey);"
        },
        "current": {
          "line": 76,
          "text": "if (summaryIndex === synopsisIndex + 1) return;"
        },
        "after": {
          "line": 77,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 79,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "reorderedKeys.splice(reorderedKeys.indexOf(synopsisKey) + 1, 0, summaryKey);",
      "context": {
        "before": {
          "line": 78,
          "text": "const reorderedKeys = keys.filter(key => key !== summaryKey);"
        },
        "current": {
          "line": 79,
          "text": "reorderedKeys.splice(reorderedKeys.indexOf(synopsisKey) + 1, 0, summaryKey);"
        },
        "after": {
          "line": 80,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 95,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisText?: string",
      "context": {
        "before": {
          "line": 94,
          "text": "summaryText: string,"
        },
        "current": {
          "line": 95,
          "text": "synopsisText?: string"
        },
        "after": {
          "line": 96,
          "text": "): Promise<{ summary: string; synopsis?: string }> {"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 96,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "): Promise<{ summary: string; synopsis?: string }> {",
      "context": {
        "before": {
          "line": 95,
          "text": "synopsisText?: string"
        },
        "current": {
          "line": 96,
          "text": "): Promise<{ summary: string; synopsis?: string }> {"
        },
        "after": {
          "line": 97,
          "text": "const file = plugin.app.vault.getAbstractFileByPath(scenePath);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 103,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsis = synopsisText ? String(synopsisText).trim() : undefined;",
      "context": {
        "before": {
          "line": 102,
          "text": "const summary = String(summaryText ?? '').trim();"
        },
        "current": {
          "line": 103,
          "text": "const synopsis = synopsisText ? String(synopsisText).trim() : undefined;"
        },
        "after": {
          "line": 104,
          "text": "const modelId = getCurrentModelId(plugin);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 121,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (synopsis) {",
      "context": {
        "before": {
          "line": 120,
          "text": "setCaseInsensitiveField(frontmatter, 'Summary', summary);"
        },
        "current": {
          "line": 121,
          "text": "if (synopsis) {"
        },
        "after": {
          "line": 122,
          "text": "setCaseInsensitiveField(frontmatter, 'Synopsis', synopsis);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 122,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "setCaseInsensitiveField(frontmatter, 'Synopsis', synopsis);",
      "context": {
        "before": {
          "line": 121,
          "text": "if (synopsis) {"
        },
        "current": {
          "line": 122,
          "text": "setCaseInsensitiveField(frontmatter, 'Synopsis', synopsis);"
        },
        "after": {
          "line": 123,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 125,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Keep Summary near Synopsis for scene authoring readability.",
      "context": {
        "before": {
          "line": 124,
          "text": ""
        },
        "current": {
          "line": 125,
          "text": "// Keep Summary near Synopsis for scene authoring readability."
        },
        "after": {
          "line": 126,
          "text": "placeSummaryAfterSynopsis(frontmatter);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 126,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "placeSummaryAfterSynopsis(frontmatter);",
      "context": {
        "before": {
          "line": 125,
          "text": "// Keep Summary near Synopsis for scene authoring readability."
        },
        "current": {
          "line": 126,
          "text": "placeSummaryAfterSynopsis(frontmatter);"
        },
        "after": {
          "line": 127,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 128,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Replace Summary Update / legacy Synopsis Update flag with timestamp",
      "context": {
        "before": {
          "line": 127,
          "text": ""
        },
        "current": {
          "line": 128,
          "text": "// Replace Summary Update / legacy Synopsis Update flag with timestamp"
        },
        "after": {
          "line": 129,
          "text": "const summaryUpdateKeys = ['Summary Update', 'SummaryUpdate', 'summaryupdate'];"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 130,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const legacyKeys = ['Synopsis Update', 'SynopsisUpdate', 'synopsisupdate'];",
      "context": {
        "before": {
          "line": 129,
          "text": "const summaryUpdateKeys = ['Summary Update', 'SummaryUpdate', 'summaryupdate'];"
        },
        "current": {
          "line": 130,
          "text": "const legacyKeys = ['Synopsis Update', 'SynopsisUpdate', 'synopsisupdate'];"
        },
        "after": {
          "line": 131,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 161,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (synopsis) {",
      "context": {
        "before": {
          "line": 160,
          "text": "sceneTimestamps.summaryUpdated = isoNow;"
        },
        "current": {
          "line": 161,
          "text": "if (synopsis) {"
        },
        "after": {
          "line": 162,
          "text": "sceneTimestamps.synopsisUpdated = isoNow;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 162,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "sceneTimestamps.synopsisUpdated = isoNow;",
      "context": {
        "before": {
          "line": 161,
          "text": "if (synopsis) {"
        },
        "current": {
          "line": 162,
          "text": "sceneTimestamps.synopsisUpdated = isoNow;"
        },
        "after": {
          "line": 163,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 172,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return { summary, synopsis };",
      "context": {
        "before": {
          "line": 171,
          "text": ""
        },
        "current": {
          "line": 172,
          "text": "return { summary, synopsis };"
        },
        "after": {
          "line": 173,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 175,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export async function calculateSynopsisSceneCount(",
      "context": {
        "before": {
          "line": 174,
          "text": ""
        },
        "current": {
          "line": 175,
          "text": "export async function calculateSynopsisSceneCount("
        },
        "after": {
          "line": 176,
          "text": "plugin: RadialTimelinePlugin,"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 183,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const threshold = weakThreshold ?? plugin.settings.synopsisWeakThreshold ?? 75;",
      "context": {
        "before": {
          "line": 182,
          "text": "const allScenes = await getAllSceneData(plugin, vault);"
        },
        "current": {
          "line": 183,
          "text": "const threshold = weakThreshold ?? plugin.settings.synopsisWeakThreshold ?? 75;"
        },
        "after": {
          "line": 184,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 192,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const quality = classifySynopsis(currentSummary, threshold);",
      "context": {
        "before": {
          "line": 191,
          "text": "const currentSummary = scene.frontmatter.Summary;"
        },
        "current": {
          "line": 192,
          "text": "const quality = classifySynopsis(currentSummary, threshold);"
        },
        "after": {
          "line": 193,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 194,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (mode === 'synopsis-flagged') {",
      "context": {
        "before": {
          "line": 193,
          "text": ""
        },
        "current": {
          "line": 194,
          "text": "if (mode === 'synopsis-flagged') {"
        },
        "after": {
          "line": 195,
          "text": "if (isFlagged(scene)) count++;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 196,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "} else if (mode === 'synopsis-missing-weak') {",
      "context": {
        "before": {
          "line": 195,
          "text": "if (isFlagged(scene)) count++;"
        },
        "current": {
          "line": 196,
          "text": "} else if (mode === 'synopsis-missing-weak') {"
        },
        "after": {
          "line": 197,
          "text": "// Enhanced: missing, weak, OR stale (Due date > last AI update)"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 199,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "} else if (mode === 'synopsis-missing') {",
      "context": {
        "before": {
          "line": 198,
          "text": "if (quality === 'missing' || quality === 'weak' || isSummaryStale(scene, plugin)) count++;"
        },
        "current": {
          "line": 199,
          "text": "} else if (mode === 'synopsis-missing') {"
        },
        "after": {
          "line": 200,
          "text": "if (quality === 'missing') count++;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 201,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "} else if (mode === 'synopsis-all') {",
      "context": {
        "before": {
          "line": 200,
          "text": "if (quality === 'missing') count++;"
        },
        "current": {
          "line": 201,
          "text": "} else if (mode === 'synopsis-all') {"
        },
        "after": {
          "line": 202,
          "text": "count++;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 207,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "console.error('Error calculating synopsis count:', error);",
      "context": {
        "before": {
          "line": 206,
          "text": "} catch (error) {"
        },
        "current": {
          "line": 207,
          "text": "console.error('Error calculating synopsis count:', error);"
        },
        "after": {
          "line": 208,
          "text": "return 0;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 212,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export async function processSynopsisByManuscriptOrder(",
      "context": {
        "before": {
          "line": 211,
          "text": ""
        },
        "current": {
          "line": 212,
          "text": "export async function processSynopsisByManuscriptOrder("
        },
        "after": {
          "line": 213,
          "text": "plugin: RadialTimelinePlugin,"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 227,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "(mode, weakThreshold) => calculateSynopsisSceneCount(plugin, vault, mode, weakThreshold),",
      "context": {
        "before": {
          "line": 226,
          "text": "plugin,"
        },
        "current": {
          "line": 227,
          "text": "(mode, weakThreshold) => calculateSynopsisSceneCount(plugin, vault, mode, weakThreshold),"
        },
        "after": {
          "line": 228,
          "text": "async (mode, weakThreshold, targetWords) => {"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 229,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "await runSynopsisBatch(plugin, vault, mode, modal, weakThreshold, targetWords);",
      "context": {
        "before": {
          "line": 228,
          "text": "async (mode, weakThreshold, targetWords) => {"
        },
        "current": {
          "line": 229,
          "text": "await runSynopsisBatch(plugin, vault, mode, modal, weakThreshold, targetWords);"
        },
        "after": {
          "line": 230,
          "text": "},"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 234,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "'synopsis' // Specify taskType",
      "context": {
        "before": {
          "line": 233,
          "text": "undefined,"
        },
        "current": {
          "line": 234,
          "text": "'synopsis' // Specify taskType"
        },
        "after": {
          "line": 235,
          "text": ");"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 239,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "async function runSynopsisBatch(",
      "context": {
        "before": {
          "line": 238,
          "text": ""
        },
        "current": {
          "line": 239,
          "text": "async function runSynopsisBatch("
        },
        "after": {
          "line": 240,
          "text": "plugin: RadialTimelinePlugin,"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 251,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const threshold = weakThreshold ?? plugin.settings.synopsisWeakThreshold ?? 75;",
      "context": {
        "before": {
          "line": 250,
          "text": "// Get settings with fallbacks"
        },
        "current": {
          "line": 251,
          "text": "const threshold = weakThreshold ?? plugin.settings.synopsisWeakThreshold ?? 75;"
        },
        "after": {
          "line": 252,
          "text": "const target = targetWords ?? plugin.settings.synopsisTargetWords ?? 200;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 252,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const target = targetWords ?? plugin.settings.synopsisTargetWords ?? 200;",
      "context": {
        "before": {
          "line": 251,
          "text": "const threshold = weakThreshold ?? plugin.settings.synopsisWeakThreshold ?? 75;"
        },
        "current": {
          "line": 252,
          "text": "const target = targetWords ?? plugin.settings.synopsisTargetWords ?? 200;"
        },
        "after": {
          "line": 253,
          "text": "const alsoUpdateSynopsis = plugin.settings.alsoUpdateSynopsis ?? false;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 253,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const alsoUpdateSynopsis = plugin.settings.alsoUpdateSynopsis ?? false;",
      "context": {
        "before": {
          "line": 252,
          "text": "const target = targetWords ?? plugin.settings.synopsisTargetWords ?? 200;"
        },
        "current": {
          "line": 253,
          "text": "const alsoUpdateSynopsis = plugin.settings.alsoUpdateSynopsis ?? false;"
        },
        "after": {
          "line": 254,
          "text": "const synopsisMaxWords = getSynopsisGenerationWordLimit(plugin.settings);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 254,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisMaxWords = getSynopsisGenerationWordLimit(plugin.settings);",
      "context": {
        "before": {
          "line": 253,
          "text": "const alsoUpdateSynopsis = plugin.settings.alsoUpdateSynopsis ?? false;"
        },
        "current": {
          "line": 254,
          "text": "const synopsisMaxWords = getSynopsisGenerationWordLimit(plugin.settings);"
        },
        "after": {
          "line": 255,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 258,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const quality = classifySynopsis(scene.frontmatter.Summary, threshold);",
      "context": {
        "before": {
          "line": 257,
          "text": "const scenesToProcess = allScenes.filter(scene => {"
        },
        "current": {
          "line": 258,
          "text": "const quality = classifySynopsis(scene.frontmatter.Summary, threshold);"
        },
        "after": {
          "line": 259,
          "text": "const isFlagged = normalizeBooleanValue(getSummaryUpdateFlag(scene.frontmatter));"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 260,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (mode === 'synopsis-flagged') return isFlagged;",
      "context": {
        "before": {
          "line": 259,
          "text": "const isFlagged = normalizeBooleanValue(getSummaryUpdateFlag(scene.frontmatter));"
        },
        "current": {
          "line": 260,
          "text": "if (mode === 'synopsis-flagged') return isFlagged;"
        },
        "after": {
          "line": 261,
          "text": "if (mode === 'synopsis-missing-weak') return quality === 'missing' || quality === 'weak' || isSummaryStale(scene, plugin);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 261,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (mode === 'synopsis-missing-weak') return quality === 'missing' || quality === 'weak' || isSummaryStale(scene, plugin);",
      "context": {
        "before": {
          "line": 260,
          "text": "if (mode === 'synopsis-flagged') return isFlagged;"
        },
        "current": {
          "line": 261,
          "text": "if (mode === 'synopsis-missing-weak') return quality === 'missing' || quality === 'weak' || isSummaryStale(scene, plugin);"
        },
        "after": {
          "line": 262,
          "text": "if (mode === 'synopsis-missing') return quality === 'missing';"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 262,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (mode === 'synopsis-missing') return quality === 'missing';",
      "context": {
        "before": {
          "line": 261,
          "text": "if (mode === 'synopsis-missing-weak') return quality === 'missing' || quality === 'weak' || isSummaryStale(scene, plugin);"
        },
        "current": {
          "line": 262,
          "text": "if (mode === 'synopsis-missing') return quality === 'missing';"
        },
        "after": {
          "line": 263,
          "text": "if (mode === 'synopsis-all') return true;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 263,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (mode === 'synopsis-all') return true;",
      "context": {
        "before": {
          "line": 262,
          "text": "if (mode === 'synopsis-missing') return quality === 'missing';"
        },
        "current": {
          "line": 263,
          "text": "if (mode === 'synopsis-all') return true;"
        },
        "after": {
          "line": 264,
          "text": "return false;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 296,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (modal.setSynopsisPreview) {",
      "context": {
        "before": {
          "line": 295,
          "text": "// Show current item info (including old summary for preview)"
        },
        "current": {
          "line": 296,
          "text": "if (modal.setSynopsisPreview) {"
        },
        "after": {
          "line": 297,
          "text": "modal.setSynopsisPreview(currentSummary, 'Generating...');"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 297,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "modal.setSynopsisPreview(currentSummary, 'Generating...');",
      "context": {
        "before": {
          "line": 296,
          "text": "if (modal.setSynopsisPreview) {"
        },
        "current": {
          "line": 297,
          "text": "modal.setSynopsisPreview(currentSummary, 'Generating...');"
        },
        "after": {
          "line": 298,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 314,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const result = await runAi(summaryPrompt, null, 'synopsis', sceneName, undefined);",
      "context": {
        "before": {
          "line": 313,
          "text": "try {"
        },
        "current": {
          "line": 314,
          "text": "const result = await runAi(summaryPrompt, null, 'synopsis', sceneName, undefined);"
        },
        "after": {
          "line": 315,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 323,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "newSummary = parsed.summary || parsed.synopsis || ''; // Accept either key",
      "context": {
        "before": {
          "line": 322,
          "text": "const parsed = JSON.parse(jsonStr);"
        },
        "current": {
          "line": 323,
          "text": "newSummary = parsed.summary || parsed.synopsis || ''; // Accept either key"
        },
        "after": {
          "line": 324,
          "text": "} catch (e) {"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 331,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "let newSynopsis: string | undefined;",
      "context": {
        "before": {
          "line": 330,
          "text": "if (newSummary) {"
        },
        "current": {
          "line": 331,
          "text": "let newSynopsis: string | undefined;"
        },
        "after": {
          "line": 332,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 333,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// --- Step 2: Generate Synopsis (optional, only if checkbox enabled) ---",
      "context": {
        "before": {
          "line": 332,
          "text": ""
        },
        "current": {
          "line": 333,
          "text": "// --- Step 2: Generate Synopsis (optional, only if checkbox enabled) ---"
        },
        "after": {
          "line": 334,
          "text": "if (alsoUpdateSynopsis) {"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 334,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (alsoUpdateSynopsis) {",
      "context": {
        "before": {
          "line": 333,
          "text": "// --- Step 2: Generate Synopsis (optional, only if checkbox enabled) ---"
        },
        "current": {
          "line": 334,
          "text": "if (alsoUpdateSynopsis) {"
        },
        "after": {
          "line": 335,
          "text": "try {"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 336,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisPrompt = buildSynopsisPrompt(",
      "context": {
        "before": {
          "line": 335,
          "text": "try {"
        },
        "current": {
          "line": 336,
          "text": "const synopsisPrompt = buildSynopsisPrompt("
        },
        "after": {
          "line": 337,
          "text": "scene.body,"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 339,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisMaxWords",
      "context": {
        "before": {
          "line": 338,
          "text": "String(scene.sceneNumber || 'N/A'),"
        },
        "current": {
          "line": 339,
          "text": "synopsisMaxWords"
        },
        "after": {
          "line": 340,
          "text": ");"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 342,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisResult = await runAi(synopsisPrompt, null, 'synopsis', `${sceneName} (synopsis)`, undefined);",
      "context": {
        "before": {
          "line": 341,
          "text": ""
        },
        "current": {
          "line": 342,
          "text": "const synopsisResult = await runAi(synopsisPrompt, null, 'synopsis', `${sceneName} (synopsis)`, undefined);"
        },
        "after": {
          "line": 343,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 344,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (synopsisResult.result) {",
      "context": {
        "before": {
          "line": 343,
          "text": ""
        },
        "current": {
          "line": 344,
          "text": "if (synopsisResult.result) {"
        },
        "after": {
          "line": 345,
          "text": "const synJsonMatch = synopsisResult.result.match(/\\{[\\s\\S]*\\}/);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 345,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synJsonMatch = synopsisResult.result.match(/\\{[\\s\\S]*\\}/);",
      "context": {
        "before": {
          "line": 344,
          "text": "if (synopsisResult.result) {"
        },
        "current": {
          "line": 345,
          "text": "const synJsonMatch = synopsisResult.result.match(/\\{[\\s\\S]*\\}/);"
        },
        "after": {
          "line": 346,
          "text": "const synJsonStr = synJsonMatch ? synJsonMatch[0] : synopsisResult.result;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 346,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synJsonStr = synJsonMatch ? synJsonMatch[0] : synopsisResult.result;",
      "context": {
        "before": {
          "line": 345,
          "text": "const synJsonMatch = synopsisResult.result.match(/\\{[\\s\\S]*\\}/);"
        },
        "current": {
          "line": 346,
          "text": "const synJsonStr = synJsonMatch ? synJsonMatch[0] : synopsisResult.result;"
        },
        "after": {
          "line": 347,
          "text": "const synParsed = JSON.parse(synJsonStr);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 348,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const parsedSynopsis = synParsed.synopsis || '';",
      "context": {
        "before": {
          "line": 347,
          "text": "const synParsed = JSON.parse(synJsonStr);"
        },
        "current": {
          "line": 348,
          "text": "const parsedSynopsis = synParsed.synopsis || '';"
        },
        "after": {
          "line": 349,
          "text": "if (parsedSynopsis) {"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 349,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (parsedSynopsis) {",
      "context": {
        "before": {
          "line": 348,
          "text": "const parsedSynopsis = synParsed.synopsis || '';"
        },
        "current": {
          "line": 349,
          "text": "if (parsedSynopsis) {"
        },
        "after": {
          "line": 350,
          "text": "newSynopsis = truncateToWordLimit(parsedSynopsis, synopsisMaxWords);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 350,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "newSynopsis = truncateToWordLimit(parsedSynopsis, synopsisMaxWords);",
      "context": {
        "before": {
          "line": 349,
          "text": "if (parsedSynopsis) {"
        },
        "current": {
          "line": 350,
          "text": "newSynopsis = truncateToWordLimit(parsedSynopsis, synopsisMaxWords);"
        },
        "after": {
          "line": 351,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 354,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Synopsis generation failure is non-fatal  Summary still succeeds.",
      "context": {
        "before": {
          "line": 353,
          "text": "} catch (synErr) {"
        },
        "current": {
          "line": 354,
          "text": "// Synopsis generation failure is non-fatal  Summary still succeeds."
        },
        "after": {
          "line": 355,
          "text": "console.warn(`Synopsis generation failed for ${sceneName}:`, synErr);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 355,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "console.warn(`Synopsis generation failed for ${sceneName}:`, synErr);",
      "context": {
        "before": {
          "line": 354,
          "text": "// Synopsis generation failure is non-fatal  Summary still succeeds."
        },
        "current": {
          "line": 355,
          "text": "console.warn(`Synopsis generation failed for ${sceneName}:`, synErr);"
        },
        "after": {
          "line": 356,
          "text": "modal.addWarning(`Synopsis generation failed for ${sceneName} (Summary was saved)`);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 356,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "modal.addWarning(`Synopsis generation failed for ${sceneName} (Summary was saved)`);",
      "context": {
        "before": {
          "line": 355,
          "text": "console.warn(`Synopsis generation failed for ${sceneName}:`, synErr);"
        },
        "current": {
          "line": 356,
          "text": "modal.addWarning(`Synopsis generation failed for ${sceneName} (Summary was saved)`);"
        },
        "after": {
          "line": 357,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 361,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const persisted = await persistSummaryForScene(plugin, scene.file.path, newSummary, newSynopsis);",
      "context": {
        "before": {
          "line": 360,
          "text": "try {"
        },
        "current": {
          "line": 361,
          "text": "const persisted = await persistSummaryForScene(plugin, scene.file.path, newSummary, newSynopsis);"
        },
        "after": {
          "line": 362,
          "text": "processedCount++;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 365,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (modal.setSynopsisPreview) {",
      "context": {
        "before": {
          "line": 364,
          "text": "// Update preview with final result"
        },
        "current": {
          "line": 365,
          "text": "if (modal.setSynopsisPreview) {"
        },
        "after": {
          "line": 366,
          "text": "modal.setSynopsisPreview(currentSummary, persisted.summary);"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/SynopsisCommands.ts",
      "line": 366,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "modal.setSynopsisPreview(currentSummary, persisted.summary);",
      "context": {
        "before": {
          "line": 365,
          "text": "if (modal.setSynopsisPreview) {"
        },
        "current": {
          "line": 366,
          "text": "modal.setSynopsisPreview(currentSummary, persisted.summary);"
        },
        "after": {
          "line": 367,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/aiProvider.ts",
      "line": 74,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const logType = payload.commandContext === 'synopsis' ? 'Synopsis' : 'Pulse';",
      "context": {
        "before": {
          "line": 73,
          "text": "const safeSceneLabel = sanitizeSegment(sceneLabel) || 'Scene';"
        },
        "current": {
          "line": 74,
          "text": "const logType = payload.commandContext === 'synopsis' ? 'Synopsis' : 'Pulse';"
        },
        "after": {
          "line": 75,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/aiProvider.ts",
      "line": 109,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "feature: payload.commandContext === 'synopsis' ? 'Synopsis' : 'Pulse',",
      "context": {
        "before": {
          "line": 108,
          "text": "metadata: {"
        },
        "current": {
          "line": 109,
          "text": "feature: payload.commandContext === 'synopsis' ? 'Synopsis' : 'Pulse',"
        },
        "after": {
          "line": 110,
          "text": "scopeTarget,"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/aiProvider.ts",
      "line": 172,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "feature: payload.commandContext === 'synopsis' ? 'Synopsis' : 'Pulse',",
      "context": {
        "before": {
          "line": 171,
          "text": "title: summaryTitle,"
        },
        "current": {
          "line": 172,
          "text": "feature: payload.commandContext === 'synopsis' ? 'Synopsis' : 'Pulse',"
        },
        "after": {
          "line": 173,
          "text": "scopeTarget,"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/aiProvider.ts",
      "line": 220,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (commandContext === 'synopsis') {",
      "context": {
        "before": {
          "line": 219,
          "text": "let jsonSchema: Record<string, unknown>;"
        },
        "current": {
          "line": 220,
          "text": "if (commandContext === 'synopsis') {"
        },
        "after": {
          "line": 221,
          "text": "const { getSummaryJsonSchema, getSummarySystemPrompt } = await import('../ai/prompts/synopsis');"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/aiProvider.ts",
      "line": 221,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const { getSummaryJsonSchema, getSummarySystemPrompt } = await import('../ai/prompts/synopsis');",
      "context": {
        "before": {
          "line": 220,
          "text": "if (commandContext === 'synopsis') {"
        },
        "current": {
          "line": 221,
          "text": "const { getSummaryJsonSchema, getSummarySystemPrompt } = await import('../ai/prompts/synopsis');"
        },
        "after": {
          "line": 222,
          "text": "jsonSchema = getSummaryJsonSchema();"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/aiProvider.ts",
      "line": 231,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "feature: commandContext === 'synopsis' ? 'SummaryRefresh' : 'PulseAnalysis',",
      "context": {
        "before": {
          "line": 230,
          "text": "runResult = await aiClient.run({"
        },
        "current": {
          "line": 231,
          "text": "feature: commandContext === 'synopsis' ? 'SummaryRefresh' : 'PulseAnalysis',"
        },
        "after": {
          "line": 232,
          "text": "task: commandContext === 'synopsis' ? 'SceneSummary' : 'ScenePulseTriplet',"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/aiProvider.ts",
      "line": 232,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "task: commandContext === 'synopsis' ? 'SceneSummary' : 'ScenePulseTriplet',",
      "context": {
        "before": {
          "line": 231,
          "text": "feature: commandContext === 'synopsis' ? 'SummaryRefresh' : 'PulseAnalysis',"
        },
        "current": {
          "line": 232,
          "text": "task: commandContext === 'synopsis' ? 'SceneSummary' : 'ScenePulseTriplet',"
        },
        "after": {
          "line": 233,
          "text": "requiredCapabilities: ['jsonStrict', 'reasoningStrong'],"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/aiProvider.ts",
      "line": 250,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "temperature: commandContext === 'synopsis' ? 0.2 : 0.1,",
      "context": {
        "before": {
          "line": 249,
          "text": "overrides: {"
        },
        "current": {
          "line": 250,
          "text": "temperature: commandContext === 'synopsis' ? 0.2 : 0.1,"
        },
        "after": {
          "line": 251,
          "text": "maxOutputMode: 'high',"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/aiProvider.ts",
      "line": 265,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (commandContext !== 'synopsis') {",
      "context": {
        "before": {
          "line": 264,
          "text": "if (runResult.aiStatus !== 'success' || !runResult.content) {"
        },
        "current": {
          "line": 265,
          "text": "if (commandContext !== 'synopsis') {"
        },
        "after": {
          "line": 266,
          "text": "await writePulseLog(plugin, vault, {"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/aiProvider.ts",
      "line": 289,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const parsedForLog = commandContext !== 'synopsis'",
      "context": {
        "before": {
          "line": 288,
          "text": ""
        },
        "current": {
          "line": 289,
          "text": "const parsedForLog = commandContext !== 'synopsis'"
        },
        "after": {
          "line": 290,
          "text": "? parsePulseAnalysisResponse(runResult.content, plugin)"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/aiProvider.ts",
      "line": 292,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (commandContext !== 'synopsis') {",
      "context": {
        "before": {
          "line": 291,
          "text": ": null;"
        },
        "current": {
          "line": 292,
          "text": "if (commandContext !== 'synopsis') {"
        },
        "after": {
          "line": 293,
          "text": "await writePulseLog(plugin, vault, {"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/aiProvider.ts",
      "line": 333,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (commandContext !== 'synopsis') {",
      "context": {
        "before": {
          "line": 332,
          "text": ""
        },
        "current": {
          "line": 333,
          "text": "if (commandContext !== 'synopsis') {"
        },
        "after": {
          "line": 334,
          "text": "await writePulseLog(plugin, vault, {"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/data.ts",
      "line": 68,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Checks Summary Update first, then falls back to legacy Synopsis Update for migration.",
      "context": {
        "before": {
          "line": 67,
          "text": "* Get the Summary Update flag from frontmatter (separate from Pulse)."
        },
        "current": {
          "line": 68,
          "text": "* Checks Summary Update first, then falls back to legacy Synopsis Update for migration."
        },
        "after": {
          "line": 69,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/data.ts",
      "line": 76,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Legacy fallback  scenes may still have Synopsis Update from before the rename",
      "context": {
        "before": {
          "line": 75,
          "text": "'summaryupdate',"
        },
        "current": {
          "line": 76,
          "text": "// Legacy fallback  scenes may still have Synopsis Update from before the rename"
        },
        "after": {
          "line": 77,
          "text": "'Synopsis Update',"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/data.ts",
      "line": 77,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "'Synopsis Update',",
      "context": {
        "before": {
          "line": 76,
          "text": "// Legacy fallback  scenes may still have Synopsis Update from before the rename"
        },
        "current": {
          "line": 77,
          "text": "'Synopsis Update',"
        },
        "after": {
          "line": 78,
          "text": "'SynopsisUpdate',"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/data.ts",
      "line": 78,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "'SynopsisUpdate',",
      "context": {
        "before": {
          "line": 77,
          "text": "'Synopsis Update',"
        },
        "current": {
          "line": 78,
          "text": "'SynopsisUpdate',"
        },
        "after": {
          "line": 79,
          "text": "'synopsisupdate'"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/data.ts",
      "line": 79,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "'synopsisupdate'",
      "context": {
        "before": {
          "line": 78,
          "text": "'SynopsisUpdate',"
        },
        "current": {
          "line": 79,
          "text": "'synopsisupdate'"
        },
        "after": {
          "line": 80,
          "text": "];"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/data.ts",
      "line": 89,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Use getSummaryUpdateFlag instead */",
      "context": {
        "before": {
          "line": 88,
          "text": ""
        },
        "current": {
          "line": 89,
          "text": "/** @deprecated Use getSummaryUpdateFlag instead */"
        },
        "after": {
          "line": 90,
          "text": "export const getSynopsisUpdateFlag = getSummaryUpdateFlag;"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/data.ts",
      "line": 90,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export const getSynopsisUpdateFlag = getSummaryUpdateFlag;",
      "context": {
        "before": {
          "line": 89,
          "text": "/** @deprecated Use getSummaryUpdateFlag instead */"
        },
        "current": {
          "line": 90,
          "text": "export const getSynopsisUpdateFlag = getSummaryUpdateFlag;"
        },
        "after": {
          "line": 91,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/synopsisQuality.ts",
      "line": 3,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Synopsis Quality Classification",
      "context": {
        "before": {
          "line": 2,
          "text": "* Radial Timeline (tm) Plugin for Obsidian"
        },
        "current": {
          "line": 3,
          "text": "* Synopsis Quality Classification"
        },
        "after": {
          "line": 4,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/synopsisQuality.ts",
      "line": 6,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export type SynopsisQuality = 'missing' | 'weak' | 'ok';",
      "context": {
        "before": {
          "line": 5,
          "text": ""
        },
        "current": {
          "line": 6,
          "text": "export type SynopsisQuality = 'missing' | 'weak' | 'ok';"
        },
        "after": {
          "line": 7,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/synopsisQuality.ts",
      "line": 10,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "/^add a synopsis/i,",
      "context": {
        "before": {
          "line": 9,
          "text": "const PLACEHOLDER_PATTERNS = ["
        },
        "current": {
          "line": 10,
          "text": "/^add a synopsis/i,"
        },
        "after": {
          "line": 11,
          "text": "/^todo/i,"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/synopsisQuality.ts",
      "line": 11,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "/^todo/i,",
      "context": {
        "before": {
          "line": 10,
          "text": "/^add a synopsis/i,"
        },
        "current": {
          "line": 11,
          "text": "/^todo/i,"
        },
        "after": {
          "line": 12,
          "text": "/^tbd/i,"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/synopsisQuality.ts",
      "line": 13,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "/^synopsis/i,",
      "context": {
        "before": {
          "line": 12,
          "text": "/^tbd/i,"
        },
        "current": {
          "line": 13,
          "text": "/^synopsis/i,"
        },
        "after": {
          "line": 14,
          "text": "/^scene synopsis/i,"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/synopsisQuality.ts",
      "line": 14,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "/^scene synopsis/i,",
      "context": {
        "before": {
          "line": 13,
          "text": "/^synopsis/i,"
        },
        "current": {
          "line": 14,
          "text": "/^scene synopsis/i,"
        },
        "after": {
          "line": 15,
          "text": "/^insert summary/i"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/synopsisQuality.ts",
      "line": 19,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Classify the quality of a synopsis string.",
      "context": {
        "before": {
          "line": 18,
          "text": "/**"
        },
        "current": {
          "line": 19,
          "text": "* Classify the quality of a synopsis string."
        },
        "after": {
          "line": 20,
          "text": "* @param synopsis The raw synopsis text from frontmatter"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/synopsisQuality.ts",
      "line": 20,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* @param synopsis The raw synopsis text from frontmatter",
      "context": {
        "before": {
          "line": 19,
          "text": "* Classify the quality of a synopsis string."
        },
        "current": {
          "line": 20,
          "text": "* @param synopsis The raw synopsis text from frontmatter"
        },
        "after": {
          "line": 21,
          "text": "* @param weakThreshold Word count below which synopsis is considered weak (default: 75)"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/synopsisQuality.ts",
      "line": 21,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* @param weakThreshold Word count below which synopsis is considered weak (default: 75)",
      "context": {
        "before": {
          "line": 20,
          "text": "* @param synopsis The raw synopsis text from frontmatter"
        },
        "current": {
          "line": 21,
          "text": "* @param weakThreshold Word count below which synopsis is considered weak (default: 75)"
        },
        "after": {
          "line": 22,
          "text": "* @returns 'missing' | 'weak' | 'ok'"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/synopsisQuality.ts",
      "line": 24,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function classifySynopsis(synopsis: unknown, weakThreshold: number = 75): SynopsisQuality {",
      "context": {
        "before": {
          "line": 23,
          "text": "*/"
        },
        "current": {
          "line": 24,
          "text": "export function classifySynopsis(synopsis: unknown, weakThreshold: number = 75): SynopsisQuality {"
        },
        "after": {
          "line": 25,
          "text": "if (synopsis === null || synopsis === undefined) {"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/synopsisQuality.ts",
      "line": 25,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (synopsis === null || synopsis === undefined) {",
      "context": {
        "before": {
          "line": 24,
          "text": "export function classifySynopsis(synopsis: unknown, weakThreshold: number = 75): SynopsisQuality {"
        },
        "current": {
          "line": 25,
          "text": "if (synopsis === null || synopsis === undefined) {"
        },
        "after": {
          "line": 26,
          "text": "return 'missing';"
        }
      }
    },
    {
      "filePath": "src/sceneAnalysis/synopsisQuality.ts",
      "line": 29,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const text = String(synopsis).trim();",
      "context": {
        "before": {
          "line": 28,
          "text": ""
        },
        "current": {
          "line": 29,
          "text": "const text = String(synopsis).trim();"
        },
        "after": {
          "line": 30,
          "text": "if (text === '') {"
        }
      }
    },
    {
      "filePath": "src/renderer/ChangeDetection.ts",
      "line": 25,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "SYNOPSIS = 'synopsis', // Synopsis text changed",
      "context": {
        "before": {
          "line": 24,
          "text": "DOMINANT_SUBPLOT = 'dominant_subplot', // Dominant subplot changed (scene colors only)"
        },
        "current": {
          "line": 25,
          "text": "SYNOPSIS = 'synopsis', // Synopsis text changed"
        },
        "after": {
          "line": 26,
          "text": "UPDATE_STATUS = 'update_status', // Plugin update available"
        }
      }
    },
    {
      "filePath": "src/renderer/ChangeDetection.ts",
      "line": 110,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "s.synopsis || '',",
      "context": {
        "before": {
          "line": 109,
          "text": "s['Publish Stage'] || '',"
        },
        "current": {
          "line": 110,
          "text": "s.synopsis || '',"
        },
        "after": {
          "line": 111,
          "text": "// Pending Edits affects number square color (gray)"
        }
      }
    },
    {
      "filePath": "src/renderer/ChangeDetection.ts",
      "line": 256,
      "token": "ChangeType.SETTINGS",
      "category": "drift-term",
      "lineText": "changeTypes.add(ChangeType.SETTINGS);",
      "context": {
        "before": {
          "line": 255,
          "text": "prev.povMode !== current.povMode) {"
        },
        "current": {
          "line": 256,
          "text": "changeTypes.add(ChangeType.SETTINGS);"
        },
        "after": {
          "line": 257,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/renderer/ChangeDetection.ts",
      "line": 282,
      "token": "ChangeType.SETTINGS",
      "category": "drift-term",
      "lineText": "changeTypes.add(ChangeType.SETTINGS);",
      "context": {
        "before": {
          "line": 281,
          "text": "if (prev.runtimeModeActive !== current.runtimeModeActive) {"
        },
        "current": {
          "line": 282,
          "text": "changeTypes.add(ChangeType.SETTINGS);"
        },
        "after": {
          "line": 283,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/renderer/ChangeDetection.ts",
      "line": 294,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "ChangeType.SYNOPSIS, // DOM update for synopsis text",
      "context": {
        "before": {
          "line": 293,
          "text": "ChangeType.DOMINANT_SUBPLOT, // DOM update for scene colors"
        },
        "current": {
          "line": 294,
          "text": "ChangeType.SYNOPSIS, // DOM update for synopsis text"
        },
        "after": {
          "line": 295,
          "text": "ChangeType.GOSSAMER"
        }
      }
    },
    {
      "filePath": "src/renderer/ChangeDetection.ts",
      "line": 342,
      "token": "ChangeType.SETTINGS",
      "category": "drift-term",
      "lineText": "case ChangeType.SETTINGS: return 'settings';",
      "context": {
        "before": {
          "line": 341,
          "text": "case ChangeType.MODE: return 'mode';"
        },
        "current": {
          "line": 342,
          "text": "case ChangeType.SETTINGS: return 'settings';"
        },
        "after": {
          "line": 343,
          "text": "case ChangeType.TIME: return 'time';"
        }
      }
    },
    {
      "filePath": "src/renderer/TimelineRenderer.ts",
      "line": 58,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "SYNOPSIS_INSET,",
      "context": {
        "before": {
          "line": 57,
          "text": "SCENE_TITLE_INSET,"
        },
        "current": {
          "line": 58,
          "text": "SYNOPSIS_INSET,"
        },
        "after": {
          "line": 59,
          "text": "BEAT_TEXT_RADIUS,"
        }
      }
    },
    {
      "filePath": "src/renderer/TimelineRenderer.ts",
      "line": 91,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { appendSynopsisElementForScene } from './utils/SynopsisBuilder';",
      "context": {
        "before": {
          "line": 90,
          "text": "import { collectChronologueSceneEntries, type ChronologueSceneEntry } from './components/ChronologueTimeline';"
        },
        "current": {
          "line": 91,
          "text": "import { appendSynopsisElementForScene } from './utils/SynopsisBuilder';"
        },
        "after": {
          "line": 92,
          "text": "import { renderGossamerOverlay, type StageColorMap } from './utils/Gossamer';"
        }
      }
    },
    {
      "filePath": "src/renderer/TimelineRenderer.ts",
      "line": 118,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "Todo: 'Todo  tasks or scenes not yet started',",
      "context": {
        "before": {
          "line": 117,
          "text": "const STATUS_HEADER_TOOLTIPS: Record<string, string> = {"
        },
        "current": {
          "line": 118,
          "text": "Todo: 'Todo  tasks or scenes not yet started',"
        },
        "after": {
          "line": 119,
          "text": "Working: 'Working  tasks or scenes currently in progress',"
        }
      }
    },
    {
      "filePath": "src/renderer/TimelineRenderer.ts",
      "line": 274,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Create a map to store scene number information for the scene square and synopsis",
      "context": {
        "before": {
          "line": 273,
          "text": ""
        },
        "current": {
          "line": 274,
          "text": "// Create a map to store scene number information for the scene square and synopsis"
        },
        "after": {
          "line": 275,
          "text": "const sceneNumbersMap = new Map<string, SceneNumberInfo>();"
        }
      }
    },
    {
      "filePath": "src/renderer/TimelineRenderer.ts",
      "line": 313,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "// Define patterns for Working and Todo states with Publish Stage colors",
      "context": {
        "before": {
          "line": 312,
          "text": ""
        },
        "current": {
          "line": 313,
          "text": "// Define patterns for Working and Todo states with Publish Stage colors"
        },
        "after": {
          "line": 314,
          "text": "svg += renderDefs(PUBLISH_STAGE_COLORS);"
        }
      }
    },
    {
      "filePath": "src/renderer/TimelineRenderer.ts",
      "line": 354,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "// TEMP TEST: Force full year display to see all colors",
      "context": {
        "before": {
          "line": 353,
          "text": "const yearProgress = (now.getTime() - startOfYear.getTime()) / (1000 * 60 * 60 * 24 * 365);"
        },
        "current": {
          "line": 354,
          "text": "// TEMP TEST: Force full year display to see all colors"
        },
        "after": {
          "line": 355,
          "text": "// const yearProgress = 1; // TEMP TEST: Force 100% to display all segments"
        }
      }
    },
    {
      "filePath": "src/renderer/TimelineRenderer.ts",
      "line": 355,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "// const yearProgress = 1; // TEMP TEST: Force 100% to display all segments",
      "context": {
        "before": {
          "line": 354,
          "text": "// TEMP TEST: Force full year display to see all colors"
        },
        "current": {
          "line": 355,
          "text": "// const yearProgress = 1; // TEMP TEST: Force 100% to display all segments"
        },
        "after": {
          "line": 356,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/renderer/TimelineRenderer.ts",
      "line": 469,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "appendSynopsisElementForScene({",
      "context": {
        "before": {
          "line": 468,
          "text": ""
        },
        "current": {
          "line": 469,
          "text": "appendSynopsisElementForScene({"
        },
        "after": {
          "line": 470,
          "text": "plugin,"
        }
      }
    },
    {
      "filePath": "src/renderer/TimelineRenderer.ts",
      "line": 619,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const rowTotal = (rc.Todo || 0) + (rc.Working || 0) + (rc.Due || 0) + (rc.Completed || 0);",
      "context": {
        "before": {
          "line": 618,
          "text": "const rc = gridCounts[stagesForGrid[i]];"
        },
        "current": {
          "line": 619,
          "text": "const rowTotal = (rc.Todo || 0) + (rc.Working || 0) + (rc.Due || 0) + (rc.Completed || 0);"
        },
        "after": {
          "line": 620,
          "text": "if (rowTotal > 0) maxStageIdxForGrid = i;"
        }
      }
    },
    {
      "filePath": "src/renderer/TimelineRenderer.ts",
      "line": 701,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisHTML = serializeSynopsesToString(synopsesElements);",
      "context": {
        "before": {
          "line": 700,
          "text": "// Serialize synopses to string and store HTML for later insertion"
        },
        "current": {
          "line": 701,
          "text": "const synopsisHTML = serializeSynopsesToString(synopsesElements);"
        },
        "after": {
          "line": 702,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/renderer/TimelineRenderer.ts",
      "line": 722,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "svg += synopsisHTML;",
      "context": {
        "before": {
          "line": 721,
          "text": ""
        },
        "current": {
          "line": 722,
          "text": "svg += synopsisHTML;"
        },
        "after": {
          "line": 723,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/renderer/TimelineRenderer.ts",
      "line": 769,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Add JavaScript to handle synopsis visibility",
      "context": {
        "before": {
          "line": 768,
          "text": ""
        },
        "current": {
          "line": 769,
          "text": "// Add JavaScript to handle synopsis visibility"
        },
        "after": {
          "line": 770,
          "text": "const scriptSection = ``;"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/AuthorProgressUtils.ts",
      "line": 12,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "delete clean.synopsis;",
      "context": {
        "before": {
          "line": 11,
          "text": "delete clean.title;"
        },
        "current": {
          "line": 12,
          "text": "delete clean.synopsis;"
        },
        "after": {
          "line": 13,
          "text": "delete clean.Summary;"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/GridData.ts",
      "line": 54,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "// If status is empty/undefined/null, count it as \"Todo\"",
      "context": {
        "before": {
          "line": 53,
          "text": ""
        },
        "current": {
          "line": 54,
          "text": "// If status is empty/undefined/null, count it as \"Todo\""
        },
        "after": {
          "line": 55,
          "text": "if (!normalizedStatus || normalizedStatus === '') {"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/GridData.ts",
      "line": 56,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "acc[\"Todo\"] = (acc[\"Todo\"] || 0) + 1;",
      "context": {
        "before": {
          "line": 55,
          "text": "if (!normalizedStatus || normalizedStatus === '') {"
        },
        "current": {
          "line": 56,
          "text": "acc[\"Todo\"] = (acc[\"Todo\"] || 0) + 1;"
        },
        "after": {
          "line": 57,
          "text": "return acc;"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/GridData.ts",
      "line": 78,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "let statusKey = \"Todo\";",
      "context": {
        "before": {
          "line": 77,
          "text": "// Future or today"
        },
        "current": {
          "line": 78,
          "text": "let statusKey = \"Todo\";"
        },
        "after": {
          "line": 79,
          "text": "if (scene.status) {"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/GridData.ts",
      "line": 90,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "let statusKey = \"Todo\";",
      "context": {
        "before": {
          "line": 89,
          "text": "// No due date"
        },
        "current": {
          "line": 90,
          "text": "let statusKey = \"Todo\";"
        },
        "after": {
          "line": 91,
          "text": "if (scene.status) {"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/GridData.ts",
      "line": 109,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "gridCounts[s] = { Todo: 0, Working: 0, Due: 0, Completed: 0 };",
      "context": {
        "before": {
          "line": 108,
          "text": "(STAGES_FOR_GRID as readonly string[]).forEach(s => {"
        },
        "current": {
          "line": 109,
          "text": "gridCounts[s] = { Todo: 0, Working: 0, Due: 0, Completed: 0 };"
        },
        "after": {
          "line": 110,
          "text": "gridSceneNames[s] = { Todo: [], Working: [], Due: [], Completed: [] };"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/GridData.ts",
      "line": 110,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "gridSceneNames[s] = { Todo: [], Working: [], Due: [], Completed: [] };",
      "context": {
        "before": {
          "line": 109,
          "text": "gridCounts[s] = { Todo: 0, Working: 0, Due: 0, Completed: 0 };"
        },
        "current": {
          "line": 110,
          "text": "gridSceneNames[s] = { Todo: [], Working: [], Due: [], Completed: [] };"
        },
        "after": {
          "line": 111,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/GridData.ts",
      "line": 125,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "let bucket: string = 'Todo';",
      "context": {
        "before": {
          "line": 124,
          "text": "const normalized = normalizeStatus(scene.status);"
        },
        "current": {
          "line": 125,
          "text": "let bucket: string = 'Todo';"
        },
        "after": {
          "line": 126,
          "text": "if (normalized === 'Completed') {"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/GridData.ts",
      "line": 135,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "bucket = 'Todo';",
      "context": {
        "before": {
          "line": 134,
          "text": "if (!(bucket in gridCounts[stageKey])) {"
        },
        "current": {
          "line": 135,
          "text": "bucket = 'Todo';"
        },
        "after": {
          "line": 136,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SceneFill.ts",
      "line": 10,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "Todo: '#cccccc',",
      "context": {
        "before": {
          "line": 9,
          "text": "Working: '#FF69B4',"
        },
        "current": {
          "line": 10,
          "text": "Todo: '#cccccc',"
        },
        "after": {
          "line": 11,
          "text": "Empty: '#ffffff',"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SceneFill.ts",
      "line": 61,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "if (norm === 'Todo') return `url(#plaidTodo${publishStage})`;",
      "context": {
        "before": {
          "line": 60,
          "text": "if (norm === 'Working') return `url(#plaidWorking${publishStage})`;"
        },
        "current": {
          "line": 61,
          "text": "if (norm === 'Todo') return `url(#plaidTodo${publishStage})`;"
        },
        "after": {
          "line": 62,
          "text": "return statusColors[statusList[0] as keyof typeof statusColors] || statusColors.Todo;"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SceneFill.ts",
      "line": 62,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "return statusColors[statusList[0] as keyof typeof statusColors] || statusColors.Todo;",
      "context": {
        "before": {
          "line": 61,
          "text": "if (norm === 'Todo') return `url(#plaidTodo${publishStage})`;"
        },
        "current": {
          "line": 62,
          "text": "return statusColors[statusList[0] as keyof typeof statusColors] || statusColors.Todo;"
        },
        "after": {
          "line": 63,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 6,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { getSynopsisGenerationWordLimit, getSynopsisHoverLineLimit, truncateToWordLimit } from '../../utils/synopsisLimits';",
      "context": {
        "before": {
          "line": 5,
          "text": "import { getReadabilityMultiplier } from '../../utils/readability';"
        },
        "current": {
          "line": 6,
          "text": "import { getSynopsisGenerationWordLimit, getSynopsisHoverLineLimit, truncateToWordLimit } from '../../utils/synopsisLimits';"
        },
        "after": {
          "line": 7,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 22,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function buildSynopsisElement(",
      "context": {
        "before": {
          "line": 21,
          "text": ""
        },
        "current": {
          "line": 22,
          "text": "export function buildSynopsisElement("
        },
        "after": {
          "line": 23,
          "text": "plugin: PluginRendererFacade,"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 31,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const maxWords = getSynopsisGenerationWordLimit(plugin.settings as any);",
      "context": {
        "before": {
          "line": 30,
          "text": "const fontScale = getReadabilityMultiplier(plugin.settings as any);"
        },
        "current": {
          "line": 31,
          "text": "const maxWords = getSynopsisGenerationWordLimit(plugin.settings as any);"
        },
        "after": {
          "line": 32,
          "text": "const maxLines = getSynopsisHoverLineLimit(plugin.settings as any);"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 32,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const maxLines = getSynopsisHoverLineLimit(plugin.settings as any);",
      "context": {
        "before": {
          "line": 31,
          "text": "const maxWords = getSynopsisGenerationWordLimit(plugin.settings as any);"
        },
        "current": {
          "line": 32,
          "text": "const maxLines = getSynopsisHoverLineLimit(plugin.settings as any);"
        },
        "after": {
          "line": 33,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 37,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const backdropContext = scene.Context ?? scene.synopsis ?? scene.Description;",
      "context": {
        "before": {
          "line": 36,
          "text": "const lines = [scene.title || 'Untitled'];"
        },
        "current": {
          "line": 37,
          "text": "const backdropContext = scene.Context ?? scene.synopsis ?? scene.Description;"
        },
        "after": {
          "line": 38,
          "text": "if (backdropContext) {"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 41,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return plugin.synopsisManager.generateElement(scene, lines, sceneId, subplotIndexResolver);",
      "context": {
        "before": {
          "line": 40,
          "text": "}"
        },
        "current": {
          "line": 41,
          "text": "return plugin.synopsisManager.generateElement(scene, lines, sceneId, subplotIndexResolver);"
        },
        "after": {
          "line": 42,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 45,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const cappedSynopsis = scene.synopsis ? truncateToWordLimit(scene.synopsis, maxWords) : undefined;",
      "context": {
        "before": {
          "line": 44,
          "text": "const beatPurpose = scene.Purpose ?? scene.Description;"
        },
        "current": {
          "line": 45,
          "text": "const cappedSynopsis = scene.synopsis ? truncateToWordLimit(scene.synopsis, maxWords) : undefined;"
        },
        "after": {
          "line": 46,
          "text": "const contentLines = ["
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 50,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": ": cappedSynopsis",
      "context": {
        "before": {
          "line": 49,
          "text": "? [beatPurpose]"
        },
        "current": {
          "line": 50,
          "text": ": cappedSynopsis"
        },
        "after": {
          "line": 51,
          "text": "? [cappedSynopsis]"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 51,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "? [cappedSynopsis]",
      "context": {
        "before": {
          "line": 50,
          "text": ": cappedSynopsis"
        },
        "current": {
          "line": 51,
          "text": "? [cappedSynopsis]"
        },
        "after": {
          "line": 52,
          "text": ": [])"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 141,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return plugin.synopsisManager.generateElement(scene, filtered, sceneId, subplotIndexResolver);",
      "context": {
        "before": {
          "line": 140,
          "text": "const filtered = contentLines.filter(line => line && line.trim() !== '\\u00A0');"
        },
        "current": {
          "line": 141,
          "text": "return plugin.synopsisManager.generateElement(scene, filtered, sceneId, subplotIndexResolver);"
        },
        "after": {
          "line": 142,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 144,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "type SynopsisAppendOptions = {",
      "context": {
        "before": {
          "line": 143,
          "text": ""
        },
        "current": {
          "line": 144,
          "text": "type SynopsisAppendOptions = {"
        },
        "after": {
          "line": 145,
          "text": "plugin: PluginRendererFacade;"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 154,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function appendSynopsisElementForScene({",
      "context": {
        "before": {
          "line": 153,
          "text": ""
        },
        "current": {
          "line": 154,
          "text": "export function appendSynopsisElementForScene({"
        },
        "after": {
          "line": 155,
          "text": "plugin,"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 162,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "}: SynopsisAppendOptions): void {",
      "context": {
        "before": {
          "line": 161,
          "text": "targets"
        },
        "current": {
          "line": 162,
          "text": "}: SynopsisAppendOptions): void {"
        },
        "after": {
          "line": 163,
          "text": "if (!scene.title) {"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 175,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisElement = buildSynopsisElement(",
      "context": {
        "before": {
          "line": 174,
          "text": "try {"
        },
        "current": {
          "line": 175,
          "text": "const synopsisElement = buildSynopsisElement("
        },
        "after": {
          "line": 176,
          "text": "plugin,"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 187,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "targets.push(synopsisElement);",
      "context": {
        "before": {
          "line": 186,
          "text": ");"
        },
        "current": {
          "line": 187,
          "text": "targets.push(synopsisElement);"
        },
        "after": {
          "line": 188,
          "text": "} catch (error) {"
        }
      }
    },
    {
      "filePath": "src/renderer/utils/SynopsisBuilder.ts",
      "line": 189,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "console.warn('Failed to build synopsis for scene:', scene.path, error);",
      "context": {
        "before": {
          "line": 188,
          "text": "} catch (error) {"
        },
        "current": {
          "line": 189,
          "text": "console.warn('Failed to build synopsis for scene:', scene.path, error);"
        },
        "after": {
          "line": 190,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/renderer/renderers/RingRenderer.ts",
      "line": 26,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { appendSynopsisElementForScene } from '../utils/SynopsisBuilder';",
      "context": {
        "before": {
          "line": 25,
          "text": "import { shouldRenderStoryBeats, shouldShowAllScenesInOuterRing } from '../modules/ModeRenderingHelpers';"
        },
        "current": {
          "line": 26,
          "text": "import { appendSynopsisElementForScene } from '../utils/SynopsisBuilder';"
        },
        "after": {
          "line": 27,
          "text": "import { resolveDominantScene } from '../components/SubplotDominanceIndicators';"
        }
      }
    },
    {
      "filePath": "src/renderer/renderers/RingRenderer.ts",
      "line": 91,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: getComputedStyle is DOM-dependent, might not be ideal in all contexts but keeping extracted logic same",
      "context": {
        "before": {
          "line": 90,
          "text": "const varName = `--rt-subplot-colors-${normalized}`;"
        },
        "current": {
          "line": 91,
          "text": "// Note: getComputedStyle is DOM-dependent, might not be ideal in all contexts but keeping extracted logic same"
        },
        "after": {
          "line": 92,
          "text": "try {"
        }
      }
    },
    {
      "filePath": "src/renderer/renderers/RingRenderer.ts",
      "line": 242,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "appendSynopsisElementForScene({",
      "context": {
        "before": {
          "line": 241,
          "text": ""
        },
        "current": {
          "line": 242,
          "text": "appendSynopsisElementForScene({"
        },
        "after": {
          "line": 243,
          "text": "plugin,"
        }
      }
    },
    {
      "filePath": "src/renderer/layout/LayoutConstants.ts",
      "line": 51,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// Legacy aliases (deprecated - use VERSION_ICON_X/Y)",
      "context": {
        "before": {
          "line": 50,
          "text": ""
        },
        "current": {
          "line": 51,
          "text": "// Legacy aliases (deprecated - use VERSION_ICON_X/Y)"
        },
        "after": {
          "line": 52,
          "text": "export const VERSION_INDICATOR_POS_X = VERSION_ICON_X;"
        }
      }
    },
    {
      "filePath": "src/renderer/layout/LayoutConstants.ts",
      "line": 81,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// Legacy aliases (deprecated - use HELP_ICON_X/Y)",
      "context": {
        "before": {
          "line": 80,
          "text": ""
        },
        "current": {
          "line": 81,
          "text": "// Legacy aliases (deprecated - use HELP_ICON_X/Y)"
        },
        "after": {
          "line": 82,
          "text": "export const HELP_ICON_POS_X = HELP_ICON_X;"
        }
      }
    },
    {
      "filePath": "src/renderer/layout/LayoutConstants.ts",
      "line": 208,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "/** Pixels inward from subplot outer radius for synopsis text positioning */",
      "context": {
        "before": {
          "line": 207,
          "text": ""
        },
        "current": {
          "line": 208,
          "text": "/** Pixels inward from subplot outer radius for synopsis text positioning */"
        },
        "after": {
          "line": 209,
          "text": "export const SYNOPSIS_INSET = 0;"
        }
      }
    },
    {
      "filePath": "src/renderer/layout/LayoutConstants.ts",
      "line": 209,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export const SYNOPSIS_INSET = 0;",
      "context": {
        "before": {
          "line": 208,
          "text": "/** Pixels inward from subplot outer radius for synopsis text positioning */"
        },
        "current": {
          "line": 209,
          "text": "export const SYNOPSIS_INSET = 0;"
        },
        "after": {
          "line": 210,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/renderer/layout/LayoutConstants.ts",
      "line": 224,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "/** Maximum text width for synopsis text (px) */",
      "context": {
        "before": {
          "line": 223,
          "text": ""
        },
        "current": {
          "line": 224,
          "text": "/** Maximum text width for synopsis text (px) */"
        },
        "after": {
          "line": 225,
          "text": "export const MAX_TEXT_WIDTH = 500;"
        }
      }
    },
    {
      "filePath": "src/renderer/layout/LayoutConstants.ts",
      "line": 233,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: Font sizes and styling should be defined in styles.css (.rt-storybeat-title)",
      "context": {
        "before": {
          "line": 232,
          "text": "// ============================================================================="
        },
        "current": {
          "line": 233,
          "text": "// Note: Font sizes and styling should be defined in styles.css (.rt-storybeat-title)"
        },
        "after": {
          "line": 234,
          "text": "// These constants are for geometric calculations only"
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 2,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Radial Timeline Plugin for Obsidian  Synopsis DOM Updater",
      "context": {
        "before": {
          "line": 1,
          "text": "/**"
        },
        "current": {
          "line": 2,
          "text": "* Radial Timeline Plugin for Obsidian  Synopsis DOM Updater"
        },
        "after": {
          "line": 3,
          "text": "* Copyright (c) 2025 Eric Rhys Taylor"
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 10,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Updates synopsis text content in the DOM without regenerating SVG",
      "context": {
        "before": {
          "line": 9,
          "text": "/**"
        },
        "current": {
          "line": 10,
          "text": "* Updates synopsis text content in the DOM without regenerating SVG"
        },
        "after": {
          "line": 11,
          "text": "* Used when scene synopsis changes but structure remains the same"
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 11,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Used when scene synopsis changes but structure remains the same",
      "context": {
        "before": {
          "line": 10,
          "text": "* Updates synopsis text content in the DOM without regenerating SVG"
        },
        "current": {
          "line": 11,
          "text": "* Used when scene synopsis changes but structure remains the same"
        },
        "after": {
          "line": 12,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 13,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function updateSynopsisText(",
      "context": {
        "before": {
          "line": 12,
          "text": "*/"
        },
        "current": {
          "line": 13,
          "text": "export function updateSynopsisText("
        },
        "after": {
          "line": 14,
          "text": "svg: SVGSVGElement,"
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 21,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!scene.path || !scene.synopsis) return;",
      "context": {
        "before": {
          "line": 20,
          "text": "changedScenes.forEach(scene => {"
        },
        "current": {
          "line": 21,
          "text": "if (!scene.path || !scene.synopsis) return;"
        },
        "after": {
          "line": 22,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 25,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Find synopsis elements for this scene",
      "context": {
        "before": {
          "line": 24,
          "text": ""
        },
        "current": {
          "line": 25,
          "text": "// Find synopsis elements for this scene"
        },
        "after": {
          "line": 26,
          "text": "const synopsisElements = svg.querySelectorAll(`[data-scene-path=\"${encodedPath}\"] .rt-synopsis-text`);"
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 26,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisElements = svg.querySelectorAll(`[data-scene-path=\"${encodedPath}\"] .rt-synopsis-text`);",
      "context": {
        "before": {
          "line": 25,
          "text": "// Find synopsis elements for this scene"
        },
        "current": {
          "line": 26,
          "text": "const synopsisElements = svg.querySelectorAll(`[data-scene-path=\"${encodedPath}\"] .rt-synopsis-text`);"
        },
        "after": {
          "line": 27,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 28,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisElements.forEach(element => {",
      "context": {
        "before": {
          "line": 27,
          "text": ""
        },
        "current": {
          "line": 28,
          "text": "synopsisElements.forEach(element => {"
        },
        "after": {
          "line": 29,
          "text": "const currentText = element.textContent || '';"
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 30,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const newText = scene.synopsis || '';",
      "context": {
        "before": {
          "line": 29,
          "text": "const currentText = element.textContent || '';"
        },
        "current": {
          "line": 30,
          "text": "const newText = scene.synopsis || '';"
        },
        "after": {
          "line": 31,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 41,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "console.error('[SynopsisDOMUpdater] Failed to update synopsis:', error);",
      "context": {
        "before": {
          "line": 40,
          "text": "} catch (error) {"
        },
        "current": {
          "line": 41,
          "text": "console.error('[SynopsisDOMUpdater] Failed to update synopsis:', error);"
        },
        "after": {
          "line": 42,
          "text": "return false;"
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 47,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Updates synopsis visibility based on mode/zoom",
      "context": {
        "before": {
          "line": 46,
          "text": "/**"
        },
        "current": {
          "line": 47,
          "text": "* Updates synopsis visibility based on mode/zoom"
        },
        "after": {
          "line": 48,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 49,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function updateSynopsisVisibility(",
      "context": {
        "before": {
          "line": 48,
          "text": "*/"
        },
        "current": {
          "line": 49,
          "text": "export function updateSynopsisVisibility("
        },
        "after": {
          "line": 50,
          "text": "svg: SVGSVGElement,"
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 56,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisGroups = svg.querySelectorAll('.rt-synopsis-group');",
      "context": {
        "before": {
          "line": 55,
          "text": ""
        },
        "current": {
          "line": 56,
          "text": "const synopsisGroups = svg.querySelectorAll('.rt-synopsis-group');"
        },
        "after": {
          "line": 57,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 58,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisGroups.forEach(group => {",
      "context": {
        "before": {
          "line": 57,
          "text": ""
        },
        "current": {
          "line": 58,
          "text": "synopsisGroups.forEach(group => {"
        },
        "after": {
          "line": 59,
          "text": "const scenePath = group.getAttribute('data-scene-path');"
        }
      }
    },
    {
      "filePath": "src/renderer/dom/SynopsisDOMUpdater.ts",
      "line": 78,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "console.error('[SynopsisDOMUpdater] Failed to update synopsis visibility:', error);",
      "context": {
        "before": {
          "line": 77,
          "text": "} catch (error) {"
        },
        "current": {
          "line": 78,
          "text": "console.error('[SynopsisDOMUpdater] Failed to update synopsis visibility:', error);"
        },
        "after": {
          "line": 79,
          "text": "return false;"
        }
      }
    },
    {
      "filePath": "src/renderer/components/BackdropMicroRings.ts",
      "line": 132,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "const temp = startMs;",
      "context": {
        "before": {
          "line": 131,
          "text": "if (endMs < startMs) {"
        },
        "current": {
          "line": 132,
          "text": "const temp = startMs;"
        },
        "after": {
          "line": 133,
          "text": "startMs = endMs;"
        }
      }
    },
    {
      "filePath": "src/renderer/components/BackdropMicroRings.ts",
      "line": 134,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "endMs = temp;",
      "context": {
        "before": {
          "line": 133,
          "text": "startMs = endMs;"
        },
        "current": {
          "line": 134,
          "text": "endMs = temp;"
        },
        "after": {
          "line": 135,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/renderer/components/BackdropRing.ts",
      "line": 11,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { appendSynopsisElementForScene } from '../utils/SynopsisBuilder';",
      "context": {
        "before": {
          "line": 10,
          "text": "import { isBeatNote, sortScenes, type PluginRendererFacade } from '../../utils/sceneHelpers';"
        },
        "current": {
          "line": 11,
          "text": "import { appendSynopsisElementForScene } from '../utils/SynopsisBuilder';"
        },
        "after": {
          "line": 12,
          "text": "import { makeSceneId } from '../../utils/numberSquareHelpers';"
        }
      }
    },
    {
      "filePath": "src/renderer/components/BackdropRing.ts",
      "line": 52,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "// IMPORTANT: We must replicate the EXACT deduplication and sorting logic used by Chronologue.ts",
      "context": {
        "before": {
          "line": 51,
          "text": "// 2. Prepare scenes for Outer Ring Alignment"
        },
        "current": {
          "line": 52,
          "text": "// IMPORTANT: We must replicate the EXACT deduplication and sorting logic used by Chronologue.ts"
        },
        "after": {
          "line": 53,
          "text": "// to ensure our angular calculations align perfectly with the scene squares on the outer ring."
        }
      }
    },
    {
      "filePath": "src/renderer/components/BackdropRing.ts",
      "line": 267,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const TD_COL_DY = 16; // Standard row height for synopsis metadata",
      "context": {
        "before": {
          "line": 266,
          "text": ""
        },
        "current": {
          "line": 267,
          "text": "const TD_COL_DY = 16; // Standard row height for synopsis metadata"
        },
        "after": {
          "line": 268,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/renderer/components/BackdropRing.ts",
      "line": 274,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Populate Synopsis",
      "context": {
        "before": {
          "line": 273,
          "text": ""
        },
        "current": {
          "line": 274,
          "text": "// Populate Synopsis"
        },
        "after": {
          "line": 275,
          "text": "appendSynopsisElementForScene({"
        }
      }
    },
    {
      "filePath": "src/renderer/components/BackdropRing.ts",
      "line": 275,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "appendSynopsisElementForScene({",
      "context": {
        "before": {
          "line": 274,
          "text": "// Populate Synopsis"
        },
        "current": {
          "line": 275,
          "text": "appendSynopsisElementForScene({"
        },
        "after": {
          "line": 276,
          "text": "plugin,"
        }
      }
    },
    {
      "filePath": "src/renderer/components/BackdropRing.ts",
      "line": 285,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Create a standard scene group wrapper so interactions (Synopsis, Click) work automatically",
      "context": {
        "before": {
          "line": 284,
          "text": ""
        },
        "current": {
          "line": 285,
          "text": "// Create a standard scene group wrapper so interactions (Synopsis, Click) work automatically"
        },
        "after": {
          "line": 286,
          "text": "const encodedPath = encodeURIComponent(seg.scene.path || '');"
        }
      }
    },
    {
      "filePath": "src/renderer/components/BackdropRing.ts",
      "line": 348,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Synopsis (Transparent hover target usually handled by shared synopsis logic,",
      "context": {
        "before": {
          "line": 347,
          "text": ""
        },
        "current": {
          "line": 348,
          "text": "// Synopsis (Transparent hover target usually handled by shared synopsis logic,"
        },
        "after": {
          "line": 349,
          "text": "// but here we might need specific hover area since it's a specific ring?)"
        }
      }
    },
    {
      "filePath": "src/renderer/components/BackdropRing.ts",
      "line": 350,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// The user said \"synopsis would still be there\".",
      "context": {
        "before": {
          "line": 349,
          "text": "// but here we might need specific hover area since it's a specific ring?)"
        },
        "current": {
          "line": 350,
          "text": "// The user said \"synopsis would still be there\"."
        },
        "after": {
          "line": 351,
          "text": "// The main renderer handles Synopsis via `appendSynopsisElementForScene`."
        }
      }
    },
    {
      "filePath": "src/renderer/components/BackdropRing.ts",
      "line": 351,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// The main renderer handles Synopsis via `appendSynopsisElementForScene`.",
      "context": {
        "before": {
          "line": 350,
          "text": "// The user said \"synopsis would still be there\"."
        },
        "current": {
          "line": 351,
          "text": "// The main renderer handles Synopsis via `appendSynopsisElementForScene`."
        },
        "after": {
          "line": 352,
          "text": "// We just need to make sure `extractGradeFromScene` or whatever generates the ID matches."
        }
      }
    },
    {
      "filePath": "src/renderer/components/ChronologueTimeline.ts",
      "line": 59,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "_durationCapMs?: number | null, // DEPRECATED: cap slider removed, kept for API compatibility",
      "context": {
        "before": {
          "line": 58,
          "text": "scenePositions?: Map<string, { startAngle: number; endAngle: number }>,"
        },
        "current": {
          "line": 59,
          "text": "_durationCapMs?: number | null, // DEPRECATED: cap slider removed, kept for API compatibility"
        },
        "after": {
          "line": 60,
          "text": "arcRadius: number = 758, // Absolute radius for duration arcs"
        }
      }
    },
    {
      "filePath": "src/renderer/components/ChronologueTimeline.ts",
      "line": 350,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Note: This is rarely used - the main path in ChronologueShiftController handles most cases",
      "context": {
        "before": {
          "line": 349,
          "text": "* Render elapsed time arc between two selected scenes (fallback when geometry not available)"
        },
        "current": {
          "line": 350,
          "text": "* Note: This is rarely used - the main path in ChronologueShiftController handles most cases"
        },
        "after": {
          "line": 351,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Defs.ts",
      "line": 12,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "statusColors?: { working: string; todo: string }",
      "context": {
        "before": {
          "line": 11,
          "text": "portableSvg = false,"
        },
        "current": {
          "line": 12,
          "text": "statusColors?: { working: string; todo: string }"
        },
        "after": {
          "line": 13,
          "text": "): string {"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Defs.ts",
      "line": 22,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const todoFill = portableSvg ? (statusColors?.todo ?? '#cccccc') : 'var(--rt-color-todo, #cccccc)';",
      "context": {
        "before": {
          "line": 21,
          "text": "const workingFill = portableSvg ? (statusColors?.working ?? '#FF69B4') : 'var(--rt-color-working, #FF69B4)';"
        },
        "current": {
          "line": 22,
          "text": "const todoFill = portableSvg ? (statusColors?.todo ?? '#cccccc') : 'var(--rt-color-todo, #cccccc)';"
        },
        "after": {
          "line": 23,
          "text": "const plaidOpacity = portableSvg ? '1' : 'var(--rt-color-plaid-opacity, 1)';"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Defs.ts",
      "line": 37,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "// Todo pattern: crosshatch grid  the original plaid for the radial timeline",
      "context": {
        "before": {
          "line": 36,
          "text": ""
        },
        "current": {
          "line": 37,
          "text": "// Todo pattern: crosshatch grid  the original plaid for the radial timeline"
        },
        "after": {
          "line": 38,
          "text": "// Stable for months. APR headless patterns (AprRenderer portable mode) are separate."
        }
      }
    },
    {
      "filePath": "src/renderer/components/Grid.ts",
      "line": 48,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const rowTotal = (rc.Todo || 0) + (rc.Working || 0) + (rc.Due || 0) + (rc.Completed || 0);",
      "context": {
        "before": {
          "line": 47,
          "text": "const rc = gridCountsIn[stage];"
        },
        "current": {
          "line": 48,
          "text": "const rowTotal = (rc.Todo || 0) + (rc.Working || 0) + (rc.Due || 0) + (rc.Completed || 0);"
        },
        "after": {
          "line": 49,
          "text": "const maxStageIdxForGrid = stages.reduce((acc, s, idx) => {"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Grid.ts",
      "line": 51,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const total = (counts.Todo || 0) + (counts.Working || 0) + (counts.Due || 0) + (counts.Completed || 0);",
      "context": {
        "before": {
          "line": 50,
          "text": "const counts = gridCountsIn[s];"
        },
        "current": {
          "line": 51,
          "text": "const total = (counts.Todo || 0) + (counts.Working || 0) + (counts.Due || 0) + (counts.Completed || 0);"
        },
        "after": {
          "line": 52,
          "text": "return total > 0 ? Math.max(acc, idx) : acc;"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Grid.ts",
      "line": 65,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const incomplete = (rc.Todo || 0) + (rc.Working || 0) + (rc.Due || 0);",
      "context": {
        "before": {
          "line": 64,
          "text": "const completed = rc.Completed || 0;"
        },
        "current": {
          "line": 65,
          "text": "const incomplete = (rc.Todo || 0) + (rc.Working || 0) + (rc.Due || 0);"
        },
        "after": {
          "line": 66,
          "text": "const thisStageComplete = completed > 0 && incomplete === 0;"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Grid.ts",
      "line": 74,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const prevTotal = (prevCounts.Todo || 0) + (prevCounts.Working || 0) + (prevCounts.Due || 0) + (prevCounts.Completed || 0);",
      "context": {
        "before": {
          "line": 73,
          "text": "const prevCounts = gridCountsIn[prevStage];"
        },
        "current": {
          "line": 74,
          "text": "const prevTotal = (prevCounts.Todo || 0) + (prevCounts.Working || 0) + (prevCounts.Due || 0) + (prevCounts.Completed || 0);"
        },
        "after": {
          "line": 75,
          "text": "const prevIncomplete = (prevCounts.Todo || 0) + (prevCounts.Working || 0) + (prevCounts.Due || 0);"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Grid.ts",
      "line": 75,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const prevIncomplete = (prevCounts.Todo || 0) + (prevCounts.Working || 0) + (prevCounts.Due || 0);",
      "context": {
        "before": {
          "line": 74,
          "text": "const prevTotal = (prevCounts.Todo || 0) + (prevCounts.Working || 0) + (prevCounts.Due || 0) + (prevCounts.Completed || 0);"
        },
        "current": {
          "line": 75,
          "text": "const prevIncomplete = (prevCounts.Todo || 0) + (prevCounts.Working || 0) + (prevCounts.Due || 0);"
        },
        "after": {
          "line": 76,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/renderer/components/Grid.ts",
      "line": 96,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "} else if (status === 'Todo') {",
      "context": {
        "before": {
          "line": 95,
          "text": "fillAttr = `fill=\"url(#plaidWorking${stage})\"`;"
        },
        "current": {
          "line": 96,
          "text": "} else if (status === 'Todo') {"
        },
        "after": {
          "line": 97,
          "text": "fillAttr = `fill=\"url(#plaidTodo${stage})\"`;"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Grid.ts",
      "line": 112,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "// Show scene names for Todo, Working, Due",
      "context": {
        "before": {
          "line": 111,
          "text": "} else {"
        },
        "current": {
          "line": 112,
          "text": "// Show scene names for Todo, Working, Due"
        },
        "after": {
          "line": 113,
          "text": "const sceneList = sceneNames.join(', ');"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Grid.ts",
      "line": 131,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const label = status === 'Todo' ? 'Tdo' : status === 'Working' ? 'Wrk' : status === 'Completed' ? 'Cmt' : 'Due';",
      "context": {
        "before": {
          "line": 130,
          "text": "${statusesForGrid.map((status, c) => {"
        },
        "current": {
          "line": 131,
          "text": "const label = status === 'Todo' ? 'Tdo' : status === 'Working' ? 'Wrk' : status === 'Completed' ? 'Cmt' : 'Due';"
        },
        "after": {
          "line": 132,
          "text": "const x = startXGrid + c * (cellWidth + cellGapX) + (cellWidth / 2);"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Grid.ts",
      "line": 156,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const total = (counts.Todo || 0) + (counts.Working || 0) + (counts.Due || 0) + (counts.Completed || 0);",
      "context": {
        "before": {
          "line": 155,
          "text": "const counts = gridCounts[s];"
        },
        "current": {
          "line": 156,
          "text": "const total = (counts.Todo || 0) + (counts.Working || 0) + (counts.Due || 0) + (counts.Completed || 0);"
        },
        "after": {
          "line": 157,
          "text": "return total > 0 ? Math.max(acc, idx) : acc;"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Grid.ts",
      "line": 164,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const pressIncomplete = (pressCounts.Todo || 0) + (pressCounts.Working || 0) + (pressCounts.Due || 0);",
      "context": {
        "before": {
          "line": 163,
          "text": "const pressCompleted = pressCounts.Completed || 0;"
        },
        "current": {
          "line": 164,
          "text": "const pressIncomplete = (pressCounts.Todo || 0) + (pressCounts.Working || 0) + (pressCounts.Due || 0);"
        },
        "after": {
          "line": 165,
          "text": "return pressCompleted > 0 && pressIncomplete === 0;"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Grid.ts",
      "line": 187,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const total = (counts.Todo || 0) + (counts.Working || 0) + (counts.Due || 0) + (counts.Completed || 0);",
      "context": {
        "before": {
          "line": 186,
          "text": "const counts = gridCounts[s];"
        },
        "current": {
          "line": 187,
          "text": "const total = (counts.Todo || 0) + (counts.Working || 0) + (counts.Due || 0) + (counts.Completed || 0);"
        },
        "after": {
          "line": 188,
          "text": "return total > 0 ? Math.max(acc, idx) : acc;"
        }
      }
    },
    {
      "filePath": "src/renderer/components/Grid.ts",
      "line": 212,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const total = (counts.Todo || 0) + (counts.Working || 0) + (counts.Due || 0) + (counts.Completed || 0);",
      "context": {
        "before": {
          "line": 211,
          "text": "const counts = gridCounts[s];"
        },
        "current": {
          "line": 212,
          "text": "const total = (counts.Todo || 0) + (counts.Working || 0) + (counts.Due || 0) + (counts.Completed || 0);"
        },
        "after": {
          "line": 213,
          "text": "return total > 0 ? Math.max(acc, idx) : acc;"
        }
      }
    },
    {
      "filePath": "src/renderer/components/ProgressTicks.ts",
      "line": 55,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: Don't show \"Stage complete!\" - if remaining is 0, it might just mean",
      "context": {
        "before": {
          "line": 54,
          "text": "}"
        },
        "current": {
          "line": 55,
          "text": "// Note: Don't show \"Stage complete!\" - if remaining is 0, it might just mean"
        },
        "after": {
          "line": 56,
          "text": "// no scenes have reached that stage yet (not actually complete)"
        }
      }
    },
    {
      "filePath": "src/renderer/components/VersionIndicator.ts",
      "line": 16,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* NOTE: VersionIndicator has dynamic X positioning to prevent text clipping.",
      "context": {
        "before": {
          "line": 15,
          "text": "*"
        },
        "current": {
          "line": 16,
          "text": "* NOTE: VersionIndicator has dynamic X positioning to prevent text clipping."
        },
        "after": {
          "line": 17,
          "text": "* The Y position uses VERSION_ICON_Y from LayoutConstants."
        }
      }
    },
    {
      "filePath": "src/renderer/components/VersionIndicator.ts",
      "line": 150,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* NOTE: X position is dynamically computed to prevent text clipping.",
      "context": {
        "before": {
          "line": 149,
          "text": "* Uses ICON-CENTERED positioning - group origin is icon center."
        },
        "current": {
          "line": 150,
          "text": "* NOTE: X position is dynamically computed to prevent text clipping."
        },
        "after": {
          "line": 151,
          "text": "*"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprBranding.ts",
      "line": 285,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "// Build the SVG text element - IMPORTANT: minimize whitespace since xml:space=\"preserve\"",
      "context": {
        "before": {
          "line": 284,
          "text": ""
        },
        "current": {
          "line": 285,
          "text": "// Build the SVG text element - IMPORTANT: minimize whitespace since xml:space=\"preserve\""
        },
        "after": {
          "line": 286,
          "text": "// causes all whitespace to be rendered as actual space characters on the path"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprConstants.ts",
      "line": 144,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "/** Todo: gray base + 45 crosshatch diagonals in stage color */",
      "context": {
        "before": {
          "line": 143,
          "text": "export const APR_HEADLESS_PATTERNS = {"
        },
        "current": {
          "line": 144,
          "text": "/** Todo: gray base + 45 crosshatch diagonals in stage color */"
        },
        "after": {
          "line": 145,
          "text": "todo: {"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprConstants.ts",
      "line": 145,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "todo: {",
      "context": {
        "before": {
          "line": 144,
          "text": "/** Todo: gray base + 45 crosshatch diagonals in stage color */"
        },
        "current": {
          "line": 145,
          "text": "todo: {"
        },
        "after": {
          "line": 146,
          "text": "tileSize: 8, // Tile side (px)  smaller = denser hatching"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprConstants.ts",
      "line": 284,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "showStatusColors: boolean; // Show status colors (Todo, In Progress, etc.)",
      "context": {
        "before": {
          "line": 283,
          "text": "showSubplots: boolean;"
        },
        "current": {
          "line": 284,
          "text": "showStatusColors: boolean; // Show status colors (Todo, In Progress, etc.)"
        },
        "after": {
          "line": 285,
          "text": "showStageColors: boolean; // Show publish stage colors (Zero, Author, House, Press)"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprConstants.ts",
      "line": 307,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "showStatusColors: true, // Show Todo, In Progress, Overdue",
      "context": {
        "before": {
          "line": 306,
          "text": "showSubplots: false,"
        },
        "current": {
          "line": 307,
          "text": "showStatusColors: true, // Show Todo, In Progress, Overdue"
        },
        "after": {
          "line": 308,
          "text": "showStageColors: false, // Don't show Zero/Author/House/Press"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprLayoutConfig.ts",
      "line": 2,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "* APR Layout Configuration - derived layout shim (deprecated).",
      "context": {
        "before": {
          "line": 1,
          "text": "/**"
        },
        "current": {
          "line": 2,
          "text": "* APR Layout Configuration - derived layout shim (deprecated)."
        },
        "after": {
          "line": 3,
          "text": "* Use aprPresets + aprLayout directly for new work."
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 28,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "showStatusColors?: boolean; // Show status colors (Todo, In Progress, etc.)",
      "context": {
        "before": {
          "line": 27,
          "text": "showActs?: boolean;"
        },
        "current": {
          "line": 28,
          "text": "showStatusColors?: boolean; // Show status colors (Todo, In Progress, etc.)"
        },
        "after": {
          "line": 29,
          "text": "showStageColors?: boolean; // Show publish stage colors (Zero, Author, House, Press)"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 124,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "* Todo  gray base + 45 crosshatch diagonals (\\ and /)",
      "context": {
        "before": {
          "line": 123,
          "text": "* These patterns draw equivalent geometry directly in the tile:"
        },
        "current": {
          "line": 124,
          "text": "* Todo  gray base + 45 crosshatch diagonals (\\ and /)"
        },
        "after": {
          "line": 125,
          "text": "* Working  pink base + horizontal sine wave"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 131,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const todo = APR_HEADLESS_PATTERNS.todo;",
      "context": {
        "before": {
          "line": 130,
          "text": "function renderHeadlessPatternDefs(stageColors: Record<string, string>): string {"
        },
        "current": {
          "line": 131,
          "text": "const todo = APR_HEADLESS_PATTERNS.todo;"
        },
        "after": {
          "line": 132,
          "text": "const working = APR_HEADLESS_PATTERNS.working;"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 135,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "//  Todo: gray base + 45 crosshatch (diagonal lines, no patternTransform) ",
      "context": {
        "before": {
          "line": 134,
          "text": "for (const [stage, stageColor] of Object.entries(stageColors)) {"
        },
        "current": {
          "line": 135,
          "text": "//  Todo: gray base + 45 crosshatch (diagonal lines, no patternTransform) "
        },
        "after": {
          "line": 136,
          "text": "const ts = todo.tileSize;"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 136,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const ts = todo.tileSize;",
      "context": {
        "before": {
          "line": 135,
          "text": "//  Todo: gray base + 45 crosshatch (diagonal lines, no patternTransform) "
        },
        "current": {
          "line": 136,
          "text": "const ts = todo.tileSize;"
        },
        "after": {
          "line": 137,
          "text": "defs += `<pattern id=\"aprHeadlessTodo${stage}\" patternUnits=\"userSpaceOnUse\" width=\"${ts}\" height=\"${ts}\">` +"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 138,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "`<rect width=\"${ts}\" height=\"${ts}\" fill=\"${todo.fill}\"/>` +",
      "context": {
        "before": {
          "line": 137,
          "text": "defs += `<pattern id=\"aprHeadlessTodo${stage}\" patternUnits=\"userSpaceOnUse\" width=\"${ts}\" height=\"${ts}\">` +"
        },
        "current": {
          "line": 138,
          "text": "`<rect width=\"${ts}\" height=\"${ts}\" fill=\"${todo.fill}\"/>` +"
        },
        "after": {
          "line": 139,
          "text": "`<path d=\"M0,0 l${ts},${ts} M0,${ts} l${ts},-${ts}\" ` +"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 140,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "`stroke=\"${stageColor}\" stroke-width=\"${todo.strokeWidth}\" stroke-opacity=\"${todo.strokeOpacity}\" fill=\"none\"/>` +",
      "context": {
        "before": {
          "line": 139,
          "text": "`<path d=\"M0,0 l${ts},${ts} M0,${ts} l${ts},-${ts}\" ` +"
        },
        "current": {
          "line": 140,
          "text": "`stroke=\"${stageColor}\" stroke-width=\"${todo.strokeWidth}\" stroke-opacity=\"${todo.strokeOpacity}\" fill=\"none\"/>` +"
        },
        "after": {
          "line": 141,
          "text": "`</pattern>`;"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 350,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: Filters are skipped in portable mode for Figma/Illustrator compatibility",
      "context": {
        "before": {
          "line": 349,
          "text": "// Use patternScale from preset for denser patterns at smaller sizes"
        },
        "current": {
          "line": 350,
          "text": "// Note: Filters are skipped in portable mode for Figma/Illustrator compatibility"
        },
        "after": {
          "line": 351,
          "text": "const percentShadow = portableSvg ? '' : `"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 364,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "todo: '#cccccc' // STATUS_COLORS.Todo fallback",
      "context": {
        "before": {
          "line": 363,
          "text": "working: '#FF69B4', // STATUS_COLORS.Working fallback"
        },
        "current": {
          "line": 364,
          "text": "todo: '#cccccc' // STATUS_COLORS.Todo fallback"
        },
        "after": {
          "line": 365,
          "text": "} : undefined;"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 368,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "// (no patternTransform) so Todo crosshatch and Working waves render in Figma/Illustrator.",
      "context": {
        "before": {
          "line": 367,
          "text": "// In portable mode we also emit Figma-safe headless patterns that use direct geometry"
        },
        "current": {
          "line": 368,
          "text": "// (no patternTransform) so Todo crosshatch and Working waves render in Figma/Illustrator."
        },
        "after": {
          "line": 369,
          "text": "const headlessPatterns = portableSvg ? renderHeadlessPatternDefs(stageColorMap) : '';"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 382,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: Grayscale filter skipped in portable mode for Figma compatibility",
      "context": {
        "before": {
          "line": 381,
          "text": "// Normal mode: Draw rings with scene cells"
        },
        "current": {
          "line": 382,
          "text": "// Note: Grayscale filter skipped in portable mode for Figma compatibility"
        },
        "after": {
          "line": 383,
          "text": "const ringFilter = (grayscaleScenes && !portableSvg) ? ' filter=\"url(#aprGrayscale)\"' : '';"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 522,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const patternMatch = portableSvg ? sceneColor.match(/^url\\(#plaid(Working|Todo)/) : null;",
      "context": {
        "before": {
          "line": 521,
          "text": "// (real plaid defs use patternTransform which Figma ignores)."
        },
        "current": {
          "line": 522,
          "text": "const patternMatch = portableSvg ? sceneColor.match(/^url\\(#plaid(Working|Todo)/) : null;"
        },
        "after": {
          "line": 523,
          "text": "if (patternMatch) {"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 525,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const headlessFill = patternMatch[1] === 'Todo'",
      "context": {
        "before": {
          "line": 524,
          "text": "const stageKey = resolvePublishStageKey(scene['Publish Stage'], stageColors);"
        },
        "current": {
          "line": 525,
          "text": "const headlessFill = patternMatch[1] === 'Todo'"
        },
        "after": {
          "line": 526,
          "text": "? `url(#aprHeadlessTodo${stageKey})`"
        }
      }
    },
    {
      "filePath": "src/renderer/apr/AprRenderer.ts",
      "line": 578,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "* @param showStatusColors - Show Todo/In Progress/Done/Overdue colors",
      "context": {
        "before": {
          "line": 577,
          "text": "* @param scene - The scene to color"
        },
        "current": {
          "line": 578,
          "text": "* @param showStatusColors - Show Todo/In Progress/Done/Overdue colors"
        },
        "after": {
          "line": 579,
          "text": "* @param showStageColors - Show Zero/Author/House/Press colors"
        }
      }
    },
    {
      "filePath": "src/modes/ModeDefinition.ts",
      "line": 95,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "| 'standard-scene-hover' // Standard scene hover with synopsis",
      "context": {
        "before": {
          "line": 94,
          "text": "export type ModeHoverBehavior ="
        },
        "current": {
          "line": 95,
          "text": "| 'standard-scene-hover' // Standard scene hover with synopsis"
        },
        "after": {
          "line": 96,
          "text": "| 'plot-only-hover' // Hover only on plot elements"
        }
      }
    },
    {
      "filePath": "src/modes/ModeManager.ts",
      "line": 172,
      "token": "refreshTimelineIfNeeded",
      "category": "drift-term",
      "lineText": "this.plugin.refreshTimelineIfNeeded(null);",
      "context": {
        "before": {
          "line": 171,
          "text": "// Fallback to plugin's refresh"
        },
        "current": {
          "line": 172,
          "text": "this.plugin.refreshTimelineIfNeeded(null);"
        },
        "after": {
          "line": 173,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/modals/BookDesignerModal.ts",
      "line": 73,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "this.descriptionEl = form.createDiv({ cls: 'rt-sub-card-note', text: 'Templates capture layout, acts, subplots, characters, beats toggle, and the selected YAML type (base/advanced).' });",
      "context": {
        "before": {
          "line": 72,
          "text": ""
        },
        "current": {
          "line": 73,
          "text": "this.descriptionEl = form.createDiv({ cls: 'rt-sub-card-note', text: 'Templates capture layout, acts, subplots, characters, beats toggle, and the selected YAML type (base/advanced).' });"
        },
        "after": {
          "line": 74,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/BookDesignerModal.ts",
      "line": 706,
      "token": "WORKAROUND",
      "category": "stale-comment",
      "lineText": "// Forward reference workaround: Define lengthSetting first but add it later?",
      "context": {
        "before": {
          "line": 705,
          "text": ""
        },
        "current": {
          "line": 706,
          "text": "// Forward reference workaround: Define lengthSetting first but add it later?"
        },
        "after": {
          "line": 707,
          "text": "// No, we can just define the update helper to take setting instance."
        }
      }
    },
    {
      "filePath": "src/modals/CreateBeatsTemplatesModal.ts",
      "line": 56,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "card.createDiv({ cls: 'rt-sub-card-note', text: 'Each beat note will have the following property structure (shown in YAML format):' });",
      "context": {
        "before": {
          "line": 55,
          "text": ""
        },
        "current": {
          "line": 56,
          "text": "card.createDiv({ cls: 'rt-sub-card-note', text: 'Each beat note will have the following property structure (shown in YAML format):' });"
        },
        "after": {
          "line": 57,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/CreateBeatsTemplatesModal.ts",
      "line": 81,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "card.createDiv({ cls: 'rt-sub-card-note', text: locationText });",
      "context": {
        "before": {
          "line": 80,
          "text": ""
        },
        "current": {
          "line": 81,
          "text": "card.createDiv({ cls: 'rt-sub-card-note', text: locationText });"
        },
        "after": {
          "line": 82,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/CreateBeatsTemplatesModal.ts",
      "line": 123,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "//  Deprecated aliases (remove after v5.2) ",
      "context": {
        "before": {
          "line": 122,
          "text": ""
        },
        "current": {
          "line": 123,
          "text": "//  Deprecated aliases (remove after v5.2) "
        },
        "after": {
          "line": 124,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/CreateBeatsTemplatesModal.ts",
      "line": 125,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Use CreateBeatSetResult */",
      "context": {
        "before": {
          "line": 124,
          "text": ""
        },
        "current": {
          "line": 125,
          "text": "/** @deprecated Use CreateBeatSetResult */"
        },
        "after": {
          "line": 126,
          "text": "export type CreateBeatsTemplatesResult = CreateBeatSetResult;"
        }
      }
    },
    {
      "filePath": "src/modals/CreateBeatsTemplatesModal.ts",
      "line": 128,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Use CreateBeatSetModal */",
      "context": {
        "before": {
          "line": 127,
          "text": ""
        },
        "current": {
          "line": 128,
          "text": "/** @deprecated Use CreateBeatSetModal */"
        },
        "after": {
          "line": 129,
          "text": "export const CreateBeatsTemplatesModal = CreateBeatSetModal;"
        }
      }
    },
    {
      "filePath": "src/modals/GossamerProcessingModal.ts",
      "line": 153,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "// TODO(#SAN-2): Update this check to be provider-agnostic.",
      "context": {
        "before": {
          "line": 152,
          "text": "// Check if API key is configured"
        },
        "current": {
          "line": 153,
          "text": "// TODO(#SAN-2): Update this check to be provider-agnostic."
        },
        "after": {
          "line": 154,
          "text": "if (!this.plugin.settings.geminiApiKey && this.plugin.settings.defaultAiProvider === 'gemini') {"
        }
      }
    },
    {
      "filePath": "src/modals/GossamerProcessingModal.ts",
      "line": 157,
      "token": "api key in settings",
      "category": "drift-term",
      "lineText": "warningEl.setText(' Gemini API key not configured. Please set your API key in Settings  AI  Gemini API key.');",
      "context": {
        "before": {
          "line": 156,
          "text": "const warningEl = card.createDiv({ cls: 'rt-pulse-warning' });"
        },
        "current": {
          "line": 157,
          "text": "warningEl.setText(' Gemini API key not configured. Please set your API key in Settings  AI  Gemini API key.');"
        },
        "after": {
          "line": 158,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/modals/GossamerProcessingModal.ts",
      "line": 295,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: Previous scores are not sent to AI to avoid anchoring bias.",
      "context": {
        "before": {
          "line": 294,
          "text": ""
        },
        "current": {
          "line": 295,
          "text": "// Note: Previous scores are not sent to AI to avoid anchoring bias."
        },
        "after": {
          "line": 296,
          "text": "// Each analysis is fresh based on manuscript content only."
        }
      }
    },
    {
      "filePath": "src/modals/GossamerScoreModal.ts",
      "line": 31,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "range?: string; // Ideal range from beat note (e.g., \"0-20\", \"60-70\")",
      "context": {
        "before": {
          "line": 30,
          "text": "scoreDisplayEl?: HTMLElement; // Reference to the scores display element"
        },
        "current": {
          "line": 31,
          "text": "range?: string; // Ideal range from beat note (e.g., \"0-20\", \"60-70\")"
        },
        "after": {
          "line": 32,
          "text": "description?: string; // Beat purpose from YAML (legacy Description supported)"
        }
      }
    },
    {
      "filePath": "src/modals/GossamerScoreModal.ts",
      "line": 264,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// NOTE: Temporarily disabled - metadata cache not refreshing Range field",
      "context": {
        "before": {
          "line": 263,
          "text": "// Validate Range fields (filter by beat system but ignore title matching)"
        },
        "current": {
          "line": 264,
          "text": "// NOTE: Temporarily disabled - metadata cache not refreshing Range field"
        },
        "after": {
          "line": 265,
          "text": "// const rangeValidation = validateBeatRanges(filteredBeats, settingsSystem);"
        }
      }
    },
    {
      "filePath": "src/modals/GossamerScoreModal.ts",
      "line": 302,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// `Add \"Range: 0-20\" to beat note frontmatter. Scores outside ideal range will show thicker red y-axis spokes.`",
      "context": {
        "before": {
          "line": 301,
          "text": "// ` ${count} beat${count > 1 ? 's' : ''} missing ideal Range (e.g., \"0-20\", \"71-90\"): ${beatList}${more}. ` +"
        },
        "current": {
          "line": 302,
          "text": "// `Add \"Range: 0-20\" to beat note frontmatter. Scores outside ideal range will show thicker red y-axis spokes.`"
        },
        "after": {
          "line": 303,
          "text": "// );"
        }
      }
    },
    {
      "filePath": "src/modals/GossamerScoreModal.ts",
      "line": 610,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "? 'Purposes are pulled directly from each beat note\\'s Purpose field (legacy Description supported).'",
      "context": {
        "before": {
          "line": 609,
          "text": "lines.push(this.includeBeatDescriptions"
        },
        "current": {
          "line": 610,
          "text": "? 'Purposes are pulled directly from each beat note\\'s Purpose field (legacy Description supported).'"
        },
        "after": {
          "line": 611,
          "text": ": 'Update each beat note\\'s Range and Purpose fields to customize this list. Toggle above to include purposes.');"
        }
      }
    },
    {
      "filePath": "src/modals/GossamerScoreModal.ts",
      "line": 611,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": ": 'Update each beat note\\'s Range and Purpose fields to customize this list. Toggle above to include purposes.');",
      "context": {
        "before": {
          "line": 610,
          "text": "? 'Purposes are pulled directly from each beat note\\'s Purpose field (legacy Description supported).'"
        },
        "current": {
          "line": 611,
          "text": ": 'Update each beat note\\'s Range and Purpose fields to customize this list. Toggle above to include purposes.');"
        },
        "after": {
          "line": 612,
          "text": "lines.push('');"
        }
      }
    },
    {
      "filePath": "src/modals/GossamerScoreModal.ts",
      "line": 667,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "lines.push('# Note: After filling in the numbers, return ONLY the \"Completed Momentum Scores\" block so it can be pasted back into Obsidian.');",
      "context": {
        "before": {
          "line": 666,
          "text": "lines.push('');"
        },
        "current": {
          "line": 667,
          "text": "lines.push('# Note: After filling in the numbers, return ONLY the \"Completed Momentum Scores\" block so it can be pasted back into Obsidian.');"
        },
        "after": {
          "line": 668,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/GossamerScoreModal.ts",
      "line": 817,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Find Plot note by title (same logic as saveGossamerScores)",
      "context": {
        "before": {
          "line": 816,
          "text": "for (const [beatTitle, gossamerNums] of deletions) {"
        },
        "current": {
          "line": 817,
          "text": "// Find Plot note by title (same logic as saveGossamerScores)"
        },
        "after": {
          "line": 818,
          "text": "let file = null;"
        }
      }
    },
    {
      "filePath": "src/modals/GossamerScoreModal.ts",
      "line": 963,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "new Notice(` Deleted all Gossamer scores and justifications from ${deletedCount} Beat note(s).`);",
      "context": {
        "before": {
          "line": 962,
          "text": ""
        },
        "current": {
          "line": 963,
          "text": "new Notice(` Deleted all Gossamer scores and justifications from ${deletedCount} Beat note(s).`);"
        },
        "after": {
          "line": 964,
          "text": "this.close(); // Close the modal since all scores are cleared"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 23,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "includeSynopsis?: boolean;",
      "context": {
        "before": {
          "line": 22,
          "text": "updateWordCounts?: boolean;"
        },
        "current": {
          "line": 23,
          "text": "includeSynopsis?: boolean;"
        },
        "after": {
          "line": 24,
          "text": "includeMatter?: boolean;"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 51,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private includeSynopsis: boolean = true;",
      "context": {
        "before": {
          "line": 50,
          "text": "private updateWordCounts: boolean = false;"
        },
        "current": {
          "line": 51,
          "text": "private includeSynopsis: boolean = true;"
        },
        "after": {
          "line": 52,
          "text": "private includeMatter: boolean = true;"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 97,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private outlineSynopsisRow?: HTMLElement;",
      "context": {
        "before": {
          "line": 96,
          "text": "private includeMatterCard?: HTMLElement;"
        },
        "current": {
          "line": 97,
          "text": "private outlineSynopsisRow?: HTMLElement;"
        },
        "after": {
          "line": 98,
          "text": "private advancedDetailsEl?: HTMLDetailsElement;"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 231,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "this.manuscriptPresetDescEl = this.manuscriptOptionsCard.createDiv({ cls: 'rt-sub-card-note' });",
      "context": {
        "before": {
          "line": 230,
          "text": "this.styleDropdownProOptions(this.manuscriptPresetDropdown, ['screenplay', 'podcast']);"
        },
        "current": {
          "line": 231,
          "text": "this.manuscriptPresetDescEl = this.manuscriptOptionsCard.createDiv({ cls: 'rt-sub-card-note' });"
        },
        "after": {
          "line": 232,
          "text": "this.updateManuscriptPresetDescription();"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 252,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "this.outlinePresetDescEl = this.outlineOptionsCard.createDiv({ cls: 'rt-sub-card-note' });",
      "context": {
        "before": {
          "line": 251,
          "text": "});"
        },
        "current": {
          "line": 252,
          "text": "this.outlinePresetDescEl = this.outlineOptionsCard.createDiv({ cls: 'rt-sub-card-note' });"
        },
        "after": {
          "line": 253,
          "text": "this.updateOutlinePresetDescription();"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 270,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'rt-sub-card-note',",
      "context": {
        "before": {
          "line": 269,
          "text": "this.actSnapNoteEl = this.scopeCard.createDiv({"
        },
        "current": {
          "line": 270,
          "text": "cls: 'rt-sub-card-note',"
        },
        "after": {
          "line": 271,
          "text": "text: 'Act snapping follows the current ordering mode.'"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 306,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'rt-sub-card-note rt-hidden',",
      "context": {
        "before": {
          "line": 305,
          "text": "this.chronoHelperEl = this.orderingCard.createDiv({"
        },
        "current": {
          "line": 306,
          "text": "cls: 'rt-sub-card-note rt-hidden',"
        },
        "after": {
          "line": 307,
          "text": "text: 'No When dates found.'"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 310,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'rt-sub-card-note',",
      "context": {
        "before": {
          "line": 309,
          "text": "this.orderingCard.createDiv({"
        },
        "current": {
          "line": 310,
          "text": "cls: 'rt-sub-card-note',"
        },
        "after": {
          "line": 311,
          "text": "text: t('manuscriptModal.orderNote')"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 334,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'rt-sub-card-note',",
      "context": {
        "before": {
          "line": 333,
          "text": "this.tocCard.createDiv({"
        },
        "current": {
          "line": 334,
          "text": "cls: 'rt-sub-card-note',"
        },
        "after": {
          "line": 335,
          "text": "text: t('manuscriptModal.tocNote')"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 347,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.outlineSynopsisRow = rulesCard.createDiv({ cls: 'rt-manuscript-toggle-row' });",
      "context": {
        "before": {
          "line": 346,
          "text": ""
        },
        "current": {
          "line": 347,
          "text": "this.outlineSynopsisRow = rulesCard.createDiv({ cls: 'rt-manuscript-toggle-row' });"
        },
        "after": {
          "line": 348,
          "text": "this.outlineSynopsisRow.createSpan({ cls: 'rt-manuscript-toggle-label', text: t('manuscriptModal.includeSynopsis') });"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 348,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.outlineSynopsisRow.createSpan({ cls: 'rt-manuscript-toggle-label', text: t('manuscriptModal.includeSynopsis') });",
      "context": {
        "before": {
          "line": 347,
          "text": "this.outlineSynopsisRow = rulesCard.createDiv({ cls: 'rt-manuscript-toggle-row' });"
        },
        "current": {
          "line": 348,
          "text": "this.outlineSynopsisRow.createSpan({ cls: 'rt-manuscript-toggle-label', text: t('manuscriptModal.includeSynopsis') });"
        },
        "after": {
          "line": 349,
          "text": "new ToggleComponent(this.outlineSynopsisRow)"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 349,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "new ToggleComponent(this.outlineSynopsisRow)",
      "context": {
        "before": {
          "line": 348,
          "text": "this.outlineSynopsisRow.createSpan({ cls: 'rt-manuscript-toggle-label', text: t('manuscriptModal.includeSynopsis') });"
        },
        "current": {
          "line": 349,
          "text": "new ToggleComponent(this.outlineSynopsisRow)"
        },
        "after": {
          "line": 350,
          "text": ".setValue(this.includeSynopsis)"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 350,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": ".setValue(this.includeSynopsis)",
      "context": {
        "before": {
          "line": 349,
          "text": "new ToggleComponent(this.outlineSynopsisRow)"
        },
        "current": {
          "line": 350,
          "text": ".setValue(this.includeSynopsis)"
        },
        "after": {
          "line": 351,
          "text": ".onChange((value) => {"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 352,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.includeSynopsis = value;",
      "context": {
        "before": {
          "line": 351,
          "text": ".onChange((value) => {"
        },
        "current": {
          "line": 352,
          "text": "this.includeSynopsis = value;"
        },
        "after": {
          "line": 353,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 375,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'rt-sub-card-note',",
      "context": {
        "before": {
          "line": 374,
          "text": "advancedBody.createDiv({"
        },
        "current": {
          "line": 375,
          "text": "cls: 'rt-sub-card-note',"
        },
        "after": {
          "line": 376,
          "text": "text: 'When rendering PDF, the markdown input is saved first.'"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 401,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "this.outputStatusEl = container.createDiv({ cls: 'ert-manuscript-output-status rt-sub-card-note rt-hidden' });",
      "context": {
        "before": {
          "line": 400,
          "text": ""
        },
        "current": {
          "line": 401,
          "text": "this.outputStatusEl = container.createDiv({ cls: 'ert-manuscript-output-status rt-sub-card-note rt-hidden' });"
        },
        "after": {
          "line": 402,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 586,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.outlineSynopsisRow?.toggleClass('rt-hidden', this.exportType !== 'outline');",
      "context": {
        "before": {
          "line": 585,
          "text": "this.includeMatterCard?.toggleClass('rt-hidden', rules.includeMatterMode !== 'user');"
        },
        "current": {
          "line": 586,
          "text": "this.outlineSynopsisRow?.toggleClass('rt-hidden', this.exportType !== 'outline');"
        },
        "after": {
          "line": 587,
          "text": "this.filterCard?.toggleClass('rt-hidden', !rules.showSubplotFilter);"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 660,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'rt-sub-card-note',",
      "context": {
        "before": {
          "line": 659,
          "text": "this.layoutContainerEl.createDiv({"
        },
        "current": {
          "line": 660,
          "text": "cls: 'rt-sub-card-note',"
        },
        "after": {
          "line": 661,
          "text": "text: layouts[0].name"
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 1253,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const includeSynopsis = this.exportType === 'outline' ? this.includeSynopsis : false;",
      "context": {
        "before": {
          "line": 1252,
          "text": "const includeMatter = rules.includeMatterMode === 'user' ? this.includeMatterUserChoice : false;"
        },
        "current": {
          "line": 1253,
          "text": "const includeSynopsis = this.exportType === 'outline' ? this.includeSynopsis : false;"
        },
        "after": {
          "line": 1254,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/ManuscriptOptionsModal.ts",
      "line": 1274,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "includeSynopsis,",
      "context": {
        "before": {
          "line": 1273,
          "text": "updateWordCounts: this.updateWordCounts,"
        },
        "current": {
          "line": 1274,
          "text": "includeSynopsis,"
        },
        "after": {
          "line": 1275,
          "text": "includeMatter,"
        }
      }
    },
    {
      "filePath": "src/modals/RuntimeProcessingModal.ts",
      "line": 229,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "this.createStatusCheckbox(statusRow, 'Todo', 'includeTodo', this.statusFilters.includeTodo);",
      "context": {
        "before": {
          "line": 228,
          "text": ""
        },
        "current": {
          "line": 229,
          "text": "this.createStatusCheckbox(statusRow, 'Todo', 'includeTodo', this.statusFilters.includeTodo);"
        },
        "after": {
          "line": 230,
          "text": "this.createStatusCheckbox(statusRow, 'Working', 'includeWorking', this.statusFilters.includeWorking);"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 15,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { getSynopsisGenerationWordLimit } from '../utils/synopsisLimits';",
      "context": {
        "before": {
          "line": 14,
          "text": "import type { LlmTimingStats } from '../types/settings';"
        },
        "current": {
          "line": 15,
          "text": "import { getSynopsisGenerationWordLimit } from '../utils/synopsisLimits';"
        },
        "after": {
          "line": 16,
          "text": "import type { AIRunAdvancedContext } from '../ai/types';"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 19,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export type ProcessingMode = 'flagged' | 'unprocessed' | 'force-all' | 'synopsis-flagged' | 'synopsis-missing-weak' | 'synopsis-missing' | 'synopsis-all';",
      "context": {
        "before": {
          "line": 18,
          "text": ""
        },
        "current": {
          "line": 19,
          "text": "export type ProcessingMode = 'flagged' | 'unprocessed' | 'force-all' | 'synopsis-flagged' | 'synopsis-missing-weak' | 'synopsis-missing' | 'synopsis-all';"
        },
        "after": {
          "line": 20,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 93,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private readonly taskType: 'pulse' | 'synopsis';",
      "context": {
        "before": {
          "line": 92,
          "text": "private readonly isEntireSubplot?: boolean; // Track if this is \"entire subplot\" vs \"flagged scenes\""
        },
        "current": {
          "line": 93,
          "text": "private readonly taskType: 'pulse' | 'synopsis';"
        },
        "after": {
          "line": 94,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 96,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private processedSynopsisResults: Map<string, string> = new Map(); // Store synopsis results for apply phase",
      "context": {
        "before": {
          "line": 95,
          "text": "private processedResults: Map<string, string> = new Map(); // Store summary results for apply phase"
        },
        "current": {
          "line": 96,
          "text": "private processedSynopsisResults: Map<string, string> = new Map(); // Store synopsis results for apply phase"
        },
        "after": {
          "line": 97,
          "text": "private hasPendingSynopsisResults: boolean = false; // Flag to indicate results are ready to apply"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 97,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private hasPendingSynopsisResults: boolean = false; // Flag to indicate results are ready to apply",
      "context": {
        "before": {
          "line": 96,
          "text": "private processedSynopsisResults: Map<string, string> = new Map(); // Store synopsis results for apply phase"
        },
        "current": {
          "line": 97,
          "text": "private hasPendingSynopsisResults: boolean = false; // Flag to indicate results are ready to apply"
        },
        "after": {
          "line": 98,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 103,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Synopsis-specific controls",
      "context": {
        "before": {
          "line": 102,
          "text": ""
        },
        "current": {
          "line": 103,
          "text": "// Synopsis-specific controls"
        },
        "after": {
          "line": 104,
          "text": "private synopsisTargetWords: number = 200;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 104,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private synopsisTargetWords: number = 200;",
      "context": {
        "before": {
          "line": 103,
          "text": "// Synopsis-specific controls"
        },
        "current": {
          "line": 104,
          "text": "private synopsisTargetWords: number = 200;"
        },
        "after": {
          "line": 105,
          "text": "private synopsisWeakThreshold: number = 75;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 105,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private synopsisWeakThreshold: number = 75;",
      "context": {
        "before": {
          "line": 104,
          "text": "private synopsisTargetWords: number = 200;"
        },
        "current": {
          "line": 105,
          "text": "private synopsisWeakThreshold: number = 75;"
        },
        "after": {
          "line": 106,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 148,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "taskType: 'pulse' | 'synopsis' = 'pulse'",
      "context": {
        "before": {
          "line": 147,
          "text": "isEntireSubplot?: boolean,"
        },
        "current": {
          "line": 148,
          "text": "taskType: 'pulse' | 'synopsis' = 'pulse'"
        },
        "after": {
          "line": 149,
          "text": ") {"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 159,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Initialize synopsis settings from plugin settings",
      "context": {
        "before": {
          "line": 158,
          "text": ""
        },
        "current": {
          "line": 159,
          "text": "// Initialize synopsis settings from plugin settings"
        },
        "after": {
          "line": 160,
          "text": "this.synopsisTargetWords = plugin.settings.synopsisTargetWords ?? 200;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 160,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.synopsisTargetWords = plugin.settings.synopsisTargetWords ?? 200;",
      "context": {
        "before": {
          "line": 159,
          "text": "// Initialize synopsis settings from plugin settings"
        },
        "current": {
          "line": 160,
          "text": "this.synopsisTargetWords = plugin.settings.synopsisTargetWords ?? 200;"
        },
        "after": {
          "line": 161,
          "text": "this.synopsisWeakThreshold = plugin.settings.synopsisWeakThreshold ?? 75;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 161,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.synopsisWeakThreshold = plugin.settings.synopsisWeakThreshold ?? 75;",
      "context": {
        "before": {
          "line": 160,
          "text": "this.synopsisTargetWords = plugin.settings.synopsisTargetWords ?? 200;"
        },
        "current": {
          "line": 161,
          "text": "this.synopsisWeakThreshold = plugin.settings.synopsisWeakThreshold ?? 75;"
        },
        "after": {
          "line": 162,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 213,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.taskType === 'synopsis') {",
      "context": {
        "before": {
          "line": 212,
          "text": "private getProcessingTitle(): string {"
        },
        "current": {
          "line": 213,
          "text": "if (this.taskType === 'synopsis') {"
        },
        "after": {
          "line": 214,
          "text": "return 'Summary refresh';"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 229,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "case 'synopsis-flagged': return 'Update flagged scenes';",
      "context": {
        "before": {
          "line": 228,
          "text": "case 'flagged': return 'Analyze flagged scenes in manuscript order';"
        },
        "current": {
          "line": 229,
          "text": "case 'synopsis-flagged': return 'Update flagged scenes';"
        },
        "after": {
          "line": 230,
          "text": "case 'synopsis-missing-weak': return 'Update missing, weak, or stale summaries';"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 230,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "case 'synopsis-missing-weak': return 'Update missing, weak, or stale summaries';",
      "context": {
        "before": {
          "line": 229,
          "text": "case 'synopsis-flagged': return 'Update flagged scenes';"
        },
        "current": {
          "line": 230,
          "text": "case 'synopsis-missing-weak': return 'Update missing, weak, or stale summaries';"
        },
        "after": {
          "line": 231,
          "text": "case 'synopsis-missing': return 'Update missing summaries only';"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 231,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "case 'synopsis-missing': return 'Update missing summaries only';",
      "context": {
        "before": {
          "line": 230,
          "text": "case 'synopsis-missing-weak': return 'Update missing, weak, or stale summaries';"
        },
        "current": {
          "line": 231,
          "text": "case 'synopsis-missing': return 'Update missing summaries only';"
        },
        "after": {
          "line": 232,
          "text": "case 'synopsis-all': return 'Regenerate ALL summaries';"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 232,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "case 'synopsis-all': return 'Regenerate ALL summaries';",
      "context": {
        "before": {
          "line": 231,
          "text": "case 'synopsis-missing': return 'Update missing summaries only';"
        },
        "current": {
          "line": 232,
          "text": "case 'synopsis-all': return 'Regenerate ALL summaries';"
        },
        "after": {
          "line": 233,
          "text": "default: return mode;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 238,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.taskType === 'synopsis') {",
      "context": {
        "before": {
          "line": 237,
          "text": "private getProcessingSubtitle(): string {"
        },
        "current": {
          "line": 238,
          "text": "if (this.taskType === 'synopsis') {"
        },
        "after": {
          "line": 239,
          "text": "return 'Generates Inquiry corpus summaries and writes each scene immediately as it completes. Existing Summary values are replaced (and Synopsis too if enabled).';"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 239,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return 'Generates Inquiry corpus summaries and writes each scene immediately as it completes. Existing Summary values are replaced (and Synopsis too if enabled).';",
      "context": {
        "before": {
          "line": 238,
          "text": "if (this.taskType === 'synopsis') {"
        },
        "current": {
          "line": 239,
          "text": "return 'Generates Inquiry corpus summaries and writes each scene immediately as it completes. Existing Summary values are replaced (and Synopsis too if enabled).';"
        },
        "after": {
          "line": 240,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 256,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const badgeLabel = this.taskType === 'synopsis' ? 'AI Summary' : 'AI Pulse Run';",
      "context": {
        "before": {
          "line": 255,
          "text": "const modelLabel = this.getActiveModelDisplayName();"
        },
        "current": {
          "line": 256,
          "text": "const badgeLabel = this.taskType === 'synopsis' ? 'AI Summary' : 'AI Pulse Run';"
        },
        "after": {
          "line": 257,
          "text": "const badgeText = modelLabel ? `${badgeLabel}  ${modelLabel}` : badgeLabel;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 305,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Background icon container (for grade-based icons or synopsis icons)",
      "context": {
        "before": {
          "line": 304,
          "text": ""
        },
        "current": {
          "line": 305,
          "text": "// Background icon container (for grade-based icons or synopsis icons)"
        },
        "after": {
          "line": 306,
          "text": "const iconBg = entry.createDiv({ cls: 'rt-pulse-card-icon-bg' });"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 309,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// For synopsis mode, add \"?\" icon for unprocessed scenes",
      "context": {
        "before": {
          "line": 308,
          "text": ""
        },
        "current": {
          "line": 309,
          "text": "// For synopsis mode, add \"?\" icon for unprocessed scenes"
        },
        "after": {
          "line": 310,
          "text": "if (this.taskType === 'synopsis') {"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 310,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.taskType === 'synopsis') {",
      "context": {
        "before": {
          "line": 309,
          "text": "// For synopsis mode, add \"?\" icon for unprocessed scenes"
        },
        "current": {
          "line": 310,
          "text": "if (this.taskType === 'synopsis') {"
        },
        "after": {
          "line": 311,
          "text": "setIcon(iconBg, 'help-circle');"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 312,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "entry.addClass('rt-synopsis-pending');",
      "context": {
        "before": {
          "line": 311,
          "text": "setIcon(iconBg, 'help-circle');"
        },
        "current": {
          "line": 312,
          "text": "entry.addClass('rt-synopsis-pending');"
        },
        "after": {
          "line": 313,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 327,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.taskType !== 'synopsis') {",
      "context": {
        "before": {
          "line": 326,
          "text": "// Grade placeholder - always present to reserve space, prevents resize when grade arrives (pulse mode only)"
        },
        "current": {
          "line": 327,
          "text": "if (this.taskType !== 'synopsis') {"
        },
        "after": {
          "line": 328,
          "text": "const gradePlaceholder = content.createDiv({ cls: 'rt-pulse-grade rt-pulse-grade-placeholder' });"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 394,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "entry.removeClass('rt-status-success', 'rt-status-error', 'rt-grade-a', 'rt-grade-b', 'rt-grade-c', 'rt-synopsis-pending', 'rt-synopsis-complete');",
      "context": {
        "before": {
          "line": 393,
          "text": "// Remove old status classes"
        },
        "current": {
          "line": 394,
          "text": "entry.removeClass('rt-status-success', 'rt-status-error', 'rt-grade-a', 'rt-grade-b', 'rt-grade-c', 'rt-synopsis-pending', 'rt-synopsis-complete');"
        },
        "after": {
          "line": 395,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 407,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Synopsis mode: use checkmark icon instead of grades",
      "context": {
        "before": {
          "line": 406,
          "text": ""
        },
        "current": {
          "line": 407,
          "text": "// Synopsis mode: use checkmark icon instead of grades"
        },
        "after": {
          "line": 408,
          "text": "if (this.taskType === 'synopsis') {"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 408,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.taskType === 'synopsis') {",
      "context": {
        "before": {
          "line": 407,
          "text": "// Synopsis mode: use checkmark icon instead of grades"
        },
        "current": {
          "line": 408,
          "text": "if (this.taskType === 'synopsis') {"
        },
        "after": {
          "line": 409,
          "text": "entry.addClass('rt-synopsis-complete');"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 409,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "entry.addClass('rt-synopsis-complete');",
      "context": {
        "before": {
          "line": 408,
          "text": "if (this.taskType === 'synopsis') {"
        },
        "current": {
          "line": 409,
          "text": "entry.addClass('rt-synopsis-complete');"
        },
        "after": {
          "line": 410,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 499,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Summary & Synopsis controls (only for synopsis/summary mode)",
      "context": {
        "before": {
          "line": 498,
          "text": ""
        },
        "current": {
          "line": 499,
          "text": "// Summary & Synopsis controls (only for synopsis/summary mode)"
        },
        "after": {
          "line": 500,
          "text": "if (this.taskType === 'synopsis') {"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 500,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.taskType === 'synopsis') {",
      "context": {
        "before": {
          "line": 499,
          "text": "// Summary & Synopsis controls (only for synopsis/summary mode)"
        },
        "current": {
          "line": 500,
          "text": "if (this.taskType === 'synopsis') {"
        },
        "after": {
          "line": 501,
          "text": "const controlsCard = contentEl.createDiv({ cls: 'rt-glass-card rt-synopsis-controls' });"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 501,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const controlsCard = contentEl.createDiv({ cls: 'rt-glass-card rt-synopsis-controls' });",
      "context": {
        "before": {
          "line": 500,
          "text": "if (this.taskType === 'synopsis') {"
        },
        "current": {
          "line": 501,
          "text": "const controlsCard = contentEl.createDiv({ cls: 'rt-glass-card rt-synopsis-controls' });"
        },
        "after": {
          "line": 502,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 504,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const targetControl = controlsCard.createDiv({ cls: 'rt-synopsis-control rt-synopsis-control--row' });",
      "context": {
        "before": {
          "line": 503,
          "text": "// Target Summary Length - Two column layout"
        },
        "current": {
          "line": 504,
          "text": "const targetControl = controlsCard.createDiv({ cls: 'rt-synopsis-control rt-synopsis-control--row' });"
        },
        "after": {
          "line": 505,
          "text": "const targetInfo = targetControl.createDiv({ cls: 'rt-synopsis-control-info' });"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 505,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const targetInfo = targetControl.createDiv({ cls: 'rt-synopsis-control-info' });",
      "context": {
        "before": {
          "line": 504,
          "text": "const targetControl = controlsCard.createDiv({ cls: 'rt-synopsis-control rt-synopsis-control--row' });"
        },
        "current": {
          "line": 505,
          "text": "const targetInfo = targetControl.createDiv({ cls: 'rt-synopsis-control-info' });"
        },
        "after": {
          "line": 506,
          "text": "targetInfo.createEl('label', { text: 'Target summary length', cls: 'rt-synopsis-control-label' });"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 506,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "targetInfo.createEl('label', { text: 'Target summary length', cls: 'rt-synopsis-control-label' });",
      "context": {
        "before": {
          "line": 505,
          "text": "const targetInfo = targetControl.createDiv({ cls: 'rt-synopsis-control-info' });"
        },
        "current": {
          "line": 506,
          "text": "targetInfo.createEl('label', { text: 'Target summary length', cls: 'rt-synopsis-control-label' });"
        },
        "after": {
          "line": 507,
          "text": "targetInfo.createDiv({"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 509,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "cls: 'rt-synopsis-control-help'",
      "context": {
        "before": {
          "line": 508,
          "text": "text: 'Target word count for Summary refresh. Each completed scene is written immediately to frontmatter.',"
        },
        "current": {
          "line": 509,
          "text": "cls: 'rt-synopsis-control-help'"
        },
        "after": {
          "line": 510,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 513,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "cls: 'rt-synopsis-control-input',",
      "context": {
        "before": {
          "line": 512,
          "text": "type: 'number',"
        },
        "current": {
          "line": 513,
          "text": "cls: 'rt-synopsis-control-input',"
        },
        "after": {
          "line": 514,
          "text": "attr: { min: '75', max: '500', step: '25' }"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 516,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "targetInput.value = String(this.synopsisTargetWords);",
      "context": {
        "before": {
          "line": 515,
          "text": "}) as HTMLInputElement;"
        },
        "current": {
          "line": 516,
          "text": "targetInput.value = String(this.synopsisTargetWords);"
        },
        "after": {
          "line": 517,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 521,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.synopsisTargetWords = val;",
      "context": {
        "before": {
          "line": 520,
          "text": "if (!isNaN(val) && val >= 75 && val <= 500) {"
        },
        "current": {
          "line": 521,
          "text": "this.synopsisTargetWords = val;"
        },
        "after": {
          "line": 522,
          "text": "this.plugin.settings.synopsisTargetWords = val;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 522,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.plugin.settings.synopsisTargetWords = val;",
      "context": {
        "before": {
          "line": 521,
          "text": "this.synopsisTargetWords = val;"
        },
        "current": {
          "line": 522,
          "text": "this.plugin.settings.synopsisTargetWords = val;"
        },
        "after": {
          "line": 523,
          "text": "this.plugin.saveSettings();"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 538,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "controlsCard.createEl('hr', { cls: 'rt-synopsis-control-divider' });",
      "context": {
        "before": {
          "line": 537,
          "text": "// Horizontal rule separator"
        },
        "current": {
          "line": 538,
          "text": "controlsCard.createEl('hr', { cls: 'rt-synopsis-control-divider' });"
        },
        "after": {
          "line": 539,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 541,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const thresholdControl = controlsCard.createDiv({ cls: 'rt-synopsis-control rt-synopsis-control--row' });",
      "context": {
        "before": {
          "line": 540,
          "text": "// Weak Summary Threshold - Two column layout"
        },
        "current": {
          "line": 541,
          "text": "const thresholdControl = controlsCard.createDiv({ cls: 'rt-synopsis-control rt-synopsis-control--row' });"
        },
        "after": {
          "line": 542,
          "text": "const thresholdInfo = thresholdControl.createDiv({ cls: 'rt-synopsis-control-info' });"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 542,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const thresholdInfo = thresholdControl.createDiv({ cls: 'rt-synopsis-control-info' });",
      "context": {
        "before": {
          "line": 541,
          "text": "const thresholdControl = controlsCard.createDiv({ cls: 'rt-synopsis-control rt-synopsis-control--row' });"
        },
        "current": {
          "line": 542,
          "text": "const thresholdInfo = thresholdControl.createDiv({ cls: 'rt-synopsis-control-info' });"
        },
        "after": {
          "line": 543,
          "text": "thresholdInfo.createEl('label', { text: 'Treat summary as weak if under', cls: 'rt-synopsis-control-label' });"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 543,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "thresholdInfo.createEl('label', { text: 'Treat summary as weak if under', cls: 'rt-synopsis-control-label' });",
      "context": {
        "before": {
          "line": 542,
          "text": "const thresholdInfo = thresholdControl.createDiv({ cls: 'rt-synopsis-control-info' });"
        },
        "current": {
          "line": 543,
          "text": "thresholdInfo.createEl('label', { text: 'Treat summary as weak if under', cls: 'rt-synopsis-control-label' });"
        },
        "after": {
          "line": 544,
          "text": "thresholdInfo.createDiv({"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 546,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "cls: 'rt-synopsis-control-help'",
      "context": {
        "before": {
          "line": 545,
          "text": "text: 'Only used to decide which scenes are selected for update.',"
        },
        "current": {
          "line": 546,
          "text": "cls: 'rt-synopsis-control-help'"
        },
        "after": {
          "line": 547,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 550,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "cls: 'rt-synopsis-control-input',",
      "context": {
        "before": {
          "line": 549,
          "text": "type: 'number',"
        },
        "current": {
          "line": 550,
          "text": "cls: 'rt-synopsis-control-input',"
        },
        "after": {
          "line": 551,
          "text": "attr: { min: '10', max: '300', step: '5' }"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 553,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "thresholdInput.value = String(this.synopsisWeakThreshold);",
      "context": {
        "before": {
          "line": 552,
          "text": "}) as HTMLInputElement;"
        },
        "current": {
          "line": 553,
          "text": "thresholdInput.value = String(this.synopsisWeakThreshold);"
        },
        "after": {
          "line": 554,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 558,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.synopsisWeakThreshold = val;",
      "context": {
        "before": {
          "line": 557,
          "text": "if (!isNaN(val) && val >= 10 && val <= 300) {"
        },
        "current": {
          "line": 558,
          "text": "this.synopsisWeakThreshold = val;"
        },
        "after": {
          "line": 559,
          "text": "this.plugin.settings.synopsisWeakThreshold = val;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 559,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.plugin.settings.synopsisWeakThreshold = val;",
      "context": {
        "before": {
          "line": 558,
          "text": "this.synopsisWeakThreshold = val;"
        },
        "current": {
          "line": 559,
          "text": "this.plugin.settings.synopsisWeakThreshold = val;"
        },
        "after": {
          "line": 560,
          "text": "this.plugin.saveSettings();"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 576,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const warningEl = controlsCard.createDiv({ cls: 'rt-synopsis-threshold-warning' });",
      "context": {
        "before": {
          "line": 575,
          "text": "// Warning for target < threshold"
        },
        "current": {
          "line": 576,
          "text": "const warningEl = controlsCard.createDiv({ cls: 'rt-synopsis-threshold-warning' });"
        },
        "after": {
          "line": 577,
          "text": "this.checkThresholdWarning(warningEl);"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 580,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "controlsCard.createEl('hr', { cls: 'rt-synopsis-control-divider' });",
      "context": {
        "before": {
          "line": 579,
          "text": "// Horizontal rule separator"
        },
        "current": {
          "line": 580,
          "text": "controlsCard.createEl('hr', { cls: 'rt-synopsis-control-divider' });"
        },
        "after": {
          "line": 581,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 582,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Also update Synopsis checkbox",
      "context": {
        "before": {
          "line": 581,
          "text": ""
        },
        "current": {
          "line": 582,
          "text": "// Also update Synopsis checkbox"
        },
        "after": {
          "line": 583,
          "text": "const synopsisControl = controlsCard.createDiv({ cls: 'rt-synopsis-control rt-synopsis-control--row' });"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 583,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisControl = controlsCard.createDiv({ cls: 'rt-synopsis-control rt-synopsis-control--row' });",
      "context": {
        "before": {
          "line": 582,
          "text": "// Also update Synopsis checkbox"
        },
        "current": {
          "line": 583,
          "text": "const synopsisControl = controlsCard.createDiv({ cls: 'rt-synopsis-control rt-synopsis-control--row' });"
        },
        "after": {
          "line": 584,
          "text": "const synopsisWordLimit = getSynopsisGenerationWordLimit(this.plugin.settings);"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 584,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisWordLimit = getSynopsisGenerationWordLimit(this.plugin.settings);",
      "context": {
        "before": {
          "line": 583,
          "text": "const synopsisControl = controlsCard.createDiv({ cls: 'rt-synopsis-control rt-synopsis-control--row' });"
        },
        "current": {
          "line": 584,
          "text": "const synopsisWordLimit = getSynopsisGenerationWordLimit(this.plugin.settings);"
        },
        "after": {
          "line": 585,
          "text": "const synopsisCheckboxId = `rt-synopsis-update-toggle-${Date.now()}`;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 585,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisCheckboxId = `rt-synopsis-update-toggle-${Date.now()}`;",
      "context": {
        "before": {
          "line": 584,
          "text": "const synopsisWordLimit = getSynopsisGenerationWordLimit(this.plugin.settings);"
        },
        "current": {
          "line": 585,
          "text": "const synopsisCheckboxId = `rt-synopsis-update-toggle-${Date.now()}`;"
        },
        "after": {
          "line": 586,
          "text": "const synopsisCheckbox = synopsisControl.createEl('input', {"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 586,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisCheckbox = synopsisControl.createEl('input', {",
      "context": {
        "before": {
          "line": 585,
          "text": "const synopsisCheckboxId = `rt-synopsis-update-toggle-${Date.now()}`;"
        },
        "current": {
          "line": 586,
          "text": "const synopsisCheckbox = synopsisControl.createEl('input', {"
        },
        "after": {
          "line": 587,
          "text": "type: 'checkbox',"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 588,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "cls: 'ert-synopsis-control-checkbox',",
      "context": {
        "before": {
          "line": 587,
          "text": "type: 'checkbox',"
        },
        "current": {
          "line": 588,
          "text": "cls: 'ert-synopsis-control-checkbox',"
        },
        "after": {
          "line": 589,
          "text": "attr: { id: synopsisCheckboxId }"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 589,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "attr: { id: synopsisCheckboxId }",
      "context": {
        "before": {
          "line": 588,
          "text": "cls: 'ert-synopsis-control-checkbox',"
        },
        "current": {
          "line": 589,
          "text": "attr: { id: synopsisCheckboxId }"
        },
        "after": {
          "line": 590,
          "text": "}) as HTMLInputElement;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 591,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisCheckbox.checked = this.plugin.settings.alsoUpdateSynopsis ?? false;",
      "context": {
        "before": {
          "line": 590,
          "text": "}) as HTMLInputElement;"
        },
        "current": {
          "line": 591,
          "text": "synopsisCheckbox.checked = this.plugin.settings.alsoUpdateSynopsis ?? false;"
        },
        "after": {
          "line": 592,
          "text": "const synopsisInfo = synopsisControl.createDiv({ cls: 'rt-synopsis-control-info' });"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 592,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisInfo = synopsisControl.createDiv({ cls: 'rt-synopsis-control-info' });",
      "context": {
        "before": {
          "line": 591,
          "text": "synopsisCheckbox.checked = this.plugin.settings.alsoUpdateSynopsis ?? false;"
        },
        "current": {
          "line": 592,
          "text": "const synopsisInfo = synopsisControl.createDiv({ cls: 'rt-synopsis-control-info' });"
        },
        "after": {
          "line": 593,
          "text": "synopsisInfo.createEl('label', {"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 593,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisInfo.createEl('label', {",
      "context": {
        "before": {
          "line": 592,
          "text": "const synopsisInfo = synopsisControl.createDiv({ cls: 'rt-synopsis-control-info' });"
        },
        "current": {
          "line": 593,
          "text": "synopsisInfo.createEl('label', {"
        },
        "after": {
          "line": 594,
          "text": "text: 'Also update Synopsis',"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 594,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "text: 'Also update Synopsis',",
      "context": {
        "before": {
          "line": 593,
          "text": "synopsisInfo.createEl('label', {"
        },
        "current": {
          "line": 594,
          "text": "text: 'Also update Synopsis',"
        },
        "after": {
          "line": 595,
          "text": "cls: 'rt-synopsis-control-label',"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 595,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "cls: 'rt-synopsis-control-label',",
      "context": {
        "before": {
          "line": 594,
          "text": "text: 'Also update Synopsis',"
        },
        "current": {
          "line": 595,
          "text": "cls: 'rt-synopsis-control-label',"
        },
        "after": {
          "line": 596,
          "text": "attr: { for: synopsisCheckboxId }"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 596,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "attr: { for: synopsisCheckboxId }",
      "context": {
        "before": {
          "line": 595,
          "text": "cls: 'rt-synopsis-control-label',"
        },
        "current": {
          "line": 596,
          "text": "attr: { for: synopsisCheckboxId }"
        },
        "after": {
          "line": 597,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 598,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisInfo.createDiv({",
      "context": {
        "before": {
          "line": 597,
          "text": "});"
        },
        "current": {
          "line": 598,
          "text": "synopsisInfo.createDiv({"
        },
        "after": {
          "line": 599,
          "text": "text: `Also replace Synopsis with a concise version generated from scene content. Current length is ${synopsisWordLimit} words and controlled in Settings  Configuration  Synopsis max words.`,"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 599,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "text: `Also replace Synopsis with a concise version generated from scene content. Current length is ${synopsisWordLimit} words and controlled in Settings  Configuration  Synopsis max words.`,",
      "context": {
        "before": {
          "line": 598,
          "text": "synopsisInfo.createDiv({"
        },
        "current": {
          "line": 599,
          "text": "text: `Also replace Synopsis with a concise version generated from scene content. Current length is ${synopsisWordLimit} words and controlled in Settings  Configuration  Synopsis max words.`,"
        },
        "after": {
          "line": 600,
          "text": "cls: 'rt-synopsis-control-help'"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 600,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "cls: 'rt-synopsis-control-help'",
      "context": {
        "before": {
          "line": 599,
          "text": "text: `Also replace Synopsis with a concise version generated from scene content. Current length is ${synopsisWordLimit} words and controlled in Settings  Configuration  Synopsis max words.`,"
        },
        "current": {
          "line": 600,
          "text": "cls: 'rt-synopsis-control-help'"
        },
        "after": {
          "line": 601,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 603,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisCheckbox.addEventListener('change', () => {",
      "context": {
        "before": {
          "line": 602,
          "text": ""
        },
        "current": {
          "line": 603,
          "text": "synopsisCheckbox.addEventListener('change', () => {"
        },
        "after": {
          "line": 604,
          "text": "this.plugin.settings.alsoUpdateSynopsis = synopsisCheckbox.checked;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 604,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.plugin.settings.alsoUpdateSynopsis = synopsisCheckbox.checked;",
      "context": {
        "before": {
          "line": 603,
          "text": "synopsisCheckbox.addEventListener('change', () => {"
        },
        "current": {
          "line": 604,
          "text": "this.plugin.settings.alsoUpdateSynopsis = synopsisCheckbox.checked;"
        },
        "after": {
          "line": 605,
          "text": "this.plugin.saveSettings();"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 612,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.taskType === 'synopsis') {",
      "context": {
        "before": {
          "line": 611,
          "text": ""
        },
        "current": {
          "line": 612,
          "text": "if (this.taskType === 'synopsis') {"
        },
        "after": {
          "line": 613,
          "text": "this.createModeOption("
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 615,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "'synopsis-flagged',",
      "context": {
        "before": {
          "line": 614,
          "text": "modesSection,"
        },
        "current": {
          "line": 615,
          "text": "'synopsis-flagged',"
        },
        "after": {
          "line": 616,
          "text": "'Selected scenes (Summary Update: yes)',"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 622,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "'synopsis-missing',",
      "context": {
        "before": {
          "line": 621,
          "text": "modesSection,"
        },
        "current": {
          "line": 622,
          "text": "'synopsis-missing',"
        },
        "after": {
          "line": 623,
          "text": "'Missing only',"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 629,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "'synopsis-missing-weak',",
      "context": {
        "before": {
          "line": 628,
          "text": "modesSection,"
        },
        "current": {
          "line": 629,
          "text": "'synopsis-missing-weak',"
        },
        "after": {
          "line": 630,
          "text": "'Missing, weak, or stale (Recommended)',"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 631,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "`Processes scenes with no summary, under ${this.synopsisWeakThreshold} words, or with a Due date newer than last AI update.`,",
      "context": {
        "before": {
          "line": 630,
          "text": "'Missing, weak, or stale (Recommended)',"
        },
        "current": {
          "line": 631,
          "text": "`Processes scenes with no summary, under ${this.synopsisWeakThreshold} words, or with a Due date newer than last AI update.`,"
        },
        "after": {
          "line": 632,
          "text": "true"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 636,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "'synopsis-all',",
      "context": {
        "before": {
          "line": 635,
          "text": "modesSection,"
        },
        "current": {
          "line": 636,
          "text": "'synopsis-all',"
        },
        "after": {
          "line": 637,
          "text": "'Regenerate all (Warning)',"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 680,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.taskType === 'synopsis' ? this.synopsisWeakThreshold : undefined",
      "context": {
        "before": {
          "line": 679,
          "text": "this.selectedMode,"
        },
        "current": {
          "line": 680,
          "text": "this.taskType === 'synopsis' ? this.synopsisWeakThreshold : undefined"
        },
        "after": {
          "line": 681,
          "text": ");"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 726,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.taskType === 'synopsis' ? this.synopsisWeakThreshold : undefined",
      "context": {
        "before": {
          "line": 725,
          "text": "this.selectedMode,"
        },
        "current": {
          "line": 726,
          "text": "this.taskType === 'synopsis' ? this.synopsisWeakThreshold : undefined"
        },
        "after": {
          "line": 727,
          "text": ");"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 752,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Only show purge button for pulse mode (not synopsis)",
      "context": {
        "before": {
          "line": 751,
          "text": ""
        },
        "current": {
          "line": 752,
          "text": "// Only show purge button for pulse mode (not synopsis)"
        },
        "after": {
          "line": 753,
          "text": "if (this.taskType !== 'synopsis') {"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 753,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.taskType !== 'synopsis') {",
      "context": {
        "before": {
          "line": 752,
          "text": "// Only show purge button for pulse mode (not synopsis)"
        },
        "current": {
          "line": 753,
          "text": "if (this.taskType !== 'synopsis') {"
        },
        "after": {
          "line": 754,
          "text": "new ButtonComponent(buttonRow)"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 782,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.synopsisTargetWords < this.synopsisWeakThreshold) {",
      "context": {
        "before": {
          "line": 781,
          "text": "private checkThresholdWarning(warningEl: HTMLElement): void {"
        },
        "current": {
          "line": 782,
          "text": "if (this.synopsisTargetWords < this.synopsisWeakThreshold) {"
        },
        "after": {
          "line": 783,
          "text": "warningEl.textContent = ` Target size (${this.synopsisTargetWords}) is less than weak threshold (${this.synopsisWeakThreshold}). Newly generated summaries may be immediately classified as weak.`;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 783,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "warningEl.textContent = ` Target size (${this.synopsisTargetWords}) is less than weak threshold (${this.synopsisWeakThreshold}). Newly generated summaries may be immediately classified as weak.`;",
      "context": {
        "before": {
          "line": 782,
          "text": "if (this.synopsisTargetWords < this.synopsisWeakThreshold) {"
        },
        "current": {
          "line": 783,
          "text": "warningEl.textContent = ` Target size (${this.synopsisTargetWords}) is less than weak threshold (${this.synopsisWeakThreshold}). Newly generated summaries may be immediately classified as weak.`;"
        },
        "after": {
          "line": 784,
          "text": "warningEl.classList.add('is-visible');"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 840,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.processedSynopsisResults = new Map();",
      "context": {
        "before": {
          "line": 839,
          "text": "this.processedResults = new Map();"
        },
        "current": {
          "line": 840,
          "text": "this.processedSynopsisResults = new Map();"
        },
        "after": {
          "line": 841,
          "text": "this.hasPendingSynopsisResults = false;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 841,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.hasPendingSynopsisResults = false;",
      "context": {
        "before": {
          "line": 840,
          "text": "this.processedSynopsisResults = new Map();"
        },
        "current": {
          "line": 841,
          "text": "this.hasPendingSynopsisResults = false;"
        },
        "after": {
          "line": 842,
          "text": "this.logAttempts = 0;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 854,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.taskType === 'synopsis' ? this.synopsisWeakThreshold : undefined,",
      "context": {
        "before": {
          "line": 853,
          "text": "this.selectedMode,"
        },
        "current": {
          "line": 854,
          "text": "this.taskType === 'synopsis' ? this.synopsisWeakThreshold : undefined,"
        },
        "after": {
          "line": 855,
          "text": "this.taskType === 'synopsis' ? this.synopsisTargetWords : undefined"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 855,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.taskType === 'synopsis' ? this.synopsisTargetWords : undefined",
      "context": {
        "before": {
          "line": 854,
          "text": "this.taskType === 'synopsis' ? this.synopsisWeakThreshold : undefined,"
        },
        "current": {
          "line": 855,
          "text": "this.taskType === 'synopsis' ? this.synopsisTargetWords : undefined"
        },
        "after": {
          "line": 856,
          "text": ");"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 915,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "this.queueNoteEl = rulerBlock.createDiv({ cls: 'rt-pulse-ruler-note' });",
      "context": {
        "before": {
          "line": 914,
          "text": "this.renderQueueItems();"
        },
        "current": {
          "line": 915,
          "text": "this.queueNoteEl = rulerBlock.createDiv({ cls: 'rt-pulse-ruler-note' });"
        },
        "after": {
          "line": 916,
          "text": "if (this.taskType === 'synopsis') {"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 916,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.taskType === 'synopsis') {",
      "context": {
        "before": {
          "line": 915,
          "text": "this.queueNoteEl = rulerBlock.createDiv({ cls: 'rt-pulse-ruler-note' });"
        },
        "current": {
          "line": 916,
          "text": "if (this.taskType === 'synopsis') {"
        },
        "after": {
          "line": 917,
          "text": "this.queueNoteEl.setText('Processing scenes to generate or update summaries based on scene content.');"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 952,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "public setSynopsisPreview(oldSynopsis: string, newSynopsis: string): void {",
      "context": {
        "before": {
          "line": 951,
          "text": ""
        },
        "current": {
          "line": 952,
          "text": "public setSynopsisPreview(oldSynopsis: string, newSynopsis: string): void {"
        },
        "after": {
          "line": 953,
          "text": "if (!this.heroStatusEl) return;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 957,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const previewLine = this.heroStatusEl.createDiv({ cls: 'rt-synopsis-preview-line' });",
      "context": {
        "before": {
          "line": 956,
          "text": "this.heroStatusEl.empty();"
        },
        "current": {
          "line": 957,
          "text": "const previewLine = this.heroStatusEl.createDiv({ cls: 'rt-synopsis-preview-line' });"
        },
        "after": {
          "line": 958,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 960,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "previewLine.createSpan({ cls: 'rt-synopsis-preview-label', text: 'Previous Summary: ' });",
      "context": {
        "before": {
          "line": 959,
          "text": "// \"Previous Summary:\" label inline"
        },
        "current": {
          "line": 960,
          "text": "previewLine.createSpan({ cls: 'rt-synopsis-preview-label', text: 'Previous Summary: ' });"
        },
        "after": {
          "line": 961,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 963,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (newSynopsis !== 'Generating...') {",
      "context": {
        "before": {
          "line": 962,
          "text": "// Old summary in italics (only show if there's a new summary, not during \"Generating...\")"
        },
        "current": {
          "line": 963,
          "text": "if (newSynopsis !== 'Generating...') {"
        },
        "after": {
          "line": 964,
          "text": "const oldText = previewLine.createSpan({ cls: 'rt-synopsis-preview-old' });"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 964,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const oldText = previewLine.createSpan({ cls: 'rt-synopsis-preview-old' });",
      "context": {
        "before": {
          "line": 963,
          "text": "if (newSynopsis !== 'Generating...') {"
        },
        "current": {
          "line": 964,
          "text": "const oldText = previewLine.createSpan({ cls: 'rt-synopsis-preview-old' });"
        },
        "after": {
          "line": 965,
          "text": "oldText.setText(oldSynopsis || '(No summary)');"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 965,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "oldText.setText(oldSynopsis || '(No summary)');",
      "context": {
        "before": {
          "line": 964,
          "text": "const oldText = previewLine.createSpan({ cls: 'rt-synopsis-preview-old' });"
        },
        "current": {
          "line": 965,
          "text": "oldText.setText(oldSynopsis || '(No summary)');"
        },
        "after": {
          "line": 966,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 970,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Store summary (and optional synopsis) results for the apply phase.",
      "context": {
        "before": {
          "line": 969,
          "text": "/**"
        },
        "current": {
          "line": 970,
          "text": "* Store summary (and optional synopsis) results for the apply phase."
        },
        "after": {
          "line": 971,
          "text": "* Called from SynopsisCommands when processing completes."
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 971,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Called from SynopsisCommands when processing completes.",
      "context": {
        "before": {
          "line": 970,
          "text": "* Store summary (and optional synopsis) results for the apply phase."
        },
        "current": {
          "line": 971,
          "text": "* Called from SynopsisCommands when processing completes."
        },
        "after": {
          "line": 972,
          "text": "* The modal will show Apply/Discard in the completion summary."
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 974,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "public setSynopsisResults(summaryResults: Map<string, string>, synopsisResults?: Map<string, string>): void {",
      "context": {
        "before": {
          "line": 973,
          "text": "*/"
        },
        "current": {
          "line": 974,
          "text": "public setSynopsisResults(summaryResults: Map<string, string>, synopsisResults?: Map<string, string>): void {"
        },
        "after": {
          "line": 975,
          "text": "this.processedResults = summaryResults;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 976,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.processedSynopsisResults = synopsisResults ?? new Map();",
      "context": {
        "before": {
          "line": 975,
          "text": "this.processedResults = summaryResults;"
        },
        "current": {
          "line": 976,
          "text": "this.processedSynopsisResults = synopsisResults ?? new Map();"
        },
        "after": {
          "line": 977,
          "text": "this.hasPendingSynopsisResults = summaryResults.size > 0;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 977,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "this.hasPendingSynopsisResults = summaryResults.size > 0;",
      "context": {
        "before": {
          "line": 976,
          "text": "this.processedSynopsisResults = synopsisResults ?? new Map();"
        },
        "current": {
          "line": 977,
          "text": "this.hasPendingSynopsisResults = summaryResults.size > 0;"
        },
        "after": {
          "line": 978,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 981,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "* @deprecated Use setSynopsisResults instead - this clears the scene queue which disrupts UX",
      "context": {
        "before": {
          "line": 980,
          "text": "/**"
        },
        "current": {
          "line": 981,
          "text": "* @deprecated Use setSynopsisResults instead - this clears the scene queue which disrupts UX"
        },
        "after": {
          "line": 982,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 981,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* @deprecated Use setSynopsisResults instead - this clears the scene queue which disrupts UX",
      "context": {
        "before": {
          "line": 980,
          "text": "/**"
        },
        "current": {
          "line": 981,
          "text": "* @deprecated Use setSynopsisResults instead - this clears the scene queue which disrupts UX"
        },
        "after": {
          "line": 982,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1016,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const { processedResults, processedSynopsisResults } = this;",
      "context": {
        "before": {
          "line": 1015,
          "text": "private async applyChanges(): Promise<void> {"
        },
        "current": {
          "line": 1016,
          "text": "const { processedResults, processedSynopsisResults } = this;"
        },
        "after": {
          "line": 1017,
          "text": "if (processedResults.size === 0) return;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1019,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const hasSynopsis = processedSynopsisResults.size > 0;",
      "context": {
        "before": {
          "line": 1018,
          "text": ""
        },
        "current": {
          "line": 1019,
          "text": "const hasSynopsis = processedSynopsisResults.size > 0;"
        },
        "after": {
          "line": 1020,
          "text": "const label = hasSynopsis ? 'summary & synopsis' : 'summary';"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1020,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const label = hasSynopsis ? 'summary & synopsis' : 'summary';",
      "context": {
        "before": {
          "line": 1019,
          "text": "const hasSynopsis = processedSynopsisResults.size > 0;"
        },
        "current": {
          "line": 1020,
          "text": "const label = hasSynopsis ? 'summary & synopsis' : 'summary';"
        },
        "after": {
          "line": 1021,
          "text": "const note = new Notice(`Applying ${processedResults.size} ${label} updates...`, 0);"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1021,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const note = new Notice(`Applying ${processedResults.size} ${label} updates...`, 0);",
      "context": {
        "before": {
          "line": 1020,
          "text": "const label = hasSynopsis ? 'summary & synopsis' : 'summary';"
        },
        "current": {
          "line": 1021,
          "text": "const note = new Notice(`Applying ${processedResults.size} ${label} updates...`, 0);"
        },
        "after": {
          "line": 1022,
          "text": "let updated = 0;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1061,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Write Synopsis if also generated",
      "context": {
        "before": {
          "line": 1060,
          "text": ""
        },
        "current": {
          "line": 1061,
          "text": "// Write Synopsis if also generated"
        },
        "after": {
          "line": 1062,
          "text": "const newSynopsis = processedSynopsisResults.get(path);"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1062,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const newSynopsis = processedSynopsisResults.get(path);",
      "context": {
        "before": {
          "line": 1061,
          "text": "// Write Synopsis if also generated"
        },
        "current": {
          "line": 1062,
          "text": "const newSynopsis = processedSynopsisResults.get(path);"
        },
        "after": {
          "line": 1063,
          "text": "if (newSynopsis) {"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1063,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (newSynopsis) {",
      "context": {
        "before": {
          "line": 1062,
          "text": "const newSynopsis = processedSynopsisResults.get(path);"
        },
        "current": {
          "line": 1063,
          "text": "if (newSynopsis) {"
        },
        "after": {
          "line": 1064,
          "text": "fm['Synopsis'] = newSynopsis;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1064,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "fm['Synopsis'] = newSynopsis;",
      "context": {
        "before": {
          "line": 1063,
          "text": "if (newSynopsis) {"
        },
        "current": {
          "line": 1064,
          "text": "fm['Synopsis'] = newSynopsis;"
        },
        "after": {
          "line": 1065,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1067,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Replace Summary Update / legacy Synopsis Update flag with timestamp",
      "context": {
        "before": {
          "line": 1066,
          "text": ""
        },
        "current": {
          "line": 1067,
          "text": "// Replace Summary Update / legacy Synopsis Update flag with timestamp"
        },
        "after": {
          "line": 1068,
          "text": "const summaryUpdateKeys = ['Summary Update', 'SummaryUpdate', 'summaryupdate'];"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1069,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const legacyKeys = ['Synopsis Update', 'SynopsisUpdate', 'synopsisupdate'];",
      "context": {
        "before": {
          "line": 1068,
          "text": "const summaryUpdateKeys = ['Summary Update', 'SummaryUpdate', 'summaryupdate'];"
        },
        "current": {
          "line": 1069,
          "text": "const legacyKeys = ['Synopsis Update', 'SynopsisUpdate', 'synopsisupdate'];"
        },
        "after": {
          "line": 1070,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1082,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Fall back to legacy Synopsis Update keys (migrate to Summary Update)",
      "context": {
        "before": {
          "line": 1081,
          "text": ""
        },
        "current": {
          "line": 1082,
          "text": "// Fall back to legacy Synopsis Update keys (migrate to Summary Update)"
        },
        "after": {
          "line": 1083,
          "text": "if (!updatedFlag) {"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1103,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (processedSynopsisResults.has(path)) {",
      "context": {
        "before": {
          "line": 1102,
          "text": "sceneTimestamps.summaryUpdated = isoNow;"
        },
        "current": {
          "line": 1103,
          "text": "if (processedSynopsisResults.has(path)) {"
        },
        "after": {
          "line": 1104,
          "text": "sceneTimestamps.synopsisUpdated = isoNow;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1104,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "sceneTimestamps.synopsisUpdated = isoNow;",
      "context": {
        "before": {
          "line": 1103,
          "text": "if (processedSynopsisResults.has(path)) {"
        },
        "current": {
          "line": 1104,
          "text": "sceneTimestamps.synopsisUpdated = isoNow;"
        },
        "after": {
          "line": 1105,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1120,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "note.hide();",
      "context": {
        "before": {
          "line": 1119,
          "text": "} finally {"
        },
        "current": {
          "line": 1120,
          "text": "note.hide();"
        },
        "after": {
          "line": 1121,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1156,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.heroStatusEl && this.taskType !== 'synopsis') {",
      "context": {
        "before": {
          "line": 1155,
          "text": ""
        },
        "current": {
          "line": 1156,
          "text": "if (this.heroStatusEl && this.taskType !== 'synopsis') {"
        },
        "after": {
          "line": 1157,
          "text": "this.heroStatusEl.setText(`Processing ${sceneName}`);"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1471,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Only show log message for pulse analysis (synopsis doesn't write detailed logs)",
      "context": {
        "before": {
          "line": 1470,
          "text": ""
        },
        "current": {
          "line": 1471,
          "text": "// Only show log message for pulse analysis (synopsis doesn't write detailed logs)"
        },
        "after": {
          "line": 1472,
          "text": "if (this.plugin.settings.logApiInteractions && this.taskType !== 'synopsis') {"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1472,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.plugin.settings.logApiInteractions && this.taskType !== 'synopsis') {",
      "context": {
        "before": {
          "line": 1471,
          "text": "// Only show log message for pulse analysis (synopsis doesn't write detailed logs)"
        },
        "current": {
          "line": 1472,
          "text": "if (this.plugin.settings.logApiInteractions && this.taskType !== 'synopsis') {"
        },
        "after": {
          "line": 1473,
          "text": "const logNoteEl = contentEl.createDiv({ cls: 'rt-pulse-summary-tip' });"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1493,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Synopsis mode with pending results: show Apply/Discard buttons",
      "context": {
        "before": {
          "line": 1492,
          "text": ""
        },
        "current": {
          "line": 1493,
          "text": "// Synopsis mode with pending results: show Apply/Discard buttons"
        },
        "after": {
          "line": 1494,
          "text": "if (this.taskType === 'synopsis' && this.hasPendingSynopsisResults && this.processedResults.size > 0) {"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1494,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (this.taskType === 'synopsis' && this.hasPendingSynopsisResults && this.processedResults.size > 0) {",
      "context": {
        "before": {
          "line": 1493,
          "text": "// Synopsis mode with pending results: show Apply/Discard buttons"
        },
        "current": {
          "line": 1494,
          "text": "if (this.taskType === 'synopsis' && this.hasPendingSynopsisResults && this.processedResults.size > 0) {"
        },
        "after": {
          "line": 1495,
          "text": "// Add synopsis apply confirmation card above the buttons"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1495,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Add synopsis apply confirmation card above the buttons",
      "context": {
        "before": {
          "line": 1494,
          "text": "if (this.taskType === 'synopsis' && this.hasPendingSynopsisResults && this.processedResults.size > 0) {"
        },
        "current": {
          "line": 1495,
          "text": "// Add synopsis apply confirmation card above the buttons"
        },
        "after": {
          "line": 1496,
          "text": "contentEl.querySelectorAll('.rt-synopsis-apply-card').forEach(el => el.remove());"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1496,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "contentEl.querySelectorAll('.rt-synopsis-apply-card').forEach(el => el.remove());",
      "context": {
        "before": {
          "line": 1495,
          "text": "// Add synopsis apply confirmation card above the buttons"
        },
        "current": {
          "line": 1496,
          "text": "contentEl.querySelectorAll('.rt-synopsis-apply-card').forEach(el => el.remove());"
        },
        "after": {
          "line": 1497,
          "text": "const applyCard = contentEl.createDiv({ cls: 'rt-glass-card rt-synopsis-apply-card' });"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1497,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const applyCard = contentEl.createDiv({ cls: 'rt-glass-card rt-synopsis-apply-card' });",
      "context": {
        "before": {
          "line": 1496,
          "text": "contentEl.querySelectorAll('.rt-synopsis-apply-card').forEach(el => el.remove());"
        },
        "current": {
          "line": 1497,
          "text": "const applyCard = contentEl.createDiv({ cls: 'rt-glass-card rt-synopsis-apply-card' });"
        },
        "after": {
          "line": 1498,
          "text": "const hasSynopsisToo = this.processedSynopsisResults.size > 0;"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1498,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const hasSynopsisToo = this.processedSynopsisResults.size > 0;",
      "context": {
        "before": {
          "line": 1497,
          "text": "const applyCard = contentEl.createDiv({ cls: 'rt-glass-card rt-synopsis-apply-card' });"
        },
        "current": {
          "line": 1498,
          "text": "const hasSynopsisToo = this.processedSynopsisResults.size > 0;"
        },
        "after": {
          "line": 1499,
          "text": "const artifactLabel = hasSynopsisToo ? 'summaries and synopses' : 'summaries';"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1499,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const artifactLabel = hasSynopsisToo ? 'summaries and synopses' : 'summaries';",
      "context": {
        "before": {
          "line": 1498,
          "text": "const hasSynopsisToo = this.processedSynopsisResults.size > 0;"
        },
        "current": {
          "line": 1499,
          "text": "const artifactLabel = hasSynopsisToo ? 'summaries and synopses' : 'summaries';"
        },
        "after": {
          "line": 1500,
          "text": "applyCard.createDiv({"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1502,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "text: hasSynopsisToo",
      "context": {
        "before": {
          "line": 1501,
          "text": "cls: 'rt-apply-message',"
        },
        "current": {
          "line": 1502,
          "text": "text: hasSynopsisToo"
        },
        "after": {
          "line": 1503,
          "text": "? `Processing complete. ${this.processedResults.size} scenes have new ${artifactLabel} ready to apply, and applying will replace existing Summary and Synopsis values in frontmatter.`"
        }
      }
    },
    {
      "filePath": "src/modals/SceneAnalysisProcessingModal.ts",
      "line": 1503,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "? `Processing complete. ${this.processedResults.size} scenes have new ${artifactLabel} ready to apply, and applying will replace existing Summary and Synopsis values in frontmatter.`",
      "context": {
        "before": {
          "line": 1502,
          "text": "text: hasSynopsisToo"
        },
        "current": {
          "line": 1503,
          "text": "? `Processing complete. ${this.processedResults.size} scenes have new ${artifactLabel} ready to apply, and applying will replace existing Summary and Synopsis values in frontmatter.`"
        },
        "after": {
          "line": 1504,
          "text": ": `Processing complete. ${this.processedResults.size} scenes have new ${artifactLabel} ready to apply, and applying will replace existing Summary values in frontmatter.`"
        }
      }
    },
    {
      "filePath": "src/modals/ZeroDraftModal.ts",
      "line": 102,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "header.createDiv({ cls: 'ert-modal-subtitle', text: 'Enter Pending Edits below, or click Override to open the note directly.' });",
      "context": {
        "before": {
          "line": 101,
          "text": "header.createDiv({ cls: 'ert-modal-title', text: this.titleText });"
        },
        "current": {
          "line": 102,
          "text": "header.createDiv({ cls: 'ert-modal-subtitle', text: 'Enter Pending Edits below, or click Override to open the note directly.' });"
        },
        "after": {
          "line": 103,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/modals/ZeroDraftModal.ts",
      "line": 104,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Info note",
      "context": {
        "before": {
          "line": 103,
          "text": ""
        },
        "current": {
          "line": 104,
          "text": "// Info note"
        },
        "after": {
          "line": 105,
          "text": "const infoEl = contentEl.createDiv({ cls: 'ert-field-note' });"
        }
      }
    },
    {
      "filePath": "src/modals/ZeroDraftModal.ts",
      "line": 105,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const infoEl = contentEl.createDiv({ cls: 'ert-field-note' });",
      "context": {
        "before": {
          "line": 104,
          "text": "// Info note"
        },
        "current": {
          "line": 105,
          "text": "const infoEl = contentEl.createDiv({ cls: 'ert-field-note' });"
        },
        "after": {
          "line": 106,
          "text": "infoEl.setText('Zero draft mode is enabled. This scene has Publish Stage = Zero and Status = Complete. You can turn this off in Settings  Zero draft mode.');"
        }
      }
    },
    {
      "filePath": "src/modals/ZeroDraftModal.ts",
      "line": 157,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Open note without saving",
      "context": {
        "before": {
          "line": 156,
          "text": "}"
        },
        "current": {
          "line": 157,
          "text": "// Open note without saving"
        },
        "after": {
          "line": 158,
          "text": "this.onOverride();"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 84,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "import { classifySynopsis, type SynopsisQuality } from '../sceneAnalysis/synopsisQuality';",
      "context": {
        "before": {
          "line": 83,
          "text": "import { splitIntoBalancedLinesOptimal } from '../utils/text';"
        },
        "current": {
          "line": 84,
          "text": "import { classifySynopsis, type SynopsisQuality } from '../sceneAnalysis/synopsisQuality';"
        },
        "after": {
          "line": 85,
          "text": "import { readSceneId } from '../utils/sceneIds';"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 100,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const INQUIRY_SYNOPSIS_CAPABLE_CLASSES = new Set(['scene', 'outline']);",
      "context": {
        "before": {
          "line": 99,
          "text": "const VIEWBOX_SIZE = 1600;"
        },
        "current": {
          "line": 100,
          "text": "const INQUIRY_SYNOPSIS_CAPABLE_CLASSES = new Set(['scene', 'outline']);"
        },
        "after": {
          "line": 101,
          "text": "const INQUIRY_CONTEXT_CLASSES = new Set(['character', 'place', 'power']);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 242,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "sceneNotes: Array<{ label: string; note: string; anchorId?: string }>;",
      "context": {
        "before": {
          "line": 241,
          "text": "}>;"
        },
        "current": {
          "line": 242,
          "text": "sceneNotes: Array<{ label: string; note: string; anchorId?: string }>;"
        },
        "after": {
          "line": 243,
          "text": "pendingActions: string[];"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 439,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const resumeNote = this.configPanel.createDiv({ cls: 'ert-omnibus-resume-note' });",
      "context": {
        "before": {
          "line": 438,
          "text": "if (prior) {"
        },
        "current": {
          "line": 439,
          "text": "const resumeNote = this.configPanel.createDiv({ cls: 'ert-omnibus-resume-note' });"
        },
        "after": {
          "line": 440,
          "text": "resumeNote.setText(`Last run stopped after question ${prior.completedQuestionIds.length} of ${prior.totalQuestions}.`);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 442,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const configNote = resumeNote.createDiv({ cls: 'ert-field-note' });",
      "context": {
        "before": {
          "line": 441,
          "text": "if (this.options.resumeUnavailableReason) {"
        },
        "current": {
          "line": 442,
          "text": "const configNote = resumeNote.createDiv({ cls: 'ert-field-note' });"
        },
        "after": {
          "line": 443,
          "text": "configNote.setText(`Resume unavailable: ${this.options.resumeUnavailableReason}`);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 492,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "indexRow.createSpan({ text: 'Index note' });",
      "context": {
        "before": {
          "line": 491,
          "text": "});"
        },
        "current": {
          "line": 492,
          "text": "indexRow.createSpan({ text: 'Index note' });"
        },
        "after": {
          "line": 493,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 559,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const reason = this.configPanel.createDiv({ cls: 'ert-field-note' });",
      "context": {
        "before": {
          "line": 558,
          "text": "if (this.runDisabledReason) {"
        },
        "current": {
          "line": 559,
          "text": "const reason = this.configPanel.createDiv({ cls: 'ert-field-note' });"
        },
        "after": {
          "line": 560,
          "text": "reason.setText(`Run disabled: ${this.runDisabledReason}`);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 567,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const volumeLine = this.configPanel.createDiv({ cls: 'ert-field-note' });",
      "context": {
        "before": {
          "line": 566,
          "text": "const logsDisabledNote = this.options.logsEnabled ? '' : ' Logs are disabled in settings.';"
        },
        "current": {
          "line": 567,
          "text": "const volumeLine = this.configPanel.createDiv({ cls: 'ert-field-note' });"
        },
        "after": {
          "line": 568,
          "text": "volumeLine.setText(`This will generate ${totalQuestions} Inquiry ${briefLabel} and ${totalQuestions} ${logLabel}.${logsDisabledNote}`);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 621,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "this.progressMicroEl = this.progressEl.createDiv({ cls: 'ert-omnibus-progress-micro ert-field-note' });",
      "context": {
        "before": {
          "line": 620,
          "text": "this.progressTextEl.setText('Preparing...');"
        },
        "current": {
          "line": 621,
          "text": "this.progressMicroEl = this.progressEl.createDiv({ cls: 'ert-omnibus-progress-micro ert-field-note' });"
        },
        "after": {
          "line": 622,
          "text": "const advancedDetails = this.progressEl.createEl('details', { cls: 'ert-ai-advanced-details' });"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 739,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "sceneSynopsisUsed: number;",
      "context": {
        "before": {
          "line": 738,
          "text": "sceneTotal: number;"
        },
        "current": {
          "line": 739,
          "text": "sceneSynopsisUsed: number;"
        },
        "after": {
          "line": 740,
          "text": "sceneSynopsisAvailable: number;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 740,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "sceneSynopsisAvailable: number;",
      "context": {
        "before": {
          "line": 739,
          "text": "sceneSynopsisUsed: number;"
        },
        "current": {
          "line": 740,
          "text": "sceneSynopsisAvailable: number;"
        },
        "after": {
          "line": 741,
          "text": "sceneFullTextCount: number;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 803,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisWords: number;",
      "context": {
        "before": {
          "line": 802,
          "text": "bodyWords: number;"
        },
        "current": {
          "line": 803,
          "text": "synopsisWords: number;"
        },
        "after": {
          "line": 804,
          "text": "synopsisQuality: SynopsisQuality;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 804,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisQuality: SynopsisQuality;",
      "context": {
        "before": {
          "line": 803,
          "text": "synopsisWords: number;"
        },
        "current": {
          "line": 804,
          "text": "synopsisQuality: SynopsisQuality;"
        },
        "after": {
          "line": 805,
          "text": "status?: 'todo' | 'working' | 'complete';"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 805,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "status?: 'todo' | 'working' | 'complete';",
      "context": {
        "before": {
          "line": 804,
          "text": "synopsisQuality: SynopsisQuality;"
        },
        "current": {
          "line": 805,
          "text": "status?: 'todo' | 'working' | 'complete';"
        },
        "after": {
          "line": 806,
          "text": "title?: string;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 1005,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisWords: number;",
      "context": {
        "before": {
          "line": 1004,
          "text": "bodyWords: number;"
        },
        "current": {
          "line": 1005,
          "text": "synopsisWords: number;"
        },
        "after": {
          "line": 1006,
          "text": "synopsisQuality: SynopsisQuality;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 1006,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisQuality: SynopsisQuality;",
      "context": {
        "before": {
          "line": 1005,
          "text": "synopsisWords: number;"
        },
        "current": {
          "line": 1006,
          "text": "synopsisQuality: SynopsisQuality;"
        },
        "after": {
          "line": 1007,
          "text": "status?: 'todo' | 'working' | 'complete';"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 1007,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "status?: 'todo' | 'working' | 'complete';",
      "context": {
        "before": {
          "line": 1006,
          "text": "synopsisQuality: SynopsisQuality;"
        },
        "current": {
          "line": 1007,
          "text": "status?: 'todo' | 'working' | 'complete';"
        },
        "after": {
          "line": 1008,
          "text": "title?: string;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 1405,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'ert-inquiry-briefing-note',",
      "context": {
        "before": {
          "line": 1404,
          "text": "this.briefingFooterEl.createDiv({"
        },
        "current": {
          "line": 1405,
          "text": "cls: 'ert-inquiry-briefing-note',"
        },
        "after": {
          "line": 1406,
          "text": "text: 'Does not delete briefs.'"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 1452,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "cls: 'ert-inquiry-engine-guard-note'",
      "context": {
        "before": {
          "line": 1451,
          "text": "this.enginePanelGuardNoteEl = this.enginePanelGuardEl.createDiv({"
        },
        "current": {
          "line": 1452,
          "text": "cls: 'ert-inquiry-engine-guard-note'"
        },
        "after": {
          "line": 1453,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 1467,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "panel.createDiv({ cls: 'ert-inquiry-engine-note', text: 'Updates Settings > AI.' });",
      "context": {
        "before": {
          "line": 1466,
          "text": "this.enginePanelListEl = panel.createDiv({ cls: 'ert-inquiry-engine-list' });"
        },
        "current": {
          "line": 1467,
          "text": "panel.createDiv({ cls: 'ert-inquiry-engine-note', text: 'Updates Settings > AI.' });"
        },
        "after": {
          "line": 1468,
          "text": "this.registerDomEvent(panel, 'pointerenter', () => this.cancelEnginePanelHide());"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 1946,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": ": stats.sceneSynopsisUsed > 0",
      "context": {
        "before": {
          "line": 1945,
          "text": "? 'Bodies'"
        },
        "current": {
          "line": 1946,
          "text": ": stats.sceneSynopsisUsed > 0"
        },
        "after": {
          "line": 1947,
          "text": "? 'Summaries'"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 2054,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isSynopsisCapable = entry.class === 'scene' || entry.class === 'outline';",
      "context": {
        "before": {
          "line": 2053,
          "text": "const summaryChars = manifest.entries.reduce((sum, entry) => {"
        },
        "current": {
          "line": 2054,
          "text": "const isSynopsisCapable = entry.class === 'scene' || entry.class === 'outline';"
        },
        "after": {
          "line": 2055,
          "text": "if (!isSynopsisCapable) {"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 2055,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!isSynopsisCapable) {",
      "context": {
        "before": {
          "line": 2054,
          "text": "const isSynopsisCapable = entry.class === 'scene' || entry.class === 'outline';"
        },
        "current": {
          "line": 2055,
          "text": "if (!isSynopsisCapable) {"
        },
        "after": {
          "line": 2056,
          "text": "return sum + this.getEntryContentLength(entry);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 4559,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "this.balanceTooltipText('Click notes to adjust scope. Shift-click to open note.'),",
      "context": {
        "before": {
          "line": 4558,
          "text": "this.ccLabelHint,"
        },
        "current": {
          "line": 4559,
          "text": "this.balanceTooltipText('Click notes to adjust scope. Shift-click to open note.'),"
        },
        "after": {
          "line": 4560,
          "text": "'top'"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 4854,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!this.isSynopsisCapableClass(baseClass)) {",
      "context": {
        "before": {
          "line": 4853,
          "text": "}"
        },
        "current": {
          "line": 4854,
          "text": "if (!this.isSynopsisCapableClass(baseClass)) {"
        },
        "after": {
          "line": 4855,
          "text": "return this.normalizeContributionMode(config.referenceScope, baseClass);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 4917,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisKeys = groupKeys.filter(key => this.isSynopsisCapableClass(this.getCorpusGroupBaseClass(key)));",
      "context": {
        "before": {
          "line": 4916,
          "text": ""
        },
        "current": {
          "line": 4917,
          "text": "const synopsisKeys = groupKeys.filter(key => this.isSynopsisCapableClass(this.getCorpusGroupBaseClass(key)));"
        },
        "after": {
          "line": 4918,
          "text": "const nonSynopsisKeys = groupKeys.filter(key => !this.isSynopsisCapableClass(this.getCorpusGroupBaseClass(key)));"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 4918,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const nonSynopsisKeys = groupKeys.filter(key => !this.isSynopsisCapableClass(this.getCorpusGroupBaseClass(key)));",
      "context": {
        "before": {
          "line": 4917,
          "text": "const synopsisKeys = groupKeys.filter(key => this.isSynopsisCapableClass(this.getCorpusGroupBaseClass(key)));"
        },
        "current": {
          "line": 4918,
          "text": "const nonSynopsisKeys = groupKeys.filter(key => !this.isSynopsisCapableClass(this.getCorpusGroupBaseClass(key)));"
        },
        "after": {
          "line": 4919,
          "text": "const synopsisAllSummary = synopsisKeys.length > 0"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 4919,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisAllSummary = synopsisKeys.length > 0",
      "context": {
        "before": {
          "line": 4918,
          "text": "const nonSynopsisKeys = groupKeys.filter(key => !this.isSynopsisCapableClass(this.getCorpusGroupBaseClass(key)));"
        },
        "current": {
          "line": 4919,
          "text": "const synopsisAllSummary = synopsisKeys.length > 0"
        },
        "after": {
          "line": 4920,
          "text": "&& synopsisKeys.every(key => this.getCorpusGroupEffectiveMode(key, configMap) === 'summary');"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 4920,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "&& synopsisKeys.every(key => this.getCorpusGroupEffectiveMode(key, configMap) === 'summary');",
      "context": {
        "before": {
          "line": 4919,
          "text": "const synopsisAllSummary = synopsisKeys.length > 0"
        },
        "current": {
          "line": 4920,
          "text": "&& synopsisKeys.every(key => this.getCorpusGroupEffectiveMode(key, configMap) === 'summary');"
        },
        "after": {
          "line": 4921,
          "text": "const nonSynopsisAllFull = nonSynopsisKeys.length === 0"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 4921,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const nonSynopsisAllFull = nonSynopsisKeys.length === 0",
      "context": {
        "before": {
          "line": 4920,
          "text": "&& synopsisKeys.every(key => this.getCorpusGroupEffectiveMode(key, configMap) === 'summary');"
        },
        "current": {
          "line": 4921,
          "text": "const nonSynopsisAllFull = nonSynopsisKeys.length === 0"
        },
        "after": {
          "line": 4922,
          "text": "|| nonSynopsisKeys.every(key => this.getCorpusGroupEffectiveMode(key, configMap) === 'full');"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 4922,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "|| nonSynopsisKeys.every(key => this.getCorpusGroupEffectiveMode(key, configMap) === 'full');",
      "context": {
        "before": {
          "line": 4921,
          "text": "const nonSynopsisAllFull = nonSynopsisKeys.length === 0"
        },
        "current": {
          "line": 4922,
          "text": "|| nonSynopsisKeys.every(key => this.getCorpusGroupEffectiveMode(key, configMap) === 'full');"
        },
        "after": {
          "line": 4923,
          "text": "if (synopsisAllSummary && nonSynopsisAllFull) return 'summary';"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 4923,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (synopsisAllSummary && nonSynopsisAllFull) return 'summary';",
      "context": {
        "before": {
          "line": 4922,
          "text": "|| nonSynopsisKeys.every(key => this.getCorpusGroupEffectiveMode(key, configMap) === 'full');"
        },
        "current": {
          "line": 4923,
          "text": "if (synopsisAllSummary && nonSynopsisAllFull) return 'summary';"
        },
        "after": {
          "line": 4924,
          "text": "return 'mixed';"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5376,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isSynopsis = mode === 'summary';",
      "context": {
        "before": {
          "line": 5375,
          "text": "const mode = entry.mode ?? 'none';"
        },
        "current": {
          "line": 5376,
          "text": "const isSynopsis = mode === 'summary';"
        },
        "after": {
          "line": 5377,
          "text": "const wordCount = isSynopsis ? stats.synopsisWords : stats.bodyWords;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5377,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const wordCount = isSynopsis ? stats.synopsisWords : stats.bodyWords;",
      "context": {
        "before": {
          "line": 5376,
          "text": "const isSynopsis = mode === 'summary';"
        },
        "current": {
          "line": 5377,
          "text": "const wordCount = isSynopsis ? stats.synopsisWords : stats.bodyWords;"
        },
        "after": {
          "line": 5378,
          "text": "const tier = isSynopsis"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5378,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const tier = isSynopsis",
      "context": {
        "before": {
          "line": 5377,
          "text": "const wordCount = isSynopsis ? stats.synopsisWords : stats.bodyWords;"
        },
        "current": {
          "line": 5378,
          "text": "const tier = isSynopsis"
        },
        "after": {
          "line": 5379,
          "text": "? this.getCorpusSynopsisTier(stats.synopsisQuality, wordCount, thresholds)"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5379,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "? this.getCorpusSynopsisTier(stats.synopsisQuality, wordCount, thresholds)",
      "context": {
        "before": {
          "line": 5378,
          "text": "const tier = isSynopsis"
        },
        "current": {
          "line": 5379,
          "text": "? this.getCorpusSynopsisTier(stats.synopsisQuality, wordCount, thresholds)"
        },
        "after": {
          "line": 5380,
          "text": ": this.getCorpusTier(wordCount, thresholds);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5397,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "'is-status-todo',",
      "context": {
        "before": {
          "line": 5396,
          "text": "'is-mode-full',"
        },
        "current": {
          "line": 5397,
          "text": "'is-status-todo',"
        },
        "after": {
          "line": 5398,
          "text": "'is-status-working',"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5416,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const lowSubstance = isSynopsis",
      "context": {
        "before": {
          "line": 5415,
          "text": "const highlightMismatch = this.plugin.settings.inquiryCorpusHighlightLowSubstanceComplete ?? true;"
        },
        "current": {
          "line": 5416,
          "text": "const lowSubstance = isSynopsis"
        },
        "after": {
          "line": 5417,
          "text": "? stats.synopsisQuality !== 'ok'"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5417,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "? stats.synopsisQuality !== 'ok'",
      "context": {
        "before": {
          "line": 5416,
          "text": "const lowSubstance = isSynopsis"
        },
        "current": {
          "line": 5417,
          "text": "? stats.synopsisQuality !== 'ok'"
        },
        "after": {
          "line": 5418,
          "text": ": wordCount < thresholds.sketchyMin;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5465,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private getCorpusSynopsisTier(",
      "context": {
        "before": {
          "line": 5464,
          "text": ""
        },
        "current": {
          "line": 5465,
          "text": "private getCorpusSynopsisTier("
        },
        "after": {
          "line": 5466,
          "text": "quality: SynopsisQuality,"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5466,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "quality: SynopsisQuality,",
      "context": {
        "before": {
          "line": 5465,
          "text": "private getCorpusSynopsisTier("
        },
        "current": {
          "line": 5466,
          "text": "quality: SynopsisQuality,"
        },
        "after": {
          "line": 5467,
          "text": "wordCount: number,"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5485,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return { bodyWords: 0, synopsisWords: 0, synopsisQuality: 'missing' };",
      "context": {
        "before": {
          "line": 5484,
          "text": "if (!filePath) {"
        },
        "current": {
          "line": 5485,
          "text": "return { bodyWords: 0, synopsisWords: 0, synopsisQuality: 'missing' };"
        },
        "after": {
          "line": 5486,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5489,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return { bodyWords: 0, synopsisWords: 0, synopsisQuality: 'missing' };",
      "context": {
        "before": {
          "line": 5488,
          "text": "if (!file || !this.isTFile(file)) {"
        },
        "current": {
          "line": 5489,
          "text": "return { bodyWords: 0, synopsisWords: 0, synopsisQuality: 'missing' };"
        },
        "after": {
          "line": 5490,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5498,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisWords: cached.synopsisWords,",
      "context": {
        "before": {
          "line": 5497,
          "text": "bodyWords: cached.bodyWords,"
        },
        "current": {
          "line": 5498,
          "text": "synopsisWords: cached.synopsisWords,"
        },
        "after": {
          "line": 5499,
          "text": "synopsisQuality: cached.synopsisQuality,"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5499,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisQuality: cached.synopsisQuality,",
      "context": {
        "before": {
          "line": 5498,
          "text": "synopsisWords: cached.synopsisWords,"
        },
        "current": {
          "line": 5499,
          "text": "synopsisQuality: cached.synopsisQuality,"
        },
        "after": {
          "line": 5500,
          "text": "status: cached.status,"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5509,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisWords = this.countWords(summary);",
      "context": {
        "before": {
          "line": 5508,
          "text": "const summary = this.extractSummary(frontmatter);"
        },
        "current": {
          "line": 5509,
          "text": "const synopsisWords = this.countWords(summary);"
        },
        "after": {
          "line": 5510,
          "text": "const synopsisQuality = classifySynopsis(summary);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5510,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisQuality = classifySynopsis(summary);",
      "context": {
        "before": {
          "line": 5509,
          "text": "const synopsisWords = this.countWords(summary);"
        },
        "current": {
          "line": 5510,
          "text": "const synopsisQuality = classifySynopsis(summary);"
        },
        "after": {
          "line": 5511,
          "text": "this.ccWordCache.set(filePath, {"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5514,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisWords,",
      "context": {
        "before": {
          "line": 5513,
          "text": "bodyWords,"
        },
        "current": {
          "line": 5514,
          "text": "synopsisWords,"
        },
        "after": {
          "line": 5515,
          "text": "synopsisQuality,"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5515,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisQuality,",
      "context": {
        "before": {
          "line": 5514,
          "text": "synopsisWords,"
        },
        "current": {
          "line": 5515,
          "text": "synopsisQuality,"
        },
        "after": {
          "line": 5516,
          "text": "status,"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5521,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisWords,",
      "context": {
        "before": {
          "line": 5520,
          "text": "bodyWords,"
        },
        "current": {
          "line": 5521,
          "text": "synopsisWords,"
        },
        "after": {
          "line": 5522,
          "text": "synopsisQuality,"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5522,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisQuality,",
      "context": {
        "before": {
          "line": 5521,
          "text": "synopsisWords,"
        },
        "current": {
          "line": 5522,
          "text": "synopsisQuality,"
        },
        "after": {
          "line": 5523,
          "text": "status,"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5540,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "private getDocumentStatus(file: TFile): 'todo' | 'working' | 'complete' | undefined {",
      "context": {
        "before": {
          "line": 5539,
          "text": ""
        },
        "current": {
          "line": 5540,
          "text": "private getDocumentStatus(file: TFile): 'todo' | 'working' | 'complete' | undefined {"
        },
        "after": {
          "line": 5541,
          "text": "const frontmatter = this.app.metadataCache.getFileCache(file)?.frontmatter as Record<string, unknown> | undefined;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5547,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "if (value === 'todo' || value === 'working' || value === 'complete') {",
      "context": {
        "before": {
          "line": 5546,
          "text": "const value = raw.trim().toLowerCase();"
        },
        "current": {
          "line": 5547,
          "text": "if (value === 'todo' || value === 'working' || value === 'complete') {"
        },
        "after": {
          "line": 5548,
          "text": "return value;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5553,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "private getCorpusCcStatusIcon(status?: 'todo' | 'working' | 'complete'): string {",
      "context": {
        "before": {
          "line": 5552,
          "text": ""
        },
        "current": {
          "line": 5553,
          "text": "private getCorpusCcStatusIcon(status?: 'todo' | 'working' | 'complete'): string {"
        },
        "after": {
          "line": 5554,
          "text": "if (status === 'todo') return '';"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5554,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "if (status === 'todo') return '';",
      "context": {
        "before": {
          "line": 5553,
          "text": "private getCorpusCcStatusIcon(status?: 'todo' | 'working' | 'complete'): string {"
        },
        "current": {
          "line": 5554,
          "text": "if (status === 'todo') return '';"
        },
        "after": {
          "line": 5555,
          "text": "if (status === 'working') return '';"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5575,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "const statusBorderNote = stats.status === 'todo' ? ' (dashed border)' : '';",
      "context": {
        "before": {
          "line": 5574,
          "text": "const statusIcon = this.getCorpusCcStatusIcon(stats.status);"
        },
        "current": {
          "line": 5575,
          "text": "const statusBorderNote = stats.status === 'todo' ? ' (dashed border)' : '';"
        },
        "after": {
          "line": 5576,
          "text": "const statusIconText = statusIcon ? ` ${statusIcon}` : '';"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5582,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isSynopsisCapable = entry.className === 'scene' || entry.className.startsWith('outline');",
      "context": {
        "before": {
          "line": 5581,
          "text": "const wordLabel = wordCount.toLocaleString();"
        },
        "current": {
          "line": 5582,
          "text": "const isSynopsisCapable = entry.className === 'scene' || entry.className.startsWith('outline');"
        },
        "after": {
          "line": 5583,
          "text": "if (entry.mode === 'none') {"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 5586,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (isSynopsisCapable) {",
      "context": {
        "before": {
          "line": 5585,
          "text": "}"
        },
        "current": {
          "line": 5586,
          "text": "if (isSynopsisCapable) {"
        },
        "after": {
          "line": 5587,
          "text": "if (entry.mode === 'summary') {"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 7646,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const addNote = (path: string, note: string) => {",
      "context": {
        "before": {
          "line": 7645,
          "text": "const notesByPath = new Map<string, Set<string>>();"
        },
        "current": {
          "line": 7646,
          "text": "const addNote = (path: string, note: string) => {"
        },
        "after": {
          "line": 7647,
          "text": "let bucket = notesByPath.get(path);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 7652,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "bucket.add(note);",
      "context": {
        "before": {
          "line": 7651,
          "text": "}"
        },
        "current": {
          "line": 7652,
          "text": "bucket.add(note);"
        },
        "after": {
          "line": 7653,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 7677,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const note = this.formatInquiryActionNote(finding, briefTitle);",
      "context": {
        "before": {
          "line": 7676,
          "text": "if (this.getImpactRank(finding.impact) < minimumRank) return;"
        },
        "current": {
          "line": 7677,
          "text": "const note = this.formatInquiryActionNote(finding, briefTitle);"
        },
        "after": {
          "line": 7678,
          "text": "const refId = finding.refId?.trim();"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 7686,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "addNote(filePath, note);",
      "context": {
        "before": {
          "line": 7685,
          "text": "if (filePath && !handledScenes.has(filePath)) {"
        },
        "current": {
          "line": 7686,
          "text": "addNote(filePath, note);"
        },
        "after": {
          "line": 7687,
          "text": "handledScenes.add(filePath);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 7690,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "addNote(outlinePath, note);",
      "context": {
        "before": {
          "line": 7689,
          "text": "if (outlinePath) {"
        },
        "current": {
          "line": 7690,
          "text": "addNote(outlinePath, note);"
        },
        "after": {
          "line": 7691,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 7763,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const nextNotes = shouldQuoteLink ? notes.map(note => quoteWikiLink(note)) : notes.slice();",
      "context": {
        "before": {
          "line": 7762,
          "text": "const shouldQuoteLink = lines.length === 0 && notes.length === 1 && !rawText.includes('\\n') && !rawText.includes('\\r');"
        },
        "current": {
          "line": 7763,
          "text": "const nextNotes = shouldQuoteLink ? notes.map(note => quoteWikiLink(note)) : notes.slice();"
        },
        "after": {
          "line": 7764,
          "text": "let nextLines = [...lines, ...nextNotes];"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 8086,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (!this.isSynopsisCapableClass(className)) {",
      "context": {
        "before": {
          "line": 8085,
          "text": ""
        },
        "current": {
          "line": 8086,
          "text": "if (!this.isSynopsisCapableClass(className)) {"
        },
        "after": {
          "line": 8087,
          "text": "if (config && config.enabled) {"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 8173,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisOnly = !entries.some(entry => this.normalizeEvidenceMode(entry.mode) === 'full');",
      "context": {
        "before": {
          "line": 8172,
          "text": "const allowedClasses = Array.from(new Set(entries.map(entry => entry.class)));"
        },
        "current": {
          "line": 8173,
          "text": "const synopsisOnly = !entries.some(entry => this.normalizeEvidenceMode(entry.mode) === 'full');"
        },
        "after": {
          "line": 8174,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 8181,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisOnly,",
      "context": {
        "before": {
          "line": 8180,
          "text": "allowedClasses,"
        },
        "current": {
          "line": 8181,
          "text": "synopsisOnly,"
        },
        "after": {
          "line": 8182,
          "text": "classCounts"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 8205,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisOnly: true,",
      "context": {
        "before": {
          "line": 8204,
          "text": "allowedClasses: [],"
        },
        "current": {
          "line": 8205,
          "text": "synopsisOnly: true,"
        },
        "after": {
          "line": 8206,
          "text": "classCounts: {}"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 8267,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const synopsisOnly = !entries.some(entry => this.normalizeEvidenceMode(entry.mode) === 'full');",
      "context": {
        "before": {
          "line": 8266,
          "text": ": Array.from(classScope.allowed);"
        },
        "current": {
          "line": 8267,
          "text": "const synopsisOnly = !entries.some(entry => this.normalizeEvidenceMode(entry.mode) === 'full');"
        },
        "after": {
          "line": 8268,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 8275,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisOnly,",
      "context": {
        "before": {
          "line": 8274,
          "text": "allowedClasses,"
        },
        "current": {
          "line": 8275,
          "text": "synopsisOnly,"
        },
        "after": {
          "line": 8276,
          "text": "classCounts"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 8285,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private isSynopsisCapableClass(className: string): boolean {",
      "context": {
        "before": {
          "line": 8284,
          "text": ""
        },
        "current": {
          "line": 8285,
          "text": "private isSynopsisCapableClass(className: string): boolean {"
        },
        "after": {
          "line": 8286,
          "text": "return INQUIRY_SYNOPSIS_CAPABLE_CLASSES.has(className.toLowerCase());"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 8286,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return INQUIRY_SYNOPSIS_CAPABLE_CLASSES.has(className.toLowerCase());",
      "context": {
        "before": {
          "line": 8285,
          "text": "private isSynopsisCapableClass(className: string): boolean {"
        },
        "current": {
          "line": 8286,
          "text": "return INQUIRY_SYNOPSIS_CAPABLE_CLASSES.has(className.toLowerCase());"
        },
        "after": {
          "line": 8287,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 8290,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (mode === 'summary' && !this.isSynopsisCapableClass(className)) {",
      "context": {
        "before": {
          "line": 8289,
          "text": "private normalizeContributionMode(mode: InquiryMaterialMode, className: string): InquiryMaterialMode {"
        },
        "current": {
          "line": 8290,
          "text": "if (mode === 'summary' && !this.isSynopsisCapableClass(className)) {"
        },
        "after": {
          "line": 8291,
          "text": "return 'full';"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 8320,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const isReference = !this.isSynopsisCapableClass(config.className);",
      "context": {
        "before": {
          "line": 8319,
          "text": "private normalizeClassContribution(config: InquiryClassConfig): InquiryClassConfig {"
        },
        "current": {
          "line": 8320,
          "text": "const isReference = !this.isSynopsisCapableClass(config.className);"
        },
        "after": {
          "line": 8321,
          "text": "const contribution = this.normalizeContributionMode(this.resolveContributionMode(config), config.className);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 8361,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "?? (!this.isSynopsisCapableClass(config.className.toLowerCase()) ? true : false),",
      "context": {
        "before": {
          "line": 8360,
          "text": "(config as InquiryClassConfig).referenceScope"
        },
        "current": {
          "line": 8361,
          "text": "?? (!this.isSynopsisCapableClass(config.className.toLowerCase()) ? true : false),"
        },
        "after": {
          "line": 8362,
          "text": "config.className.toLowerCase()"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9556,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "sceneSynopsisUsed: sceneStats.synopsisUsed,",
      "context": {
        "before": {
          "line": 9555,
          "text": "sceneTotal: sceneStats.total,"
        },
        "current": {
          "line": 9556,
          "text": "sceneSynopsisUsed: sceneStats.synopsisUsed,"
        },
        "after": {
          "line": 9557,
          "text": "sceneSynopsisAvailable: sceneStats.synopsisAvailable,"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9557,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "sceneSynopsisAvailable: sceneStats.synopsisAvailable,",
      "context": {
        "before": {
          "line": 9556,
          "text": "sceneSynopsisUsed: sceneStats.synopsisUsed,"
        },
        "current": {
          "line": 9557,
          "text": "sceneSynopsisAvailable: sceneStats.synopsisAvailable,"
        },
        "after": {
          "line": 9558,
          "text": "sceneFullTextCount: sceneStats.fullCount,"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9577,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisUsed: number;",
      "context": {
        "before": {
          "line": 9576,
          "text": "total: number;"
        },
        "current": {
          "line": 9577,
          "text": "synopsisUsed: number;"
        },
        "after": {
          "line": 9578,
          "text": "synopsisAvailable: number;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9578,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisAvailable: number;",
      "context": {
        "before": {
          "line": 9577,
          "text": "synopsisUsed: number;"
        },
        "current": {
          "line": 9578,
          "text": "synopsisAvailable: number;"
        },
        "after": {
          "line": 9579,
          "text": "fullCount: number;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9582,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "let synopsisUsed = 0;",
      "context": {
        "before": {
          "line": 9581,
          "text": "} {"
        },
        "current": {
          "line": 9582,
          "text": "let synopsisUsed = 0;"
        },
        "after": {
          "line": 9583,
          "text": "let synopsisAvailable = 0;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9583,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "let synopsisAvailable = 0;",
      "context": {
        "before": {
          "line": 9582,
          "text": "let synopsisUsed = 0;"
        },
        "current": {
          "line": 9583,
          "text": "let synopsisAvailable = 0;"
        },
        "after": {
          "line": 9584,
          "text": "let fullCount = 0;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9589,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisAvailable += 1;",
      "context": {
        "before": {
          "line": 9588,
          "text": "if (summary) {"
        },
        "current": {
          "line": 9589,
          "text": "synopsisAvailable += 1;"
        },
        "after": {
          "line": 9590,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9594,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisUsed += 1;",
      "context": {
        "before": {
          "line": 9593,
          "text": "if (!summary) return;"
        },
        "current": {
          "line": 9594,
          "text": "synopsisUsed += 1;"
        },
        "after": {
          "line": 9595,
          "text": "chars += summary.length;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9607,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisUsed,",
      "context": {
        "before": {
          "line": 9606,
          "text": "total: entries.length,"
        },
        "current": {
          "line": 9607,
          "text": "synopsisUsed,"
        },
        "after": {
          "line": 9608,
          "text": "synopsisAvailable,"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9608,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisAvailable,",
      "context": {
        "before": {
          "line": 9607,
          "text": "synopsisUsed,"
        },
        "current": {
          "line": 9608,
          "text": "synopsisAvailable,"
        },
        "after": {
          "line": 9609,
          "text": "fullCount,"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9704,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Reads exclusively from frontmatter[\"Summary\"]. Synopsis is never used.",
      "context": {
        "before": {
          "line": 9703,
          "text": "* Extract extended Summary from frontmatter for Inquiry context."
        },
        "current": {
          "line": 9704,
          "text": "* Reads exclusively from frontmatter[\"Summary\"]. Synopsis is never used."
        },
        "after": {
          "line": 9705,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9735,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (stats.sceneSynopsisUsed > 0) {",
      "context": {
        "before": {
          "line": 9734,
          "text": "}"
        },
        "current": {
          "line": 9735,
          "text": "if (stats.sceneSynopsisUsed > 0) {"
        },
        "after": {
          "line": 9736,
          "text": "return `Scenes  ${stats.sceneSynopsisUsed} (Summary)`;"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9736,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return `Scenes  ${stats.sceneSynopsisUsed} (Summary)`;",
      "context": {
        "before": {
          "line": 9735,
          "text": "if (stats.sceneSynopsisUsed > 0) {"
        },
        "current": {
          "line": 9736,
          "text": "return `Scenes  ${stats.sceneSynopsisUsed} (Summary)`;"
        },
        "after": {
          "line": 9737,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9943,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "note?: string",
      "context": {
        "before": {
          "line": 9942,
          "text": "input: InquiryRunnerInput,"
        },
        "current": {
          "line": 9943,
          "text": "note?: string"
        },
        "after": {
          "line": 9944,
          "text": "): Promise<InquiryRunTrace> {"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9947,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "if (note) {",
      "context": {
        "before": {
          "line": 9946,
          "text": "const trace = await this.runner.buildTrace(input);"
        },
        "current": {
          "line": 9947,
          "text": "if (note) {"
        },
        "after": {
          "line": 9948,
          "text": "trace.notes.push(note);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9948,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "trace.notes.push(note);",
      "context": {
        "before": {
          "line": 9947,
          "text": "if (note) {"
        },
        "current": {
          "line": 9948,
          "text": "trace.notes.push(note);"
        },
        "after": {
          "line": 9949,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 9953,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const notes = note ? [note] : [];",
      "context": {
        "before": {
          "line": 9952,
          "text": "const message = error instanceof Error ? error.message : String(error);"
        },
        "current": {
          "line": 9953,
          "text": "const notes = note ? [note] : [];"
        },
        "after": {
          "line": 9954,
          "text": "if (message) {"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 10146,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "brief.sceneNotes.forEach(note => {",
      "context": {
        "before": {
          "line": 10145,
          "text": "lines.push('', '## Per-Scene / Per-Moment Notes');"
        },
        "current": {
          "line": 10146,
          "text": "brief.sceneNotes.forEach(note => {"
        },
        "after": {
          "line": 10147,
          "text": "const anchor = note.anchorId ? ` ^${note.anchorId}` : '';"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 10147,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const anchor = note.anchorId ? ` ^${note.anchorId}` : '';",
      "context": {
        "before": {
          "line": 10146,
          "text": "brief.sceneNotes.forEach(note => {"
        },
        "current": {
          "line": 10147,
          "text": "const anchor = note.anchorId ? ` ^${note.anchorId}` : '';"
        },
        "after": {
          "line": 10148,
          "text": "lines.push(`- ${note.label}: ${note.note}${anchor}`);"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 10148,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "lines.push(`- ${note.label}: ${note.note}${anchor}`);",
      "context": {
        "before": {
          "line": 10147,
          "text": "const anchor = note.anchorId ? ` ^${note.anchorId}` : '';"
        },
        "current": {
          "line": 10148,
          "text": "lines.push(`- ${note.label}: ${note.note}${anchor}`);"
        },
        "after": {
          "line": 10149,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 10199,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "private buildInquirySceneNotes(result: InquiryResult): Array<{ label: string; note: string; anchorId?: string }> {",
      "context": {
        "before": {
          "line": 10198,
          "text": ""
        },
        "current": {
          "line": 10199,
          "text": "private buildInquirySceneNotes(result: InquiryResult): Array<{ label: string; note: string; anchorId?: string }> {"
        },
        "after": {
          "line": 10200,
          "text": "if (result.scope !== 'book') return [];"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 10203,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const notes = new Map<string, { note: string; anchorId?: string }>();",
      "context": {
        "before": {
          "line": 10202,
          "text": "const orderedFindings = this.getOrderedFindings(result, result.mode);"
        },
        "current": {
          "line": 10203,
          "text": "const notes = new Map<string, { note: string; anchorId?: string }>();"
        },
        "after": {
          "line": 10204,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 10210,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const note = (finding.bullets?.find(entry => entry?.trim()) || finding.headline || '')",
      "context": {
        "before": {
          "line": 10209,
          "text": "if (!label || notes.has(label)) return;"
        },
        "current": {
          "line": 10210,
          "text": "const note = (finding.bullets?.find(entry => entry?.trim()) || finding.headline || '')"
        },
        "after": {
          "line": 10211,
          "text": ".replace(/\\s+/g, ' ')"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 10213,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "if (!note) return;",
      "context": {
        "before": {
          "line": 10212,
          "text": ".trim();"
        },
        "current": {
          "line": 10213,
          "text": "if (!note) return;"
        },
        "after": {
          "line": 10214,
          "text": "const labelLower = label.toLowerCase();"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 10225,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "notes.set(label, { note, anchorId });",
      "context": {
        "before": {
          "line": 10224,
          "text": "const anchorId = anchorSource ? this.getBriefSceneAnchorId(anchorSource) : undefined;"
        },
        "current": {
          "line": 10225,
          "text": "notes.set(label, { note, anchorId });"
        },
        "after": {
          "line": 10226,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/inquiry/InquiryView.ts",
      "line": 10230,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "note: entry.note,",
      "context": {
        "before": {
          "line": 10229,
          "text": "label,"
        },
        "current": {
          "line": 10230,
          "text": "note: entry.note,"
        },
        "after": {
          "line": 10231,
          "text": "anchorId: entry.anchorId"
        }
      }
    },
    {
      "filePath": "src/inquiry/services/InquiryCorpusResolver.ts",
      "line": 16,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "hasSynopsis?: boolean;",
      "context": {
        "before": {
          "line": 15,
          "text": "sceneId?: string;"
        },
        "current": {
          "line": 16,
          "text": "hasSynopsis?: boolean;"
        },
        "after": {
          "line": 17,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/inquiry/services/InquiryCorpusResolver.ts",
      "line": 170,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const hasSynopsis = this.hasSynopsis(frontmatter);",
      "context": {
        "before": {
          "line": 169,
          "text": "const sceneNumber = this.getSceneNumber(file.basename);"
        },
        "current": {
          "line": 170,
          "text": "const hasSynopsis = this.hasSynopsis(frontmatter);"
        },
        "after": {
          "line": 171,
          "text": "const sceneId = readSceneId(frontmatter);"
        }
      }
    },
    {
      "filePath": "src/inquiry/services/InquiryCorpusResolver.ts",
      "line": 181,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "hasSynopsis",
      "context": {
        "before": {
          "line": 180,
          "text": "sceneNumber,"
        },
        "current": {
          "line": 181,
          "text": "hasSynopsis"
        },
        "after": {
          "line": 182,
          "text": "});"
        }
      }
    },
    {
      "filePath": "src/inquiry/services/InquiryCorpusResolver.ts",
      "line": 257,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Synopsis is not used by Inquiry.",
      "context": {
        "before": {
          "line": 256,
          "text": "* Returns true when frontmatter[\"Summary\"] exists."
        },
        "current": {
          "line": 257,
          "text": "* Synopsis is not used by Inquiry."
        },
        "after": {
          "line": 258,
          "text": "* Legacy name kept for type compatibility with InquiryCorpusItem.hasSynopsis."
        }
      }
    },
    {
      "filePath": "src/inquiry/services/InquiryCorpusResolver.ts",
      "line": 258,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Legacy name kept for type compatibility with InquiryCorpusItem.hasSynopsis.",
      "context": {
        "before": {
          "line": 257,
          "text": "* Synopsis is not used by Inquiry."
        },
        "current": {
          "line": 258,
          "text": "* Legacy name kept for type compatibility with InquiryCorpusItem.hasSynopsis."
        },
        "after": {
          "line": 259,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/inquiry/services/InquiryCorpusResolver.ts",
      "line": 260,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "private hasSynopsis(frontmatter: Record<string, unknown>): boolean {",
      "context": {
        "before": {
          "line": 259,
          "text": "*/"
        },
        "current": {
          "line": 260,
          "text": "private hasSynopsis(frontmatter: Record<string, unknown>): boolean {"
        },
        "after": {
          "line": 261,
          "text": "const value = frontmatter['Summary'];"
        }
      }
    },
    {
      "filePath": "src/inquiry/services/InquiryCorpusResolver.ts",
      "line": 267,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "/** Alias for hasSynopsis  prefer in new code to prevent semantic drift. */",
      "context": {
        "before": {
          "line": 266,
          "text": ""
        },
        "current": {
          "line": 267,
          "text": "/** Alias for hasSynopsis  prefer in new code to prevent semantic drift. */"
        },
        "after": {
          "line": 268,
          "text": "private hasSummary(frontmatter: Record<string, unknown>): boolean {"
        }
      }
    },
    {
      "filePath": "src/inquiry/services/InquiryCorpusResolver.ts",
      "line": 269,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return this.hasSynopsis(frontmatter);",
      "context": {
        "before": {
          "line": 268,
          "text": "private hasSummary(frontmatter: Record<string, unknown>): boolean {"
        },
        "current": {
          "line": 269,
          "text": "return this.hasSynopsis(frontmatter);"
        },
        "after": {
          "line": 270,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/inquiry/runner/InquiryRunnerService.ts",
      "line": 530,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Hard guard: Inquiry corpus must never include Synopsis-sourced content.",
      "context": {
        "before": {
          "line": 529,
          "text": ""
        },
        "current": {
          "line": 530,
          "text": "// Hard guard: Inquiry corpus must never include Synopsis-sourced content."
        },
        "after": {
          "line": 531,
          "text": "// Catches accidental reintroduction of Synopsis semantics in future changes."
        }
      }
    },
    {
      "filePath": "src/inquiry/runner/InquiryRunnerService.ts",
      "line": 531,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "// Catches accidental reintroduction of Synopsis semantics in future changes.",
      "context": {
        "before": {
          "line": 530,
          "text": "// Hard guard: Inquiry corpus must never include Synopsis-sourced content."
        },
        "current": {
          "line": 531,
          "text": "// Catches accidental reintroduction of Synopsis semantics in future changes."
        },
        "after": {
          "line": 532,
          "text": "if (typeof process !== 'undefined' && process.env?.NODE_ENV !== 'production') {"
        }
      }
    },
    {
      "filePath": "src/inquiry/runner/InquiryRunnerService.ts",
      "line": 534,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "if (/\\bsynopsis\\b/i.test(block.label)) {",
      "context": {
        "before": {
          "line": 533,
          "text": "for (const block of blocks) {"
        },
        "current": {
          "line": 534,
          "text": "if (/\\bsynopsis\\b/i.test(block.label)) {"
        },
        "after": {
          "line": 535,
          "text": "console.warn("
        }
      }
    },
    {
      "filePath": "src/inquiry/runner/InquiryRunnerService.ts",
      "line": 536,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "`[Inquiry guard] Evidence block label \"${block.label}\" contains \"synopsis\". ` +",
      "context": {
        "before": {
          "line": 535,
          "text": "console.warn("
        },
        "current": {
          "line": 536,
          "text": "`[Inquiry guard] Evidence block label \"${block.label}\" contains \"synopsis\". ` +"
        },
        "after": {
          "line": 537,
          "text": "`Inquiry corpus must use Summary only. This may indicate a regression.`"
        }
      }
    },
    {
      "filePath": "src/inquiry/runner/InquiryRunnerService.ts",
      "line": 1548,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "const bullets = message ? [`Runner note: ${message}`] : ['Deterministic placeholder result.'];",
      "context": {
        "before": {
          "line": 1547,
          "text": "const summary = this.buildStubSummary(aiMeta.aiStatus, aiMeta.aiReason, message);"
        },
        "current": {
          "line": 1548,
          "text": "const bullets = message ? [`Runner note: ${message}`] : ['Deterministic placeholder result.'];"
        },
        "after": {
          "line": 1549,
          "text": "const fallbackRefId = this.resolveFindingFallbackRefId(input);"
        }
      }
    },
    {
      "filePath": "src/inquiry/runner/InquiryRunnerService.ts",
      "line": 1702,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Reads exclusively from frontmatter[\"Summary\"]. Synopsis is never used.",
      "context": {
        "before": {
          "line": 1701,
          "text": "* Extract extended Summary from frontmatter for Inquiry context."
        },
        "current": {
          "line": 1702,
          "text": "* Reads exclusively from frontmatter[\"Summary\"]. Synopsis is never used."
        },
        "after": {
          "line": 1703,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/inquiry/runner/types.ts",
      "line": 37,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisOnly: boolean;",
      "context": {
        "before": {
          "line": 36,
          "text": "allowedClasses: EvidenceClass[];"
        },
        "current": {
          "line": 37,
          "text": "synopsisOnly: boolean;"
        },
        "after": {
          "line": 38,
          "text": "classCounts: Record<EvidenceClass, number>;"
        }
      }
    },
    {
      "filePath": "src/inquiry/components/InquiryGlyph.ts",
      "line": 363,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "dotGroup.setAttribute('role', 'note');",
      "context": {
        "before": {
          "line": 362,
          "text": "dotGroup.setAttribute('transform', `translate(${dotX.toFixed(2)} ${dotY.toFixed(2)})`);"
        },
        "current": {
          "line": 363,
          "text": "dotGroup.setAttribute('role', 'note');"
        },
        "after": {
          "line": 364,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 29,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Kept for structural compat; not rendered in UI. */",
      "context": {
        "before": {
          "line": 28,
          "text": "};"
        },
        "current": {
          "line": 29,
          "text": "/** @deprecated Kept for structural compat; not rendered in UI. */"
        },
        "after": {
          "line": 30,
          "text": "showTitle: {"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 86,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisMaxLines: {",
      "context": {
        "before": {
          "line": 85,
          "text": "};"
        },
        "current": {
          "line": 86,
          "text": "synopsisMaxLines: {"
        },
        "after": {
          "line": 87,
          "text": "name: string;"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 150,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Kept for structural compat; use DEFAULT_BOOK_TITLE instead. */",
      "context": {
        "before": {
          "line": 149,
          "text": "};"
        },
        "current": {
          "line": 150,
          "text": "/** @deprecated Kept for structural compat; use DEFAULT_BOOK_TITLE instead. */"
        },
        "after": {
          "line": 151,
          "text": "workInProgress: string;"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 234,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "includeSynopsis: string;",
      "context": {
        "before": {
          "line": 233,
          "text": "wordCountNote: string;"
        },
        "current": {
          "line": 234,
          "text": "includeSynopsis: string;"
        },
        "after": {
          "line": 235,
          "text": "includeSynopsisNote: string;"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 235,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "includeSynopsisNote: string;",
      "context": {
        "before": {
          "line": 234,
          "text": "includeSynopsis: string;"
        },
        "current": {
          "line": 235,
          "text": "includeSynopsisNote: string;"
        },
        "after": {
          "line": 236,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 268,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis: { prefix: string; };",
      "context": {
        "before": {
          "line": 267,
          "text": "};"
        },
        "current": {
          "line": 268,
          "text": "synopsis: { prefix: string; };"
        },
        "after": {
          "line": 269,
          "text": "tooltip: { altHint: string; };"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 284,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Legacy toggle  book title is now set via Book Profiles. */",
      "context": {
        "before": {
          "line": 283,
          "text": "},"
        },
        "current": {
          "line": 284,
          "text": "/** @deprecated Legacy toggle  book title is now set via Book Profiles. */"
        },
        "after": {
          "line": 285,
          "text": "showTitle: {"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 286,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "name: 'Legacy: source path title (deprecated)',",
      "context": {
        "before": {
          "line": 285,
          "text": "showTitle: {"
        },
        "current": {
          "line": 286,
          "text": "name: 'Legacy: source path title (deprecated)',"
        },
        "after": {
          "line": 287,
          "text": "desc: 'This setting is no longer used. Book title is managed via Book Profiles in General settings.',"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 341,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsisMaxLines: {",
      "context": {
        "before": {
          "line": 340,
          "text": "},"
        },
        "current": {
          "line": 341,
          "text": "synopsisMaxLines: {"
        },
        "after": {
          "line": 342,
          "text": "name: 'Synopsis max words',"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 342,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "name: 'Synopsis max words',",
      "context": {
        "before": {
          "line": 341,
          "text": "synopsisMaxLines: {"
        },
        "current": {
          "line": 342,
          "text": "name: 'Synopsis max words',"
        },
        "after": {
          "line": 343,
          "text": "desc: 'Maximum words for generated Synopsis. Hover display is synced automatically from this value.',"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 343,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "desc: 'Maximum words for generated Synopsis. Hover display is synced automatically from this value.',",
      "context": {
        "before": {
          "line": 342,
          "text": "name: 'Synopsis max words',"
        },
        "current": {
          "line": 343,
          "text": "desc: 'Maximum words for generated Synopsis. Hover display is synced automatically from this value.',"
        },
        "after": {
          "line": 344,
          "text": "placeholder: '30',"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 348,
      "token": "Ripple Rename",
      "category": "drift-term",
      "lineText": "name: 'Manuscript ripple rename: normalize numeric prefixes after drag reorder.',",
      "context": {
        "before": {
          "line": 347,
          "text": "rippleRename: {"
        },
        "current": {
          "line": 348,
          "text": "name: 'Manuscript ripple rename: normalize numeric prefixes after drag reorder.',"
        },
        "after": {
          "line": 349,
          "text": "desc: 'Renames both scenes and beats filenames only. Keeps padding (01/001). Removes decimals (1.2/1.5 -> 1/2).',"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 353,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "desc: 'When hovering over a scene, automatically expand it if the title text is clipped. Disable this if you prefer to quickly slide through scenes and read titles from the synopsis instead.',",
      "context": {
        "before": {
          "line": 352,
          "text": "name: 'Auto-expand clipped scene titles',"
        },
        "current": {
          "line": 353,
          "text": "desc: 'When hovering over a scene, automatically expand it if the title text is clipped. Disable this if you prefer to quickly slide through scenes and read titles from the synopsis instead.',"
        },
        "after": {
          "line": 354,
          "text": "},"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 383,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "desc: 'Show command palette options and UI scene analysis colors and hover synopsis. When off, these visuals are hidden, but metadata remains unchanged.',",
      "context": {
        "before": {
          "line": 382,
          "text": "name: 'Enable AI LLM features',"
        },
        "current": {
          "line": 383,
          "text": "desc: 'Show command palette options and UI scene analysis colors and hover synopsis. When off, these visuals are hidden, but metadata remains unchanged.',"
        },
        "after": {
          "line": 384,
          "text": "},"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 405,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated No longer used  book title comes from Book Profiles. */",
      "context": {
        "before": {
          "line": 404,
          "text": "},"
        },
        "current": {
          "line": 405,
          "text": "/** @deprecated No longer used  book title comes from Book Profiles. */"
        },
        "after": {
          "line": 406,
          "text": "workInProgress: 'Untitled Manuscript',"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 446,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "outlineIndexCardsDesc: 'Scene metadata as structured data (CSV/JSON). Works from YAML metadata only  no scene body formatting required. Includes runtime, word counts, synopsis. Best for external tools, scripts, or databases.',",
      "context": {
        "before": {
          "line": 445,
          "text": "outlineShootingScheduleDesc: 'Production-ready table with scenes, locations, timing, subplots. Works from YAML metadata only  no scene body formatting required. Includes session planning estimates if configured. Best for film/TV production.',"
        },
        "current": {
          "line": 446,
          "text": "outlineIndexCardsDesc: 'Scene metadata as structured data (CSV/JSON). Works from YAML metadata only  no scene body formatting required. Includes runtime, word counts, synopsis. Best for external tools, scripts, or databases.',"
        },
        "after": {
          "line": 447,
          "text": "formatMarkdown: 'Markdown',"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 489,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "includeSynopsis: 'Include scene synopsis',",
      "context": {
        "before": {
          "line": 488,
          "text": "wordCountNote: 'Updates the Words field in each scene\\'s frontmatter with accurate counts (excludes YAML and comments).',"
        },
        "current": {
          "line": 489,
          "text": "includeSynopsis: 'Include scene synopsis',"
        },
        "after": {
          "line": 490,
          "text": "includeSynopsisNote: 'Adds the Synopsis field from each scene\\'s frontmatter to the outline.',"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 490,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "includeSynopsisNote: 'Adds the Synopsis field from each scene\\'s frontmatter to the outline.',",
      "context": {
        "before": {
          "line": 489,
          "text": "includeSynopsis: 'Include scene synopsis',"
        },
        "current": {
          "line": 490,
          "text": "includeSynopsisNote: 'Adds the Synopsis field from each scene\\'s frontmatter to the outline.',"
        },
        "after": {
          "line": 491,
          "text": "},"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 496,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "desc: 'Turns on the converter modal, Chronologue Alt/Option tooltip, and synopsis line for the active profile.',",
      "context": {
        "before": {
          "line": 495,
          "text": "name: 'Enable planetary conversions',"
        },
        "current": {
          "line": 496,
          "text": "desc: 'Turns on the converter modal, Chronologue Alt/Option tooltip, and synopsis line for the active profile.',"
        },
        "after": {
          "line": 497,
          "text": "},"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/en.ts",
      "line": 532,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "synopsis: { prefix: 'Local: ' },",
      "context": {
        "before": {
          "line": 531,
          "text": "},"
        },
        "current": {
          "line": 532,
          "text": "synopsis: { prefix: 'Local: ' },"
        },
        "after": {
          "line": 533,
          "text": "tooltip: { altHint: 'Hold Alt/Option to show local time.' },"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/ja.ts",
      "line": 34,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated Legacy toggle  book title is now set via Book Profiles. */",
      "context": {
        "before": {
          "line": 33,
          "text": "},"
        },
        "current": {
          "line": 34,
          "text": "/** @deprecated Legacy toggle  book title is now set via Book Profiles. */"
        },
        "after": {
          "line": 35,
          "text": "showTitle: {"
        }
      }
    },
    {
      "filePath": "src/i18n/locales/ja.ts",
      "line": 116,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "/** @deprecated No longer used  book title comes from Book Profiles. */",
      "context": {
        "before": {
          "line": 115,
          "text": "},"
        },
        "current": {
          "line": 116,
          "text": "/** @deprecated No longer used  book title comes from Book Profiles. */"
        },
        "after": {
          "line": 117,
          "text": "workInProgress: '',"
        }
      }
    },
    {
      "filePath": "src/assets/embeddedFonts.ts",
      "line": 24,
      "token": "TODO",
      "category": "stale-comment",
      "lineText": "normal: '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BQYGBgYGAwMGAwgGBgYGBQYFBgYIBQYGBQMFBgUAAAALCAYABAQDBggHCAgDBAQGBgQGAwgHBAcHBwcHBwcHAwMGBgYHCAcHBwcHBwcHBgcHBwgHBwcHBwcGBwcIBwcHBAgEBgcEBwcGBwcHBwcDAwcDCAcHBwcGBwYHBwgGBwcGAwYHBgAAAAwJBgAFBQMGCQgJCQMFBQYGBQYDCQgFCAgICAgICAgDAwYGBggJCAgICAgICAgGCAgICQgICAgICAYICAkICAgFCQUGCAUICAYICAgICAMDCAMJCAgICAYIBggICQYICAYDBggGAAAADQoHAAUFAwcKCAoKAwUFBwcFBwMKCAUICAgICAgICAMDBwcHCAoICAgICAgICAcICAgKCAgICAgIBwgICggICAUKBQcIBQgIBwgICAgIAwMIAwoICAgIBwgHCAgKBwgIBwMHCAcAAAAOCwcABQUEBwsJCwsEBQUHBwUHBAsJBQkJCQkJCQkJBAQHBwcJCwkJCQkJCQkJBwkJCQsJCQkJCQkHCQkLCQkJBQsFBwkFCQkHCQkJCQkEBAkECwkJCQkHCQcJCQsHCQkHBAcJBwAAAA8LCAAGBgQICwkLCwQGBggIBggECwkGCQkJCQkJCQkEBAgICAkLCQkJCQkJCQkICQkJCwkJCQkJCQgJCQsJCQkGCwYICQYJCQgJCQkJCQQECQQLCQkJCQgJCAkJCwgJCQgECAkIAAAAEAwIAAYGBAgMCgwMBAYGCAgGCAQMCgYKCgoKCgoKCgQECAgICgwKCgoKCgoKCggKCgoMCgoKCgoKCAoKDAoKCgYMBggKBgoKCAoKCgoKBAQKBAwKCgoKCAoICgoMCAoKCAQICggAAAARDQkABgYECQ0LDQ0EBgYJCQYJBA0LBgsLCwsLCwsLBAQJCQkLDQsLCwsLCwsLCQsLCw0LCwsLCwsJCwsNCwsLBg0GCQsGCwsJCwsLCwsEBAsEDQsLCwsJCwkLCw0JCwsJBAkLCQAAABIOCQAHBwUJDgsODgUHBwkJBwkFDgsHCwsLCwsLCwsFBQkJCQsOCwsLCwsLCwsJCwsLDgsLCwsLCwkLCw4LCwsHDgcJCwcLCwkLCwsLCwUFCwUOCwsLCwkLCQsLDgkLCwkFCQsJAAAAEw4KAAcHBQoODA4OBQcHCgoHCgUODAcMDAwMDAwMDAUFCgoKDA4MDAwMDAwMDAoMDAwODAwMDAwMCgwMDgwMDAcOBwoMBwwMCgwMDAwMBQUMBQ4MDAwMCgwKDAwOCgwMCgUKDAoAAAAUDwoACAgFCg8NDw8FCAgKCggKBQ8NCA0NDQ0NDQ0NBQUKCgoNDw0NDQ0NDQ0NCg0NDQ8NDQ0NDQ0KDQ0PDQ0NCA8ICg0IDQ0KDQ0NDQ0FBQ0FDw0NDQ0KDQoNDQ8KDQ0KBQoNCgAAABUQCwAICAULEA0QEAUICAsLCAsFEA0IDQ0NDQ0NDQ0FBQsLCw0QDQ0NDQ0NDQ0LDQ0NEA0NDQ0NDQsNDRANDQ0IEAgLDQgNDQsNDQ0NDQUFDQUQDQ0NDQsNCw0NEAsNDQsFCw0LAAAAFhELAAgIBgsRDhERBggICwsICwYRDggODg4ODg4ODgYGCwsLDhEODg4ODg4ODgsODg4RDg4ODg4OCw4OEQ4ODggRCAsOCA4OCw4ODg4OBgYOBhEODg4OCw4LDg4RCw4OCwYLDgsAAAAXEQwACQkGDBEOEREGCQkMDAkMBhEOCQ4ODg4ODg4OBgYMDAwOEQ4ODg4ODg4ODA4ODhEODg4ODg4MDg4RDg4OCREJDA4JDg4MDg4ODg4GBg4GEQ4ODg4MDgwODhEMDg4MBgwODAAAABgSDAAJCQYMEg8SEgYJCQwMCQwGEg8JDw8PDw8PDw8GBgwMDA8SDw8PDw8PDw8MDw8PEg8PDw8PDwwPDxIPDw8JEgkMDwkPDwwPDw8PDwYGDwYSDw8PDwwPDA8PEgwPDwwGDA8MAAAAAAACEwGQAAUAAQK8AooAAACPArwCigAAAcUAMgEDAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEFsdHMAQAAgIBAC7v8GAAAC7gB9AAAAAQAAAAEAAD/X79hfDzz1AAAD6AAAAAC6pnmDAAAAALqmeYMAAP+DAnEC7gAAAAMAAgABAAAAAAABAAAC7v8GAAAC7gAAAD4CcQABAAAAAAAAAAAAAAAAAAAAYwABAAAAYwAgAAcAAAAAAAIACABAAAoAAABXAKoAAQAB' // TODO: Paste your base64-encoded 04b03b woff2 font here",
      "context": {
        "before": {
          "line": 23,
          "text": "'04b03b': {"
        },
        "current": {
          "line": 24,
          "text": "normal: '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BQYGBgYGAwMGAwgGBgYGBQYFBgYIBQYGBQMFBgUAAAALCAYABAQDBggHCAgDBAQGBgQGAwgHBAcHBwcHBwcHAwMGBgYHCAcHBwcHBwcHBgcHBwgHBwcHBwcGBwcIBwcHBAgEBgcEBwcGBwcHBwcDAwcDCAcHBwcGBwYHBwgGBwcGAwYHBgAAAAwJBgAFBQMGCQgJCQMFBQYGBQYDCQgFCAgICAgICAgDAwYGBggJCAgICAgICAgGCAgICQgICAgICAYICAkICAgFCQUGCAUICAYICAgICAMDCAMJCAgICAYIBggICQYICAYDBggGAAAADQoHAAUFAwcKCAoKAwUFBwcFBwMKCAUICAgICAgICAMDBwcHCAoICAgICAgICAcICAgKCAgICAgIBwgICggICAUKBQcIBQgIBwgICAgIAwMIAwoICAgIBwgHCAgKBwgIBwMHCAcAAAAOCwcABQUEBwsJCwsEBQUHBwUHBAsJBQkJCQkJCQkJBAQHBwcJCwkJCQkJCQkJBwkJCQsJCQkJCQkHCQkLCQkJBQsFBwkFCQkHCQkJCQkEBAkECwkJCQkHCQcJCQsHCQkHBAcJBwAAAA8LCAAGBgQICwkLCwQGBggIBggECwkGCQkJCQkJCQkEBAgICAkLCQkJCQkJCQkICQkJCwkJCQkJCQgJCQsJCQkGCwYICQYJCQgJCQkJCQQECQQLCQkJCQgJCAkJCwgJCQgECAkIAAAAEAwIAAYGBAgMCgwMBAYGCAgGCAQMCgYKCgoKCgoKCgQECAgICgwKCgoKCgoKCggKCgoMCgoKCgoKCAoKDAoKCgYMBggKBgoKCAoKCgoKBAQKBAwKCgoKCAoICgoMCAoKCAQICggAAAARDQkABgYECQ0LDQ0EBgYJCQYJBA0LBgsLCwsLCwsLBAQJCQkLDQsLCwsLCwsLCQsLCw0LCwsLCwsJCwsNCwsLBg0GCQsGCwsJCwsLCwsEBAsEDQsLCwsJCwkLCw0JCwsJBAkLCQAAABIOCQAHBwUJDgsODgUHBwkJBwkFDgsHCwsLCwsLCwsFBQkJCQsOCwsLCwsLCwsJCwsLDgsLCwsLCwkLCw4LCwsHDgcJCwcLCwkLCwsLCwUFCwUOCwsLCwkLCQsLDgkLCwkFCQsJAAAAEw4KAAcHBQoODA4OBQcHCgoHCgUODAcMDAwMDAwMDAUFCgoKDA4MDAwMDAwMDAoMDAwODAwMDAwMCgwMDgwMDAcOBwoMBwwMCgwMDAwMBQUMBQ4MDAwMCgwKDAwOCgwMCgUKDAoAAAAUDwoACAgFCg8NDw8FCAgKCggKBQ8NCA0NDQ0NDQ0NBQUKCgoNDw0NDQ0NDQ0NCg0NDQ8NDQ0NDQ0KDQ0PDQ0NCA8ICg0IDQ0KDQ0NDQ0FBQ0FDw0NDQ0KDQoNDQ8KDQ0KBQoNCgAAABUQCwAICAULEA0QEAUICAsLCAsFEA0IDQ0NDQ0NDQ0FBQsLCw0QDQ0NDQ0NDQ0LDQ0NEA0NDQ0NDQsNDRANDQ0IEAgLDQgNDQsNDQ0NDQUFDQUQDQ0NDQsNCw0NEAsNDQsFCw0LAAAAFhELAAgIBgsRDhERBggICwsICwYRDggODg4ODg4ODgYGCwsLDhEODg4ODg4ODgsODg4RDg4ODg4OCw4OEQ4ODggRCAsOCA4OCw4ODg4OBgYOBhEODg4OCw4LDg4RCw4OCwYLDgsAAAAXEQwACQkGDBEOEREGCQkMDAkMBhEOCQ4ODg4ODg4OBgYMDAwOEQ4ODg4ODg4ODA4ODhEODg4ODg4MDg4RDg4OCREJDA4JDg4MDg4ODg4GBg4GEQ4ODg4MDgwODhEMDg4MBgwODAAAABgSDAAJCQYMEg8SEgYJCQwMCQwGEg8JDw8PDw8PDw8GBgwMDA8SDw8PDw8PDw8MDw8PEg8PDw8PDwwPDxIPDw8JEgkMDwkPDwwPDw8PDwYGDwYSDw8PDwwPDA8PEgwPDwwGDA8MAAAAAAACEwGQAAUAAQK8AooAAACPArwCigAAAcUAMgEDAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEFsdHMAQAAgIBAC7v8GAAAC7gB9AAAAAQAAAAEAAD/X79hfDzz1AAAD6AAAAAC6pnmDAAAAALqmeYMAAP+DAnEC7gAAAAMAAgABAAAAAAABAAAC7v8GAAAC7gAAAD4CcQABAAAAAAAAAAAAAAAAAAAAYwABAAAAYwAgAAcAAAAAAAIACABAAAoAAABXAKoAAQAB' // TODO: Paste your base64-encoded 04b03b woff2 font here"
        },
        "after": {
          "line": 25,
          "text": "},"
        }
      }
    },
    {
      "filePath": "src/api/anthropicApi.ts",
      "line": 6,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints.",
      "context": {
        "before": {
          "line": 5,
          "text": "*/"
        },
        "current": {
          "line": 6,
          "text": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints."
        },
        "after": {
          "line": 7,
          "text": "import { requestUrl } from 'obsidian';"
        }
      }
    },
    {
      "filePath": "src/api/geminiApi.ts",
      "line": 6,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints.",
      "context": {
        "before": {
          "line": 5,
          "text": "*/"
        },
        "current": {
          "line": 6,
          "text": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints."
        },
        "after": {
          "line": 7,
          "text": "import { requestUrl } from 'obsidian';"
        }
      }
    },
    {
      "filePath": "src/api/legacyAccessGuard.ts",
      "line": 1,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints.",
      "context": {
        "current": {
          "line": 1,
          "text": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints."
        },
        "after": {
          "line": 2,
          "text": "const LEGACY_WARNING_PREFIX = '[AI Legacy Access]';"
        }
      }
    },
    {
      "filePath": "src/api/legacyAccessGuard.ts",
      "line": 7,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "`${LEGACY_WARNING_PREFIX} ${apiName} is deprecated and should only be reached through src/ai/providers adapters.`",
      "context": {
        "before": {
          "line": 6,
          "text": "console.warn("
        },
        "current": {
          "line": 7,
          "text": "`${LEGACY_WARNING_PREFIX} ${apiName} is deprecated and should only be reached through src/ai/providers adapters.`"
        },
        "after": {
          "line": 8,
          "text": ");"
        }
      }
    },
    {
      "filePath": "src/api/localAiApi.ts",
      "line": 5,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints.",
      "context": {
        "before": {
          "line": 4,
          "text": "*/"
        },
        "current": {
          "line": 5,
          "text": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints."
        },
        "after": {
          "line": 6,
          "text": "import { requestUrl } from 'obsidian';"
        }
      }
    },
    {
      "filePath": "src/api/openaiApi.ts",
      "line": 6,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints.",
      "context": {
        "before": {
          "line": 5,
          "text": "*/"
        },
        "current": {
          "line": 6,
          "text": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints."
        },
        "after": {
          "line": 7,
          "text": "import { requestUrl } from 'obsidian'; // Use requestUrl for consistency"
        }
      }
    },
    {
      "filePath": "src/api/providerCapabilities.ts",
      "line": 1,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints.",
      "context": {
        "current": {
          "line": 1,
          "text": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints."
        },
        "after": {
          "line": 2,
          "text": "import type { OpenAiResponseFormat } from './openaiApi';"
        }
      }
    },
    {
      "filePath": "src/api/providerErrors.ts",
      "line": 1,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints.",
      "context": {
        "current": {
          "line": 1,
          "text": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints."
        },
        "after": {
          "line": 2,
          "text": "export type AiStatus = 'success' | 'rejected' | 'unavailable' | 'timeout' | 'auth' | 'rate_limit';"
        }
      }
    },
    {
      "filePath": "src/api/providerRouter.ts",
      "line": 4,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints.",
      "context": {
        "before": {
          "line": 3,
          "text": "*/"
        },
        "current": {
          "line": 4,
          "text": "// DEPRECATED: Legacy provider adapter; prefer aiClient entrypoints."
        },
        "after": {
          "line": 5,
          "text": "import type RadialTimelinePlugin from '../main';"
        }
      }
    },
    {
      "filePath": "src/api/requestPayload.ts",
      "line": 1,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "// DEPRECATED: Legacy provider payload shim; route new call paths through aiClient.",
      "context": {
        "current": {
          "line": 1,
          "text": "// DEPRECATED: Legacy provider payload shim; route new call paths through aiClient."
        },
        "after": {
          "line": 2,
          "text": "import type { AiProvider, ProviderCallArgs } from './providerCapabilities';"
        }
      }
    },
    {
      "filePath": "src/ai/log.ts",
      "line": 9,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export type AiLogFeature = 'Inquiry' | 'Pulse' | 'Synopsis' | 'Gossamer';",
      "context": {
        "before": {
          "line": 8,
          "text": ""
        },
        "current": {
          "line": 9,
          "text": "export type AiLogFeature = 'Inquiry' | 'Pulse' | 'Synopsis' | 'Gossamer';"
        },
        "after": {
          "line": 10,
          "text": "export type AiLogStatus = 'success' | 'error' | 'simulated';"
        }
      }
    },
    {
      "filePath": "src/ai/types.ts",
      "line": 18,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "export type ModelStatus = 'stable' | 'legacy' | 'deprecated';",
      "context": {
        "before": {
          "line": 17,
          "text": "export type ModelTier = 'DEEP' | 'BALANCED' | 'FAST' | 'LOCAL';"
        },
        "current": {
          "line": 18,
          "text": "export type ModelStatus = 'stable' | 'legacy' | 'deprecated';"
        },
        "after": {
          "line": 19,
          "text": ""
        }
      }
    },
    {
      "filePath": "src/ai/router/selectModel.ts",
      "line": 18,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": ".filter(model => model.status !== 'deprecated')",
      "context": {
        "before": {
          "line": 17,
          "text": ".filter(model => model.provider === request.provider)"
        },
        "current": {
          "line": 18,
          "text": ".filter(model => model.status !== 'deprecated')"
        },
        "after": {
          "line": 19,
          "text": ".filter(model => hasCapabilities(model, request.requiredCapabilities))"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/gossamer.ts",
      "line": 45,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "\"note\": \"Opening establishes world effectively\"",
      "context": {
        "before": {
          "line": 44,
          "text": "\"score\": 0,"
        },
        "current": {
          "line": 45,
          "text": "\"note\": \"Opening establishes world effectively\""
        },
        "after": {
          "line": 46,
          "text": "},"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/gossamer.ts",
      "line": 50,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "\"note\": \"Strong reversal creates new stakes\"",
      "context": {
        "before": {
          "line": 49,
          "text": "\"score\": 72,"
        },
        "current": {
          "line": 50,
          "text": "\"note\": \"Strong reversal creates new stakes\""
        },
        "after": {
          "line": 51,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/gossamer.ts",
      "line": 61,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "- \"note\": one concise sentence of guidance for this beat",
      "context": {
        "before": {
          "line": 60,
          "text": "- \"score\": 0-100 number representing tension/momentum at that beat"
        },
        "current": {
          "line": 61,
          "text": "- \"note\": one concise sentence of guidance for this beat"
        },
        "after": {
          "line": 62,
          "text": "- Only output the JSON object, no markdown fences, no commentary"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/gossamerAnalysis.ts",
      "line": 8,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Note: idealRange and isWithinRange are computed in code after AI response,",
      "context": {
        "before": {
          "line": 7,
          "text": "* JSON schema for Gemini Gossamer analysis response"
        },
        "current": {
          "line": 8,
          "text": "* Note: idealRange and isWithinRange are computed in code after AI response,"
        },
        "after": {
          "line": 9,
          "text": "* not requested from AI to avoid anchoring bias"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/gossamerAnalysis.ts",
      "line": 22,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "description: \"Name of the beat (matches beat note title without number prefix)\"",
      "context": {
        "before": {
          "line": 21,
          "text": "type: \"string\","
        },
        "current": {
          "line": 22,
          "text": "description: \"Name of the beat (matches beat note title without number prefix)\""
        },
        "after": {
          "line": 23,
          "text": "},"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 2,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* AI Summary & Synopsis Prompt Builders",
      "context": {
        "before": {
          "line": 1,
          "text": "/*"
        },
        "current": {
          "line": 2,
          "text": "* AI Summary & Synopsis Prompt Builders"
        },
        "after": {
          "line": 3,
          "text": "* Summary = extended AI-generated scene analysis (200300 words)"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 4,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Synopsis = concise, skimmable navigation text (strict max word cap)",
      "context": {
        "before": {
          "line": 3,
          "text": "* Summary = extended AI-generated scene analysis (200300 words)"
        },
        "current": {
          "line": 4,
          "text": "* Synopsis = concise, skimmable navigation text (strict max word cap)"
        },
        "after": {
          "line": 5,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 18,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "const SYNOPSIS_JSON_SCHEMA = {",
      "context": {
        "before": {
          "line": 17,
          "text": ""
        },
        "current": {
          "line": 18,
          "text": "const SYNOPSIS_JSON_SCHEMA = {"
        },
        "after": {
          "line": 19,
          "text": "type: \"object\","
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 21,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "\"synopsis\": {",
      "context": {
        "before": {
          "line": 20,
          "text": "properties: {"
        },
        "current": {
          "line": 21,
          "text": "\"synopsis\": {"
        },
        "after": {
          "line": 22,
          "text": "type: \"string\","
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 23,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "description: \"Concise scene synopsis for navigation and hovers (strict word cap)\"",
      "context": {
        "before": {
          "line": 22,
          "text": "type: \"string\","
        },
        "current": {
          "line": 23,
          "text": "description: \"Concise scene synopsis for navigation and hovers (strict word cap)\""
        },
        "after": {
          "line": 24,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 26,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "required: [\"synopsis\"]",
      "context": {
        "before": {
          "line": 25,
          "text": "},"
        },
        "current": {
          "line": 26,
          "text": "required: [\"synopsis\"]"
        },
        "after": {
          "line": 27,
          "text": "};"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 33,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function getSynopsisJsonSchema() {",
      "context": {
        "before": {
          "line": 32,
          "text": ""
        },
        "current": {
          "line": 33,
          "text": "export function getSynopsisJsonSchema() {"
        },
        "after": {
          "line": 34,
          "text": "return SYNOPSIS_JSON_SCHEMA;"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 34,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return SYNOPSIS_JSON_SCHEMA;",
      "context": {
        "before": {
          "line": 33,
          "text": "export function getSynopsisJsonSchema() {"
        },
        "current": {
          "line": 34,
          "text": "return SYNOPSIS_JSON_SCHEMA;"
        },
        "after": {
          "line": 35,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 41,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function getSynopsisSystemPrompt(): string {",
      "context": {
        "before": {
          "line": 40,
          "text": ""
        },
        "current": {
          "line": 41,
          "text": "export function getSynopsisSystemPrompt(): string {"
        },
        "after": {
          "line": 42,
          "text": "return `You are a precise, neutral summarizer for fiction manuscripts. Your goal is to generate short, purely factual summaries of scene events for an outline database. Do not critique, do not improve the prose, and do not use flowery language.`;"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 86,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Build a prompt for generating a short Synopsis with a strict word cap.",
      "context": {
        "before": {
          "line": 85,
          "text": "/**"
        },
        "current": {
          "line": 86,
          "text": "* Build a prompt for generating a short Synopsis with a strict word cap."
        },
        "after": {
          "line": 87,
          "text": "* Synopsis is concise, skimmable navigation text for hovers and outlines."
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 87,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "* Synopsis is concise, skimmable navigation text for hovers and outlines.",
      "context": {
        "before": {
          "line": 86,
          "text": "* Build a prompt for generating a short Synopsis with a strict word cap."
        },
        "current": {
          "line": 87,
          "text": "* Synopsis is concise, skimmable navigation text for hovers and outlines."
        },
        "after": {
          "line": 88,
          "text": "*/"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 89,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "export function buildSynopsisPrompt(",
      "context": {
        "before": {
          "line": 88,
          "text": "*/"
        },
        "current": {
          "line": 89,
          "text": "export function buildSynopsisPrompt("
        },
        "after": {
          "line": 90,
          "text": "sceneBody: string,"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 97,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "return `${instructions}Read the scene below and write a concise synopsis (brief summary).",
      "context": {
        "before": {
          "line": 96,
          "text": ""
        },
        "current": {
          "line": 97,
          "text": "return `${instructions}Read the scene below and write a concise synopsis (brief summary)."
        },
        "after": {
          "line": 98,
          "text": "Return ONLY valid JSON matching this structure:"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/synopsis.ts",
      "line": 101,
      "token": "Synopsis",
      "category": "drift-term",
      "lineText": "\"synopsis\": \"Short factual synopsis of the scene.\"",
      "context": {
        "before": {
          "line": 100,
          "text": "{"
        },
        "current": {
          "line": 101,
          "text": "\"synopsis\": \"Short factual synopsis of the scene.\""
        },
        "after": {
          "line": 102,
          "text": "}"
        }
      }
    },
    {
      "filePath": "src/ai/prompts/unifiedBeatAnalysis.ts",
      "line": 10,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Note: previousScore and previousJustification are intentionally NOT included",
      "context": {
        "before": {
          "line": 9,
          "text": "idealRange: string; // e.g., \"0-20\""
        },
        "current": {
          "line": 10,
          "text": "// Note: previousScore and previousJustification are intentionally NOT included"
        },
        "after": {
          "line": 11,
          "text": "// to avoid anchoring bias. Each analysis is fresh based on manuscript content only."
        }
      }
    },
    {
      "filePath": "src/ai/prompts/unifiedBeatAnalysis.ts",
      "line": 16,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "* Note: idealRange and isWithinRange are computed in code after AI response,",
      "context": {
        "before": {
          "line": 15,
          "text": "* JSON schema for unified beat analysis response"
        },
        "current": {
          "line": 16,
          "text": "* Note: idealRange and isWithinRange are computed in code after AI response,"
        },
        "after": {
          "line": 17,
          "text": "* not requested from AI to avoid anchoring bias"
        }
      }
    },
    {
      "filePath": "src/ai/credentials/credentials.test.ts",
      "line": 50,
      "token": "legacy key",
      "category": "drift-term",
      "lineText": "it('migration moves legacy key values into Secret Storage and clears legacy fields', async () => {",
      "context": {
        "before": {
          "line": 49,
          "text": "describe('AI credentials', () => {"
        },
        "current": {
          "line": 50,
          "text": "it('migration moves legacy key values into Secret Storage and clears legacy fields', async () => {"
        },
        "after": {
          "line": 51,
          "text": "const { plugin, store } = createPlugin({"
        }
      }
    },
    {
      "filePath": "src/ai/credentials/noPlaintextKeys.test.ts",
      "line": 64,
      "token": "plaintext key",
      "category": "drift-term",
      "lineText": "describe('no plaintext key material invariant', () => {",
      "context": {
        "before": {
          "line": 63,
          "text": ""
        },
        "current": {
          "line": 64,
          "text": "describe('no plaintext key material invariant', () => {"
        },
        "after": {
          "line": 65,
          "text": "it('settings serialization keeps saved key names without plaintext key values', () => {"
        }
      }
    },
    {
      "filePath": "src/ai/credentials/noPlaintextKeys.test.ts",
      "line": 65,
      "token": "plaintext key",
      "category": "drift-term",
      "lineText": "it('settings serialization keeps saved key names without plaintext key values', () => {",
      "context": {
        "before": {
          "line": 64,
          "text": "describe('no plaintext key material invariant', () => {"
        },
        "current": {
          "line": 65,
          "text": "it('settings serialization keeps saved key names without plaintext key values', () => {"
        },
        "after": {
          "line": 66,
          "text": "const aiSettings = buildDefaultAiSettings();"
        }
      }
    },
    {
      "filePath": "scripts/check-model-updates.mjs",
      "line": 126,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "// Gemini doesn't have created dates, so we'll note all matching models",
      "context": {
        "before": {
          "line": 125,
          "text": "});"
        },
        "current": {
          "line": 126,
          "text": "// Gemini doesn't have created dates, so we'll note all matching models"
        },
        "after": {
          "line": 127,
          "text": "if (matches.length > 0) {"
        }
      }
    },
    {
      "filePath": "scripts/compliance-check.mjs",
      "line": 229,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "id: 'deprecated-frontmatter-props',",
      "context": {
        "before": {
          "line": 228,
          "text": "{"
        },
        "current": {
          "line": 229,
          "text": "id: 'deprecated-frontmatter-props',"
        },
        "after": {
          "line": 230,
          "text": "description: 'Use tags/aliases/cssclasses instead of deprecated tag/alias/cssclass (Obsidian 1.9.0+).',"
        }
      }
    },
    {
      "filePath": "scripts/compliance-check.mjs",
      "line": 230,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "description: 'Use tags/aliases/cssclasses instead of deprecated tag/alias/cssclass (Obsidian 1.9.0+).',",
      "context": {
        "before": {
          "line": 229,
          "text": "id: 'deprecated-frontmatter-props',"
        },
        "current": {
          "line": 230,
          "text": "description: 'Use tags/aliases/cssclasses instead of deprecated tag/alias/cssclass (Obsidian 1.9.0+).',"
        },
        "after": {
          "line": 231,
          "text": "// Match usage of .tag, .alias, .cssclass on objects (likely frontmatter)"
        }
      }
    },
    {
      "filePath": "scripts/compliance-check.mjs",
      "line": 242,
      "token": "DEPRECATED",
      "category": "stale-comment",
      "lineText": "case 'deprecated-frontmatter-props':",
      "context": {
        "before": {
          "line": 241,
          "text": "switch (id) {"
        },
        "current": {
          "line": 242,
          "text": "case 'deprecated-frontmatter-props':"
        },
        "after": {
          "line": 243,
          "text": "return \"Rename property to plural form (tags, aliases, cssclasses) and ensure it is an array.\";"
        }
      }
    },
    {
      "filePath": "scripts/compliance-check.mjs",
      "line": 297,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "return \"Replace element.addEventListener('event', handler) with this.registerDomEvent(element, 'event', handler) for automatic cleanup. Note: Modal classes don't have registerDomEvent and must use addEventListener.\";",
      "context": {
        "before": {
          "line": 296,
          "text": "case 'raw-addEventListener':"
        },
        "current": {
          "line": 297,
          "text": "return \"Replace element.addEventListener('event', handler) with this.registerDomEvent(element, 'event', handler) for automatic cleanup. Note: Modal classes don't have registerDomEvent and must use addEventListener.\";"
        },
        "after": {
          "line": 298,
          "text": "case 'fetch-without-signal':"
        }
      }
    },
    {
      "filePath": "scripts/css-drift-check.mjs",
      "line": 198,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "// 1) !important (fail)",
      "context": {
        "before": {
          "line": 197,
          "text": ""
        },
        "current": {
          "line": 198,
          "text": "// 1) !important (fail)"
        },
        "after": {
          "line": 199,
          "text": "for (const m of findAll(/!important\\b/g, css)) {"
        }
      }
    },
    {
      "filePath": "scripts/css-drift-check.mjs",
      "line": 199,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "for (const m of findAll(/!important\\b/g, css)) {",
      "context": {
        "before": {
          "line": 198,
          "text": "// 1) !important (fail)"
        },
        "current": {
          "line": 199,
          "text": "for (const m of findAll(/!important\\b/g, css)) {"
        },
        "after": {
          "line": 200,
          "text": "addFail("
        }
      }
    },
    {
      "filePath": "scripts/css-drift-check.mjs",
      "line": 202,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "\"Found !important (ban).\",",
      "context": {
        "before": {
          "line": 201,
          "text": "file,"
        },
        "current": {
          "line": 202,
          "text": "\"Found !important (ban).\","
        },
        "after": {
          "line": 203,
          "text": "\"!important\","
        }
      }
    },
    {
      "filePath": "scripts/css-drift-check.mjs",
      "line": 203,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "\"!important\",",
      "context": {
        "before": {
          "line": 202,
          "text": "\"Found !important (ban).\","
        },
        "current": {
          "line": 203,
          "text": "\"!important\","
        },
        "after": {
          "line": 204,
          "text": "\"important\","
        }
      }
    },
    {
      "filePath": "scripts/css-drift-check.mjs",
      "line": 204,
      "token": "IMPORTANT",
      "category": "stale-comment",
      "lineText": "\"important\",",
      "context": {
        "before": {
          "line": 203,
          "text": "\"!important\","
        },
        "current": {
          "line": 204,
          "text": "\"important\","
        },
        "after": {
          "line": 205,
          "text": "getLineNumber(lineStarts, m.index)"
        }
      }
    },
    {
      "filePath": "scripts/echo-branch.mjs",
      "line": 23,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "console.log(`[note] Backup will commit to 'master'.`);",
      "context": {
        "before": {
          "line": 22,
          "text": "if (mode === 'backup') {"
        },
        "current": {
          "line": 23,
          "text": "console.log(`[note] Backup will commit to 'master'.`);"
        },
        "after": {
          "line": 24,
          "text": "}"
        }
      }
    },
    {
      "filePath": "scripts/publish-wiki.mjs",
      "line": 23,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "// 1. Clean up previous temp dir",
      "context": {
        "before": {
          "line": 22,
          "text": ""
        },
        "current": {
          "line": 23,
          "text": "// 1. Clean up previous temp dir"
        },
        "after": {
          "line": 24,
          "text": "if (fs.existsSync(TEMP_DIR)) {"
        }
      }
    },
    {
      "filePath": "scripts/publish-wiki.mjs",
      "line": 25,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "console.log('Cleaning up previous temp directory...');",
      "context": {
        "before": {
          "line": 24,
          "text": "if (fs.existsSync(TEMP_DIR)) {"
        },
        "current": {
          "line": 25,
          "text": "console.log('Cleaning up previous temp directory...');"
        },
        "after": {
          "line": 26,
          "text": "fs.rmSync(TEMP_DIR, { recursive: true, force: true });"
        }
      }
    },
    {
      "filePath": "scripts/publish-wiki.mjs",
      "line": 33,
      "token": "TEMP",
      "category": "stale-comment",
      "lineText": "// 3. Copy files from 'wiki/' to temp dir",
      "context": {
        "before": {
          "line": 32,
          "text": ""
        },
        "current": {
          "line": 33,
          "text": "// 3. Copy files from 'wiki/' to temp dir"
        },
        "after": {
          "line": 34,
          "text": "console.log(`Copying files from ${SOURCE_DIR} to ${TEMP_DIR}...`);"
        }
      }
    },
    {
      "filePath": "scripts/sync-yaml-to-wiki.mjs",
      "line": 36,
      "token": "NOTE",
      "category": "stale-comment",
      "lineText": "> **Note:** This page is auto-generated from [\\`docs/YAML_REFERENCE.md\\`](../YAML_REFERENCE.md)",
      "context": {
        "before": {
          "line": 35,
          "text": ""
        },
        "current": {
          "line": 36,
          "text": "> **Note:** This page is auto-generated from [\\`docs/YAML_REFERENCE.md\\`](../YAML_REFERENCE.md)"
        },
        "after": {
          "line": 37,
          "text": "> Last synced: ${new Date().toISOString()}"
        }
      }
    }
  ]
}
